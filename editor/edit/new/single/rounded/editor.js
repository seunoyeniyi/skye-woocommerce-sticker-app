(()=>{var t={34851:(t,exports,e)=>{(t.exports=e(62132)(!1)).push([t.id,"/* Copyright 2017 Sticker App AB */\r\n\r\n.svgContainer {\r\n  background-color: #f5f5f5;\r\n}\r\n\r\n.svgSheet {\r\n  fill: none;\r\n  stroke: none;\r\n}\r\n\r\n.svgSheet.sheet {\r\n  fill: white;\r\n}\r\n.svgSheet.skin {\r\n}\r\n.svgSheet.case {\r\n}\r\n.svgSheet.single {\r\n}\r\n\r\n.svgSheetPath {\r\n  fill: none;\r\n  stroke: none;\r\n  stroke-width: 2;\r\n}\r\n\r\n.svgSheetPath.sheet {\r\n  fill: none;\r\n  stroke: rgb(0, 0, 0);\r\n  stroke-width: 0.5;\r\n}\r\n.svgSheetPath.skin {\r\n}\r\n.svgSheetPath.case {\r\n}\r\n.svgSheetPath.single {\r\n}\r\n\r\n.svgPartPath {\r\n  fill: none;\r\n  stroke: #ff00ff;\r\n  stroke-width: 1;\r\n}\r\n\r\n.svgPartPathHover {\r\n  stroke: #000;\r\n  stroke-width: 1.1;\r\n}\r\n\r\n.svgPartPath.partImage {\r\n  fill: none;\r\n  stroke: none;\r\n  stroke-width: 1;\r\n}\r\n\r\n.svgPartPathHover.partImage {\r\n  stroke: #000;\r\n  stroke-width: 1.1;\r\n}\r\n\r\n.svgPartBleedPath {\r\n  fill: none;\r\n  stroke: #0096ff;\r\n  stroke-width: 1;\r\n}\r\n/*\r\nbody.case .svgPartPath,\r\nbody.skin .svgPartPath {\r\n  fill: none;\r\n\tstroke: rgb(0, 150, 255);\r\n}\r\nbody.case .svgPartBleedPath,\r\nbody.skin .svgPartBleedPath {\r\n  fill: none;\r\n\tstroke: rgb(255,0,255);\r\n}\r\n*/\r\n\r\n.svgShadowSheet {\r\n  display: none;\r\n  fill: none;\r\n  stroke: black;\r\n  stroke-opacity: 0.5;\r\n  stroke-width: 1;\r\n}\r\n\r\n.svgShadowPath {\r\n  fill: none;\r\n  stroke: black;\r\n  stroke-opacity: 0.5;\r\n  stroke-width: 0;\r\n}\r\n\r\n.svgShadowOverlay {\r\n  fill: #e8e8e8;\r\n  stroke: none;\r\n  fill-opacity: 0.5;\r\n}\r\n\r\n.svgCollageShadowOverlay {\r\n  fill: black;\r\n  stroke: none;\r\n  fill-opacity: 0.4;\r\n}\r\n\r\n.svgHover {\r\n  stroke-width: 1px;\r\n  fill: none;\r\n  stroke: #000;\r\n  cursor: pointer;\r\n}\r\n.svgHover.move {\r\n  cursor: move;\r\n}\r\n\r\n.svgSelect {\r\n  fill: none;\r\n  stroke: black;\r\n  stroke-width: 1;\r\n  cursor: move;\r\n}\r\n\r\n.svgSelectCorner {\r\n  fill: white;\r\n  stroke: green;\r\n  stroke-width: 2;\r\n}\r\n\r\n.svgSelectNW {\r\n  cursor: nw-resize;\r\n}\r\n\r\n.svgSelectNE {\r\n  cursor: ne-resize;\r\n}\r\n\r\n.svgSelectSE {\r\n  cursor: se-resize;\r\n}\r\n\r\n.svgSelectSW {\r\n  cursor: sw-resize;\r\n}\r\n\r\n.svgSelectN {\r\n  cursor: n-resize;\r\n}\r\n\r\n.svgSelectE {\r\n  cursor: e-resize;\r\n}\r\n\r\n.svgSelectS {\r\n  cursor: s-resize;\r\n}\r\n\r\n.svgSelectW {\r\n  cursor: w-resize;\r\n}\r\n\r\n.svgSelectRotate {\r\n  /*  fill : none;*/\r\n  /*  stroke : none; */\r\n  cursor: e-resize;\r\n}\r\n\r\n.svgSelectRotateLine {\r\n  stroke: #000;\r\n  stroke-width: 1;\r\n}\r\n\r\n.svgSelectIcon {\r\n  cursor: pointer;\r\n}\r\n\r\n.svgPartSizeText {\r\n  fill: #000;\r\n  font-family: sans-serif;\r\n  pointer-events: none;\r\n}\r\n.editor.preview-on .svgPartSizeText {\r\n  fill: #666;\r\n}\r\n\r\n.svgSheetSizeText {\r\n  fill: #000;\r\n  font-size: 20px;\r\n  font-family: sans-serif;\r\n  pointer-events: none;\r\n}\r\n\r\n.svgIcon {\r\n  stroke: none;\r\n  stroke-width: 2px;\r\n  fill: #363636;\r\n}\r\n.svgIcon:hover {\r\n  fill: #000;\r\n}\r\n\r\n.svgIconRound {\r\n  padding: 12.5px;\r\n}\r\n\r\n.svgIconRect {\r\n  padding: 25px;\r\n  border-radius: 25px;\r\n}\r\n\r\n.svgIconMenu {\r\n  stroke: none;\r\n  stroke-width: 2px;\r\n  fill: #363636;\r\n  padding: 35px;\r\n  border-radius: 25px;\r\n  margin-left: 35px;\r\n  margin-top: 30px;\r\n}\r\n.svgIconMenu:hover {\r\n  fill: #000;\r\n}\r\n\r\n.svgIconMenuTouch {\r\n  stroke: none;\r\n  fill: #363636;\r\n  padding: 35px;\r\n  border-radius: 25px;\r\n  margin-left: 40px;\r\n  margin-top: 32px;\r\n}\r\n\r\n.svgCollagePath {\r\n  fill: none;\r\n  stroke: grey;\r\n  stroke-width: 0.5px;\r\n}\r\n\r\n.svgCollagePath.drag {\r\n  fill: none;\r\n  stroke: black;\r\n  stroke-width: 1px;\r\n}\r\n\r\n.svgCollagePath.drop {\r\n  fill: none;\r\n  stroke: black;\r\n  stroke-width: 1px;\r\n}\r\n",""])},87201:t=>{t.exports='!function(t){"use strict";"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof exports&&"object"==typeof module?module.exports=t(require("jquery")):t(jQuery)}(function(Tt,Ot){"use strict";var qt={beforeShow:e,move:e,change:e,show:e,hide:e,color:!1,flat:!1,showInput:!1,allowEmpty:!1,showButtons:!0,clickoutFiresChange:!0,showInitial:!1,showPalette:!1,showPaletteOnly:!1,hideAfterPaletteSelect:!1,togglePaletteOnly:!1,showSelectionPalette:!0,localStorageKey:!1,appendTo:"body",maxSelectionSize:7,cancelText:"cancel",chooseText:"choose",togglePaletteMoreText:"more",togglePaletteLessText:"less",clearText:"Clear Color Selection",noColorSelectedText:"No Color Selected",preferredFormat:!1,className:"",containerClassName:"",replacerClassName:"",showAlpha:!1,theme:"sp-light",palette:[["#ffffff","#000000","#ff0000","#ff8000","#ffff00","#008000","#0000ff","#4b0082","#9400d3"]],selectionPalette:[],disabled:!1,offset:null},Nt=[],jt=!!/msie/i.exec(window.navigator.userAgent),Et=((u=document.createElement("div").style).cssText="background-color:rgba(0,0,0,.5)",t(u.backgroundColor,"rgba")||t(u.backgroundColor,"hsla")),Lt=["<div class=\'sp-replacer\'>","<div class=\'sp-preview\'><div class=\'sp-preview-inner\'></div></div>","<div class=\'sp-dd\'>&#9660;</div>","</div>"].join(""),Kt=function(){var t="";if(jt)for(var e=1;e<=6;e++)t+="<div class=\'sp-"+e+"\'></div>";return["<div class=\'sp-container sp-hidden\'>","<div class=\'sp-palette-container\'>","<div class=\'sp-palette sp-thumb sp-cf\'></div>","<div class=\'sp-palette-button-container sp-cf\'>","<button type=\'button\' class=\'sp-palette-toggle\'></button>","</div>","</div>","<div class=\'sp-picker-container\'>","<div class=\'sp-top sp-cf\'>","<div class=\'sp-fill\'></div>","<div class=\'sp-top-inner\'>","<div class=\'sp-color\'>","<div class=\'sp-sat\'>","<div class=\'sp-val\'>","<div class=\'sp-dragger\'></div>","</div>","</div>","</div>","<div class=\'sp-clear sp-clear-display\'>","</div>","<div class=\'sp-hue\'>","<div class=\'sp-slider\'></div>",t,"</div>","</div>","<div class=\'sp-alpha\'><div class=\'sp-alpha-inner\'><div class=\'sp-alpha-handle\'></div></div></div>","</div>","<div class=\'sp-input-container sp-cf\'>","<input class=\'sp-input\' type=\'text\' spellcheck=\'false\'  />","</div>","<div class=\'sp-initial sp-thumb sp-cf\'></div>","<div class=\'sp-button-container sp-cf\'>","<a class=\'sp-cancel\' href=\'#\'></a>","<button type=\'button\' class=\'sp-choose\'></button>","</div>","</div>","</div>"].join("")}();function t(t,e){return!!~(""+t).indexOf(e)}function Dt(t,e,r,n){for(var a=[],o=0;o<t.length;o++){var i,s,l,c=t[o];c?(s=(i=tinycolor(c)).toHsl().l<.5?"sp-thumb-el sp-thumb-dark":"sp-thumb-el sp-thumb-light",s+=tinycolor.equals(e,c)?" sp-thumb-active":"",c=i.toString(n.preferredFormat||"rgb"),l=Et?"background-color:"+i.toRgbString():"filter:"+i.toFilter(),a.push(\'<span title="\'+c+\'" data-color="\'+i.toRgbString()+\'" class="\'+s+\'"><span class="sp-thumb-inner" style="\'+l+\';"></span></span>\')):a.push(Tt("<div />").append(Tt(\'<span data-color="" style="background-color:transparent;" class="sp-clear-display"></span>\').attr("title",n.noColorSelectedText)).html())}return"<div class=\'sp-cf "+r+"\'>"+a.join("")+"</div>"}function P(t,e){e=e,a=t,(e=Tt.extend({},qt,e)).callbacks={move:It(e.move,a),change:It(e.change,a),show:It(e.show,a),hide:It(e.hide,a),beforeShow:It(e.beforeShow,a)};var j,E,D,I,r,l=e,c=l.flat,z=l.showSelectionPalette,n=l.localStorageKey,a=l.theme,o=l.callbacks,B=(j=N,function(){var t=this,e=arguments;D&&clearTimeout(I),!D&&I||(I=setTimeout(function(){I=null,j.apply(t,e)},E))}),f=!(E=10),L=!1,h=0,u=0,d=0,K=0,V=0,$=0,W=0,i=0,s=0,p=0,g=1,X=[],b=[],Y={},m=l.selectionPalette.slice(0),G=l.maxSelectionSize,Q="sp-dragging",v=null,y=t.ownerDocument,w=(y.body,Tt(t)),J=!1,_=Tt(Kt,y).addClass(a),U=_.find(".sp-picker-container"),Z=_.find(".sp-color"),tt=_.find(".sp-dragger"),et=_.find(".sp-hue"),rt=_.find(".sp-slider"),nt=_.find(".sp-alpha-inner"),at=_.find(".sp-alpha"),ot=_.find(".sp-alpha-handle"),x=_.find(".sp-input"),it=_.find(".sp-palette"),st=_.find(".sp-initial"),e=_.find(".sp-cancel"),t=_.find(".sp-clear"),lt=_.find(".sp-choose"),ct=_.find(".sp-palette-toggle"),ft=w.is("input"),ht=ft&&"color"===w.attr("type")&&Bt(),ut=ft&&!c,k=ut?Tt(Lt).addClass(a).addClass(l.className).addClass(l.replacerClassName):Tt([]),dt=ut?k:w,S=k.find(".sp-preview-inner"),a=l.color||ft&&w.val(),C=!1,P=l.preferredFormat,pt=!l.showButtons||l.clickoutFiresChange,A=!a,M=l.allowEmpty&&!ht;function gt(){if(l.showPaletteOnly&&(l.showPalette=!0),ct.text(l.showPaletteOnly?l.togglePaletteMoreText:l.togglePaletteLessText),l.palette){X=l.palette.slice(0),b=Tt.isArray(X[0])?X:[X],Y={};for(var t=0;t<b.length;t++)for(var e=0;e<b[t].length;e++){var r=tinycolor(b[t][e]).toRgbString();Y[r]=!0}}_.toggleClass("sp-flat",c),_.toggleClass("sp-input-disabled",!l.showInput),_.toggleClass("sp-alpha-enabled",l.showAlpha),_.toggleClass("sp-clear-enabled",M),_.toggleClass("sp-buttons-disabled",!l.showButtons),_.toggleClass("sp-palette-buttons-disabled",!l.togglePaletteOnly),_.toggleClass("sp-palette-disabled",!l.showPalette),_.toggleClass("sp-palette-only",l.showPaletteOnly),_.toggleClass("sp-initial-disabled",!l.showInitial),_.addClass(l.className).addClass(l.containerClassName),N()}function bt(){if(n&&window.localStorage){try{var t=window.localStorage[n].split(",#");1<t.length&&(delete window.localStorage[n],Tt.each(t,function(t,e){mt(e)}))}catch(t){}try{m=window.localStorage[n].split(";")}catch(t){}}}function mt(t){if(z){t=tinycolor(t).toRgbString();if(!Y[t]&&-1===Tt.inArray(t,m))for(m.push(t);m.length>G;)m.shift();if(n&&window.localStorage)try{window.localStorage[n]=m.join(";")}catch(t){}}}function vt(){var r=F(),t=Tt.map(b,function(t,e){return Dt(t,r,"sp-palette-row sp-palette-row-"+e,l)});bt(),m&&t.push(Dt(function(){var t=[];if(l.showPalette)for(var e=0;e<m.length;e++){var r=tinycolor(m[e]).toRgbString();Y[r]||t.push(m[e])}return t.reverse().slice(0,l.maxSelectionSize)}(),r,"sp-palette-row sp-palette-row-selection",l)),it.html(t.join(""))}function yt(){var t,e;l.showInitial&&(t=C,e=F(),st.html(Dt([t,e],e,"sp-palette-row-initial",l)))}function wt(){(u<=0||h<=0||K<=0)&&N(),L=!0,_.addClass(Q),v=null,w.trigger("dragstart.spectrum",[F()])}function _t(){L=!1,_.removeClass(Q),w.trigger("dragstop.spectrum",[F()])}function xt(){var t=x.val();null!==t&&""!==t||!M?(t=tinycolor(t)).isValid()?(H(t),T(),q()):x.addClass("sp-validation-error"):(H(null),T(),q())}function kt(){(f?R:St)()}function St(){var t=Tt.Event("beforeShow.spectrum");if(f)N();else if(w.trigger(t,[F()]),!1!==o.beforeShow(F())&&!t.isDefaultPrevented()){for(var e=0;e<Nt.length;e++)Nt[e]&&Nt[e].hide();f=!0,Tt(y).on("keydown.spectrum",Ct),Tt(y).on("click.spectrum",Pt),Tt(window).on("resize.spectrum",B),k.addClass("sp-active"),_.removeClass("sp-hidden"),N(),O(),C=F(),yt(),o.show(C),w.trigger("show.spectrum",[C])}}function Ct(t){27===t.keyCode&&R()}function Pt(t){2==t.button||L||(pt?q(!0):At(),R())}function R(){f&&!c&&(f=!1,Tt(y).off("keydown.spectrum",Ct),Tt(y).off("click.spectrum",Pt),Tt(window).off("resize.spectrum",B),k.removeClass("sp-active"),_.addClass("sp-hidden"),o.hide(F()),w.trigger("hide.spectrum",[F()]))}function At(){H(C,!0),q(!0)}function H(t,e){var r;tinycolor.equals(t,F())?O():(!t&&M?A=!0:(A=!1,t=(r=tinycolor(t)).toHsv(),i=t.h%360/360,s=t.s,p=t.v,g=t.a),O(),r&&r.isValid()&&!e&&(P=l.preferredFormat||r.getFormat()))}function F(t){return t=t||{},M&&A?null:tinycolor.fromRatio({h:i,s:s,v:p,a:Math.round(1e3*g)/1e3},{format:t.format||P})}function T(){O(),o.move(F()),w.trigger("move.spectrum",[F()])}function O(){x.removeClass("sp-validation-error"),Mt();var t,e,r,n=tinycolor.fromRatio({h:i,s:1,v:1}),n=(Z.css("background-color",n.toHexString()),P),a=F({format:n=!(g<1)||0===g&&"name"===P||"hex"!==P&&"hex3"!==P&&"hex6"!==P&&"name"!==P?P:"rgb"}),o="";S.removeClass("sp-clear-display"),S.css("background-color","transparent"),!a&&M?S.addClass("sp-clear-display"):(t=a.toHexString(),e=a.toRgbString(),Et||1===a.alpha?S.css("background-color",e):(S.css("background-color","transparent"),S.css("filter",a.toFilter())),l.showAlpha&&((e=a.toRgb()).a=0,r="linear-gradient(left, "+(e=tinycolor(e).toRgbString())+", "+t+")",jt?nt.css("filter",tinycolor(e).toFilter({gradientType:1},t)):(nt.css("background","-webkit-"+r),nt.css("background","-moz-"+r),nt.css("background","-ms-"+r),nt.css("background","linear-gradient(to right, "+e+", "+t+")"))),o=a.toString(n)),l.showInput&&x.val(o),l.showPalette&&vt(),yt()}function Mt(){var t=s,e=p;M&&A?(ot.hide(),rt.hide(),tt.hide()):(ot.show(),rt.show(),tt.show(),t=t*h,e=u-e*u,t=Math.max(-d,Math.min(h-d,t-d)),e=Math.max(-d,Math.min(u-d,e-d)),tt.css({top:e+"px",left:t+"px"}),e=g*V,ot.css({left:e-$/2+"px"}),t=i*K,rt.css({top:t-W+"px"}))}function q(t){var e=F(),r="",n=!tinycolor.equals(e,C);e&&(r=e.toString(P),mt(e)),ft&&w.val(r),t&&n&&(o.change(e),w.trigger("change",[e]))}function N(){var t,e,r,n,a,o,i,s;f&&(h=Z.width(),u=Z.height(),d=tt.height(),et.width(),K=et.height(),W=rt.height(),V=at.width(),$=ot.width(),c||(_.css("position","absolute"),l.offset?_.offset(l.offset):_.offset((e=dt,r=(t=_).outerWidth(),n=t.outerHeight(),a=e.outerHeight(),t=t[0].ownerDocument,o=t.documentElement,i=o.clientWidth+Tt(t).scrollLeft(),o=o.clientHeight+Tt(t).scrollTop(),e=(t=e.offset()).left,s=t.top,s+=a,e-=Math.min(e,i<e+r&&r<i?Math.abs(e+r-i):0),{top:s-=Math.min(s,o<s+n&&n<o?Math.abs(+(n+a)):0),bottom:t.bottom,left:e,right:t.right,width:t.width,height:t.height}))),Mt(),l.showPalette&&vt(),w.trigger("reflow.spectrum"))}function Rt(){R(),J=!0,w.attr("disabled",!0),dt.addClass("sp-disabled")}function Ht(t){return t.data&&t.data.ignore?(H(Tt(t.target).closest(".sp-thumb-el").data("color")),T()):(H(Tt(t.target).closest(".sp-thumb-el").data("color")),T(),l.hideAfterPaletteSelect?(q(!0),R()):q()),!1}jt&&_.find("*:not(input)").attr("unselectable","on"),gt(),ut&&w.after(k).hide(),M||t.hide(),c?w.after(_).hide():(r=1!==(r="parent"===l.appendTo?w.parent():Tt(l.appendTo)).length?Tt("body"):r).append(_),bt(),dt.on("click.spectrum touchstart.spectrum",function(t){J||kt(),t.stopPropagation(),Tt(t.target).is("input")||t.preventDefault()}),!w.is(":disabled")&&!0!==l.disabled||Rt(),_.click(Vt),x.change(xt),x.on("paste",function(){setTimeout(xt,1)}),x.keydown(function(t){13==t.keyCode&&xt()}),e.text(l.cancelText),e.on("click.spectrum",function(t){t.stopPropagation(),t.preventDefault(),At(),R()}),t.attr("title",l.clearText),t.on("click.spectrum",function(t){t.stopPropagation(),t.preventDefault(),A=!0,T(),c&&q(!0)}),lt.text(l.chooseText),lt.on("click.spectrum",function(t){t.stopPropagation(),t.preventDefault(),jt&&x.is(":focus")&&x.trigger("change"),x.hasClass("sp-validation-error")||(q(!0),R())}),ct.text(l.showPaletteOnly?l.togglePaletteMoreText:l.togglePaletteLessText),ct.on("click.spectrum",function(t){t.stopPropagation(),t.preventDefault(),l.showPaletteOnly=!l.showPaletteOnly,l.showPaletteOnly||c||_.css("left","-="+(U.outerWidth(!0)+5)),gt()}),zt(at,function(t,e,r){g=t/V,A=!1,r.shiftKey&&(g=Math.round(10*g)/10),T()},wt,_t),zt(et,function(t,e){i=parseFloat(e/K),A=!1,l.showAlpha||(g=1),T()},wt,_t),zt(Z,function(t,e,r){r.shiftKey?v||(r=s*h,n=u-p*u,r=Math.abs(t-r)>Math.abs(e-n),v=r?"x":"y"):v=null;var n=!v||"x"===v,r=!v||"y"===v;n&&(s=parseFloat(t/h)),r&&(p=parseFloat((u-e)/u)),A=!1,l.showAlpha||(g=1),T()},wt,_t),a?(H(a),O(),P=l.preferredFormat||tinycolor(a).format,mt(a)):O(),c&&St(),r=jt?"mousedown.spectrum":"click.spectrum touchstart.spectrum",it.on(r,".sp-thumb-el",Ht),st.on(r,".sp-thumb-el:nth-child(1)",{ignore:!0},Ht);var Ft={show:St,hide:R,toggle:kt,reflow:N,option:function(t,e){return t===Ot?Tt.extend({},l):e===Ot?l[t]:(l[t]=e,"preferredFormat"===t&&(P=l.preferredFormat),void gt())},enable:function(){J=!1,w.attr("disabled",!1),dt.removeClass("sp-disabled")},disable:Rt,offset:function(t){l.offset=t,N()},set:function(t){H(t),q()},get:F,destroy:function(){w.show(),dt.off("click.spectrum touchstart.spectrum"),_.remove(),k.remove(),Nt[Ft.id]=null},container:_};return Ft.id=Nt.push(Ft)-1,Ft}function e(){}function Vt(t){t.stopPropagation()}function It(t,e){var r=Array.prototype.slice,n=r.call(arguments,2);return function(){return t.apply(e,n.concat(r.call(arguments)))}}function zt(n,a,e,t){a=a||function(){},e=e||function(){},t=t||function(){};var o=document,i=!1,s={},l=0,c=0,f="ontouchstart"in window,r={};function h(t){t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),t.returnValue=!1}function u(t){if(i){if(jt&&o.documentMode<9&&!t.button)return d();var e=t.originalEvent&&t.originalEvent.touches&&t.originalEvent.touches[0],r=e&&e.pageX||t.pageX,e=e&&e.pageY||t.pageY,r=Math.max(0,Math.min(r-s.left,c)),e=Math.max(0,Math.min(e-s.top,l));f&&h(t),a.apply(n,[r,e,t])}}function d(){i&&(Tt(o).off(r),Tt(o.body).removeClass("sp-dragging"),setTimeout(function(){t.apply(n,arguments)},0)),i=!1}r.selectstart=h,r.dragstart=h,r["touchmove mousemove"]=u,r["touchend mouseup"]=d,Tt(n).on("touchstart mousedown",function(t){(t.which?3==t.which:2==t.button)||i||!1!==e.apply(n,arguments)&&(i=!0,l=Tt(n).height(),c=Tt(n).width(),s=Tt(n).offset(),Tt(o).on(r),Tt(o.body).addClass("sp-dragging"),u(t),h(t))})}function Bt(){return Tt.fn.spectrum.inputTypeColorSupport()}var o,i,n,s,a,c,f,r,l,h,u,d,p,g="spectrum.id";function b(t,e){if(e=e||{},(t=t||"")instanceof b)return t;if(!(this instanceof b))return new b(t,e);var r=function(t){var e={r:0,g:0,b:0},r=1,n=!1,a=!1;"string"==typeof t&&(t=function(t){t=t.replace(o,"").replace(i,"").toLowerCase();var e,r=!1;if(l[t])t=l[t],r=!0;else if("transparent"==t)return{r:0,g:0,b:0,a:0,format:"name"};if(e=p.rgb.exec(t))return{r:e[1],g:e[2],b:e[3]};if(e=p.rgba.exec(t))return{r:e[1],g:e[2],b:e[3],a:e[4]};if(e=p.hsl.exec(t))return{h:e[1],s:e[2],l:e[3]};if(e=p.hsla.exec(t))return{h:e[1],s:e[2],l:e[3],a:e[4]};if(e=p.hsv.exec(t))return{h:e[1],s:e[2],v:e[3]};if(e=p.hsva.exec(t))return{h:e[1],s:e[2],v:e[3],a:e[4]};if(e=p.hex8.exec(t))return{a:function(t){return k(t)/255}(e[1]),r:k(e[2]),g:k(e[3]),b:k(e[4]),format:r?"name":"hex8"};if(e=p.hex6.exec(t))return{r:k(e[1]),g:k(e[2]),b:k(e[3]),format:r?"name":"hex"};if(e=p.hex3.exec(t))return{r:k(e[1]+""+e[1]),g:k(e[2]+""+e[2]),b:k(e[3]+""+e[3]),format:r?"name":"hex"};return!1}(t));"object"==typeof t&&(t.hasOwnProperty("r")&&t.hasOwnProperty("g")&&t.hasOwnProperty("b")?(e=function(t,e,r){return{r:255*_(t,255),g:255*_(e,255),b:255*_(r,255)}}(t.r,t.g,t.b),n=!0,a="%"===String(t.r).substr(-1)?"prgb":"rgb"):t.hasOwnProperty("h")&&t.hasOwnProperty("s")&&t.hasOwnProperty("v")?(t.s=C(t.s),t.v=C(t.v),e=function(t,e,r){t=6*_(t,360),e=_(e,100),r=_(r,100);var n=s.floor(t),t=t-n,a=r*(1-e),o=r*(1-t*e),t=r*(1-(1-t)*e),e=n%6;return{r:255*[r,o,a,a,t,r][e],g:255*[t,r,r,o,a,a][e],b:255*[a,a,t,r,r,o][e]}}(t.h,t.s,t.v),n=!0,a="hsv"):t.hasOwnProperty("h")&&t.hasOwnProperty("s")&&t.hasOwnProperty("l")&&(t.s=C(t.s),t.l=C(t.l),e=function(t,e,r){var n,a,o;function i(t,e,r){return r<0&&(r+=1),1<r&&--r,r<1/6?t+6*(e-t)*r:r<.5?e:r<2/3?t+(e-t)*(2/3-r)*6:t}t=_(t,360),e=_(e,100),r=_(r,100),0===e?n=a=o=r:(n=i(e=2*r-(r=r<.5?r*(1+e):r+e-r*e),r,t+1/3),a=i(e,r,t),o=i(e,r,t-1/3));return{r:255*n,g:255*a,b:255*o}}(t.h,t.s,t.l),n=!0,a="hsl"),t.hasOwnProperty("a")&&(r=t.a));return r=z(r),{ok:n,format:t.format||a,r:c(255,f(e.r,0)),g:c(255,f(e.g,0)),b:c(255,f(e.b,0)),a:r}}(t);this._originalInput=t,this._r=r.r,this._g=r.g,this._b=r.b,this._a=r.a,this._roundA=a(1e3*this._a)/1e3,this._format=e.format||r.format,this._gradientType=e.gradientType,this._r<1&&(this._r=a(this._r)),this._g<1&&(this._g=a(this._g)),this._b<1&&(this._b=a(this._b)),this._ok=r.ok,this._tc_id=n++}function m(t,e,r){t=_(t,255),e=_(e,255),r=_(r,255);var n,a=f(t,e,r),o=c(t,e,r),i=(a+o)/2;if(a==o)n=l=0;else{var s=a-o,l=.5<i?s/(2-a-o):s/(a+o);switch(a){case t:n=(e-r)/s+(e<r?6:0);break;case e:n=(r-t)/s+2;break;case r:n=(t-e)/s+4}n/=6}return{h:n,s:l,l:i}}function v(t,e,r){t=_(t,255),e=_(e,255),r=_(r,255);var n,a=f(t,e,r),o=c(t,e,r),i=a,s=a-o,l=0===a?0:s/a;if(a==o)n=0;else{switch(a){case t:n=(e-r)/s+(e<r?6:0);break;case e:n=(r-t)/s+2;break;case r:n=(t-e)/s+4}n/=6}return{h:n,s:l,v:i}}function y(t,e,r,n){t=[S(a(t).toString(16)),S(a(e).toString(16)),S(a(r).toString(16))];return n&&t[0].charAt(0)==t[0].charAt(1)&&t[1].charAt(0)==t[1].charAt(1)&&t[2].charAt(0)==t[2].charAt(1)?t[0].charAt(0)+t[1].charAt(0)+t[2].charAt(0):t.join("")}function w(t,e,r,n){return[S(Math.round(255*parseFloat(n)).toString(16)),S(a(t).toString(16)),S(a(e).toString(16)),S(a(r).toString(16))].join("")}function A(t,e){e=0===e?0:e||10;t=b(t).toHsl();return t.s-=e/100,t.s=x(t.s),b(t)}function M(t,e){e=0===e?0:e||10;t=b(t).toHsl();return t.s+=e/100,t.s=x(t.s),b(t)}function R(t){return b(t).desaturate(100)}function H(t,e){e=0===e?0:e||10;t=b(t).toHsl();return t.l+=e/100,t.l=x(t.l),b(t)}function F(t,e){e=0===e?0:e||10;t=b(t).toRgb();return t.r=f(0,c(255,t.r-a(-e/100*255))),t.g=f(0,c(255,t.g-a(-e/100*255))),t.b=f(0,c(255,t.b-a(-e/100*255))),b(t)}function T(t,e){e=0===e?0:e||10;t=b(t).toHsl();return t.l-=e/100,t.l=x(t.l),b(t)}function O(t,e){t=b(t).toHsl(),e=(a(t.h)+e)%360;return t.h=e<0?360+e:e,b(t)}function q(t){t=b(t).toHsl();return t.h=(t.h+180)%360,b(t)}function N(t){var e=b(t).toHsl(),r=e.h;return[b(t),b({h:(r+120)%360,s:e.s,l:e.l}),b({h:(r+240)%360,s:e.s,l:e.l})]}function j(t){var e=b(t).toHsl(),r=e.h;return[b(t),b({h:(r+90)%360,s:e.s,l:e.l}),b({h:(r+180)%360,s:e.s,l:e.l}),b({h:(r+270)%360,s:e.s,l:e.l})]}function E(t){var e=b(t).toHsl(),r=e.h;return[b(t),b({h:(r+72)%360,s:e.s,l:e.l}),b({h:(r+216)%360,s:e.s,l:e.l})]}function D(t,e,r){e=e||6,r=r||30;var n=b(t).toHsl(),a=360/r,o=[b(t)];for(n.h=(n.h-(a*e>>1)+720)%360;--e;)n.h=(n.h+a)%360,o.push(b(n));return o}function I(t,e){e=e||6;for(var t=b(t).toHsv(),r=t.h,n=t.s,a=t.v,o=[],i=1/e;e--;)o.push(b({h:r,s:n,v:a})),a=(a+i)%1;return o}function z(t){return t=parseFloat(t),t=isNaN(t)||t<0||1<t?1:t}function _(t,e){"string"==typeof(r=t)&&-1!=r.indexOf(".")&&1===parseFloat(r)&&(t="100%");var r="string"==typeof(r=t)&&-1!=r.indexOf("%");return t=c(e,f(0,parseFloat(t))),r&&(t=parseInt(t*e,10)/100),s.abs(t-e)<1e-6?1:t%e/parseFloat(e)}function x(t){return c(1,f(0,t))}function k(t){return parseInt(t,16)}function S(t){return 1==t.length?"0"+t:""+t}function C(t){return t=t<=1?100*t+"%":t}Tt.fn.spectrum=function(r,t){var n,a;return"string"==typeof r?(n=this,a=Array.prototype.slice.call(arguments,1),this.each(function(){var t=Nt[Tt(this).data(g)];if(t){var e=t[r];if(!e)throw new Error("Spectrum: no such method: \'"+r+"\'");"get"==r?n=t.get():"container"==r?n=t.container:"option"==r?n=t.option.apply(t,a):"destroy"==r?(t.destroy(),Tt(this).removeData(g)):e.apply(t,a)}}),n):this.spectrum("destroy").each(function(){var t=P(this,Tt.extend({},Tt(this).data(),r));Tt(this).data(g,t.id)})},Tt.fn.spectrum.load=!0,Tt.fn.spectrum.loadOpts={},Tt.fn.spectrum.draggable=zt,Tt.fn.spectrum.defaults=qt,Tt.fn.spectrum.inputTypeColorSupport=function t(){var e;return void 0===t._cachedResult&&(e=Tt("<input type=\'color\'/>")[0],t._cachedResult="color"===e.type&&""!==e.value),t._cachedResult},Tt.spectrum={},Tt.spectrum.localization={},Tt.spectrum.palettes={},Tt.fn.spectrum.processNativeColorInputs=function(){var t=Tt("input[type=color]");t.length&&!Bt()&&t.spectrum({preferredFormat:"hex6"})},o=/^[\\s,#]+/,i=/\\s+$/,n=0,s=Math,a=s.round,c=s.min,f=s.max,r=s.random,b.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var t=this.toRgb();return(299*t.r+587*t.g+114*t.b)/1e3},setAlpha:function(t){return this._a=z(t),this._roundA=a(1e3*this._a)/1e3,this},toHsv:function(){var t=v(this._r,this._g,this._b);return{h:360*t.h,s:t.s,v:t.v,a:this._a}},toHsvString:function(){var t=v(this._r,this._g,this._b),e=a(360*t.h),r=a(100*t.s),t=a(100*t.v);return 1==this._a?"hsv("+e+", "+r+"%, "+t+"%)":"hsva("+e+", "+r+"%, "+t+"%, "+this._roundA+")"},toHsl:function(){var t=m(this._r,this._g,this._b);return{h:360*t.h,s:t.s,l:t.l,a:this._a}},toHslString:function(){var t=m(this._r,this._g,this._b),e=a(360*t.h),r=a(100*t.s),t=a(100*t.l);return 1==this._a?"hsl("+e+", "+r+"%, "+t+"%)":"hsla("+e+", "+r+"%, "+t+"%, "+this._roundA+")"},toHex:function(t){return y(this._r,this._g,this._b,t)},toHexString:function(t){return"#"+this.toHex(t)},toHex8:function(){return w(this._r,this._g,this._b,this._a)},toHex8String:function(){return"#"+this.toHex8()},toRgb:function(){return{r:a(this._r),g:a(this._g),b:a(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+a(this._r)+", "+a(this._g)+", "+a(this._b)+")":"rgba("+a(this._r)+", "+a(this._g)+", "+a(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:a(100*_(this._r,255))+"%",g:a(100*_(this._g,255))+"%",b:a(100*_(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+a(100*_(this._r,255))+"%, "+a(100*_(this._g,255))+"%, "+a(100*_(this._b,255))+"%)":"rgba("+a(100*_(this._r,255))+"%, "+a(100*_(this._g,255))+"%, "+a(100*_(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":!(this._a<1)&&h[y(this._r,this._g,this._b,!0)]||!1},toFilter:function(t){var e="#"+w(this._r,this._g,this._b,this._a),r=e;return"progid:DXImageTransform.Microsoft.gradient("+(this._gradientType?"GradientType = 1, ":"")+"startColorstr="+e+",endColorstr="+(r=t?b(t).toHex8String():r)+")"},toString:function(t){var e=!!t,r=(t=t||this._format,!1),n=this._a<1&&0<=this._a;return e||!n||"hex"!==t&&"hex6"!==t&&"hex3"!==t&&"name"!==t?("rgb"===t&&(r=this.toRgbString()),"prgb"===t&&(r=this.toPercentageRgbString()),"hex"!==t&&"hex6"!==t||(r=this.toHexString()),"hex3"===t&&(r=this.toHexString(!0)),"hex8"===t&&(r=this.toHex8String()),"name"===t&&(r=this.toName()),"hsl"===t&&(r=this.toHslString()),(r="hsv"===t?this.toHsvString():r)||this.toHexString()):"name"===t&&0===this._a?this.toName():this.toRgbString()},_applyModification:function(t,e){t=t.apply(null,[this].concat([].slice.call(e)));return this._r=t._r,this._g=t._g,this._b=t._b,this.setAlpha(t._a),this},lighten:function(){return this._applyModification(H,arguments)},brighten:function(){return this._applyModification(F,arguments)},darken:function(){return this._applyModification(T,arguments)},desaturate:function(){return this._applyModification(A,arguments)},saturate:function(){return this._applyModification(M,arguments)},greyscale:function(){return this._applyModification(R,arguments)},spin:function(){return this._applyModification(O,arguments)},_applyCombination:function(t,e){return t.apply(null,[this].concat([].slice.call(e)))},analogous:function(){return this._applyCombination(D,arguments)},complement:function(){return this._applyCombination(q,arguments)},monochromatic:function(){return this._applyCombination(I,arguments)},splitcomplement:function(){return this._applyCombination(E,arguments)},triad:function(){return this._applyCombination(N,arguments)},tetrad:function(){return this._applyCombination(j,arguments)}},b.fromRatio=function(t,e){if("object"==typeof t){var r,n={};for(r in t)t.hasOwnProperty(r)&&(n[r]="a"===r?t[r]:C(t[r]));t=n}return b(t,e)},b.equals=function(t,e){return!(!t||!e)&&b(t).toRgbString()==b(e).toRgbString()},b.random=function(){return b.fromRatio({r:r(),g:r(),b:r()})},b.mix=function(t,e,r){r=0===r?0:r||50;var t=b(t).toRgb(),e=b(e).toRgb(),r=r/100,n=2*r-1,a=e.a-t.a,n=n*a==-1?n:(n+a)/(1+n*a),a=1-(n=(n+1)/2),n={r:e.r*n+t.r*a,g:e.g*n+t.g*a,b:e.b*n+t.b*a,a:e.a*r+t.a*(1-r)};return b(n)},b.readability=function(t,e){var t=b(t),e=b(e),r=t.toRgb(),n=e.toRgb(),t=t.getBrightness(),e=e.getBrightness(),r=Math.max(r.r,n.r)-Math.min(r.r,n.r)+Math.max(r.g,n.g)-Math.min(r.g,n.g)+Math.max(r.b,n.b)-Math.min(r.b,n.b);return{brightness:Math.abs(t-e),color:r}},b.isReadable=function(t,e){t=b.readability(t,e);return 125<t.brightness&&500<t.color},b.mostReadable=function(t,e){for(var r=null,n=0,a=!1,o=0;o<e.length;o++){var i=b.readability(t,e[o]),s=125<i.brightness&&500<i.color,i=i.brightness/125*3+i.color/500;(s&&!a||s&&a&&n<i||!s&&!a&&n<i)&&(a=s,n=i,r=b(e[o]))}return r},l=b.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},h=b.hexNames=function(t){var e,r={};for(e in t)t.hasOwnProperty(e)&&(r[t[e]]=e);return r}(l),d="[\\\\s|\\\\(]+("+(u="(?:[-\\\\+]?\\\\d*\\\\.\\\\d+%?)|(?:[-\\\\+]?\\\\d+%?)")+")[,|\\\\s]+("+u+")[,|\\\\s]+("+u+")\\\\s*\\\\)?",u="[\\\\s|\\\\(]+("+u+")[,|\\\\s]+("+u+")[,|\\\\s]+("+u+")[,|\\\\s]+("+u+")\\\\s*\\\\)?",p={rgb:new RegExp("rgb"+d),rgba:new RegExp("rgba"+u),hsl:new RegExp("hsl"+d),hsla:new RegExp("hsla"+u),hsv:new RegExp("hsv"+d),hsva:new RegExp("hsva"+u),hex3:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex8:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/},window.tinycolor=b,Tt(function(){Tt.fn.spectrum.load&&Tt.fn.spectrum.processNativeColorInputs()})});'},33165:t=>{t.exports='!function(t){function a(){}function p(t,e){return t-e}function d(t,e){t+="";var r,i=x,n=Array.prototype.slice.call(arguments,2),s=d.listeners(t),a=0,o=[],l={},h=[],u=g;g=t;for(var c=x=0,f=s.length;c<f;c++)"zIndex"in s[c]&&(o.push(s[c].zIndex),s[c].zIndex<0&&(l[s[c].zIndex]=s[c]));for(o.sort(p);o[a]<0;)if(r=l[o[a++]],h.push(r.apply(e,n)),x)return x=i,h;for(c=0;c<f;c++)if("zIndex"in(r=s[c]))if(r.zIndex==o[a]){if(h.push(r.apply(e,n)),x)break;do{if((r=l[o[++a]])&&h.push(r.apply(e,n)),x)break}while(r)}else l[r.zIndex]=r;else if(h.push(r.apply(e,n)),x)break;return x=i,g=u,h.length?h:null}var g,x,e="0.4.2",f="hasOwnProperty",y=/[\\.\\/]/,m={n:{}};d._events=m,d.listeners=function(t){for(var e,r,i,n,s,a,o,l=t.split(y),h=[m],u=[],c=0,f=l.length;c<f;c++){for(a=[],n=0,s=h.length;n<s;n++)for(r=[(o=h[n].n)[l[c]],o["*"]],i=2;i--;)(e=r[i])&&(a.push(e),u=u.concat(e.f||[]));h=a}return u},d.on=function(t,e){if("function"!=typeof e)return function(){};for(var r=(t+="").split(y),i=m,n=0,s=r.length;n<s;n++)i=(i=i.n).hasOwnProperty(r[n])&&i[r[n]]||(i[r[n]]={n:{}});for(i.f=i.f||[],n=0,s=i.f.length;n<s;n++)if(i.f[n]==e)return a;return i.f.push(e),function(t){+t==+t&&(e.zIndex=+t)}},d.f=function(t){var e=[].slice.call(arguments,1);return function(){d.apply(null,[t,null].concat(e).concat([].slice.call(arguments,0)))}},d.stop=function(){x=1},d.nt=function(t){return t?RegExp("(?:\\\\.|\\\\/|^)"+t+"(?:\\\\.|\\\\/|$)").test(g):g},d.nts=function(){return g.split(y)},d.off=d.unbind=function(t,e){if(t){for(var r,i,n,s=t.split(y),a=[m],o=0,l=s.length;o<l;o++)for(u=0;a.length>u;u+=n.length-2){if(n=[u,1],r=a[u].n,"*"!=s[o])r[s[o]]&&n.push(r[s[o]]);else for(i in r)r[f](i)&&n.push(r[i]);a.splice.apply(a,n)}for(o=0,l=a.length;o<l;o++)for(r=a[o];r.n;){if(e){if(r.f){for(u=0,c=r.f.length;u<c;u++)if(r.f[u]==e){r.f.splice(u,1);break}r.f.length||delete r.f}for(i in r.n)if(r.n[f](i)&&r.n[i].f){for(var h=r.n[i].f,u=0,c=h.length;u<c;u++)if(h[u]==e){h.splice(u,1);break}h.length||delete r.n[i].f}}else for(i in delete r.f,r.n)r.n[f](i)&&r.n[i].f&&delete r.n[i].f;r=r.n}}else d._events=m={n:{}}},d.once=function(t,e){function r(){return d.unbind(t,r),e.apply(this,arguments)}return d.on(t,r)},d.version=e,d.toString=function(){return"You are running Eve "+e},"undefined"!=typeof module&&module.exports?module.exports=d:"undefined"!=typeof define?define("eve",[],function(){return d}):t.eve=d}(this),function(){function E(t){if(E.is(t,"function"))return U?t():eve.on("raphael.DOMload",t);if(E.is(t,v))return E._engine.create[y](E,t.splice(0,3+E.is(t[0],P))).add(t);var e,r=Array.prototype.slice.call(arguments,0);return E.is(r[r.length-1],"function")?(e=r.pop(),U?e.call(E._engine.create[y](E,r)):eve.on("raphael.DOMload",function(){e.call(E._engine.create[y](E,r))})):E._engine.create[y](E,arguments)}function x(t){if(Object(t)!==t)return t;var e,r=new t.constructor;for(e in t)t[M](e)&&(r[e]=x(t[e]));return r}function C(n,s,a){function o(){var t=Array.prototype.slice.call(arguments,0),e=t.join("â€"),r=o.cache=o.cache||{},i=o.count=o.count||[];return r[M](e)?function(t,e){for(var r=0,i=t.length;r<i;r++)if(t[r]===e)return t.push(t.splice(r,1)[0])}(i,e):(1e3<=i.length&&delete r[i.shift()],i.push(e),r[e]=n[y](s,t)),a?a(r[e]):r[e]}return o}function l(){return this.hex}function D(t,e){for(var r=[],i=0,n=t.length;i<n-2*!e;i+=2){var s=[{x:+t[i-2],y:+t[i-1]},{x:+t[i],y:+t[i+1]},{x:+t[i+2],y:+t[i+3]},{x:+t[i+4],y:+t[i+5]}];e?i?n-4==i?s[3]={x:+t[0],y:+t[1]}:n-2==i&&(s[2]={x:+t[0],y:+t[1]},s[3]={x:+t[2],y:+t[3]}):s[0]={x:+t[n-2],y:+t[n-1]}:n-4==i?s[3]=s[2]:i||(s[0]={x:+t[i],y:+t[i+1]}),r.push(["C",(-s[0].x+6*s[1].x+s[2].x)/6,(-s[0].y+6*s[1].y+s[2].y)/6,(s[1].x+6*s[2].x-s[3].x)/6,(s[1].y+6*s[2].y-s[3].y)/6,s[2].x,s[2].y])}return r}function O(t,e,r,i,n){return t*(t*(-3*e+9*r-9*i+3*n)+6*e-12*r+6*i)-3*e+3*r}function _(t,e,r,i,n,s,a,o,l){for(var h=(l=1<(l=null==l?1:l)?1:l<0?0:l)/2,u=[-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816],c=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],f=0,p=0;p<12;p++){var d=h*u[p]+h,g=O(d,t,r,n,a),d=O(d,e,i,s,o);f+=c[p]*B.sqrt(g*g+d*d)}return h*f}function V(t,e,r){var i=E.bezierBBox(t),n=E.bezierBBox(e);if(!E.isBBoxIntersect(i,n))return r?0:[];for(var s=~~(_.apply(0,t)/5),a=~~(_.apply(0,e)/5),o=[],l=[],h={},u=r?0:[],c=0;c<1+s;c++){var f=E.findDotsAtSegment.apply(E,t.concat(c/s));o.push({x:f.x,y:f.y,t:c/s})}for(c=0;c<1+a;c++)f=E.findDotsAtSegment.apply(E,e.concat(c/a)),l.push({x:f.x,y:f.y,t:c/a});for(c=0;c<s;c++)for(var p=0;p<a;p++){var d=o[c],g=o[c+1],x=l[p],y=l[p+1],m=T(g.x-d.x)<.001?"y":"x",v=T(y.x-x.x)<.001?"y":"x",b=function(t,e,r,i,n,s,a,o){if(!(S(t,r)<A(n,a)||A(t,r)>S(n,a)||S(e,i)<A(s,o)||A(e,i)>S(s,o))){var l=(t-r)*(s-o)-(e-i)*(n-a);if(l){var h=((t*i-e*r)*(n-a)-(t-r)*(n*o-s*a))/l,l=((t*i-e*r)*(s-o)-(e-i)*(n*o-s*a))/l,u=+h.toFixed(2),c=+l.toFixed(2);if(!(+A(t,r).toFixed(2)>u||u>+S(t,r).toFixed(2)||+A(n,a).toFixed(2)>u||u>+S(n,a).toFixed(2)||+A(e,i).toFixed(2)>c||c>+S(e,i).toFixed(2)||+A(s,o).toFixed(2)>c||c>+S(s,o).toFixed(2)))return{x:h,y:l}}}}(d.x,d.y,g.x,g.y,x.x,x.y,y.x,y.y);b&&h[b.x.toFixed(4)]!=b.y.toFixed(4)&&(h[b.x.toFixed(4)]=b.y.toFixed(4),m=d.t+T((b[m]-d[m])/(g[m]-d[m]))*(g.t-d.t),g=x.t+T((b[v]-x[v])/(y[v]-x[v]))*(y.t-x.t),0<=m&&m<=1&&0<=g&&g<=1&&(r?u++:u.push({x:b.x,y:b.y,t1:m,t2:g})))}return u}function c(t,e,r){t=E._path2curve(t),e=E._path2curve(e);for(var i,n,s,a,o,l,h,u,c=r?0:[],f=0,p=t.length;f<p;f++){var d=t[f];if("M"==d[0])i=s=d[1],g=a=d[2];else for(var g="C"==d[0]?(i=(h=[i,g].concat(d.slice(1)))[6],h[7]):(h=[i,g,i,g,s,a,s,a],i=s,a),x=0,y=e.length;x<y;x++){var m=e[x];if("M"==m[0])n=o=m[1],v=l=m[2];else{var v="C"==m[0]?(n=(u=[n,v].concat(m.slice(1)))[6],u[7]):(u=[n,v,n,v,o,l,o,l],n=o,l),b=V(h,u,r);if(r)c+=b;else{for(var _=0,w=b.length;_<w;_++)b[_].segment1=f,b[_].segment2=x,b[_].bez1=h,b[_].bez2=u;c=c.concat(b)}}}}return c}function L(t,e,r,i,n,s){null!=t?(this.a=+t,this.b=+e,this.c=+r,this.d=+i,this.e=+n,this.f=+s):(this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0)}function f(){return this.x+k+this.y+k+this.width+" Ã— "+this.height}function Y(t,e,r,i,n,s){function l(t){return((c*t+u)*t+h)*t}var h=3*e,u=3*(i-e)-h,c=1-h-u,i=3*r,e=3*(n-r)-i,n=1-i-e;return r=function(t,e){var r,i,n,s,a,o;for(n=t,o=0;o<8;o++){if(s=l(n)-t,e>T(s))return n;if(T(a=(3*c*n+2*u)*n+h)<1e-6)break;n-=s/a}if(i=1,(r=0)>(n=t))return r;if(i<n)return i;for(;r<i;){if(s=l(n),e>T(s-t))return n;s<t?r=n:i=n,n=(i-r)/2+r}return n}(r=t,1/(200*s)),((n*r+e)*r+i)*r}function h(t,e){var r=[],i={};if(this.ms=e,this.times=1,t){for(var n in t)t[M](n)&&(i[I(n)]=t[n],r.push(I(n)));r.sort(W)}this.anim=i,this.top=r[r.length-1],this.percents=r}function w(t,e,r,i,n,s){r=I(r);var a,o,l,h,u,c=t.ms,f={},p={},d={};if(i)for(x=0,y=q.length;x<y;x++){var g=q[x];if(g.el.id==e.id&&g.anim==t){g.percent!=r?(q.splice(x,1),l=1):o=g,e.attr(g.totalOrigin);break}}else i=+p;for(var x=0,y=t.percents.length;x<y;x++){if(t.percents[x]==r||t.percents[x]>i*t.top){r=t.percents[x],u=t.percents[x-1]||0,c=c/t.top*(r-u),h=t.percents[x+1],a=t.anim[r];break}i&&e.attr(t.anim[t.percents[x]])}if(a){if(o)o.initstatus=i,o.start=new Date-o.ms*i;else{for(var m in a)if(a[M](m)&&(pt[M](m)||e.paper.customAttributes[M](m)))switch(f[m]=e.attr(m),null==f[m]&&(f[m]=ft[m]),p[m]=a[m],pt[m]){case P:d[m]=(p[m]-f[m])/c;break;case"colour":f[m]=E.getRGB(f[m]);var v=E.getRGB(p[m]);d[m]={r:(v.r-f[m].r)/c,g:(v.g-f[m].g)/c,b:(v.b-f[m].b)/c};break;case"path":var v=It(f[m],p[m]),b=v[1];for(f[m]=v[0],d[m]=[],x=0,y=f[m].length;x<y;x++){d[m][x]=[0];for(var _=1,w=f[m][x].length;_<w;_++)d[m][x][_]=(b[x][_]-f[m][x][_])/c}break;case"transform":var k=e._,C=Ot(k[m],p[m]);if(C)for(f[m]=C.from,p[m]=C.to,d[m]=[],d[m].real=!0,x=0,y=f[m].length;x<y;x++)for(d[m][x]=[f[m][x][0]],_=1,w=f[m][x].length;_<w;_++)d[m][x][_]=(p[m][x][_]-f[m][x][_])/c;else{C=e.matrix||new L,k={_:{transform:k.transform},getBBox:function(){return e.getBBox(1)}};f[m]=[C.a,C.b,C.c,C.d,C.e,C.f],Dt(k,p[m]),p[m]=k._.transform,d[m]=[(k.matrix.a-C.a)/c,(k.matrix.b-C.b)/c,(k.matrix.c-C.c)/c,(k.matrix.d-C.d)/c,(k.matrix.e-C.e)/c,(k.matrix.f-C.f)/c]}break;case"csv":var B=F(a[m])[R](Q),S=F(f[m])[R](Q);if("clip-rect"==m)for(f[m]=S,d[m]=[],x=S.length;x--;)d[m][x]=(B[x]-f[m][x])/c;p[m]=B;break;default:for(B=[][z](a[m]),S=[][z](f[m]),d[m]=[],x=e.paper.customAttributes[m].length;x--;)d[m][x]=((B[x]||0)-(S[x]||0))/c}var A,T=a.easing,N=E.easing_formulas[T];if(N=N||((N=F(T).match(ht))&&5==N.length?(A=N,function(t){return Y(t,+A[1],+A[2],+A[3],+A[4],c)}):X),g={anim:t,percent:r,timestamp:T=a.start||t.start||+new Date,start:T+(t.del||0),status:0,initstatus:i||0,stop:!1,ms:c,easing:N,from:f,diff:d,to:p,el:e,callback:a.callback,prev:u,next:h,repeat:s||t.times,origin:e.attr(),totalOrigin:n},q.push(g),i&&!o&&!l&&(g.stop=!0,g.start=new Date-c*i,1==q.length))return he();l&&(g.start=new Date-g.ms*i),1==q.length&&le(he)}eve("raphael.anim.start."+e.id,e,t)}}function p(t){for(var e=0;q.length>e;e++)q[e].el.paper==t&&q.splice(e--,1)}E.version="2.1.0",E.eve=eve;function G(){this.ca=this.customAttributes={}}function W(t,e){return I(t)-I(e)}function X(t){return t}function H(t,e,r,i){return[["M",t,e],["m",0,-(i=null==i?r:i)],["a",r,i,0,1,1,0,2*i],["a",r,i,0,1,1,0,-2*i],["z"]]}var U,$,Z,Q=/[, ]+/,J={circle:1,rect:1,path:1,ellipse:1,text:1,image:1},K=/\\{(\\d+)\\}/g,M="hasOwnProperty",d={doc:document,win:window},tt={was:Object.prototype[M].call(d.win,"Raphael"),is:d.win.Raphael},y="apply",z="concat",et="createTouch"in d.doc,k=" ",F=String,R="split",rt="click dblclick mousedown mousemove mouseout mouseover mouseup touchstart touchmove touchend touchcancel"[R](k),it={mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},nt=F.prototype.toLowerCase,B=Math,S=B.max,A=B.min,T=B.abs,m=B.pow,N=B.PI,P="number",st="string",v="array",at=Object.prototype.toString,ot=(E._ISURL=/^url\\([\'"]?([^\\)]+?)[\'"]?\\)$/i,/^\\s*((#[a-f\\d]{6})|(#[a-f\\d]{3})|rgba?\\(\\s*([\\d\\.]+%?\\s*,\\s*[\\d\\.]+%?\\s*,\\s*[\\d\\.]+%?(?:\\s*,\\s*[\\d\\.]+%?)?)\\s*\\)|hsba?\\(\\s*([\\d\\.]+(?:deg|\\xb0|%)?\\s*,\\s*[\\d\\.]+%?\\s*,\\s*[\\d\\.]+(?:%?\\s*,\\s*[\\d\\.]+)?)%?\\s*\\)|hsla?\\(\\s*([\\d\\.]+(?:deg|\\xb0|%)?\\s*,\\s*[\\d\\.]+%?\\s*,\\s*[\\d\\.]+(?:%?\\s*,\\s*[\\d\\.]+)?)%?\\s*\\))\\s*$/i),lt={NaN:1,Infinity:1,"-Infinity":1},ht=/^(?:cubic-)?bezier\\(([^,]+),([^,]+),([^,]+),([^\\)]+)\\)/,ut=B.round,I=parseFloat,o=parseInt,ct=F.prototype.toUpperCase,ft=E._availableAttrs={"arrow-end":"none","arrow-start":"none",blur:0,"clip-rect":"0 0 1e9 1e9",cursor:"default",cx:0,cy:0,fill:"#fff","fill-opacity":1,font:\'10px "Arial"\',"font-family":\'"Arial"\',"font-size":"10","font-style":"normal","font-weight":400,gradient:0,height:0,href:"http://raphaeljs.com/","letter-spacing":0,opacity:1,path:"M0,0",r:0,rx:0,ry:0,src:"",stroke:"#000","stroke-dasharray":"","stroke-linecap":"butt","stroke-linejoin":"butt","stroke-miterlimit":0,"stroke-opacity":1,"stroke-width":1,target:"_blank","text-anchor":"middle",title:"Raphael",transform:"",width:0,x:0,y:0},pt=E._availableAnimAttrs={blur:P,"clip-rect":"csv",cx:P,cy:P,fill:"colour","fill-opacity":P,"font-size":P,height:P,opacity:P,path:"path",r:P,rx:P,ry:P,stroke:"colour","stroke-opacity":P,"stroke-width":P,transform:"transform",width:P,x:P,y:P},dt=/[\\x09\\x0a\\x0b\\x0c\\x0d\\x20\\xa0\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000\\u2028\\u2029]*,[\\x09\\x0a\\x0b\\x0c\\x0d\\x20\\xa0\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000\\u2028\\u2029]*/,gt={hs:1,rg:1},xt=/,?([achlmqrstvxz]),?/gi,yt=/([achlmrqstvz])[\\x09\\x0a\\x0b\\x0c\\x0d\\x20\\xa0\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000\\u2028\\u2029,]*((-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?[\\x09\\x0a\\x0b\\x0c\\x0d\\x20\\xa0\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000\\u2028\\u2029]*,?[\\x09\\x0a\\x0b\\x0c\\x0d\\x20\\xa0\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000\\u2028\\u2029]*)+)/gi,mt=/([rstm])[\\x09\\x0a\\x0b\\x0c\\x0d\\x20\\xa0\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000\\u2028\\u2029,]*((-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?[\\x09\\x0a\\x0b\\x0c\\x0d\\x20\\xa0\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000\\u2028\\u2029]*,?[\\x09\\x0a\\x0b\\x0c\\x0d\\x20\\xa0\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000\\u2028\\u2029]*)+)/gi,vt=/(-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?)[\\x09\\x0a\\x0b\\x0c\\x0d\\x20\\xa0\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000\\u2028\\u2029]*,?[\\x09\\x0a\\x0b\\x0c\\x0d\\x20\\xa0\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000\\u2028\\u2029]*/gi,n=(E._radial_gradient=/^r(?:\\(([^,]+?)[\\x09\\x0a\\x0b\\x0c\\x0d\\x20\\xa0\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000\\u2028\\u2029]*,[\\x09\\x0a\\x0b\\x0c\\x0d\\x20\\xa0\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000\\u2028\\u2029]*([^\\)]+?)\\))?/,{}),bt=E._rectPath=function(t,e,r,i,n){return n?[["M",t+n,e],["l",r-2*n,0],["a",n,n,0,0,1,n,n],["l",0,i-2*n],["a",n,n,0,0,1,-n,n],["l",2*n-r,0],["a",n,n,0,0,1,-n,-n],["l",0,2*n-i],["a",n,n,0,0,1,n,-n],["z"]]:[["M",t,e],["l",r,0],["l",0,i],["l",-r,0],["z"]]},_t=E._getPath={path:function(t){return t.attr("path")},circle:function(t){t=t.attrs;return H(t.cx,t.cy,t.r)},ellipse:function(t){t=t.attrs;return H(t.cx,t.cy,t.rx,t.ry)},rect:function(t){t=t.attrs;return bt(t.x,t.y,t.width,t.height,t.r)},image:function(t){t=t.attrs;return bt(t.x,t.y,t.width,t.height)},text:function(t){t=t._getBBox();return bt(t.x,t.y,t.width,t.height)},set:function(t){t=t._getBBox();return bt(t.x,t.y,t.width,t.height)}},wt=E.mapPath=function(t,e){if(!e)return t;for(var r,i,n,s,a,o=0,l=(t=It(t)).length;o<l;o++)for(n=1,s=(a=t[o]).length;n<s;n+=2)r=e.x(a[n],a[n+1]),i=e.y(a[n],a[n+1]),a[n]=r,a[n+1]=i;return t};if(E._g=d,E.type=d.win.SVGAngle||d.doc.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")?"SVG":"VML","VML"==E.type){var t,e=d.doc.createElement("div");if(e.innerHTML=\'<v:shape adj="1"/>\',(t=e.firstChild).style.behavior="url(#default#VML)",!t||"object"!=typeof t.adj)return E.type="";e=null}E.svg=!(E.vml="VML"==E.type),E._Paper=G,E.fn=t=G.prototype=E.prototype,E._id=0,E._oid=0,E.is=function(t,e){return"finite"==(e=nt.call(e))?!lt[M](+t):"array"==e?t instanceof Array:"null"==e&&null===t||e==typeof t&&null!==t||"object"==e&&t===Object(t)||"array"==e&&Array.isArray&&Array.isArray(t)||at.call(t).slice(8,-1).toLowerCase()==e},E.angle=function(t,e,r,i,n,s){var a,o;return null==n?(o=e-i,(a=t-r)||o?(180+180*B.atan2(-o,-a)/N+360)%360:0):E.angle(t,e,n,s)-E.angle(r,i,n,s)},E.rad=function(t){return t%360*N/180},E.deg=function(t){return 180*t/N%360},E.snapTo=function(t,e,r){if(r=E.is(r,"finite")?r:10,E.is(t,v)){for(var i=t.length;i--;)if(r>=T(t[i]-e))return t[i]}else{var n=e%(t=+t);if(n<r)return e-n;if(t-r<n)return e-n+t}return e},E.createUUID=($=/[xy]/g,Z=function(t){var e=0|16*B.random();return("x"==t?e:8|3&e).toString(16)},function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace($,Z).toUpperCase()}),E.setWindow=function(t){eve("raphael.setWindow",E,d.win,t),d.win=t,d.doc=d.win.document,E._engine.initWin&&E._engine.initWin(d.win)};function kt(){return"hsb("+[this.h,this.s,this.b]+")"}function Ct(){return"hsl("+[this.h,this.s,this.l]+")"}function Bt(){return this.hex}function St(t,e,r){var i;return null==e&&E.is(t,"object")&&"r"in t&&"g"in t&&"b"in t&&(r=t.b,e=t.g,t=t.r),null==e&&E.is(t,st)&&(t=(i=E.getRGB(t)).r,e=i.g,r=i.b),(1<t||1<e||1<r)&&(t/=255,e/=255,r/=255),[t,e,r]}function At(t,e,r,i){return t={r:t*=255,g:e*=255,b:r*=255,hex:E.rgb(t,e,r),toString:Bt},E.is(i,"finite")&&(t.opacity=i),t}function Tt(t,e,r,i){return[t,e,r,i,r,i]}function Nt(t,e,r,i,n,s){return[1/3*t+2/3*r,1/3*e+2/3*i,1/3*n+2/3*r,1/3*s+2/3*i,n,s]}function Et(t,e,r,i,n,s,a,o,l){var h=1-l;return{x:m(h,3)*t+3*m(h,2)*l*r+3*h*l*l*n+m(l,3)*a,y:m(h,3)*e+3*m(h,2)*l*i+3*h*l*l*s+m(l,3)*o}}function Lt(t){var e=t[0];switch(e.toLowerCase()){case"t":return[e,0,0];case"m":return[e,1,0,0,1,0,0];case"r":return 4==t.length?[e,0,t[2],t[3]]:[e,0];case"s":return 5==t.length?[e,1,1,t[3],t[4]]:3==t.length?[e,1,1]:[e,1]}}var Mt=function(t){if(E.vml){var r,i=/^\\s+|\\s+$/g;try{var e=new ActiveXObject("htmlfile");e.write("<body>"),e.close(),r=e.body}catch(t){r=createPopup().document.body}var n=r.createTextRange();Mt=C(function(t){try{r.style.color=F(t).replace(i,"");var e=n.queryCommandValue("ForeColor");return"#"+("000000"+(e=(255&e)<<16|65280&e|(16711680&e)>>>16).toString(16)).slice(-6)}catch(t){return"none"}})}else{var s=d.doc.createElement("i");s.title="RaphaÃ«l Colour Picker",s.style.display="none",d.doc.body.appendChild(s),Mt=C(function(t){return s.style.color=t,d.doc.defaultView.getComputedStyle(s,"").getPropertyValue("color")})}return Mt(t)},b=(E.color=function(t){var e;return E.is(t,"object")&&"h"in t&&"s"in t&&"b"in t?(e=E.hsb2rgb(t),t.r=e.r,t.g=e.g,t.b=e.b,t.hex=e.hex):E.is(t,"object")&&"h"in t&&"s"in t&&"l"in t?(e=E.hsl2rgb(t),t.r=e.r,t.g=e.g,t.b=e.b,t.hex=e.hex):(E.is(t,"string")&&(t=E.getRGB(t)),E.is(t,"object")&&"r"in t&&"g"in t&&"b"in t?(e=E.rgb2hsl(t),t.h=e.h,t.s=e.s,t.l=e.l,e=E.rgb2hsb(t),t.v=e.b):(t={hex:"none"}).r=t.g=t.b=t.h=t.s=t.v=t.l=-1),t.toString=Bt,t},E.hsb2rgb=function(t,e,r,i){var n,s,a;return this.is(t,"object")&&"h"in t&&"s"in t&&"b"in t&&(r=t.b,e=t.s,i=(t=t.h).o),a=(e=r*e)*(1-T((t=(t*=360)%360/60)%2-1)),n=s=r=r-e,At(n+=[e,a,0,0,a,e][t=~~t],s+=[a,e,e,a,0,0][t],r+=[0,0,a,e,e,a][t],i)},E.hsl2rgb=function(t,e,r,i){var n,s,a;return this.is(t,"object")&&"h"in t&&"s"in t&&"l"in t&&(r=t.l,e=t.s,t=t.h),(1<t||1<e||1<r)&&(t/=360,e/=100,r/=100),a=(e=2*e*(r<.5?r:1-r))*(1-T((t=(t*=360)%360/60)%2-1)),n=s=r=r-e/2,At(n+=[e,a,0,0,a,e][t=~~t],s+=[a,e,e,a,0,0][t],r+=[0,0,a,e,e,a][t],i)},E.rgb2hsb=function(t,e,r){var i,n;return t=(r=St(t,e,r))[0],e=r[1],r=r[2],{h:((0==(n=(i=S(t,e,r))-A(t,e,r))?null:i==t?(e-r)/n:i==e?(r-t)/n+2:(t-e)/n+4)+360)%6*60/360,s:0==n?0:n/i,b:i,toString:kt}},E.rgb2hsl=function(t,e,r){var i,n,s;return t=(r=St(t,e,r))[0],e=r[1],r=r[2],i=((n=S(t,e,r))+(s=A(t,e,r)))/2,{h:((0==(s=n-s)?null:n==t?(e-r)/s:n==e?(r-t)/s+2:(t-e)/s+4)+360)%6*60/360,s:0==s?0:i<.5?s/(2*i):s/(2-2*i),l:i,toString:Ct}},E._path2string=function(){return this.join(",").replace(xt,"$1")},E._preload=function(t,e){var r=d.doc.createElement("img");r.style.cssText="position:absolute;left:-9999em;top:-9999em",r.onload=function(){e.call(this),this.onload=null,d.doc.body.removeChild(this)},r.onerror=function(){d.doc.body.removeChild(this)},d.doc.body.appendChild(r),r.src=t},E.getRGB=C(function(t){if(!t||(t=F(t)).indexOf("-")+1)return{r:-1,g:-1,b:-1,hex:"none",error:1,toString:l};if("none"==t)return{r:-1,g:-1,b:-1,hex:"none",toString:l};var e,r,i,n,s,a,t=(t=gt[M](t.toLowerCase().substring(0,2))||"#"==t.charAt()?t:Mt(t)).match(ot);return t?(t[2]&&(i=o(t[2].substring(5),16),r=o(t[2].substring(3,5),16),e=o(t[2].substring(1,3),16)),t[3]&&(i=o((s=t[3].charAt(3))+s,16),r=o((s=t[3].charAt(2))+s,16),e=o((s=t[3].charAt(1))+s,16)),t[4]&&(a=t[4][R](dt),e=I(a[0]),"%"==a[0].slice(-1)&&(e*=2.55),r=I(a[1]),"%"==a[1].slice(-1)&&(r*=2.55),i=I(a[2]),"%"==a[2].slice(-1)&&(i*=2.55),"rgba"==t[1].toLowerCase().slice(0,4)&&(n=I(a[3])),a[3]&&"%"==a[3].slice(-1)&&(n/=100)),t[5]?(a=t[5][R](dt),e=I(a[0]),"%"==a[0].slice(-1)&&(e*=2.55),r=I(a[1]),"%"==a[1].slice(-1)&&(r*=2.55),i=I(a[2]),"%"==a[2].slice(-1)&&(i*=2.55),"deg"!=a[0].slice(-3)&&"Â°"!=a[0].slice(-1)||(e/=360),"hsba"==t[1].toLowerCase().slice(0,4)&&(n=I(a[3])),a[3]&&"%"==a[3].slice(-1)&&(n/=100),E.hsb2rgb(e,r,i,n)):t[6]?(a=t[6][R](dt),e=I(a[0]),"%"==a[0].slice(-1)&&(e*=2.55),r=I(a[1]),"%"==a[1].slice(-1)&&(r*=2.55),i=I(a[2]),"%"==a[2].slice(-1)&&(i*=2.55),"deg"!=a[0].slice(-3)&&"Â°"!=a[0].slice(-1)||(e/=360),"hsla"==t[1].toLowerCase().slice(0,4)&&(n=I(a[3])),a[3]&&"%"==a[3].slice(-1)&&(n/=100),E.hsl2rgb(e,r,i,n)):((t={r:e,g:r,b:i,toString:l}).hex="#"+(16777216|i|r<<8|e<<16).toString(16).slice(1),E.is(n,"finite")&&(t.opacity=n),t)):{r:-1,g:-1,b:-1,hex:"none",error:1,toString:l}},E),E.hsb=C(function(t,e,r){return E.hsb2rgb(t,e,r).hex}),E.hsl=C(function(t,e,r){return E.hsl2rgb(t,e,r).hex}),E.rgb=C(function(t,e,r){return"#"+(16777216|r|e<<8|t<<16).toString(16).slice(1)}),E.getColor=function(t){var t=this.getColor.start=this.getColor.start||{h:0,s:1,b:t||.75},e=this.hsb2rgb(t.h,t.s,t.b);return t.h+=.075,1<t.h&&(t.h=0,t.s-=.2,t.s<=0&&(this.getColor.start={h:0,s:1,b:t.b})),e.hex},E.getColor.reset=function(){delete this.start},E.parsePathString=function(t){if(!t)return null;var e=b(t);if(e.arr)return j(e.arr);var s={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0},a=[];return(a=E.is(t,v)&&E.is(t[0],v)?j(t):a).length||F(t).replace(yt,function(t,e,r){var i=[],n=e.toLowerCase();if(r.replace(vt,function(t,e){e&&i.push(+e)}),"m"==n&&2<i.length&&(a.push([e][z](i.splice(0,2))),n="l",e="m"==e?"l":"L"),"r"==n)a.push([e][z](i));else for(;i.length>=s[n]&&(a.push([e][z](i.splice(0,s[n]))),s[n]););}),a.toString=E._path2string,e.arr=j(a),a},E.parseTransformString=C(function(t){if(!t)return null;var n=[];return(n=E.is(t,v)&&E.is(t[0],v)?j(t):n).length||F(t).replace(mt,function(t,e,r){var i=[];nt.call(e),r.replace(vt,function(t,e){e&&i.push(+e)}),n.push([e][z](i))}),n.toString=E._path2string,n}),function(e){var r=b.ps=b.ps||{};return r[e]?r[e].sleep=100:r[e]={sleep:100},setTimeout(function(){for(var t in r)r[M](t)&&t!=e&&(r[t].sleep--,r[t].sleep||delete r[t])}),r[e]}),zt=(E.findDotsAtSegment=function(t,e,r,i,n,s,a,o,l){var h=1-l,u=m(h,3),c=m(h,2),f=l*l,p=f*l,d=u*t+3*c*l*r+3*h*l*l*n+p*a,u=u*e+3*c*l*i+3*h*l*l*s+p*o,c=t+2*l*(r-t)+f*(n-2*r+t),p=e+2*l*(i-e)+f*(s-2*i+e),g=r+2*l*(n-r)+f*(a-2*n+r),f=i+2*l*(s-i)+f*(o-2*s+i),t=h*t+l*r,r=h*e+l*i,e=h*n+l*a,i=h*s+l*o,n=90-180*B.atan2(c-g,p-f)/N;return(g<c||p<f)&&(n+=180),{x:d,y:u,m:{x:c,y:p},n:{x:g,y:f},start:{x:t,y:r},end:{x:e,y:i},alpha:n}},E.bezierBBox=function(t,e,r,i,n,s,a,o){E.is(t,"array")||(t=[t,e,r,i,n,s,a,o]);e=Pt.apply(null,t);return{x:e.min.x,y:e.min.y,x2:e.max.x,y2:e.max.y,width:e.max.x-e.min.x,height:e.max.y-e.min.y}},E.isPointInsideBBox=function(t,e,r){return e>=t.x&&t.x2>=e&&r>=t.y&&t.y2>=r},E.isBBoxIntersect=function(t,e){var r=E.isPointInsideBBox;return r(e,t.x,t.y)||r(e,t.x2,t.y)||r(e,t.x,t.y2)||r(e,t.x2,t.y2)||r(t,e.x,e.y)||r(t,e.x2,e.y)||r(t,e.x,e.y2)||r(t,e.x2,e.y2)||(t.x<e.x2&&t.x>e.x||e.x<t.x2&&e.x>t.x)&&(t.y<e.y2&&t.y>e.y||e.y<t.y2&&e.y>t.y)},E.pathIntersection=function(t,e){return c(t,e)},E.pathIntersectionNumber=function(t,e){return c(t,e,1)},E.isPointInsidePath=function(t,e,r){var i=E.pathBBox(t);return E.isPointInsideBBox(i,e,r)&&1==c(t,[["M",e,r],["H",i.x2+10]],1)%2},E._removedFactory=function(t){return function(){eve("raphael.log",null,"RaphaÃ«l: you are calling to method â€œ"+t+"â€ of removed object",t)}},E.pathBBox=function(t){var e=b(t);if(e.bbox)return x(e.bbox);if(!t)return{x:0,y:0,width:0,height:0,x2:0,y2:0};for(var r,i,n=0,s=0,a=[],o=[],l=0,h=(t=It(t)).length;l<h;l++)"M"==(r=t[l])[0]?(n=r[1],s=r[2],a.push(n),o.push(s)):(i=Pt(n,s,r[1],r[2],r[3],r[4],r[5],r[6]),a=a[z](i.min.x,i.max.x),o=o[z](i.min.y,i.max.y),n=r[5],s=r[6]);var u=A[y](0,a),c=A[y](0,o),f=S[y](0,a),p=S[y](0,o),d=f-u,g=p-c,f={x:u,y:c,x2:f,y2:p,width:d,height:g,cx:u+d/2,cy:c+g/2};return e.bbox=x(f),f}),j=function(t){t=x(t);return t.toString=E._path2string,t},e=E._pathToRelative=function(t){var e=b(t);if(e.rel)return j(e.rel);var r=[],i=0,n=0,s=0,a=0,o=0;"M"==(t=E.is(t,v)&&E.is(t&&t[0],v)?t:E.parsePathString(t))[0][0]&&(s=i=t[0][1],a=n=t[0][2],o++,r.push(["M",i,n]));for(var l=o,h=t.length;l<h;l++){var u=r[l]=[],c=t[l];if(c[0]!=nt.call(c[0]))switch(u[0]=nt.call(c[0]),u[0]){case"a":u[1]=c[1],u[2]=c[2],u[3]=c[3],u[4]=c[4],u[5]=c[5],u[6]=+(c[6]-i).toFixed(3),u[7]=+(c[7]-n).toFixed(3);break;case"v":u[1]=+(c[1]-n).toFixed(3);break;case"m":s=c[1],a=c[2];default:for(var f=1,p=c.length;f<p;f++)u[f]=+(c[f]-(f%2?i:n)).toFixed(3)}else{u=r[l]=[],"m"==c[0]&&(s=c[1]+i,a=c[2]+n);for(var d=0,g=c.length;d<g;d++)r[l][d]=c[d]}var x=r[l].length;switch(r[l][0]){case"z":i=s,n=a;break;case"h":i+=+r[l][x-1];break;case"v":n+=+r[l][x-1];break;default:i+=+r[l][x-2],n+=+r[l][x-1]}}return r.toString=E._path2string,e.rel=j(r),r},Ft=E._pathToAbsolute=function(t){var e=b(t);if(e.abs)return j(e.abs);if(!(t=E.is(t,v)&&E.is(t&&t[0],v)?t:E.parsePathString(t))||!t.length)return[["M",0,0]];var r=[],i=0,n=0,s=0,a=0,o=0;"M"==t[0][0]&&(s=i=+t[0][1],a=n=+t[0][2],o++,r[0]=["M",i,n]);for(var l,h,u=3==t.length&&"M"==t[0][0]&&"R"==t[1][0].toUpperCase()&&"Z"==t[2][0].toUpperCase(),c=o,f=t.length;c<f;c++){if(r.push(l=[]),(h=t[c])[0]!=ct.call(h[0]))switch(l[0]=ct.call(h[0]),l[0]){case"A":l[1]=h[1],l[2]=h[2],l[3]=h[3],l[4]=h[4],l[5]=h[5],l[6]=+(h[6]+i),l[7]=+(h[7]+n);break;case"V":l[1]=+h[1]+n;break;case"H":l[1]=+h[1]+i;break;case"R":for(var p=[i,n][z](h.slice(1)),d=2,g=p.length;d<g;d++)p[d]=+p[d]+i,p[++d]=+p[d]+n;r.pop(),r=r[z](D(p,u));break;case"M":s=+h[1]+i,a=+h[2]+n;default:for(d=1,g=h.length;d<g;d++)l[d]=+h[d]+(d%2?i:n)}else if("R"==h[0])p=[i,n][z](h.slice(1)),r.pop(),r=r[z](D(p,u)),l=["R"][z](h.slice(-2));else for(var x=0,y=h.length;x<y;x++)l[x]=h[x];switch(l[0]){case"Z":i=s,n=a;break;case"H":i=l[1];break;case"V":n=l[1];break;case"M":s=l[l.length-2],a=l[l.length-1];default:i=l[l.length-2],n=l[l.length-1]}}return r.toString=E._path2string,e.abs=j(r),r},Rt=function(t,e,r,i,n,s,a,o,l,h){var u=120*N/180,c=N/180*(+n||0),f=[],p=C(function(t,e,r){return{x:t*B.cos(r)-e*B.sin(r),y:t*B.sin(r)+e*B.cos(r)}}),s=(h?(v=h[0],b=h[1],y=h[2],m=h[3]):(t=(g=p(t,e,-c)).x,e=g.y,o=(g=p(o,l,-c)).x,l=g.y,B.cos(N/180*n),B.sin(N/180*n),1<(d=(g=(t-o)/2)*g/(r*r)+(x=(e-l)/2)*x/(i*i))&&(r*=d=B.sqrt(d),i*=d),y=(d=(s==a?-1:1)*B.sqrt(T(((d=r*r)*(s=i*i)-d*x*x-s*g*g)/(d*x*x+s*g*g))))*r*x/i+(t+o)/2,v=B.asin(((e-(m=d*-i*g/r+(e+l)/2))/i).toFixed(9)),b=B.asin(((l-m)/i).toFixed(9)),(v=t<y?N-v:v)<0&&(v=2*N+v),(b=o<y?N-b:b)<0&&(b=2*N+b),a&&b<v&&(v-=2*N),!a&&v<b&&(b-=2*N)),b-v),u=(T(s)>u&&(x=b,d=o,g=l,o=y+r*B.cos(b=v+u*(a&&v<b?1:-1)),l=m+i*B.sin(b),f=Rt(o,l,r,i,n,0,a,d,g,[b,x,y,m])),s=b-v,B.cos(v)),n=B.sin(v),a=B.cos(b),d=B.sin(b),g=B.tan(s/4),x=4/3*r*g,y=4/3*i*g,m=[t,e],v=[t+x*n,e-y*u],b=[o+x*d,l-y*a],s=[o,l];if(v[0]=2*m[0]-v[0],v[1]=2*m[1]-v[1],h)return[v,b,s][z](f);for(var _=[],w=0,k=(f=[v,b,s][z](f).join()[R](",")).length;w<k;w++)_[w]=w%2?p(f[w-1],f[w],c).y:p(f[w],f[w+1],c).x;return _},Pt=C(function(t,e,r,i,n,s,a,o){var l,h=n-2*r+t-(a-2*n+r),u=2*(r-t)-2*(n-r),c=t-r,f=(-u+B.sqrt(u*u-4*h*c))/2/h,p=(-u-B.sqrt(u*u-4*h*c))/2/h,d=[e,o],g=[t,a];return"1e12"<T(f)&&(f=.5),"1e12"<T(p)&&(p=.5),0<f&&f<1&&(l=Et(t,e,r,i,n,s,a,o,f),g.push(l.x),d.push(l.y)),0<p&&p<1&&(l=Et(t,e,r,i,n,s,a,o,p),g.push(l.x),d.push(l.y)),f=(-(u=2*(i-e)-2*(s-i))+B.sqrt(u*u-4*(h=s-2*i+e-(o-2*s+i))*(c=e-i)))/2/h,p=(-u-B.sqrt(u*u-4*h*c))/2/h,"1e12"<T(f)&&(f=.5),"1e12"<T(p)&&(p=.5),0<f&&f<1&&(l=Et(t,e,r,i,n,s,a,o,f),g.push(l.x),d.push(l.y)),0<p&&p<1&&(l=Et(t,e,r,i,n,s,a,o,p),g.push(l.x),d.push(l.y)),{min:{x:A[y](0,g),y:A[y](0,d)},max:{x:S[y](0,g),y:S[y](0,d)}}}),It=E._path2curve=C(function(t,e){var r=!e&&b(t);if(!e&&r.curve)return j(r.curve);function i(t,e){if(!t)return["C",e.x,e.y,e.x,e.y,e.x,e.y];switch(t[0]in{T:1,Q:1}||(e.qx=e.qy=null),t[0]){case"M":e.X=t[1],e.Y=t[2];break;case"A":t=["C"][z](Rt[y](0,[e.x,e.y][z](t.slice(1))));break;case"S":t=["C",e.x+(e.x-(e.bx||e.x)),e.y+(e.y-(e.by||e.y))][z](t.slice(1));break;case"T":e.qx=e.x+(e.x-(e.qx||e.x)),e.qy=e.y+(e.y-(e.qy||e.y)),t=["C"][z](Nt(e.x,e.y,e.qx,e.qy,t[1],t[2]));break;case"Q":e.qx=t[1],e.qy=t[2],t=["C"][z](Nt(e.x,e.y,t[1],t[2],t[3],t[4]));break;case"L":t=["C"][z](Tt(e.x,e.y,t[1],t[2]));break;case"H":t=["C"][z](Tt(e.x,e.y,t[1],e.y));break;case"V":t=["C"][z](Tt(e.x,e.y,e.x,t[1]));break;case"Z":t=["C"][z](Tt(e.x,e.y,e.X,e.Y))}return t}function n(t,e){if(7<t[e].length){t[e].shift();for(var r=t[e];r.length;)t.splice(e++,0,["C"][z](r.splice(0,6)));t.splice(e,1),c=S(a.length,o&&o.length||0)}}function s(t,e,r,i,n){t&&e&&"M"==t[n][0]&&"M"!=e[n][0]&&(e.splice(n,0,["M",i.x,i.y]),r.bx=0,r.by=0,r.x=t[n][1],r.y=t[n][2],c=S(a.length,o&&o.length||0))}for(var a=Ft(t),o=e&&Ft(e),l={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},h={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},u=0,c=S(a.length,o&&o.length||0);u<c;u++){a[u]=i(a[u],l),n(a,u),o&&(o[u]=i(o[u],h)),o&&n(o,u),s(a,o,l,h,u),s(o,a,h,l,u);var f=a[u],p=o&&o[u],d=f.length,g=o&&p.length;l.x=f[d-2],l.y=f[d-1],l.bx=I(f[d-4])||l.x,l.by=I(f[d-3])||l.y,h.bx=o&&(I(p[g-4])||h.x),h.by=o&&(I(p[g-3])||h.y),h.x=o&&p[g-2],h.y=o&&p[g-1]}return o||(r.curve=j(a)),o?[a,o]:a},null,j),jt=(E._parseDots=C(function(t){for(var e=[],r=0,i=t.length;r<i;r++){var n={},s=t[r].match(/^([^:]*):?([\\d\\.]*)/);if(n.color=E.getRGB(s[1]),n.color.error)return null;n.color=n.color.hex,s[2]&&(n.offset=s[2]+"%"),e.push(n)}for(i=e.length-(r=1);r<i;r++)if(!e[r].offset){for(var a=I(e[r-1].offset||0),o=0,l=r+1;l<i;l++)if(e[l].offset){o=e[l].offset;break}o||(o=100,l=i);for(var h=((o=I(o))-a)/(l-r+1);r<l;r++)a+=h,e[r].offset=a+"%"}return e}),E._tear=function(t,e){t==e.top&&(e.top=t.prev),t==e.bottom&&(e.bottom=t.next),t.next&&(t.next.prev=t.prev),t.prev&&(t.prev.next=t.next)}),qt=(E._tofront=function(t,e){e.top!==t&&(jt(t,e),t.next=null,t.prev=e.top,e.top.next=t,e.top=t)},E._toback=function(t,e){e.bottom!==t&&(jt(t,e),t.next=e.bottom,t.prev=null,e.bottom.prev=t,e.bottom=t)},E._insertafter=function(t,e,r){jt(t,r),e==r.top&&(r.top=t),e.next&&(e.next.prev=t),t.next=e.next,(t.prev=e).next=t},E._insertbefore=function(t,e,r){jt(t,r),e==r.bottom&&(r.bottom=t),e.prev&&(e.prev.next=t),t.prev=e.prev,(e.prev=t).next=e},E.toMatrix=function(t,e){var r=zt(t),t={_:{transform:""},getBBox:function(){return r}};return Dt(t,e),t.matrix}),Dt=(E.transformPath=function(t,e){return wt(t,qt(t,e))},E._extractTransform=function(t,e){if(null==e)return t._.transform;e=F(e).replace(/\\.{3}|\\u2026/g,t._.transform||"");var r,i=E.parseTransformString(e),n=0,s=1,a=1,o=t._,l=new L;if(o.transform=i||[],i)for(var h=0,u=i.length;h<u;h++){var c,f,p,d,g,x=i[h],y=x.length,m=F(x[0]).toLowerCase(),v=x[0]!=m,b=v?l.invert():0;"t"==m&&3==y?v?(c=b.x(0,0),f=b.y(0,0),p=b.x(x[1],x[2]),d=b.y(x[1],x[2]),l.translate(p-c,d-f)):l.translate(x[1],x[2]):"r"==m?2==y?(g=g||t.getBBox(1),l.rotate(x[1],g.x+g.width/2,g.y+g.height/2),n+=x[1]):4==y&&(v?(p=b.x(x[2],x[3]),d=b.y(x[2],x[3]),l.rotate(x[1],p,d)):l.rotate(x[1],x[2],x[3]),n+=x[1]):"s"==m?2==y||3==y?(g=g||t.getBBox(1),l.scale(x[1],x[y-1],g.x+g.width/2,g.y+g.height/2),s*=x[1],a*=x[y-1]):5==y&&(v?(p=b.x(x[3],x[4]),d=b.y(x[3],x[4]),l.scale(x[1],x[2],p,d)):l.scale(x[1],x[2],x[3],x[4]),s*=x[1],a*=x[2]):"m"==m&&7==y&&l.add(x[1],x[2],x[3],x[4],x[5],x[6]),o.dirtyT=1,t.matrix=l}t.matrix=l,o.sx=s,o.sy=a,o.deg=n,o.dx=e=l.e,o.dy=r=l.f,1==s&&1==a&&!n&&o.bbox?(o.bbox.x+=+e,o.bbox.y+=+r):o.dirtyT=1}),Ot=E._equaliseTransform=function(t,e){e=F(e).replace(/\\.{3}|\\u2026/g,t),t=E.parseTransformString(t)||[],e=E.parseTransformString(e)||[];for(var r,i,n,s,a=S(t.length,e.length),o=[],l=[],h=0;h<a;h++){if(n=t[h]||Lt(e[h]),s=e[h]||Lt(n),n[0]!=s[0]||"r"==n[0].toLowerCase()&&(n[2]!=s[2]||n[3]!=s[3])||"s"==n[0].toLowerCase()&&(n[3]!=s[3]||n[4]!=s[4]))return;for(o[h]=[],l[h]=[],r=0,i=S(n.length,s.length);r<i;r++)r in n&&(o[h][r]=n[r]),r in s&&(l[h][r]=s[r])}return{from:o,to:l}};function Vt(t){return t[0]*t[0]+t[1]*t[1]}function Yt(t){var e=B.sqrt(Vt(t));t[0]&&(t[0]/=e),t[1]&&(t[1]/=e)}E._getContainer=function(t,e,r,i){var n=null!=i||E.is(t,"object")?t:d.doc.getElementById(t);return null!=n?n.tagName?null==e?{container:n,width:n.style.pixelWidth||n.offsetWidth,height:n.style.pixelHeight||n.offsetHeight}:{container:n,width:e,height:r}:{container:1,x:t,y:e,width:r,height:i}:void 0},E.pathToRelative=e,E._engine={},E.path2curve=It,E.matrix=function(t,e,r,i,n,s){return new L(t,e,r,i,n,s)},(e=L.prototype).add=function(t,e,r,i,n,s){var a,o,l,h,u=[[],[],[]],c=[[this.a,this.c,this.e],[this.b,this.d,this.f],[0,0,1]],f=[[t,r,n],[e,i,s],[0,0,1]];for(t&&t instanceof L&&(f=[[t.a,t.c,t.e],[t.b,t.d,t.f],[0,0,1]]),a=0;a<3;a++)for(o=0;o<3;o++){for(l=h=0;l<3;l++)h+=c[a][l]*f[l][o];u[a][o]=h}this.a=u[0][0],this.b=u[1][0],this.c=u[0][1],this.d=u[1][1],this.e=u[0][2],this.f=u[1][2]},e.invert=function(){var t=this,e=t.a*t.d-t.b*t.c;return new L(t.d/e,-t.b/e,-t.c/e,t.a/e,(t.c*t.f-t.d*t.e)/e,(t.b*t.e-t.a*t.f)/e)},e.clone=function(){return new L(this.a,this.b,this.c,this.d,this.e,this.f)},e.translate=function(t,e){this.add(1,0,0,1,t,e)},e.scale=function(t,e,r,i){null==e&&(e=t),(r||i)&&this.add(1,0,0,1,r,i),this.add(t,0,0,e,0,0),(r||i)&&this.add(1,0,0,1,-r,-i)},e.rotate=function(t,e,r){t=E.rad(t),e=e||0,r=r||0;var i=+B.cos(t).toFixed(9),t=+B.sin(t).toFixed(9);this.add(i,t,-t,i,e,r),this.add(1,0,0,1,-e,-r)},e.x=function(t,e){return t*this.a+e*this.c+this.e},e.y=function(t,e){return t*this.b+e*this.d+this.f},e.get=function(t){return+this[F.fromCharCode(97+t)].toFixed(4)},e.toString=function(){return E.svg?"matrix("+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)].join()+")":[this.get(0),this.get(2),this.get(1),this.get(3),0,0].join()},e.toFilter=function(){return"progid:DXImageTransform.Microsoft.Matrix(M11="+this.get(0)+", M12="+this.get(2)+", M21="+this.get(1)+", M22="+this.get(3)+", Dx="+this.get(4)+", Dy="+this.get(5)+", sizingmethod=\'auto expand\')"},e.offset=function(){return[this.e.toFixed(4),this.f.toFixed(4)]},e.split=function(){var t={},e=(t.dx=this.e,t.dy=this.f,[[this.a,this.c],[this.b,this.d]]),r=(t.scalex=B.sqrt(Vt(e[0])),Yt(e[0]),t.shear=e[0][0]*e[1][0]+e[0][1]*e[1][1],e[1]=[e[1][0]-e[0][0]*t.shear,e[1][1]-e[0][1]*t.shear],t.scaley=B.sqrt(Vt(e[1])),Yt(e[1]),t.shear/=t.scaley,-e[0][1]),e=e[1][1];return e<0?(t.rotate=E.deg(B.acos(e)),r<0&&(t.rotate=360-t.rotate)):t.rotate=E.deg(B.asin(r)),t.isSimple=!(+t.shear.toFixed(9)||t.scalex.toFixed(9)!=t.scaley.toFixed(9)&&t.rotate),t.isSuperSimple=!+t.shear.toFixed(9)&&t.scalex.toFixed(9)==t.scaley.toFixed(9)&&!t.rotate,t.noRotation=!+t.shear.toFixed(9)&&!t.rotate,t},e.toTransformString=function(t){t=t||this[R]();return t.isSimple?(t.scalex=+t.scalex.toFixed(4),t.scaley=+t.scaley.toFixed(4),t.rotate=+t.rotate.toFixed(4),(t.dx||t.dy?"t"+[t.dx,t.dy]:"")+(1!=t.scalex||1!=t.scaley?"s"+[t.scalex,t.scaley,0,0]:"")+(t.rotate?"r"+[t.rotate,0,0]:"")):"m"+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)]};var r=navigator.userAgent.match(/Version\\/(.*?)\\s/)||navigator.userAgent.match(/Chrome\\/(\\d+)/);t.safari="Apple Computer, Inc."==navigator.vendor&&(r&&r[1]<4||"iP"==navigator.platform.slice(0,2))||"Google Inc."==navigator.vendor&&r&&r[1]<8?function(){var t=this.rect(-99,-99,this.width+99,this.height+99).attr({stroke:"none"});setTimeout(function(){t.remove()})}:function(){};function Gt(){this.returnValue=!1}function Wt(){return this.originalEvent.preventDefault()}function Xt(){this.cancelBubble=!0}function Ht(){return this.originalEvent.stopPropagation()}for(var Ut=d.doc.addEventListener?function(a,o,l,h){function t(t){var e=d.doc.documentElement.scrollTop||d.doc.body.scrollTop,r=d.doc.documentElement.scrollLeft||d.doc.body.scrollLeft,r=t.clientX+r,e=t.clientY+e;if(et&&it[M](o))for(var i=0,n=t.targetTouches&&t.targetTouches.length;i<n;i++)if(t.targetTouches[i].target==a){var s=t;(t=t.targetTouches[i]).originalEvent=s,t.preventDefault=Wt,t.stopPropagation=Ht;break}return l.call(h,t,r,e)}var e=et&&it[o]?it[o]:o;return a.addEventListener(e,t,!1),function(){return a.removeEventListener(e,t,!1),!0}}:d.doc.attachEvent?function(t,e,i,n){function r(t){t=t||d.win.event;var e=d.doc.documentElement.scrollTop||d.doc.body.scrollTop,r=d.doc.documentElement.scrollLeft||d.doc.body.scrollLeft,r=t.clientX+r,e=t.clientY+e;return t.preventDefault=t.preventDefault||Gt,t.stopPropagation=t.stopPropagation||Xt,i.call(n,t,r,e)}t.attachEvent("on"+e,r);return function(){return t.detachEvent("on"+e,r),!0}}:void 0,g=[],$t=function(t){for(var e,r=t.clientX,i=t.clientY,n=d.doc.documentElement.scrollTop||d.doc.body.scrollTop,s=d.doc.documentElement.scrollLeft||d.doc.body.scrollLeft,a=g.length;a--;){if(e=g[a],et){for(var o,l=t.touches.length;l--;)if((o=t.touches[l]).identifier==e.el._drag.id){r=o.clientX,i=o.clientY,(t.originalEvent||t).preventDefault();break}}else t.preventDefault();var h,u=e.el.node,c=u.nextSibling,f=u.parentNode,p=u.style.display;d.win.opera&&f.removeChild(u),u.style.display="none",h=e.el.paper.getElementByPoint(r,i),u.style.display=p,d.win.opera&&(c?f.insertBefore(u,c):f.appendChild(u)),h&&eve("raphael.drag.over."+e.el.id,e.el,h),r+=s,i+=n,eve("raphael.drag.move."+e.el.id,e.move_scope||e.el,r-e.el._drag.x,i-e.el._drag.y,r,i,t)}},Zt=function(t){E.unmousemove($t).unmouseup(Zt);for(var e,r=g.length;r--;)(e=g[r]).el._drag={},eve("raphael.drag.end."+e.el.id,e.end_scope||e.start_scope||e.move_scope||e.el,t);g=[]},s=E.el={},Qt=rt.length;Qt--;)!function(i){E[i]=s[i]=function(t,e){return E.is(t,"function")&&(this.events=this.events||[],this.events.push({name:i,f:t,unbind:Ut(this.shape||this.node||d.doc,i,t,e||this)})),this},E["un"+i]=s["un"+i]=function(t){for(var e=this.events||[],r=e.length;r--;)if(e[r].name==i&&e[r].f==t)return e[r].unbind(),e.splice(r,1),e.length||delete this.events,this;return this}}(rt[Qt]);s.data=function(t,e){var r=n[this.id]=n[this.id]||{};if(1!=arguments.length)return r[t]=e,eve("raphael.data.set."+this.id,this,e,t),this;if(E.is(t,"object")){for(var i in t)t[M](i)&&this.data(i,t[i]);return this}return eve("raphael.data.get."+this.id,this,r[t],t),r[t]},s.removeData=function(t){return null==t?n[this.id]={}:n[this.id]&&delete n[this.id][t],this},s.getData=function(){return x(n[this.id]||{})},s.hover=function(t,e,r,i){return this.mouseover(t,r).mouseout(e,i||r)},s.unhover=function(t,e){return this.unmouseover(t).unmouseout(e)};function Jt(t,e,r,i,n,s,a,o,l){return null==l?_(t,e,r,i,n,s,a,o):E.findDotsAtSegment(t,e,r,i,n,s,a,o,function(t,e,r,i,n,s,a,o,l){if(!(l<0||l>_(t,e,r,i,n,s,a,o))){for(var h=.5,u=1-h,c=_(t,e,r,i,n,s,a,o,u);.01<T(c-l);)c=_(t,e,r,i,n,s,a,o,u+=(c<l?1:-1)*(h/=2));return u}}(t,e,r,i,n,s,a,o,l))}function Kt(p,d){return function(t,e,r){for(var i,n,s,a,o,l="",h={},u=0,c=0,f=(t=It(t)).length;c<f;c++){if("M"==(s=t[c])[0])i=+s[1],n=+s[2];else{if(e<u+(a=Jt(i,n,s[1],s[2],s[3],s[4],s[5],s[6]))){if(d&&!h.start){if(l+=["C"+(o=Jt(i,n,s[1],s[2],s[3],s[4],s[5],s[6],e-u)).start.x,o.start.y,o.m.x,o.m.y,o.x,o.y],r)return l;h.start=l,l=["M"+o.x,o.y+"C"+o.n.x,o.n.y,o.end.x,o.end.y,s[5],s[6]].join(),u+=a,i=+s[5],n=+s[6];continue}if(!p&&!d)return{x:(o=Jt(i,n,s[1],s[2],s[3],s[4],s[5],s[6],e-u)).x,y:o.y,alpha:o.alpha}}u+=a,i=+s[5],n=+s[6]}l+=s.shift()+s}return h.end=l,o=(o=p?u:d?h:E.findDotsAtSegment(i,n,s[0],s[1],s[2],s[3],s[4],s[5],1)).alpha?{x:o.x,y:o.y,alpha:o.alpha}:o}}var te,i,ee,re,ie,ne,u=[],se=(s.drag=function(i,n,s,a,o,l){function t(t){(t.originalEvent||t).preventDefault();var e=d.doc.documentElement.scrollTop||d.doc.body.scrollTop,r=d.doc.documentElement.scrollLeft||d.doc.body.scrollLeft;this._drag.x=t.clientX+r,this._drag.y=t.clientY+e,this._drag.id=t.identifier,g.length||E.mousemove($t).mouseup(Zt),g.push({el:this,move_scope:a,start_scope:o,end_scope:l}),n&&eve.on("raphael.drag.start."+this.id,n),i&&eve.on("raphael.drag.move."+this.id,i),s&&eve.on("raphael.drag.end."+this.id,s),eve("raphael.drag.start."+this.id,o||a||this,t.clientX+r,t.clientY+e,t)}return this._drag={},u.push({el:this,start:t}),this.mousedown(t),this},s.onDragOver=function(t){t?eve.on("raphael.drag.over."+this.id,t):eve.unbind("raphael.drag.over."+this.id)},s.undrag=function(){for(var t=u.length;t--;)u[t].el==this&&(this.unmousedown(u[t].start),u.splice(t,1),eve.unbind("raphael.drag.*."+this.id));u.length||E.unmousemove($t).unmouseup(Zt),g=[]},t.circle=function(t,e,r){t=E._engine.circle(this,t||0,e||0,r||0);return this.__set__&&this.__set__.push(t),t},t.rect=function(t,e,r,i,n){t=E._engine.rect(this,t||0,e||0,r||0,i||0,n||0);return this.__set__&&this.__set__.push(t),t},t.ellipse=function(t,e,r,i){t=E._engine.ellipse(this,t||0,e||0,r||0,i||0);return this.__set__&&this.__set__.push(t),t},t.path=function(t){!t||E.is(t,st)||E.is(t[0],v)||(t+="");var e=E._engine.path(E.format[y](E,arguments),this);return this.__set__&&this.__set__.push(e),e},t.image=function(t,e,r,i,n){t=E._engine.image(this,t||"about:blank",e||0,r||0,i||0,n||0);return this.__set__&&this.__set__.push(t),t},t.text=function(t,e,r){t=E._engine.text(this,t||0,e||0,F(r));return this.__set__&&this.__set__.push(t),t},t.set=function(t){E.is(t,"array")||(t=Array.prototype.splice.call(arguments,0,arguments.length));var e=new ce(t);return this.__set__&&this.__set__.push(e),e.paper=this,e.type="set",e},t.setStart=function(t){this.__set__=t||this.set()},t.setFinish=function(){var t=this.__set__;return delete this.__set__,t},t.setSize=function(t,e){return E._engine.setSize.call(this,t,e)},t.setViewBox=function(t,e,r,i,n){return E._engine.setViewBox.call(this,t,e,r,i,n)},t.top=t.bottom=null,t.raphael=E,t.getElementByPoint=function(t,e){var r,i,n,s,a,o=this.canvas,l=d.doc.elementFromPoint(t,e);if(d.win.opera&&"svg"==l.tagName&&(i=(r=o).getBoundingClientRect(),r=r.ownerDocument,n=r.body,r=r.documentElement,s=r.clientTop||n.clientTop||0,a=r.clientLeft||n.clientLeft||0,s={y:i.top+(d.win.pageYOffset||r.scrollTop||n.scrollTop)-s,x:i.left+(d.win.pageXOffset||r.scrollLeft||n.scrollLeft)-a},(i=o.createSVGRect()).x=t-s.x,i.y=e-s.y,i.width=i.height=1,(r=o.getIntersectionList(i,null)).length&&(l=r[r.length-1])),!l)return null;for(;l.parentNode&&l!=o.parentNode&&!l.raphael;)l=l.parentNode;return(l=l==this.canvas.parentNode?o:l)&&l.raphael?this.getById(l.raphaelid):null},t.getElementsByBBox=function(e){var r=this.set();return this.forEach(function(t){E.isBBoxIntersect(t.getBBox(),e)&&r.push(t)}),r},t.getById=function(t){for(var e=this.bottom;e;){if(e.id==t)return e;e=e.next}return null},t.forEach=function(t,e){for(var r=this.bottom;r;){if(!1===t.call(e,r))return this;r=r.next}return this},t.getElementsByPoint=function(e,r){var i=this.set();return this.forEach(function(t){t.isPointInside(e,r)&&i.push(t)}),i},s.isPointInside=function(t,e){var r=this.realPath=this.realPath||_t[this.type](this);return E.isPointInsidePath(r,t,e)},s.getBBox=function(t){if(this.removed)return{};var e=this._;return t?(!e.dirty&&e.bboxwt||(this.realPath=_t[this.type](this),e.bboxwt=zt(this.realPath),e.bboxwt.toString=f,e.dirty=0),e.bboxwt):(!e.dirty&&!e.dirtyT&&e.bbox||(!e.dirty&&this.realPath||(e.bboxwt=0,this.realPath=_t[this.type](this)),e.bbox=zt(wt(this.realPath,this.matrix)),e.bbox.toString=f,e.dirty=e.dirtyT=0),e.bbox)},s.clone=function(){if(this.removed)return null;var t=this.paper[this.type]().attr(this.attr());return this.__set__&&this.__set__.push(t),t},s.glow=function(t){if("text"==this.type)return null;for(var e={width:((t=t||{}).width||10)+(+this.attr("stroke-width")||1),fill:t.fill||!1,opacity:t.opacity||.5,offsetx:t.offsetx||0,offsety:t.offsety||0,color:t.color||"#000"},r=e.width/2,i=this.paper,n=i.set(),s=this.realPath||_t[this.type](this),s=this.matrix?wt(s,this.matrix):s,a=1;a<1+r;a++)n.push(i.path(s).attr({stroke:e.color,fill:e.fill?e.color:"none","stroke-linejoin":"round","stroke-linecap":"round","stroke-width":+(e.width/r*a).toFixed(3),opacity:+(e.opacity/r).toFixed(3)}));return n.insertBefore(this).translate(e.offsetx,e.offsety)},Kt(1)),ae=Kt(),oe=Kt(0,1),r=(E.getTotalLength=se,E.getPointAtLength=ae,E.getSubpath=function(t,e,r){if(this.getTotalLength(t)-r<1e-6)return oe(t,e).end;t=oe(t,r,1);return e?oe(t,e).end:t},s.getTotalLength=function(){return"path"==this.type?this.node.getTotalLength?this.node.getTotalLength():se(this.attrs.path):void 0},s.getPointAtLength=function(t){return"path"==this.type?ae(this.attrs.path,t):void 0},s.getSubpath=function(t,e){return"path"==this.type?E.getSubpath(this.attrs.path,t,e):void 0},E.easing_formulas={linear:function(t){return t},"<":function(t){return m(t,1.7)},">":function(t){return m(t,.48)},"<>":function(t){var t=.48-t/1.04,e=B.sqrt(.1734+t*t),r=e-t,e=-e-t,t=m(T(r),1/3)*(r<0?-1:1)+m(T(e),1/3)*(e<0?-1:1)+.5;return 3*(1-t)*t*t+t*t*t},backIn:function(t){return t*t*(2.70158*t-1.70158)},backOut:function(t){return--t*t*(2.70158*t+1.70158)+1},elastic:function(t){return t==!!t?t:m(2,-10*t)*B.sin(2*(t-.075)*N/.3)+1},bounce:function(t){var e=7.5625,r=2.75,e=t<1/r?e*t*t:t<2/r?e*(t-=1.5/r)*t+.75:t<2.5/r?e*(t-=2.25/r)*t+.9375:e*(t-=2.625/r)*t+.984375;return e}}),q=(r.easeIn=r["ease-in"]=r["<"],r.easeOut=r["ease-out"]=r[">"],r.easeInOut=r["ease-in-out"]=r["<>"],r["back-in"]=r.backIn,r["back-out"]=r.backOut,[]),le=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){setTimeout(t,16)},he=function(){for(var t=+new Date,e=0;q.length>e;e++){var r=q[e];if(!r.el.removed&&!r.paused){var i,n=t-r.start,s=r.ms,a=r.easing,o=r.from,l=r.diff,h=r.to,u=(r.t,r.el),c={},f={};if(r.initstatus?(n=(r.initstatus*r.anim.top-r.prev)/(r.percent-r.prev)*s,r.status=r.initstatus,delete r.initstatus,r.stop&&q.splice(e--,1)):r.status=(r.prev+(r.percent-r.prev)*(n/s))/r.anim.top,!(n<0))if(n<s){var p,d=a(n/s);for(p in o)if(o[M](p)){switch(pt[p]){case P:g=+o[p]+d*s*l[p];break;case"colour":g="rgb("+[ue(ut(o[p].r+d*s*l[p].r)),ue(ut(o[p].g+d*s*l[p].g)),ue(ut(o[p].b+d*s*l[p].b))].join(",")+")";break;case"path":for(var g=[],x=0,y=o[p].length;x<y;x++){g[x]=[o[p][x][0]];for(var m=1,v=o[p][x].length;m<v;m++)g[x][m]=+o[p][x][m]+d*s*l[p][x][m];g[x]=g[x].join(k)}g=g.join(k);break;case"transform":if(l[p].real)for(g=[],x=0,y=o[p].length;x<y;x++)for(g[x]=[o[p][x][0]],m=1,v=o[p][x].length;m<v;m++)g[x][m]=o[p][x][m]+d*s*l[p][x][m];else{function b(t){return+o[p][t]+d*s*l[p][t]}g=[["m",b(0),b(1),b(2),b(3),b(4),b(5)]]}break;case"csv":if("clip-rect"==p)for(g=[],x=4;x--;)g[x]=+o[p][x]+d*s*l[p][x];break;default:var _=[][z](o[p]);for(g=[],x=u.paper.customAttributes[p].length;x--;)g[x]=+_[x]+d*s*l[p][x]}c[p]=g}u.attr(c),function(t,e,r){setTimeout(function(){eve("raphael.anim.frame."+t,e,r)})}(u.id,u,r.anim)}else{if(function(t,e,r){setTimeout(function(){eve("raphael.anim.frame."+e.id,e,r),eve("raphael.anim.finish."+e.id,e,r),E.is(t,"function")&&t.call(e)})}(r.callback,u,r.anim),u.attr(h),q.splice(e--,1),1<r.repeat&&!r.next){for(i in h)h[M](i)&&(f[i]=r.totalOrigin[i]);r.el.attr(f),w(r.anim,r.el,r.anim.percents[0],null,r.totalOrigin,r.repeat-1)}r.next&&!r.stop&&w(r.anim,r.el,r.next,null,r.totalOrigin,r.repeat)}}}E.svg&&u&&u.paper&&u.paper.safari(),q.length&&le(he)},ue=function(t){return 255<t?255:t<0?0:t},ce=(s.animateWith=function(t,e,r,i,n,s){var a=this;if(a.removed)return s&&s.call(a),a;r=r instanceof h?r:E.animation(r,i,n,s);w(r,a,r.percents[0],null,a.attr());for(var o=0,l=q.length;o<l;o++)if(q[o].anim==e&&q[o].el==t){q[l-1].start=q[o].start;break}return a},s.onAnimation=function(t){return t?eve.on("raphael.anim.frame."+this.id,t):eve.unbind("raphael.anim.frame."+this.id),this},h.prototype.delay=function(t){var e=new h(this.anim,this.ms);return e.times=this.times,e.del=+t||0,e},h.prototype.repeat=function(t){var e=new h(this.anim,this.ms);return e.del=this.del,e.times=B.floor(S(t,0))||1,e},E.animation=function(t,e,r,i){if(t instanceof h)return t;!E.is(r,"function")&&r||(i=i||r||null,r=null),e=+e||0;var n,s,a={};for(s in t=Object(t))t[M](s)&&I(s)!=s&&I(s)+"%"!=s&&(n=!0,a[s]=t[s]);return n?(r&&(a.easing=r),i&&(a.callback=i),new h({100:a},e)):new h(t,e)},s.animate=function(t,e,r,i){var n=this;if(n.removed)return i&&i.call(n),n;t=t instanceof h?t:E.animation(t,e,r,i);return w(t,n,t.percents[0],null,n.attr()),n},s.setTime=function(t,e){return t&&null!=e&&this.status(t,A(e,t.ms)/t.ms),this},s.status=function(t,e){var r,i,n=[],s=0;if(null!=e)return w(t,this,-1,A(e,1)),this;for(r=q.length;s<r;s++)if((i=q[s]).el.id==this.id&&(!t||i.anim==t)){if(t)return i.status;n.push({anim:i.anim,status:i.status})}return t?0:n},s.pause=function(t){for(var e=0;q.length>e;e++)q[e].el.id!=this.id||t&&q[e].anim!=t||!1!==eve("raphael.anim.pause."+this.id,this,q[e].anim)&&(q[e].paused=!0);return this},s.resume=function(t){for(var e,r=0;q.length>r;r++)q[r].el.id!=this.id||t&&q[r].anim!=t||(e=q[r],!1!==eve("raphael.anim.resume."+this.id,this,e.anim)&&(delete e.paused,this.status(e.anim,e.status)));return this},s.stop=function(t){for(var e=0;q.length>e;e++)q[e].el.id!=this.id||t&&q[e].anim!=t||!1!==eve("raphael.anim.stop."+this.id,this,q[e].anim)&&q.splice(e--,1);return this},eve.on("raphael.remove",p),eve.on("raphael.clear",p),s.toString=function(){return"RaphaÃ«lâ€™s object"},function(t){if(this.items=[],this.length=0,this.type="set",t)for(var e=0,r=t.length;e<r;e++)!t[e]||t[e].constructor!=s.constructor&&t[e].constructor!=ce||(this[this.items.length]=this.items[this.items.length]=t[e],this.length++)}),a=ce.prototype;for(te in a.push=function(){for(var t,e,r=0,i=arguments.length;r<i;r++)!(t=arguments[r])||t.constructor!=s.constructor&&t.constructor!=ce||(this[e=this.items.length]=this.items[e]=t,this.length++);return this},a.pop=function(){return this.length&&delete this[this.length--],this.items.pop()},a.forEach=function(t,e){for(var r=0,i=this.items.length;r<i;r++)if(!1===t.call(e,this.items[r],r))return this;return this},s)s[M](te)&&(a[te]=function(r){return function(){var e=arguments;return this.forEach(function(t){t[r][y](t,e)})}}(te));a.attr=function(t,e){if(t&&E.is(t,v)&&E.is(t[0],"object"))for(var r=0,i=t.length;r<i;r++)this.items[r].attr(t[r]);else for(var n=0,s=this.items.length;n<s;n++)this.items[n].attr(t,e);return this},a.clear=function(){for(;this.length;)this.pop()},a.splice=function(t,e){t=t<0?S(this.length+t,0):t,e=S(0,A(this.length-t,e));for(var r=[],i=[],n=[],s=2;s<arguments.length;s++)n.push(arguments[s]);for(s=0;s<e;s++)i.push(this[t+s]);for(;this.length-t>s;s++)r.push(this[t+s]);var a=n.length;for(s=0;a+r.length>s;s++)this.items[t+s]=this[t+s]=s<a?n[s]:r[s-a];for(s=this.items.length=this.length-=e-a;this[s];)delete this[s++];return new ce(i)},a.exclude=function(t){for(var e=0,r=this.length;e<r;e++)if(this[e]==t)return this.splice(e,1),!0},a.animate=function(t,e,r,i){!E.is(r,"function")&&r||(i=r||null);var n,s=this.items.length,a=s,o=this;if(!s)return this;i&&(n=function(){--s||i.call(o)}),r=E.is(r,st)?r:n;for(var l=E.animation(t,e,r,n),h=this.items[--a].animate(l);a--;)this.items[a]&&!this.items[a].removed&&this.items[a].animateWith(h,l,l);return this},a.insertAfter=function(t){for(var e=this.items.length;e--;)this.items[e].insertAfter(t);return this},a.getBBox=function(){for(var t,e=[],r=[],i=[],n=[],s=this.items.length;s--;)this.items[s].removed||(t=this.items[s].getBBox(),e.push(t.x),r.push(t.y),i.push(t.x+t.width),n.push(t.y+t.height));return{x:e=A[y](0,e),y:r=A[y](0,r),x2:i=S[y](0,i),y2:n=S[y](0,n),width:i-e,height:n-r}},a.clone=function(t){t=this.paper.set();for(var e=0,r=this.items.length;e<r;e++)t.push(this.items[e].clone());return t},a.toString=function(){return"RaphaÃ«lâ€˜s set"},a.glow=function(e){var r=this.paper.set();return this.forEach(function(t){t=t.glow(e);null!=t&&t.forEach(function(t){r.push(t)})}),r},E.registerFont=function(t){if(!t.face)return t;this.fonts=this.fonts||{};var e,r={w:t.w,face:{},glyphs:{}},i=t.face["font-family"];for(e in t.face)t.face[M](e)&&(r.face[e]=t.face[e]);if(this.fonts[i]?this.fonts[i].push(r):this.fonts[i]=[r],!t.svg)for(var n in r.face["units-per-em"]=o(t.face["units-per-em"],10),t.glyphs)if(t.glyphs[M](n)){var s=t.glyphs[n];if(r.glyphs[n]={w:s.w,k:{},d:s.d&&"M"+s.d.replace(/[mlcxtrv]/g,function(t){return{l:"L",c:"C",x:"z",t:"m",r:"l",v:"c"}[t]||"M"})+"z"},s.k)for(var a in s.k)s[M](a)&&(r.glyphs[n].k[a]=s.k[a])}return t},t.getFont=function(t,e,r,i){if(i=i||"normal",r=r||"normal",e=+e||{normal:400,bold:700,lighter:300,bolder:800}[e]||400,E.fonts){var n,s=E.fonts[t];if(!s){var a,o=RegExp("(^|\\\\s)"+t.replace(/[^\\w\\d\\s+!~.:_-]/g,"")+"(\\\\s|$)","i");for(a in E.fonts)if(E.fonts[M](a)&&o.test(a)){s=E.fonts[a];break}}if(s)for(var l=0,h=s.length;l<h&&((n=s[l]).face["font-weight"]!=e||n.face["font-style"]!=r&&n.face["font-style"]||n.face["font-stretch"]!=i);l++);return n}},t.print=function(t,e,r,i,n,s,a){s=s||"middle",a=S(A(a||0,1),-1);var o=F(r)[R](""),l=0,h=0,u="";if(i=E.is(i,"string")?this.getFont(i):i)for(var c,f,p=(n||16)/i.face["units-per-em"],r=i.face.bbox[R](Q),d=+r[0],g=r[3]-r[1],x=0,y=+r[1]+("baseline"==s?g+ +i.face.descent:g/2),m=0,v=o.length;m<v;m++)"\\n"==o[m]?(h=f=l=0,x+=g):(c=h&&i.glyphs[o[m-1]]||{},f=i.glyphs[o[m]],l+=h?(c.w||i.w)+(c.k&&c.k[o[m]]||0)+i.w*a:0,h=1),f&&f.d&&(u+=E.transformPath(f.d,["t",l*p,x*p,"s",p,p,d,y,"t",(t-d)/p,(e-y)/p]));return this.path(u).attr({fill:"#000",stroke:"none"})},t.add=function(t){if(E.is(t,"array"))for(var e,r=this.set(),i=0,n=t.length;i<n;i++)e=t[i]||{},J[M](e.type)&&r.push(this[e.type]().attr(e));return r},E.format=function(t,e){var r=E.is(e,v)?[0][z](e):arguments;return(t=t&&E.is(t,st)&&r.length-1?t.replace(K,function(t,e){return null==r[++e]?"":r[e]}):t)||""},E.fullfill=(ie=/\\{([^\\}]+)\\}/g,ne=/(?:(?:^|\\.)(.+?)(?=\\[|\\.|$|\\()|\\[(\'|")(.+?)\\2\\])(\\(\\))?/g,function(t,i){return(t+"").replace(ie,function(t,e){return t=t,s=r=i,e.replace(ne,function(t,e,r,i,n){e=e||i,s&&("function"==typeof(s=e in s?s[e]:s)&&n&&(s=s()))}),s=(null==s||s==r?t:s)+"";var r,s})}),E.ninja=function(){return tt.was?d.win.Raphael=tt.is:delete Raphael,E},E.st=a,i=document,ee="DOMContentLoaded",null==i.readyState&&i.addEventListener&&(i.addEventListener(ee,re=function(){i.removeEventListener(ee,re,!1),i.readyState="complete"},!1),i.readyState="loading"),function t(){/in/.test(i.readyState)?setTimeout(t,9):E.eve("raphael.DOMload")}(),tt.was?d.win.Raphael=E:Raphael=E,eve.on("raphael.DOMload",function(){U=!0})}(),window.Raphael&&window.Raphael.svg&&function(S){function A(t,e){var i="linear",r=t.id+e,n=.5,s=.5,a=t.node,o=t.paper,l=a.style,h=S._g.doc.getElementById(r);if(!h){if(e=(e=M(e).replace(S._radial_gradient,function(t,e,r){return i="radial",e&&r&&(n=g(e),e=2*(.5<(s=g(r)))-1,.25<y(n-.5,2)+y(s-.5,2)&&(s=x.sqrt(.25-y(n-.5,2))*e+.5)&&.5!=s&&(s=s.toFixed(5)-1e-5*e)),I})).split(/\\s*\\-\\s*/),"linear"==i){var u=e.shift(),u=-g(u);if(isNaN(u))return;var u=[0,0,x.cos(S.rad(u)),x.sin(S.rad(u))],c=1/(F(R(u[2]),R(u[3]))||1);u[2]*=c,u[3]*=c,u[2]<0&&(u[0]=-u[2],u[2]=0),u[3]<0&&(u[1]=-u[3],u[3]=0)}var f=S._parseDots(e);if(!f)return;if(r=r.replace(/[\\(\\)\\s,\\xb0#]/g,"_"),t.gradient&&r!=t.gradient.id&&(o.defs.removeChild(t.gradient),delete t.gradient),!t.gradient){h=q(i+"Gradient",{id:r}),t.gradient=h,q(h,"radial"==i?{fx:n,fy:s}:{x1:u[0],y1:u[1],x2:u[2],y2:u[3],gradientTransform:t.matrix.invert()}),o.defs.appendChild(h);for(var p=0,d=f.length;p<d;p++)h.appendChild(q("stop",{offset:f[p].offset||(p?"100%":"0%"),"stop-color":f[p].color||"#fff"}))}}return q(a,{fill:"url(#"+r+")",opacity:1,"fill-opacity":1}),l.fill=I,l.opacity=1,l.fillOpacity=1}function T(t){var e=t.getBBox(1);q(t.pattern,{patternTransform:t.matrix.invert()+" translate("+e.x+","+e.y+")"})}function N(t,e,r){if("path"==t.type){for(var i,n,s,a,o,l,h,u,c,f=M(e).toLowerCase().split("-"),p=t.paper,d=r?"end":"start",g=t.node,x=t.attrs,y=x["stroke-width"],m=f.length,v="classic",b=3,_=3,w=5;m--;)switch(f[m]){case"block":case"classic":case"oval":case"diamond":case"open":case"none":v=f[m];break;case"wide":_=5;break;case"narrow":_=2;break;case"long":b=5;break;case"short":b=2}for(u in u="open"==v?(b+=2,_+=2,w+=2,n=1,l=r?4:1,{fill:"none",stroke:x.stroke}):(l=n=b/2,{fill:x.stroke,stroke:"none"}),t._.arrows?r?(t._.arrows.endPath&&C[t._.arrows.endPath]--,t._.arrows.endMarker&&C[t._.arrows.endMarker]--):(t._.arrows.startPath&&C[t._.arrows.startPath]--,t._.arrows.startMarker&&C[t._.arrows.startMarker]--):t._.arrows={},"none"!=v?(a="raphael-marker-"+d+v+b+_,S._g.doc.getElementById(s="raphael-marker-"+v)?C[s]++:(p.defs.appendChild(q(q("path"),{"stroke-linecap":"round",d:k[v],id:s})),C[s]=1),(h=S._g.doc.getElementById(a))?(C[a]++,o=h.getElementsByTagName("use")[0]):(h=q(q("marker"),{id:a,markerHeight:_,markerWidth:b,orient:"auto",refX:l,refY:_/2}),o=q(q("use"),{"xlink:href":"#"+s,transform:(r?"rotate(180 "+b/2+" "+_/2+") ":I)+"scale("+b/w+","+_/w+")","stroke-width":(1/((b/w+_/w)/2)).toFixed(4)}),h.appendChild(o),p.defs.appendChild(h),C[a]=1),q(o,u),l=n*("diamond"!=v&&"oval"!=v),h=r?(i=t._.arrows.startdx*y||0,S.getTotalLength(x.path)-l*y):(i=l*y,S.getTotalLength(x.path)-(t._.arrows.enddx*y||0)),(u={})["marker-"+d]="url(#"+a+")",(h||i)&&(u.d=Raphael.getSubpath(x.path,i,h)),q(g,u),t._.arrows[d+"Path"]=s,t._.arrows[d+"Marker"]=a,t._.arrows[d+"dx"]=l,t._.arrows[d+"Type"]=v,t._.arrows[d+"String"]=e):(h=r?(i=t._.arrows.startdx*y||0,S.getTotalLength(x.path)-i):(i=0,S.getTotalLength(x.path)-(t._.arrows.enddx*y||0)),t._.arrows[d+"Path"]&&q(g,{d:Raphael.getSubpath(x.path,i,h)}),delete t._.arrows[d+"Path"],delete t._.arrows[d+"Marker"],delete t._.arrows[d+"dx"],delete t._.arrows[d+"Type"],delete t._.arrows[d+"String"]),C)!C[L](u)||C[u]||(c=S._g.doc.getElementById(u))&&c.parentNode.removeChild(c)}}function E(t,e,r){if(e=l[M(e).toLowerCase()]){for(var i=t.attrs["stroke-width"]||"1",n={round:i,square:i,butt:0}[t.attrs["stroke-linecap"]||r["stroke-linecap"]]||0,s=[],a=e.length;a--;)s[a]=e[a]*i+(a%2?1:-1)*n;q(t.node,{"stroke-dasharray":s.join(",")})}}function f(i,t){var e,r=i.node,n=i.attrs,s=r.style.visibility;for(e in r.style.visibility="hidden",t)if(t[L](e)){if(!S._availableAttrs[L](e))continue;var a=t[e];switch(n[e]=a,e){case"blur":i.blur(a);break;case"href":case"title":case"target":var o=r.parentNode;"a"!=o.tagName.toLowerCase()&&(l=q("a"),o.insertBefore(l,r),l.appendChild(r),o=l),"target"==e?o.setAttributeNS(j,"show","blank"==a?"new":a):o.setAttributeNS(j,e,a);break;case"cursor":r.style.cursor=a;break;case"transform":i.transform(a);break;case"arrow-start":N(i,a);break;case"arrow-end":N(i,a,1);break;case"clip-rect":var l=M(a).split(P);4==l.length&&(i.clip&&i.clip.parentNode.parentNode.removeChild(i.clip.parentNode),u=q("clipPath"),o=q("rect"),u.id=S.createUUID(),q(o,{x:l[0],y:l[1],width:l[2],height:l[3]}),u.appendChild(o),i.paper.defs.appendChild(u),q(r,{"clip-path":"url(#"+u.id+")"}),i.clip=o),a||(g=r.getAttribute("clip-path"))&&((g=S._g.doc.getElementById(g.replace(/(^url\\(#|\\)$)/g,I)))&&g.parentNode.removeChild(g),q(r,{"clip-path":I}),delete i.clip);break;case"path":"path"==i.type&&(q(r,{d:a?n.path=S._pathToAbsolute(a):"M0,0"}),i._.dirty=1,i._.arrows&&("startString"in i._.arrows&&N(i,i._.arrows.startString),"endString"in i._.arrows&&N(i,i._.arrows.endString,1)));break;case"width":if(r.setAttribute(e,a),i._.dirty=1,!n.fx)break;e="x",a=n.x;case"x":n.fx&&(a=-n.x-(n.width||0));case"rx":if("rx"==e&&"rect"==i.type)break;case"cx":r.setAttribute(e,a),i.pattern&&T(i),i._.dirty=1;break;case"height":if(r.setAttribute(e,a),i._.dirty=1,!n.fy)break;e="y",a=n.y;case"y":n.fy&&(a=-n.y-(n.height||0));case"ry":if("ry"==e&&"rect"==i.type)break;case"cy":r.setAttribute(e,a),i.pattern&&T(i),i._.dirty=1;break;case"r":"rect"==i.type?q(r,{rx:a,ry:a}):r.setAttribute(e,a),i._.dirty=1;break;case"src":"image"==i.type&&r.setAttributeNS(j,"href",a);break;case"stroke-width":1==i._.sx&&1==i._.sy||(a/=F(R(i._.sx),R(i._.sy))||1),i.paper._vbSize&&(a*=i.paper._vbSize),r.setAttribute(e,a),n["stroke-dasharray"]&&E(i,n["stroke-dasharray"],t),i._.arrows&&("startString"in i._.arrows&&N(i,i._.arrows.startString),"endString"in i._.arrows&&N(i,i._.arrows.endString,1));break;case"stroke-dasharray":E(i,a,t);break;case"fill":var h=M(a).match(S._ISURL);if(h){var u=q("pattern"),c=q("image");u.id=S.createUUID(),q(u,{x:0,y:0,patternUnits:"userSpaceOnUse",height:1,width:1}),q(c,{x:0,y:0,"xlink:href":h[1]}),u.appendChild(c),function(r){S._preload(h[1],function(){var t=this.offsetWidth,e=this.offsetHeight;q(r,{width:t,height:e}),q(c,{width:t,height:e}),i.paper.safari()})}(u),i.paper.defs.appendChild(u),q(r,{fill:"url(#"+u.id+")"}),i.pattern=u,i.pattern&&T(i);break}var f,p,d=S.getRGB(a);if(d.error){if(("circle"==i.type||"ellipse"==i.type||"r"!=M(a).charAt())&&A(i,a)){!("opacity"in n||"fill-opacity"in n)||(f=S._g.doc.getElementById(r.getAttribute("fill").replace(/^url\\(#|\\)$/g,I)))&&(p=f.getElementsByTagName("stop"),q(p[p.length-1],{"stop-opacity":("opacity"in n?n.opacity:1)*("fill-opacity"in n?n["fill-opacity"]:1)})),n.gradient=a,n.fill="none";break}}else delete t.gradient,delete n.gradient,!S.is(n.opacity,"undefined")&&S.is(t.opacity,"undefined")&&q(r,{opacity:n.opacity}),!S.is(n["fill-opacity"],"undefined")&&S.is(t["fill-opacity"],"undefined")&&q(r,{"fill-opacity":n["fill-opacity"]});d[L]("opacity")&&q(r,{"fill-opacity":1<d.opacity?d.opacity/100:d.opacity});case"stroke":d=S.getRGB(a),r.setAttribute(e,d.hex),"stroke"==e&&d[L]("opacity")&&q(r,{"stroke-opacity":1<d.opacity?d.opacity/100:d.opacity}),"stroke"==e&&i._.arrows&&("startString"in i._.arrows&&N(i,i._.arrows.startString),"endString"in i._.arrows&&N(i,i._.arrows.endString,1));break;case"gradient":"circle"!=i.type&&"ellipse"!=i.type&&"r"==M(a).charAt()||A(i,a);break;case"opacity":n.gradient&&!n[L]("stroke-opacity")&&q(r,{"stroke-opacity":1<a?a/100:a});case"fill-opacity":if(n.gradient){(f=S._g.doc.getElementById(r.getAttribute("fill").replace(/^url\\(#|\\)$/g,I)))&&(p=f.getElementsByTagName("stop"),q(p[p.length-1],{"stop-opacity":a}));break}default:"font-size"==e&&(a=z(a,10)+"px");var g=e.replace(/(\\-.)/g,function(t){return t.substring(1).toUpperCase()});r.style[g]=a,i._.dirty=1,r.setAttribute(e,a)}}var x=i,y=t;if("text"==x.type&&(y[L]("text")||y[L]("font")||y[L]("font-size")||y[L]("x")||y[L]("y"))){var m=x.attrs,v=x.node,b=v.firstChild?z(S._g.doc.defaultView.getComputedStyle(v.firstChild,I).getPropertyValue("font-size"),10):10;if(y[L]("text")){for(m.text=y.text;v.firstChild;)v.removeChild(v.firstChild);for(var _,w=M(y.text).split("\\n"),k=[],C=0,B=w.length;C<B;C++)_=q("tspan"),C&&q(_,{dy:b*D,x:m.x}),_.appendChild(S._g.doc.createTextNode(w[C])),v.appendChild(_),k[C]=_}else for(k=v.getElementsByTagName("tspan"),C=0,B=k.length;C<B;C++)C?q(k[C],{dy:b*D,x:m.x}):q(k[0],{dy:0});q(v,{x:m.x,y:m.y}),x._.dirty=1,y=x._getBBox(),(x=m.y-(y.y+y.height/2))&&S.is(x,"finite")&&q(k[0],{dy:x})}r.style.visibility=s}function o(t,e){(this[0]=this.node=t).raphael=!0,this.id=S._oid++,t.raphaelid=this.id,this.matrix=S.matrix(),this.realPath=null,this.paper=e,this.attrs=this.attrs||{},this._={transform:[],sx:1,sy:1,deg:0,dx:0,dy:0,dirty:1},e.bottom||(e.bottom=this),this.prev=e.top,e.top&&(e.top.next=this),(e.top=this).next=null}var t,L="hasOwnProperty",M=String,g=parseFloat,z=parseInt,x=Math,F=x.max,R=x.abs,y=x.pow,P=/[, ]+/,p=S.eve,I="",j="http://www.w3.org/1999/xlink",k={block:"M5,0 0,2.5 5,5z",classic:"M5,0 0,2.5 5,5 3.5,3 3.5,2z",diamond:"M2.5,0 5,2.5 2.5,5 0,2.5z",open:"M6,1 1,3.5 6,6",oval:"M2.5,0A2.5,2.5,0,0,1,2.5,5 2.5,2.5,0,0,1,2.5,0z"},C={},q=(S.toString=function(){return"Your browser supports SVG.\\nYou are running RaphaÃ«l "+this.version},function(t,e){if(e)for(var r in"string"==typeof t&&(t=q(t)),e)e[L](r)&&("xlink:"==r.substring(0,6)?t.setAttributeNS(j,r.substring(6),M(e[r])):t.setAttribute(r,M(e[r])));else(t=S._g.doc.createElementNS("http://www.w3.org/2000/svg",t)).style&&(t.style.webkitTapHighlightColor="rgba(0,0,0,0)");return t}),l={"":[0],none:[0],"-":[3,1],".":[1,1],"-.":[3,1,1,1],"-..":[3,1,1,1,1,1],". ":[1,3],"- ":[4,3],"--":[8,3],"- .":[4,3,1,3],"--.":[8,3,1,3],"--..":[8,3,1,3,1,3]},D=1.2,e=S.el,r=((o.prototype=e).constructor=o,S._engine.path=function(t,e){var r=q("path"),r=(e.canvas&&e.canvas.appendChild(r),new o(r,e));return r.type="path",f(r,{fill:"none",stroke:"#000",path:t}),r},e.rotate=function(t,e,r){return this.removed||((t=M(t).split(P)).length-1&&(e=g(t[1]),r=g(t[2])),t=g(t[0]),null!=(e=null==r?r:e)&&null!=r||(e=(i=this.getBBox(1)).x+i.width/2,r=i.y+i.height/2),this.transform(this._.transform.concat([["r",t,e,r]]))),this;var i},e.scale=function(t,e,r,i){return this.removed||((t=M(t).split(P)).length-1&&(e=g(t[1]),r=g(t[2]),i=g(t[3])),t=g(t[0]),null==e&&(e=t),null!=(r=null==i?i:r)&&null!=i||(n=this.getBBox(1)),r=null==r?n.x+n.width/2:r,i=null==i?n.y+n.height/2:i,this.transform(this._.transform.concat([["s",t,e,r,i]]))),this;var n},e.translate=function(t,e){return this.removed||((t=M(t).split(P)).length-1&&(e=g(t[1])),t=g(t[0])||0,this.transform(this._.transform.concat([["t",t,e=+e||0]]))),this},e.transform=function(t){var e=this._;return null==t?e.transform:(S._extractTransform(this,t),this.clip&&q(this.clip,{transform:this.matrix.invert()}),this.pattern&&T(this),this.node&&q(this.node,{transform:this.matrix}),1==e.sx&&1==e.sy||(t=this.attrs[L]("stroke-width")?this.attrs["stroke-width"]:1,this.attr({"stroke-width":t})),this)},e.hide=function(){return this.removed||this.paper.safari(this.node.style.display="none"),this},e.show=function(){return this.removed||this.paper.safari(this.node.style.display=""),this},e.remove=function(){if(!this.removed&&this.node.parentNode){var t,e=this.paper;for(t in e.__set__&&e.__set__.exclude(this),p.unbind("raphael.*.*."+this.id),this.gradient&&e.defs.removeChild(this.gradient),S._tear(this,e),"a"==this.node.parentNode.tagName.toLowerCase()?this.node.parentNode.parentNode.removeChild(this.node.parentNode):this.node.parentNode.removeChild(this.node),this)this[t]="function"==typeof this[t]?S._removedFactory(t):null;this.removed=!0}},e._getBBox=function(){"none"==this.node.style.display&&(this.show(),t=!0);var t,e={};try{e=this.node.getBBox()}catch(t){}finally{e=e||{}}return t&&this.hide(),e},e.attr=function(t,e){if(this.removed)return this;if(null==t){var r,i={};for(r in this.attrs)this.attrs[L](r)&&(i[r]=this.attrs[r]);return i.gradient&&"none"==i.fill&&(i.fill=i.gradient)&&delete i.gradient,i.transform=this._.transform,i}if(null==e&&S.is(t,"string")){if("fill"==t&&"none"==this.attrs.fill&&this.attrs.gradient)return this.attrs.gradient;if("transform"==t)return this._.transform;for(var n=t.split(P),s={},a=0,o=n.length;a<o;a++)s[t=n[a]]=t in this.attrs?this.attrs[t]:S.is(this.paper.customAttributes[t],"function")?this.paper.customAttributes[t].def:S._availableAttrs[t];return o-1?s:s[n[0]]}if(null==e&&S.is(t,"array")){for(s={},a=0,o=t.length;a<o;a++)s[t[a]]=this.attr(t[a]);return s}var l,h;for(h in null!=e?(l={})[t]=e:null!=t&&S.is(t,"object")&&(l=t),l)p("raphael.attr."+h+"."+this.id,this,l[h]);for(h in this.paper.customAttributes)if(this.paper.customAttributes[L](h)&&l[L](h)&&S.is(this.paper.customAttributes[h],"function")){var u,c=this.paper.customAttributes[h].apply(this,[].concat(l[h]));for(u in this.attrs[h]=l[h],c)c[L](u)&&(l[u]=c[u])}return f(this,l),this},e.toFront=function(){if(this.removed)return this;"a"==this.node.parentNode.tagName.toLowerCase()?this.node.parentNode.parentNode.appendChild(this.node.parentNode):this.node.parentNode.appendChild(this.node);var t=this.paper;return t.top!=this&&S._tofront(this,t),this},e.toBack=function(){if(this.removed)return this;var t=this.node.parentNode;return"a"==t.tagName.toLowerCase()?t.parentNode.insertBefore(this.node.parentNode,this.node.parentNode.parentNode.firstChild):t.firstChild!=this.node&&t.insertBefore(this.node,this.node.parentNode.firstChild),S._toback(this,this.paper),this.paper,this},e.insertAfter=function(t){if(this.removed)return this;var e=t.node||t[t.length-1].node;return e.nextSibling?e.parentNode.insertBefore(this.node,e.nextSibling):e.parentNode.appendChild(this.node),S._insertafter(this,t,this.paper),this},e.insertBefore=function(t){if(this.removed)return this;var e=t.node||t[0].node;return e.parentNode.insertBefore(this.node,e),S._insertbefore(this,t,this.paper),this},e.blur=function(t){var e,r,i=this;0!=+t?(e=q("filter"),r=q("feGaussianBlur"),i.attrs.blur=t,e.id=S.createUUID(),q(r,{stdDeviation:+t||1.5}),e.appendChild(r),i.paper.defs.appendChild(e),i._blur=e,q(i.node,{filter:"url(#"+e.id+")"})):(i._blur&&(i._blur.parentNode.removeChild(i._blur),delete i._blur,delete i.attrs.blur),i.node.removeAttribute("filter"))},S._engine.circle=function(t,e,r,i){var n=q("circle"),t=(t.canvas&&t.canvas.appendChild(n),new o(n,t));return t.attrs={cx:e,cy:r,r:i,fill:"none",stroke:"#000"},t.type="circle",q(n,t.attrs),t},S._engine.rect=function(t,e,r,i,n,s){var a=q("rect"),t=(t.canvas&&t.canvas.appendChild(a),new o(a,t));return t.attrs={x:e,y:r,width:i,height:n,r:s||0,rx:s||0,ry:s||0,fill:"none",stroke:"#000"},t.type="rect",q(a,t.attrs),t},S._engine.ellipse=function(t,e,r,i,n){var s=q("ellipse"),t=(t.canvas&&t.canvas.appendChild(s),new o(s,t));return t.attrs={cx:e,cy:r,rx:i,ry:n,fill:"none",stroke:"#000"},t.type="ellipse",q(s,t.attrs),t},S._engine.image=function(t,e,r,i,n,s){var a=q("image"),a=(q(a,{x:r,y:i,width:n,height:s,preserveAspectRatio:"none"}),a.setAttributeNS(j,"href",e),t.canvas&&t.canvas.appendChild(a),new o(a,t));return a.attrs={x:r,y:i,width:n,height:s,src:e},a.type="image",a},S._engine.text=function(t,e,r,i){var n=q("text"),n=(t.canvas&&t.canvas.appendChild(n),new o(n,t));return n.attrs={x:e,y:r,"text-anchor":"middle",text:i,font:S._availableAttrs.font,stroke:"none",fill:"#000"},n.type="text",f(n,n.attrs),n},S._engine.setSize=function(t,e){return this.width=t||this.width,this.height=e||this.height,this.canvas.setAttribute("width",this.width),this.canvas.setAttribute("height",this.height),this._viewBox&&this.setViewBox.apply(this,this._viewBox),this},S._engine.create=function(){var t=S._getContainer.apply(0,arguments),e=t&&t.container,r=t.x,i=t.y,n=t.width,t=t.height;if(!e)throw Error("SVG container not found.");var s,a=q("svg"),o="overflow:hidden;",r=r||0,i=i||0;return q(a,{height:t=t||342,version:1.1,width:n=n||512,xmlns:"http://www.w3.org/2000/svg"}),1==e?(a.style.cssText=o+"position:absolute;left:"+r+"px;top:"+i+"px",S._g.doc.body.appendChild(a),s=1):(a.style.cssText=o+"position:relative",e.firstChild?e.insertBefore(a,e.firstChild):e.appendChild(a)),(e=new S._Paper).width=n,e.height=t,e.canvas=a,e.clear(),e._left=e._top=0,s&&(e.renderfix=function(){}),e.renderfix(),e},S._engine.setViewBox=function(t,e,r,i,n){p("raphael.setViewBox",this,this._viewBox,[t,e,r,i,n]);var s,a=F(r/this.width,i/this.height),o=this.top,l=n?"meet":"xMinYMin",h=null==t?(this._vbSize&&(a=1),delete this._vbSize,"0 0 "+this.width+" "+this.height):(this._vbSize=a,t+" "+e+" "+r+" "+i);for(q(this.canvas,{viewBox:h,preserveAspectRatio:l});a&&o;)s="stroke-width"in o.attrs?o.attrs["stroke-width"]:1,o.attr({"stroke-width":s}),o._.dirty=1,o._.dirtyT=1,o=o.prev;return this._viewBox=[t,e,r,i,!!n],this},S.prototype.renderfix=function(){var e=this.canvas,t=e.style;try{r=e.getScreenCTM()||e.createSVGMatrix()}catch(t){r=e.createSVGMatrix()}var e=-r.e%1,r=-r.f%1;(e||r)&&(e&&(this._left=(this._left+e)%1,t.left=this._left+"px"),r&&(this._top=(this._top+r)%1,t.top=this._top+"px"))},S.prototype.clear=function(){S.eve("raphael.clear",this);for(var t=this.canvas;t.firstChild;)t.removeChild(t.firstChild);this.bottom=this.top=null,(this.desc=q("desc")).appendChild(S._g.doc.createTextNode("Created with RaphaÃ«l "+S.version)),t.appendChild(this.desc),t.appendChild(this.defs=q("defs"))},S.prototype.remove=function(){for(var t in p("raphael.remove",this),this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this)this[t]="function"==typeof this[t]?S._removedFactory(t):null},S.st);for(t in e)e[L](t)&&!r[L](t)&&(r[t]=function(r){return function(){var e=arguments;return this.forEach(function(t){t[r].apply(t,e)})}}(t))}(window.Raphael),window.Raphael&&window.Raphael.vml&&function(g){function x(t,e,r){var i=g.matrix();return i.rotate(-t,.5,.5),{dx:i.x(e,r),dy:i.y(e,r)}}function y(t,e,r,i,n,s){var a,o=t._,l=t.matrix,h=o.fillpos,u=(t=t.node).style,c=1,f="",p=R/e,d=R/r;u.visibility="hidden",e&&r&&(t.coordsize=A(p)+E+A(d),u.rotation=s*(e*r<0?-1:1),s&&(i=(a=x(s,i,n)).dx,n=a.dy),e<0&&(f+="x"),r<0&&(f+=" y")&&(c=-1),u.flip=f,t.coordorigin=i*-p+E+n*-d,(h||o.fillsize)&&(f=(f=t.getElementsByTagName(T))&&f[0],t.removeChild(f),h&&(a=x(s,l.x(h[0],h[1]),l.y(h[0],h[1])),f.position=a.dx*c+E+a.dy*c),o.fillsize&&(f.size=o.fillsize[0]*A(e)+E+o.fillsize[1]*A(r)),t.appendChild(f)),u.visibility="visible")}function m(t,e,r){for(var i=_(e).toLowerCase().split("-"),e=r?"end":"start",n=i.length,s="classic",a="medium",o="medium";n--;)switch(i[n]){case"block":case"classic":case"oval":case"diamond":case"open":case"none":s=i[n];break;case"wide":case"narrow":o=i[n];break;case"long":case"short":a=i[n]}(r=t.node.getElementsByTagName("stroke")[0])[e+"arrow"]=s,r[e+"arrowlength"]=a,r[e+"arrowwidth"]=o}function f(t,e){t.attrs=t.attrs||{};var r,i=t.node,n=t.attrs,s=i.style,a=P[t.type]&&(e.x!=n.x||e.y!=n.y||e.width!=n.width||e.height!=n.height||e.cx!=n.cx||e.cy!=n.cy||e.rx!=n.rx||e.ry!=n.ry||e.r!=n.r),o=I[t.type]&&(n.cx!=e.cx||n.cy!=e.cy||n.r!=e.r||n.rx!=e.rx||n.ry!=e.ry),l=t;for(r in e)e[b](r)&&(n[r]=e[r]);if(a&&(n.path=g._getPath[t.type](t),t._.dirty=1),e.href&&(i.href=e.href),e.title&&(i.title=e.title),e.target&&(i.target=e.target),e.cursor&&(s.cursor=e.cursor),"blur"in e&&t.blur(e.blur),(e.path&&"path"==t.type||a)&&(i.path=function(t){var e=/[ahqstv]/gi,r=g._pathToAbsolute;if(_(t).match(e)&&(r=g._path2curve),e=/[clmz]/g,r==g._pathToAbsolute&&!_(t).match(e))return a=_(t).replace(z,function(t,e,r){var i=[],n="m"==e.toLowerCase(),s=M[e];return r.replace(F,function(t){n&&2==i.length&&(s+=i+M["m"==e?"l":"L"],i=[]),i.push(C(t*R))}),s+i});for(var i,n,s=r(t),a=[],o=0,l=s.length;o<l;o++){i=s[o],"z"==(n=s[o][0].toLowerCase())&&(n="x");for(var h=1,u=i.length;h<u;h++)n+=C(i[h]*R)+(h!=u-1?",":L);a.push(n)}return a.join(E)}(~_(n.path).toLowerCase().indexOf("r")?g._pathToAbsolute(n.path):n.path),"image"==t.type&&(t._.fillpos=[n.x,n.y],t._.fillsize=[n.width,n.height],y(t,1,1,0,0,0))),"transform"in e&&t.transform(e.transform),o&&(a=+n.cx,o=+n.cy,h=+n.rx||+n.r||0,c=+n.ry||+n.r||0,i.path=g.format("ar{0},{1},{2},{3},{4},{1},{4},{1}x",C((a-h)*R),C((o-c)*R),C((a+h)*R),C((o+c)*R),C(a*R))),"clip-rect"in e&&(4==(h=_(e["clip-rect"]).split(N)).length&&(h[2]=+h[2]+ +h[0],h[3]=+h[3]+ +h[1],(c=(o=i.clipRect||g._g.doc.createElement("div")).style).clip=g.format("rect({1}px {2}px {3}px {0}px)",h),i.clipRect||(c.position="absolute",c.top=0,c.left=0,c.width=t.paper.width+"px",c.height=t.paper.height+"px",i.parentNode.insertBefore(o,i),o.appendChild(i),i.clipRect=o)),e["clip-rect"]||i.clipRect&&(i.clipRect.style.clip="auto")),t.textpath&&(a=t.textpath.style,e.font&&(a.font=e.font),e["font-family"]&&(a.fontFamily=\'"\'+e["font-family"].split(",")[0].replace(/^[\'"]+|[\'"]+$/g,L)+\'"\'),e["font-size"]&&(a.fontSize=e["font-size"]),e["font-weight"]&&(a.fontWeight=e["font-weight"]),e["font-style"]&&(a.fontStyle=e["font-style"])),"arrow-start"in e&&m(l,e["arrow-start"]),"arrow-end"in e&&m(l,e["arrow-end"],1),null==e.opacity&&null==e["stroke-width"]&&null==e.fill&&null==e.src&&null==e.stroke&&null==e["stroke-width"]&&null==e["stroke-opacity"]&&null==e["fill-opacity"]&&null==e["stroke-dasharray"]&&null==e["stroke-miterlimit"]&&null==e["stroke-linejoin"]&&null==e["stroke-linecap"]||((h=(h=i.getElementsByTagName(T))&&h[0])||(h=v(T)),"image"==t.type&&e.src&&(h.src=e.src),e.fill&&(h.on=!0),null!=h.on&&"none"!=e.fill&&null!==e.fill||(h.on=!1),h.on&&e.fill&&((c=_(e.fill).match(g._ISURL))?(h.parentNode==i&&i.removeChild(h),h.rotate=!0,h.src=c[1],h.type="tile",o=t.getBBox(1),h.position=o.x+E+o.y,t._.fillpos=[o.x,o.y],g._preload(c[1],function(){t._.fillsize=[this.offsetWidth,this.offsetHeight]})):(h.color=g.getRGB(e.fill).hex,h.src=L,h.type="solid",g.getRGB(e.fill).error&&(l.type in{circle:1,ellipse:1}||"r"!=_(e.fill).charAt())&&function(t,e,r){t.attrs=t.attrs||{};var i=(t.attrs,Math.pow),n="linear",s=".5 .5";if(t.attrs.gradient=e,e=(e=_(e).replace(g._radial_gradient,function(t,e,r){return n="radial",e&&r&&(e=w(e),r=w(r),i(e-.5,2)+i(r-.5,2)>.25&&(r=k.sqrt(.25-i(e-.5,2))*(2*(r>.5)-1)+.5),s=e+E+r),L})).split(/\\s*\\-\\s*/),"linear"==n){var a=e.shift();if(a=-w(a),isNaN(a))return null}var o=g._parseDots(e);if(!o)return null;if(t=t.shape||t.node,o.length){t.removeChild(r),r.on=!0,r.method="none",r.color=o[0].color,r.color2=o[o.length-1].color;for(var l=[],h=0,u=o.length;u>h;h++)o[h].offset&&l.push(o[h].offset+E+o[h].color);r.colors=l.length?l.join():"0% "+r.color,"radial"==n?(r.type="gradientTitle",r.focus="100%",r.focussize="0 0",r.focusposition=s,r.angle=0):(r.type="gradient",r.angle=(270-a)%360),t.appendChild(r)}return 1}(l,e.fill,h)&&(n.fill="none",n.gradient=e.fill,h.rotate=!1))),("fill-opacity"in e||"opacity"in e)&&(u=((+n["fill-opacity"]+1||2)-1)*((+n.opacity+1||2)-1)*((+g.getRGB(e.fill).o+1||2)-1),u=S(B(u,0),1),h.opacity=u,h.src&&(h.color="none")),i.appendChild(h),a=!1,(o=i.getElementsByTagName("stroke")&&i.getElementsByTagName("stroke")[0])||(a=o=v("stroke")),(e.stroke&&"none"!=e.stroke||e["stroke-width"]||null!=e["stroke-opacity"]||e["stroke-dasharray"]||e["stroke-miterlimit"]||e["stroke-linejoin"]||e["stroke-linecap"])&&(o.on=!0),"none"!=e.stroke&&null!==e.stroke&&null!=o.on&&0!=e.stroke&&0!=e["stroke-width"]||(o.on=!1),c=g.getRGB(e.stroke),o.on&&e.stroke&&(o.color=c.hex),u=((+n["stroke-opacity"]+1||2)-1)*((+n.opacity+1||2)-1)*((+c.o+1||2)-1),h=.75*(w(e["stroke-width"])||1),u=S(B(u,0),1),null==e["stroke-width"]&&(h=n["stroke-width"]),e["stroke-width"]&&(o.weight=h),h&&h<1&&(u*=h)&&(o.weight=1),o.opacity=u,e["stroke-linejoin"]&&(o.joinstyle=e["stroke-linejoin"]||"miter"),o.miterlimit=e["stroke-miterlimit"]||8,e["stroke-linecap"]&&(o.endcap="butt"==e["stroke-linecap"]?"flat":"square"==e["stroke-linecap"]?"square":"round"),e["stroke-dasharray"]&&(o.dashstyle=(c={"-":"shortdash",".":"shortdot","-.":"shortdashdot","-..":"shortdashdotdot",". ":"dot","- ":"dash","--":"longdash","- .":"dashdot","--.":"longdashdot","--..":"longdashdotdot"})[b](e["stroke-dasharray"])?c[e["stroke-dasharray"]]:L),a&&i.appendChild(o)),"text"==l.type){l.paper.canvas.style.display=L;var h=l.paper.span,u=n.font&&n.font.match(/\\d+(?:\\.\\d*)?(?=px)/),s=h.style,c=(n.font&&(s.font=n.font),n["font-family"]&&(s.fontFamily=n["font-family"]),n["font-weight"]&&(s.fontWeight=n["font-weight"]),n["font-style"]&&(s.fontStyle=n["font-style"]),u=w(n["font-size"]||u&&u[0])||10,s.fontSize=100*u+"px",l.textpath.string&&(h.innerHTML=_(l.textpath.string).replace(/</g,"&#60;").replace(/&/g,"&#38;").replace(/\\n/g,"<br>")),h.getBoundingClientRect());l.W=n.w=(c.right-c.left)/100,l.H=n.h=(c.bottom-c.top)/100,l.X=n.x,l.Y=n.y+l.H/2,("x"in e||"y"in e)&&(l.path.v=g.format("m{0},{1}l{2},{1}",C(n.x*R),C(n.y*R),C(n.x*R)+1));for(var f=["x","y","text","font","font-family","font-weight","font-style","font-size"],p=0,d=f.length;p<d;p++)if(f[p]in e){l._.dirty=1;break}switch(n["text-anchor"]){case"start":l.textpath.style["v-text-align"]="left",l.bbx=l.W/2;break;case"end":l.textpath.style["v-text-align"]="right",l.bbx=-l.W/2;break;default:l.textpath.style["v-text-align"]="center",l.bbx=0}l.textpath.style["v-text-kern"]=!0}}function h(t,e){(this[0]=this.node=t).raphael=!0,this.id=g._oid++,t.raphaelid=this.id,this.X=0,this.Y=0,this.attrs={},this.paper=e,this.matrix=g.matrix(),this._={transform:[],sx:1,sy:1,dx:0,dy:0,deg:0,dirty:1,dirtyT:1},e.bottom||(e.bottom=this),this.prev=e.top,e.top&&(e.top.next=this),(e.top=this).next=null}var v,t,b="hasOwnProperty",_=String,w=parseFloat,k=Math,C=k.round,B=k.max,S=k.min,A=k.abs,T="fill",N=/[, ]+/,p=g.eve,E=" ",L="",M={M:"m",L:"l",C:"c",Z:"x",m:"t",l:"r",c:"v",z:"x"},z=/([clmz]),?([^clmz]*)/gi,i=/ progid:\\S+Blur\\([^\\)]+\\)/g,F=/-?[^,\\s-]+/g,u="position:absolute;left:0;top:0;width:1px;height:1px",R=21600,P={path:1,rect:1,image:1},I={circle:1,ellipse:1},e=(g.toString=function(){return"Your browser doesnâ€™t support SVG. Falling down to VML.\\nYou are running RaphaÃ«l "+this.version},g.el),r=((h.prototype=e).constructor=h,e.transform=function(t){if(null==t)return this._.transform;var e,r=this.paper._viewBoxShift,i=r?"s"+[r.scale,r.scale]+"-1-1t"+[r.dx,r.dy]:L;r&&(e=t=_(t).replace(/\\.{3}|\\u2026/g,this._.transform||L)),g._extractTransform(this,i+t);var n,s,r=this.matrix.clone(),i=this.skew,t=this.node,a=~_(this.attrs.fill).indexOf("-"),o=!_(this.attrs.fill).indexOf("url(");return r.translate(-.5,-.5),o||a||"image"==this.type?(i.matrix="1 0 0 1",i.offset="0 0",o=r.split(),a&&o.noRotation||!o.isSimple?(t.style.filter=r.toFilter(),a=this.getBBox(),n=this.getBBox(1),s=a.x-n.x,a=a.y-n.y,t.coordorigin=s*-R+E+a*-R,y(this,1,1,s,a,0)):(t.style.filter=L,y(this,o.scalex,o.scaley,o.dx,o.dy,o.rotate))):(t.style.filter=L,i.matrix=_(r),i.offset=r.offset()),e&&(this._.transform=e),this},e.rotate=function(t,e,r){return this.removed?this:null!=t?((t=_(t).split(N)).length-1&&(e=w(t[1]),r=w(t[2])),t=w(t[0]),null!=(e=null==r?r:e)&&null!=r||(e=(i=this.getBBox(1)).x+i.width/2,r=i.y+i.height/2),this._.dirtyT=1,this.transform(this._.transform.concat([["r",t,e,r]])),this):void 0;var i},e.translate=function(t,e){return this.removed||((t=_(t).split(N)).length-1&&(e=w(t[1])),t=w(t[0])||0,e=+e||0,this._.bbox&&(this._.bbox.x+=t,this._.bbox.y+=e),this.transform(this._.transform.concat([["t",t,e]]))),this},e.scale=function(t,e,r,i){return this.removed||((t=_(t).split(N)).length-1&&(e=w(t[1]),r=w(t[2]),i=w(t[3]),isNaN(r)&&(r=null),isNaN(i)&&(i=null)),t=w(t[0]),null==e&&(e=t),null!=(r=null==i?i:r)&&null!=i||(n=this.getBBox(1)),r=null==r?n.x+n.width/2:r,i=null==i?n.y+n.height/2:i,this.transform(this._.transform.concat([["s",t,e,r,i]])),this._.dirtyT=1),this;var n},e.hide=function(){return this.removed||(this.node.style.display="none"),this},e.show=function(){return this.removed||(this.node.style.display=L),this},e._getBBox=function(){return this.removed?{}:{x:this.X+(this.bbx||0)-this.W/2,y:this.Y-this.H,width:this.W,height:this.H}},e.remove=function(){if(!this.removed&&this.node.parentNode){for(var t in this.paper.__set__&&this.paper.__set__.exclude(this),g.eve.unbind("raphael.*.*."+this.id),g._tear(this,this.paper),this.node.parentNode.removeChild(this.node),this.shape&&this.shape.parentNode.removeChild(this.shape),this)this[t]="function"==typeof this[t]?g._removedFactory(t):null;this.removed=!0}},e.attr=function(t,e){if(this.removed)return this;if(null==t){var r,i={};for(r in this.attrs)this.attrs[b](r)&&(i[r]=this.attrs[r]);return i.gradient&&"none"==i.fill&&(i.fill=i.gradient)&&delete i.gradient,i.transform=this._.transform,i}if(null==e&&g.is(t,"string")){if(t==T&&"none"==this.attrs.fill&&this.attrs.gradient)return this.attrs.gradient;for(var n=t.split(N),s={},a=0,o=n.length;a<o;a++)s[t=n[a]]=t in this.attrs?this.attrs[t]:g.is(this.paper.customAttributes[t],"function")?this.paper.customAttributes[t].def:g._availableAttrs[t];return o-1?s:s[n[0]]}if(this.attrs&&null==e&&g.is(t,"array")){for(s={},a=0,o=t.length;a<o;a++)s[t[a]]=this.attr(t[a]);return s}var l,h;for(h in null!=e&&((l={})[t]=e),l=null==e&&g.is(t,"object")?t:l)p("raphael.attr."+h+"."+this.id,this,l[h]);if(l){for(h in this.paper.customAttributes)if(this.paper.customAttributes[b](h)&&l[b](h)&&g.is(this.paper.customAttributes[h],"function")){var u,c=this.paper.customAttributes[h].apply(this,[].concat(l[h]));for(u in this.attrs[h]=l[h],c)c[b](u)&&(l[u]=c[u])}l.text&&"text"==this.type&&(this.textpath.string=l.text),f(this,l)}return this},e.toFront=function(){return this.removed||this.node.parentNode.appendChild(this.node),this.paper&&this.paper.top!=this&&g._tofront(this,this.paper),this},e.toBack=function(){return this.removed||this.node.parentNode.firstChild!=this.node&&(this.node.parentNode.insertBefore(this.node,this.node.parentNode.firstChild),g._toback(this,this.paper)),this},e.insertAfter=function(t){return this.removed||((t=t.constructor==g.st.constructor?t[t.length-1]:t).node.nextSibling?t.node.parentNode.insertBefore(this.node,t.node.nextSibling):t.node.parentNode.appendChild(this.node),g._insertafter(this,t,this.paper)),this},e.insertBefore=function(t){return this.removed||((t=t.constructor==g.st.constructor?t[0]:t).node.parentNode.insertBefore(this.node,t.node),g._insertbefore(this,t,this.paper)),this},e.blur=function(t){var e=this.node.runtimeStyle,r=(r=e.filter).replace(i,L);0!=+t?(this.attrs.blur=t,e.filter=r+E+" progid:DXImageTransform.Microsoft.Blur(pixelradius="+(+t||1.5)+")",e.margin=g.format("-{0}px 0 0 -{0}px",C(+t||1.5))):(e.filter=r,e.margin=0,delete this.attrs.blur)},g._engine.path=function(t,e){var r=v("shape"),i=(r.style.cssText=u,r.coordsize=R+E+R,r.coordorigin=e.coordorigin,new h(r,e)),n={fill:"none",stroke:"#000"},t=(t&&(n.path=t),i.type="path",i.path=[],i.Path=L,f(i,n),e.canvas.appendChild(r),v("skew"));return t.on=!0,r.appendChild(t),i.skew=t,i.transform(L),i},g._engine.rect=function(t,e,r,i,n,s){var a=g._rectPath(e,r,i,n,s),t=t.path(a),o=t.attrs;return t.X=o.x=e,t.Y=o.y=r,t.W=o.width=i,t.H=o.height=n,o.r=s,o.path=a,t.type="rect",t},g._engine.ellipse=function(t,e,r,i,n){t=t.path();return t.attrs,t.X=e-i,t.Y=r-n,t.W=2*i,t.H=2*n,t.type="ellipse",f(t,{cx:e,cy:r,rx:i,ry:n}),t},g._engine.circle=function(t,e,r,i){t=t.path();return t.attrs,t.X=e-i,t.Y=r-i,t.W=t.H=2*i,t.type="circle",f(t,{cx:e,cy:r,r:i}),t},g._engine.image=function(t,e,r,i,n,s){var a=g._rectPath(r,i,n,s),t=t.path(a).attr({stroke:"none"}),o=t.attrs,l=t.node,h=l.getElementsByTagName(T)[0];return o.src=e,t.X=o.x=r,t.Y=o.y=i,t.W=o.width=n,t.H=o.height=s,o.path=a,t.type="image",h.parentNode==l&&l.removeChild(h),h.rotate=!0,h.src=e,h.type="tile",t._.fillpos=[r,i],t._.fillsize=[n,s],l.appendChild(h),y(t,1,1,0,0,0),t},g._engine.text=function(t,e,r,i){var n=v("shape"),s=v("path"),a=v("textpath"),o=(r=r||0,i=i||"",s.v=g.format("m{0},{1}l{2},{1}",C((e=e||0)*R),C(r*R),C(e*R)+1),s.textpathok=!0,a.string=_(i),a.on=!0,n.style.cssText=u,n.coordsize=R+E+R,n.coordorigin="0 0",new h(n,t)),l={fill:"#000",stroke:"none",font:g._availableAttrs.font,text:i},i=(o.shape=n,o.path=s,o.textpath=a,o.type="text",o.attrs.text=_(i),o.attrs.x=e,o.attrs.y=r,o.attrs.w=1,o.attrs.h=1,f(o,l),n.appendChild(a),n.appendChild(s),t.canvas.appendChild(n),v("skew"));return i.on=!0,n.appendChild(i),o.skew=i,o.transform(L),o},g._engine.setSize=function(t,e){var r=this.canvas.style;return(this.width=t)==+t&&(t+="px"),(this.height=e)==+e&&(e+="px"),r.width=t,r.height=e,r.clip="rect(0 "+t+" "+e+" 0)",this._viewBox&&g._engine.setViewBox.apply(this,this._viewBox),this},g._engine.setViewBox=function(t,e,r,i,n){g.eve("raphael.setViewBox",this,this._viewBox,[t,e,r,i,n]);var s,a=this.width,o=this.height,l=1/B(r/a,i/o);return n&&(r*(s=o/i)<a&&(t-=(a-r*s)/2/s),i*(s=a/r)<o&&(e-=(o-i*s)/2/s)),this._viewBox=[t,e,r,i,!!n],this._viewBoxShift={dx:-t,dy:-e,scale:l},this.forEach(function(t){t.transform("...")}),this},g._engine.initWin=function(t){var e=t.document;e.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)");try{e.namespaces.rvml||e.namespaces.add("rvml","urn:schemas-microsoft-com:vml"),v=function(t){return e.createElement("<rvml:"+t+\' class="rvml">\')}}catch(t){v=function(t){return e.createElement("<"+t+\' xmlns="urn:schemas-microsoft.com:vml" class="rvml">\')}}},g._engine.initWin(g._g.win),g._engine.create=function(){var t=g._getContainer.apply(0,arguments),e=t.container,r=t.height,i=t.width,n=t.x,t=t.y;if(!e)throw Error("VML container not found.");var s=new g._Paper,a=s.canvas=g._g.doc.createElement("div"),o=a.style,n=n||0,t=t||0,i=i||512,r=r||342;return(s.width=i)==+i&&(i+="px"),(s.height=r)==+r&&(r+="px"),s.coordsize=1e3*R+E+1e3*R,s.coordorigin="0 0",s.span=g._g.doc.createElement("span"),s.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;",a.appendChild(s.span),o.cssText=g.format("top:0;left:0;width:{0};height:{1};display:inline-block;position:relative;clip:rect(0 {0} {1} 0);overflow:hidden",i,r),1==e?(g._g.doc.body.appendChild(a),o.left=n+"px",o.top=t+"px",o.position="absolute"):e.firstChild?e.insertBefore(a,e.firstChild):e.appendChild(a),s.renderfix=function(){},s},g.prototype.clear=function(){g.eve("raphael.clear",this),this.canvas.innerHTML=L,this.span=g._g.doc.createElement("span"),this.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;",this.canvas.appendChild(this.span),this.bottom=this.top=null},g.prototype.remove=function(){for(var t in g.eve("raphael.remove",this),this.canvas.parentNode.removeChild(this.canvas),this)this[t]="function"==typeof this[t]?g._removedFactory(t):null;return!0},g.st);for(t in e)e[b](t)&&!r[b](t)&&(r[t]=function(r){return function(){var e=arguments;return this.forEach(function(t){t[r].apply(t,e)})}}(t))}(window.Raphael);'},39007:t=>{t.exports='function Branch(e){var l=e;new Node(l),l.addChild=function(e,n){l.children.splice(n=void 0===n?0:n,0,e),l.updateChildrensParentIndex(),e.parent=l,null!=e.element&&l.renderChildren()},l.changeBranch=function(e,n){e.parent.children.splice(e.parentIndex,1),e.parent.updateChildrensParentIndex(),l.addChild(e,n)},l.updateChildrensParentIndex=function(){for(var e=0;e<l.children.length;e++)null!=l.children[e]&&(l.children[e].parentIndex=e)},l.remove=function(){l.isDeleteable?(l.updateChildrensParentIndex(),l.preRemove(function(){l.parent.updateChildrensParentIndex(),l.parent.removeChild(l.parentIndex)})):console.log("Not allowed to delete "+l.id)},l.removeInklChildren=function(e){e=void 0===e||e;for(var n=l.children.length-1;0<n;n--)"function"==typeof l.children[n].removeInklChildren?l.children[n].removeInklChildren(!1):l.children[n]=null;e&&l.parent.removeChild(l.parentIndex,e),l.updateChildrensParentIndex()},l.removeChild=function(e,n){null!=l&&null!=l.children[e]&&(n=void 0===n||n,l.children[e]&&(n&&$(l.children[e].element).remove(),l.children.splice(e,1)),l.updateChildrensParentIndex())},l.removeChildren=function(){for(var e=0;e<l.children.length;e++)null!=l.children[e].element&&(l.children[e].preRemove(),$(l.children[e].element).remove()),l.children[e].remove();l.children=new Array},l.moveChildFirst=function(e){l.children.splice(e.parentIndex,1),l.children.splice(1,0,e),l.updateChildrensParentIndex(),l.renderChildren()},l.getChildAt=function(e){return l.children.length?e<0?l.children[0]:e>=l.children.length?l.children[l.children.length-1]:l.children[e]:null},l.isChildIndexInterchangeable=function(e){e=l.getChildAt(e);return!!e&&!e.isIndexLocked},l.moveChildToPos=function(e,n){for(var r=e.parentIndex>n?"up":"down",d=l.isChildIndexInterchangeable(n);!d&&0<=n&&n<=l.children.length;)"up"==r?n++:n--,d=l.isChildIndexInterchangeable(n);0<=n&&n<=l.children.length&&(l.children.splice(e.parentIndex,1),l.children.splice(n,0,e),l.updateChildrensParentIndex(),l.renderChildren())},l.moveChildUp=function(e){0<e.parentIndex&&(l.moveChildToPos(e,0),l.updateChildrensParentIndex(),l.renderChildren())},l.moveChildDown=function(e){e.parentIndex<l.children.length-1&&(null!=l.editor.svg.collage?l.moveChildToPos(e,l.children.length-1):l.moveChildToPos(e,l.children.length),l.updateChildrensParentIndex(),l.renderChildren())},e.isChildFirst=function(e,n){if(n=void 0===n?!0:n)return!(0<e.parentIndex);for(var r=0,d=l.isChildIndexInterchangeable(r);!d&&0<=r&&r<=l.children.length;)d=l.isChildIndexInterchangeable(++r);return e.parentIndex==r},e.isChildLast=function(e,n){if(null!=l.editor.svg.collage&&e.parentIndex==l.children.length-2)return!0;if(n=void 0===n?!0:n)return!(e.parentIndex<l.children.length-1);for(var r=l.children.length-1,d=l.isChildIndexInterchangeable(r);!d&&0<=r;)d=l.isChildIndexInterchangeable(--r);return e.parentIndex==r},l.calcDPI=function(){for(var e=0;e<l.children.length;e++)l.children[e].calcDPI()},l.preRemove=function(e){for(var n=0;n<l.children.length;n++)l.children[n].preRemove(),l.updateChildrensParentIndex();void 0!==e&&e()}}'},5810:t=>{t.exports='function Filters(t){var s=this,u=t,o=(s.dropShadow=null,s.fakeDropShadow=null,s.backgroundPattern=null,s.backSidePrintDealPattern=null,1),p=1,c=1;function b(){var t=u.svg.root.element.viewBox.baseVal.height,e=u.svg.root.element.viewBox.baseVal.width,r=$(u.container).height(),a=$(u.container).width(),r=(heightAspect=(r=r<1?1:r)/t,widthAspect=(a=a<1?1:a)/e,u.svg.sheet.getTransformationMatrix()),t=Math.sqrt(Math.pow(r.a,2)+Math.pow(r.b,2)),a=Math.sqrt(Math.pow(r.c,2)+Math.pow(r.d,2));o=1/Math.min(heightAspect*t,widthAspect*a)}s.CreateFilters=function(){u.svg.mode==SVG.MODE_SINGLE&&(s.dropShadow=s.CreateDropShadow()),u.svg.mode,SVG.MODE_SHEET},s.CreateFakeDropShadow=function(){var t=document.createElementNS(SVG.SVG_NAMESPACE,"linearGradient"),e=(t.setAttribute("id","gradient_1"),t.setAttribute("x1","0%"),t.setAttribute("y1","0%"),t.setAttribute("x2","100%"),t.setAttribute("y2","0%"),document.createElementNS(SVG.SVG_NAMESPACE,"stop")),r=(e.setAttribute("offset","0%"),e.setAttribute("style","stop-color:rgb(f,f,f);stop-opacity:0"),document.createElementNS(SVG.SVG_NAMESPACE,"stop")),a=(r.setAttribute("offset","4%"),r.setAttribute("style","stop-color:rgb(0,0,0);stop-opacity:1"),document.createElementNS(SVG.SVG_NAMESPACE,"stop")),i=(a.setAttribute("offset","96%"),a.setAttribute("style","stop-color:rgb(0,0,0);stop-opacity:1"),document.createElementNS(SVG.SVG_NAMESPACE,"stop")),e=(i.setAttribute("offset","100%"),i.setAttribute("style","stop-color:rgb(f,f,f);stop-opacity:0"),t.appendChild(e),t.appendChild(r),t.appendChild(a),t.appendChild(i),u.svg.defs.element.appendChild(t),document.createElementNS(SVG.SVG_NAMESPACE,"linearGradient")),r=(e.setAttribute("id","gradient_2"),e.setAttribute("x1","0%"),e.setAttribute("y1","0%"),e.setAttribute("x2","0%"),e.setAttribute("y2","100%"),document.createElementNS(SVG.SVG_NAMESPACE,"stop")),a=(r.setAttribute("offset","0%"),r.setAttribute("style","stop-color:rgb(f,f,f);stop-opacity:0"),document.createElementNS(SVG.SVG_NAMESPACE,"stop")),i=(a.setAttribute("offset","4%"),a.setAttribute("style","stop-color:rgb(0,0,0);stop-opacity:1"),document.createElementNS(SVG.SVG_NAMESPACE,"stop")),n=(i.setAttribute("offset","96%"),i.setAttribute("style","stop-color:rgb(0,0,0);stop-opacity:1"),document.createElementNS(SVG.SVG_NAMESPACE,"stop"));return n.setAttribute("offset","100%"),n.setAttribute("style","stop-color:rgb(f,f,f);stop-opacity:0"),e.appendChild(r),e.appendChild(a),e.appendChild(i),e.appendChild(n),u.svg.defs.element.appendChild(e),t},s.CreateDropShadow=function(){var t=document.createElementNS(SVG.SVG_NAMESPACE,"filter"),e=(t.setAttribute("id","drop_shadow"),t.setAttribute("x","-50%"),t.setAttribute("y","-50%"),t.setAttribute("width","200%"),t.setAttribute("height","200%"),t.setAttribute("filterRes",Math.max(window.innerWidth,window.innerHeight)),document.createElementNS(SVG.SVG_NAMESPACE,"feOffset")),r=(e.setAttribute("result","offOut"),e.setAttribute("in","SourceAlpha"),e.setAttribute("dx","2"),e.setAttribute("dy","2"),document.createElementNS(SVG.SVG_NAMESPACE,"feGaussianBlur")),a=(r.setAttribute("result","blurOut"),r.setAttribute("in","offOut"),r.setAttribute("stdDeviation","2"),document.createElementNS(SVG.SVG_NAMESPACE,"feColorMatrix")),i=(a.setAttribute("result","matrixOut"),a.setAttribute("in","blurOut"),a.setAttribute("type","matrix"),a.setAttribute("values","1 0 0 0 0.2, 0 1 0 0 0.2, 0 0 1 0 0.2, 0 0 0 0.5 0"),document.createElementNS(SVG.SVG_NAMESPACE,"feBlend"));return u.svg.mode==SVG.MODE_SINGLE?(i.setAttribute("in","SourceGraphic"),i.setAttribute("in2","matrixOut")):(i.setAttribute("in","SourceGraphic"),i.setAttribute("in2","blurOut")),i.setAttribute("mode","normal"),t.appendChild(e),t.feOffset=e,t.appendChild(r),t.feGaussianBlur=r,t.appendChild(a),t.feColorMatrix=a,t.appendChild(i),t.feBlend=i,u.svg.defs.element.appendChild(t),t},s.CreateBackgroundPattern=function(t,e,r){c=p=r,b();var r=2*p*u.svg.px2mm*o+"px",a=2*c*u.svg.px2mm*o+"px",i=p*u.svg.px2mm*o+"px",n=c*u.svg.px2mm*o+"px",d=(s.backgroundPattern=document.createElementNS(SVG.SVG_NAMESPACE,"pattern"),s.backgroundPattern.setAttribute("id",u.id+"-BackgroundPattern"),s.backgroundPattern.setAttribute("shape-rendering","crispEdges"),s.backgroundPattern.setAttribute("patternUnits","userSpaceOnUse"),s.backgroundPattern.setAttribute("x","0px"),s.backgroundPattern.setAttribute("y","0px"),s.backgroundPattern.setAttribute("width",r),s.backgroundPattern.setAttribute("height",a),document.createElementNS(SVG.SVG_NAMESPACE,"rect")),r=(d.setAttribute("id",u.id+"-BackgroundPatternRect1"),d.setAttribute("shape-rendering","crispEdges"),d.setAttribute("x","0px"),d.setAttribute("y","0px"),d.setAttribute("width",r),d.setAttribute("height",a),d.setAttribute("fill",t),s.backgroundPattern.appendChild(d),document.createElementNS(SVG.SVG_NAMESPACE,"rect")),a=(r.setAttribute("id",u.id+"-BackgroundPatternRect2"),r.setAttribute("shape-rendering","crispEdges"),r.setAttribute("x","0px"),r.setAttribute("y","0px"),r.setAttribute("width",i),r.setAttribute("height",n),r.setAttribute("fill",e),s.backgroundPattern.appendChild(r),document.createElementNS(SVG.SVG_NAMESPACE,"rect"));a.setAttribute("id",u.id+"-BackgroundPatternRect3"),a.setAttribute("shape-rendering","crispEdges"),a.setAttribute("x",i),a.setAttribute("y",n),a.setAttribute("width",i),a.setAttribute("height",n),a.setAttribute("fill",e),s.backgroundPattern.appendChild(a),u.svg.defs.element.appendChild(s.backgroundPattern)},s.CreateBackgroundImage=function(t,e,r){p=e,c=r,b();var e=2*p*u.svg.px2mm*o+"px",r=2*c*u.svg.px2mm*o+"px",a=(u.svg.px2mm,u.svg.px2mm,s.backgroundPattern=document.createElementNS(SVG.SVG_NAMESPACE,"pattern"),s.backgroundPattern.setAttribute("id",u.id+"-BackgroundPattern"),s.backgroundPattern.setAttribute("patternUnits","userSpaceOnUse"),s.backgroundPattern.setAttribute("x","0px"),s.backgroundPattern.setAttribute("y","0px"),s.backgroundPattern.setAttribute("width",e),s.backgroundPattern.setAttribute("height",r),document.createElementNS(SVG.SVG_NAMESPACE,"image"));a.setAttribute("id",u.id+"-BackgroundPatternImage"),a.setAttribute("x","0px"),a.setAttribute("y","0px"),a.setAttribute("width",e),a.setAttribute("height",r),a.setAttributeNS(SVG.SVG_XLINK,"href",t),s.backgroundPattern.appendChild(a),u.svg.defs.element.appendChild(s.backgroundPattern)},s.CreateBackgroundImageForBackprintDeal=function(t,e,r){var e=e+"px",r=r+"px",a=(s.backSidePrintDealPattern=document.createElementNS(SVG.SVG_NAMESPACE,"pattern"),s.backSidePrintDealPattern.setAttribute("id",u.id+"-BackPrintDealPattern"),s.backSidePrintDealPattern.setAttribute("patternUnits","userSpaceOnUse"),s.backSidePrintDealPattern.setAttribute("x","0px"),s.backSidePrintDealPattern.setAttribute("y","0px"),s.backSidePrintDealPattern.setAttribute("width",e),s.backSidePrintDealPattern.setAttribute("height",r),s.backSidePrintDealPattern.setAttribute("patternTransform","rotate(-10)"),document.createElementNS(SVG.SVG_NAMESPACE,"image"));a.setAttribute("id",u.id+"-BackPrintDealPattern"),a.setAttribute("x","0px"),a.setAttribute("y","0px"),a.setAttribute("width",e),a.setAttribute("height",r),a.setAttributeNS(SVG.SVG_XLINK,"href",t),s.backSidePrintDealPattern.appendChild(a),u.svg.defs.element.appendChild(s.backSidePrintDealPattern)},s.UpdatePattern=function(){b();var t=2*p*u.svg.px2mm*o+"px",e=2*c*u.svg.px2mm*o+"px",r=p*u.svg.px2mm*o+"px",a=c*u.svg.px2mm*o+"px";$("#"+u.id+"-BackgroundPattern").attr("width",t),$("#"+u.id+"-BackgroundPattern").attr("height",e),$("#"+u.id+"-BackgroundPatternRect1").attr("width",t),$("#"+u.id+"-BackgroundPatternRect1").attr("height",e),$("#"+u.id+"-BackgroundPatternRect2").attr("width",r),$("#"+u.id+"-BackgroundPatternRect2").attr("height",a),$("#"+u.id+"-BackgroundPatternRect3").attr("x",r),$("#"+u.id+"-BackgroundPatternRect3").attr("y",a),$("#"+u.id+"-BackgroundPatternRect3").attr("width",r),$("#"+u.id+"-BackgroundPatternRect3").attr("height",a),$("#"+u.id+"-BackgroundPatternImage").attr("width",t),$("#"+u.id+"-BackgroundPatternImage").attr("height",e)},u.registerCallback(u,"editorResize",function(){null!=s.dropShadow&&s.UpdateDropShadow(),null!=s.backgroundPattern&&s.UpdatePattern()}),s.UpdateDropShadow=function(){var t;null!=s.dropShadow&&(t=Math.max(u.svg.sheet.width,u.svg.sheet.height)*u.svg.px2mm/100,s.dropShadow.feOffset.setAttribute("dx",t),s.dropShadow.feOffset.setAttribute("dy",t),s.dropShadow.feGaussianBlur.setAttribute("stdDeviation",.5*t)),s.fakeDropShadow},s.DisableDropShadow=function(){null==s.dropShadow||u.svg.mode!=SVG.MODE_SHEET&&u.svg.mode!=SVG.MODE_SINGLE||s.dropShadow.setAttribute("style","display : none")},s.EnableDropShadow=function(){null==s.dropShadow||u.svg.mode!=SVG.MODE_SHEET&&u.svg.mode!=SVG.MODE_SINGLE||s.dropShadow.setAttribute("style","display : inline")}}'},77377:t=>{t.exports="function Layer(e){var n=e;new Branch(n),n.isClickThrough=!0,n.isSelectable=!1,n.isOverable=!1,n.isOverBBox=function(){return!0},n.createBBoxAndCenter=function(){},n.createElement=function(e){void 0!==e&&e(n)}}"},83293:t=>{t.exports='function Node(e){var E=e,M=(E.type=null,E.options=null,E.parent=null,E.parentIndex=null,E.part=null,E.element=null,E.id="",E.intId="",E.boundingBox=null,E.hoverElement=null,E.selectElement=null,E.selectToolElement1=null,E.selectToolElement2=null,E.children=new Array,E.overHandling=SVG.OVER_BBOX,E.isClickThrough=null,E.isSelectable=null,E.isOverable=null,E.isTransformable=!1,E.isResizeable=!1,E.isRotateable=!1,E.isSkewable=!1,E.isMoveable=!1,E.isDeleteable=!0,E.isAspectChangable=!1,E.isCopyable=!1,E.isUpDownable=!0,E.isEditable=!0,E.isLockedContent=!1,E.isIndexLocked=!1,E.ignore=!1,E.icon=!1,E.isStrangeCenter=!1,E.center=null,E.calcBBox=!0,E.lastTransformType=null,E.selectRedirect=null,E.collageObject=null,E.createElement=null,E.getElement=null,E.render=null,E.remove=null,E.select=null,E.transform=null,E.updateOptions=null,E.editor=null),I=null,C=null,w=null,L=null,t=null,o=null,i=null,r=null,k=null,_=null,N=null;E.intId="node"+Math.random().toString().replace(",","").replace(".",""),E.init=function(e,n,t,o){E.options=t,E.parent=e,E.editor=n,E.onInit(),E.create(o)},E.create=function(e){null!=E.svgTag&&(E.element=document.createElementNS(SVG.SVG_NAMESPACE,E.svgTag)),E.type==SVG.PART?E.editor.svg.root.addChild(E,E.editor.svg.sheet.parentIndex):E.parent.addChild(E),null!=E.svgTag&&E.createElement(e),E.updateNodeOptions()},E.getElement=function(){if(null!=E.element)return E.element;if(e.type!=SVG.LAYER_ROOT)return E.parent.getElement();throw"No elements above root"},E.renderChildren=function(){for(var e=E.getElement(),n=E.children.length-1;0<=n;n--)E.children[n].renderChildren(),null!=E.children[n].element&&$(e).append(E.children[n].element)},E.updateNodeOptions=function(){E.options.id&&(E.id=E.options.id),null!=E.updateOptions&&E.updateOptions()},E.isOverBBox=function(e){return null!=e&&null!=E.boundingBox&&(!(e.x<E.boundingBox.x)&&(!(e.x>E.boundingBox.x+E.boundingBox.width)&&(!(e.y<E.boundingBox.y)&&!(e.y>E.boundingBox.y+E.boundingBox.height))))},E.isOverBBoxInklChildren=function(e,n,t,o){o=void 0===o?0:o;var i=new Array;if(0<o){o++,console.log("debug:"+E.id+" "+E.type);for(var r=0;r<n.length;r++){var a="   ".repeat(r);console.log("* "+a+n[r].id+" "+n[r].type)}}if(E.editor.svg.zoom==SVG.ZOOM_PART&&E.type==SVG.PART&&E.id!=E.editor.svg.activePart.id)return!1;switch(E.overHandling){case SVG.OVER_ALWAYS:if(n.push(E),t)return!0;break;case SVG.OVER_LAYER:break;case SVG.OVER_BBOX:if(E.isOverBBox(e)&&(n.push(E),t))return!0;break;case SVG.OVER_NEVER:return!1;case SVG.OVER_IGNORE:break;case SVG.OVER_ZOOMED:E.isOverBBox(e)&&i.push(E)}if(E.overHandling==SVG.OVER_ALWAYS||E.overHandling==SVG.OVER_ZOOMED||E.overHandling==SVG.OVER_LAYER||E.isOverBBox(e))for(r=0;r<E.children.length;r++)if(E.children[r].isOverBBoxInklChildren(e,n,t,o))return n.push.apply(n,i),!0;return n.push.apply(n,i),!1},E.getPart=function(){return null==E.part?E.type==SVG.PART?E:E.parent.getPart():E.part},E.searchNodeById=function(e){if(E.id==e)return E;for(var n,t=0;t<E.children.length;t++)if(null!=(n=E.children[t].searchNodeById(e)))return n;return null},E.searchNodeByIntId=function(e){if(E.intId==e)return E;for(var n,t=0;t<E.children.length;t++)if(null!=(n=E.children[t].searchNodeByIntId(e)))return n;return null},E.beforeTransform=function(e,n){return n=void 0!==n&&n,!(!E.isTransformable&&!n)&&(E.getTransformList(),k=E.editor.svg.root.element.createSVGTransform(),_=E.editor.svg.root.element.createSVGTransform(),M=E.getBaseTransformationMatrix().multiply(E.editor.svg.root.element.createSVGMatrix()),(I=E.editor.svg.root.element.createSVGPoint()).x=E.boundingBox.x,I.y=E.boundingBox.y,(C=E.editor.svg.root.element.createSVGPoint()).x=E.boundingBox.x+E.boundingBox.width,C.y=E.boundingBox.y,(w=E.editor.svg.root.element.createSVGPoint()).x=E.boundingBox.x+E.boundingBox.width,w.y=E.boundingBox.y+E.boundingBox.height,(L=E.editor.svg.root.element.createSVGPoint()).x=E.boundingBox.x,L.y=E.boundingBox.y+E.boundingBox.height,(t=E.editor.svg.root.element.createSVGPoint()).x=E.boundingBox.x+E.boundingBox.width/2,t.y=E.boundingBox.y,(o=E.editor.svg.root.element.createSVGPoint()).x=E.boundingBox.x+E.boundingBox.width,o.y=E.boundingBox.y+E.boundingBox.height/2,(i=E.editor.svg.root.element.createSVGPoint()).x=E.boundingBox.x+E.boundingBox.width/2,i.y=E.boundingBox.y+E.boundingBox.height,(r=E.editor.svg.root.element.createSVGPoint()).x=E.boundingBox.x,r.y=E.boundingBox.y+E.boundingBox.height/2,E.type!=SVG.PART&&E.type!=SVG.SHAPE_PATH||E.specialBeforeTransform(),N=E.getCenterPoint(!1).matrixTransform(E.getTransformationMatrix().inverse()),null!=E.editor.svg.selected&&E.editor.svg.selected.intId==E.intId&&E.editor.helpers.select.hideSelect(E),null!=E.editor.svg.hovered&&E.editor.helpers.select.hover(null),E.editor.svg.isTransforming=!0)},E.afterTransform=function(e,n,t){return E.editor.svg.isTransforming=!1,e=void 0!==e&&e,t=void 0===t?null:t,!(!E.isTransformable&&!e)&&(E.element.transform.baseVal.consolidate(),E.type!=SVG.PART&&E.type!=SVG.SHAPE_PATH||E.specialAfterTransform(t),E.makeBBoxUpdateList(),null!=E.editor.svg.selected&&E.editor.svg.selected.intId==E.intId&&E.editor.helpers.select.showSelect(E),E.editor.helpers.select.removeRotateLine(E),!0)},E.swapTranform=function(){E.element.transform.baseVal.consolidate(),k=E.editor.svg.root.element.createSVGTransform(),_=E.editor.svg.root.element.createSVGTransform(),M=E.getBaseTransformationMatrix().multiply(E.editor.svg.root.element.createSVGMatrix()),(I=E.editor.svg.root.element.createSVGPoint()).x=E.boundingBox.x,I.y=E.boundingBox.y,(C=E.editor.svg.root.element.createSVGPoint()).x=E.boundingBox.x+E.boundingBox.width,C.y=E.boundingBox.y,(w=E.editor.svg.root.element.createSVGPoint()).x=E.boundingBox.x+E.boundingBox.width,w.y=E.boundingBox.y+E.boundingBox.height,(L=E.editor.svg.root.element.createSVGPoint()).x=E.boundingBox.x,L.y=E.boundingBox.y+E.boundingBox.height,(t=E.editor.svg.root.element.createSVGPoint()).x=E.boundingBox.x+E.boundingBox.width/2,t.y=E.boundingBox.y,(o=E.editor.svg.root.element.createSVGPoint()).x=E.boundingBox.x+E.boundingBox.width,o.y=E.boundingBox.y+E.boundingBox.height/2,(i=E.editor.svg.root.element.createSVGPoint()).x=E.boundingBox.x+E.boundingBox.width/2,i.y=E.boundingBox.y+E.boundingBox.height,(r=E.editor.svg.root.element.createSVGPoint()).x=E.boundingBox.x,r.y=E.boundingBox.y+E.boundingBox.height/2,N=E.getCenterPoint(!1).matrixTransform(E.getTransformationMatrix().inverse())},E.transform=function(e,n,t,o,i,r,a,l){l=void 0!==l&&l,E.lastTransformType=e;var s,d,u,g=0,x=0;if(!E.isTransformable&&!l)return!1;if(E.getTransformList().numberOfItems<3&&(E.element.transform.baseVal.appendItem(k),E.element.transform.baseVal.appendItem(_)),e==SVG.TRANSFORM_MOVE&&(E.isMoveable||l)&&(S=n,T=t,g=(G=E.getBaseTransformationMatrix()).e,x=G.f,(V=E.editor.svg.root.element.createSVGPoint()).x=S+g,V.y=T+x,V=V.matrixTransform(G.inverse()),E.type==SVG.PART&&(u=E.boundingBox.x+V.x,v=E.boundingBox.x+E.boundingBox.width+V.x,s=E.boundingBox.y+V.y,d=E.boundingBox.y+E.boundingBox.height+V.y,l||(u<E.editor.svg.sheet.boundingBox.x&&(V.x=E.editor.svg.sheet.boundingBox.x-E.boundingBox.x),v>E.editor.svg.sheet.boundingBox.x+E.editor.svg.sheet.boundingBox.width&&(V.x=E.editor.svg.sheet.boundingBox.x+E.editor.svg.sheet.boundingBox.width-E.boundingBox.x-E.boundingBox.width),s<E.editor.svg.sheet.boundingBox.y&&(V.y=E.editor.svg.sheet.boundingBox.y-E.boundingBox.y),d>E.editor.svg.sheet.boundingBox.y+E.editor.svg.sheet.boundingBox.height&&(V.y=E.editor.svg.sheet.boundingBox.y+E.editor.svg.sheet.boundingBox.height-E.boundingBox.y-E.boundingBox.height))),k.setTranslate(V.x,V.y),E.element.transform.baseVal.replaceItem(k,1)),e==SVG.TRANSFORM_ROTATE&&(E.isRotateable||l)&&(u=0!=t||t,k.setRotate(n,N.x,N.y),E.element.transform.baseVal.replaceItem(k,1),u&&E.editor.helpers.select.drawRotateLine(E)),e==SVG.TRANSFORM_SCALE&&(E.isResizeable||l)){var c,b,m,f,h,B,y,p,v=n,S=t,T=o,V=E.editor.svg.root.element.createSVGPoint(),G=(E.editor.svg.root.element.createSVGPoint(),E.getBaseTransformationMatrix()),R=Math.min(M.a,M.d),O=Math.min(G.a,G.d);switch(v){case"uni":c=t,m=b=0;break;case"center":c=t,f=1/(c=E.type==SVG.PART?E.transforming(SVG.TRANSFORM_SCALE,c,"all"):c)-1,V.x=E.boundingBox.x+E.boundingBox.width/2,V.y=E.boundingBox.y+E.boundingBox.height/2,b=(V=V.matrixTransform(G.inverse())).x*f,m=V.y*f;break;case"se":y=w.x-I.x,p=w.y-I.y,h=(S-I.x)/y,B=(T-I.y)/p,c=R*(c=Math.max(h,B))/O,f=1/(c=E.type==SVG.PART?E.transforming(SVG.TRANSFORM_SCALE,c,"se"):c)-1,V.x=E.boundingBox.x,V.y=E.boundingBox.y,b=(V=V.matrixTransform(G.inverse())).x*f,m=V.y*f;break;case"sw":y=C.x-L.x,p=L.y-C.y,h=(C.x-S)/y,B=(T-C.y)/p,c=R*(c=Math.max(h,B))/O,f=1/(c=E.type==SVG.PART?E.transforming(SVG.TRANSFORM_SCALE,c,"sw"):c)-1,V.x=E.boundingBox.x+E.boundingBox.width,V.y=E.boundingBox.y,b=(V=V.matrixTransform(G.inverse())).x*f,m=V.y*f;break;case"nw":y=w.x-I.x,p=w.y-I.y,h=(w.x-S)/y,B=(w.y-T)/p,c=R*(c=Math.max(h,B))/O,f=1/(c=E.type==SVG.PART?E.transforming(SVG.TRANSFORM_SCALE,c,"nw"):c)-1,V.x=E.boundingBox.x+E.boundingBox.width,V.y=E.boundingBox.y+E.boundingBox.height,b=(V=V.matrixTransform(G.inverse())).x*f,m=V.y*f;break;case"ne":y=C.x-L.x,p=L.y-C.y,h=(S-L.x)/y,B=(L.y-T)/p,c=R*(c=Math.max(h,B))/O,f=1/(c=E.type==SVG.PART?E.transforming(SVG.TRANSFORM_SCALE,c,"ne"):c)-1,V.x=E.boundingBox.x,V.y=E.boundingBox.y+E.boundingBox.height,b=(V=V.matrixTransform(G.inverse())).x*f,m=V.y*f}if(0<c){try{for(var A=E.element.transform.baseVal,P=A.numberOfItems-1;1<=P;P--)0<P&&A.removeItem(P)}catch(e){console.error("Fel: "+e)}k.setScale(c,c),_.setTranslate(b,m),E.element.transform.baseVal.appendItem(k),E.element.transform.baseVal.appendItem(_),g=b,x=m,E.element.transform.baseVal.consolidate()}E.calcDPI()}return E.type==SVG.PART&&E.specialTransform(E.getTransformationMatrix(!1),g,x),!0},E.getTransformList=function(){return E.element.transform?(0==E.element.transform.baseVal.numberOfItems&&E.element.transform.baseVal.initialize(E.editor.svg.root.element.createSVGTransform()),E.element.transform.baseVal):E.editor.svg.root.element.createSVGTransform()},E.getTransformationMatrix=function(e){e=void 0===e||e;var n=E.editor.svg.root.element.createSVGMatrix();if(e){if(E.type==SVG.LAYER_ROOT)return n;n=n.multiply(E.parent.getTransformationMatrix(!0))}for(var t=E.getTransformList(),o=0;o<t.numberOfItems;o++)n=n.multiply(t.getItem(o).matrix);return n},E.getBaseTransformationMatrix=function(e){e=void 0===e||e;var n=E.editor.svg.root.element.createSVGMatrix();if(e){if(E.type==SVG.LAYER_ROOT)return n;n=n.multiply(E.parent.getTransformationMatrix(!0))}e=E.getTransformList();return n=n.multiply(e.getItem(0).matrix)},E.makeBBoxUpdateList=function(e,n){if(n=void 0===n||n,void 0===e){if(e=new Array,E.calcBBox)for(var t=0;t<E.children.length;t++)E.children[t].makeBBoxUpdateList(e,!1);n=!0}if(n){if(n)if(e.unshift(E),E.type!=SVG.LAYER_ROOT)E.parent.makeBBoxUpdateList(e,!0);else for(t=0;t<e.length;t++)e[t].createBBoxAndCenter()}else if(e.push(E),E.calcBBox)for(var t=0;t<E.children.length;t++)E.children[t].makeBBoxUpdateList(e,!1)},E.moveToLayer=function(e,n){E.parent.removeChild(E.parentIndex),e.addChild(E,n),E.parent=e},E.getCenterPoint=function(e){return e?E.center.matrixTransform(E.getTransformationMatrix()):E.center},E.onSelect=function(){},E.onDeSelect=function(){},E.onEditMenu=function(){return null},E.onDeleteMenu=function(){return!0},E.copy=function(){return null},E.getMenuOptions=function(){return null},E.preRemove=function(e){void 0!==e&&e()},E.calcDPI=function(){},E.isParentSelected=function(){return null!=E.editor.svg.selected&&E.editor.svg.selected.id==E.id||E.parent.isParentSelected()},E.serializeFlags=function(){var e="";return(e+=E.isClickThrough?1:0)+(E.isSelectable?1:0)+(E.isOverable?1:0)+(E.isTransformable?1:0)+(E.isResizeable?1:0)+(E.isRotateable?1:0)+(E.isSkewable?1:0)+(E.isMoveable?1:0)+(E.isDeleteable?1:0)+(E.isAspectChangable?1:0)+(E.isCopyable?1:0)+(E.isEditable?1:0)+(E.isLockedContent?1:0)+(E.isIndexLocked?1:0)},E.deSerializeFlags=function(e){e=e.split("");"1"==e[0]?E.isClickThrough=!0:E.isClickThrough=!1,"1"==e[1]?E.isSelectable=!0:E.isSelectable=!1,"1"==e[2]?E.isOverable=!0:E.isOverable=!1,"1"==e[3]?E.isTransformable=!0:E.isTransformable=!1,"1"==e[4]?E.isResizeable=!0:E.isResizeable=!1,"1"==e[5]?E.isRotateable=!0:E.isRotateable=!1,"1"==e[6]?E.isSkewable=!0:E.isSkewable=!1,"1"==e[7]?E.isMoveable=!0:E.isMoveable=!1,"1"==e[8]?E.isDeleteable=!0:E.isDeleteable=!1,"1"==e[9]?E.isAspectChangable=!0:E.isAspectChangable=!1,"1"==e[10]?E.isCopyable=!0:E.isCopyable=!1,"1"==e[11]?E.isEditable=!0:E.isEditable=!1,"1"==e[12]?E.isLockedContent=!0:E.isLockedContent=!1,"1"==e[13]?E.isIndexLocked=!0:E.isIndexLocked=!1},E.toMatrix=function(e){return E.editor.helpers.importHelper.transformStringToMatrix(e)},E.findChildWithOption=function(e,n){for(var t,o=0;o<this.children.length&&!t;o++){var i=this.children[o];if(i.options&&i.options[e]&&i.options[e]==n)return i;t=i.findChildWithOption(e,n)}return t},E.onInit=function(){},E.setBoundingBox=function(e,n,t,o){E.boundingBox.x=e,E.boundingBox.y=n,E.boundingBox.height=t,E.boundingBox.width=o},E.setPaths=function(e,n){E.path=e,E.orgPath=n},E.setPartTypeOnPart=function(e){E.part_type=e},E.setIsResizable=function(e){E.isResizable=e}}'},85678:t=>{t.exports='function SVG(e,t){this.root=null,this.defs=null,this.mode=SVG.MODE_SHEET,this.zoom=SVG.ZOOM_SHEET,this.selected=null,this.hovered=null,this.activePart=null,this.sheet=null,this.shadow=null,this.infoLayer=null,(this.defaultBranch=this).collage=null,this.filters=null,this.isTransforming=!1,this.editorMargin={top:0,right:0,bottom:0,left:0,topProc:0,rightProc:0,bottomProc:0,leftProc:0},this.px2mm=t.px2mm,this.imperial=t.imperial,this.language=t.language,t.min_size&&(SVG.PART_MIN_SIDE=parseFloat(t.min_size)),t.max_size&&(SVG.PART_MAX_SIDE=parseFloat(t.max_size)),this.sheetZoomable=!0,this.runBBox=!0,this.noOnSelect=!1,this.zoomSteps=void 0===t.zoomSteps?10:t.zoomSteps,this.zoomDelay=void 0===t.zoomDelay?2:t.zoomDelay,this.noZoom=void 0!==t.noZoom&&t.noZoom,this.changeModeBusy=!1,this.extraCopy=void 0!==t.extraCopy&&t.extraCopy,this.fadePathId="cut",void 0!==t.fadePathId&&"bleed"==t.fadePathId&&(this.fadePathId="bleed"),this.multiArr=new Array;var u,c,l=e,f=this,o=t;function d(e,t,o,r,n){var a=f.root.getViewBox().split(" "),e=e.split(" ");!function e(t,o,r,n,a,i,s,d){var h=f.root.getViewBox();h=h.split(" ");var l=parseFloat(h[0])+parseFloat(t);var p=parseFloat(h[1])+parseFloat(o);var g=parseFloat(h[2])+parseFloat(r);h=parseFloat(h[3])+parseFloat(n);l=l+" "+p+" "+g+" "+h;f.root.element.setAttribute("viewBox",l);i--;0==i?(f.changeModeBusy=!1,d()):(c=d,u=setTimeout(function(){e(t,o,r,n,a,i,s,d)},s))}((e[0]-a[0])/o,(e[1]-a[1])/o,(e[2]-a[2])/o,(e[3]-a[3])/o,0,o,r,n)}this.setMargin=function(e){e=e.split(" ");f.editorMargin.top=parseInt(e[0]),f.editorMargin.right=parseInt(e[1]),f.editorMargin.bottom=parseInt(e[2]),f.editorMargin.left=parseInt(e[3]),4<e.length&&(f.editorMargin.topProc=parseInt(e[4]),f.editorMargin.rightProc=parseInt(e[5]),f.editorMargin.bottomProc=parseInt(e[6]),f.editorMargin.leftProc=parseInt(e[7]))},this.addMarginToViewBox=function(e){var e=e.split(" "),t=parseFloat(e[0]),o=parseFloat(e[1]),r=parseFloat(e[2]),e=parseFloat(e[3]),n=f.editorMargin,a=f.root.element.createSVGPoint(),i=(a.x=l.fixedLeft,a.y=l.fixedTop,f.root.element.createSVGPoint()),s=(i.x=l.fixedLeft+$(l.container).innerWidth(),i.y=l.fixedTop+$(l.container).innerHeight(),f.root.element.createSVGPoint()),a=(s.x=a.x+n.left,s.y=a.y+n.top,f.root.element.createSVGPoint()),i=(a.x=i.x-n.right,a.y=i.y-n.bottom,f.root.element.createSVGPoint()),d=f.root.element.createSVGPoint(),h=1,h=r/e<=(a.x-s.x)/(a.y-s.y)?e/(a.y-s.y):r/(a.x-s.x),a=(i.x=t-n.left*h,i.y=o-n.top*h,d.x=r+t+n.right*h,d.y=e+o+n.bottom*h,d.x-i.x),s=d.y-i.y;return i.x-=a*n.rightProc*.01,i.y-=s*n.topProc*.01,d.x+=a*n.leftProc*.01,d.y+=s*n.bottomProc*.01,i.x+" "+i.y+" "+(d.x-i.x)+" "+(d.y-i.y)},this.addChild=function(e){f.root=e,$(l.container).append(f.root.element),f.defaultBranch=f.root},this.createNode=function(e,t,o){(t=void 0===t?new Array:t).json&&((r=t.json).id&&(t.id=r.id),r.parentId&&(t.parentId=r.parentId),r.parentIntId&&(t.parentIntId=r.parentIntId),r.part&&(t.part=r.part)),t.id&&void 0!==t.id||(t.id=Math.random().toString().replace(",","").replace(".","")),parentNode=t.parentId?f.getNodeById(t.parentId):t.parentIntId?f.getNodeByIntId(t.parentIntId):t.part?f.getNodeById(t.part):null!=f.selected?f.selected:f.defaultBranch,e==SVG.PART&&(parentNode=f.root),(parentNode=e==SVG.CLIP_PATH?f.defs:parentNode).type==SVG.PART&&t.id!=parentNode.id+"PartBackground"&&t.id!=parentNode.id+"_partGroup"&&(parentNode=f.getNodeById(parentNode.id+"_partGroup"));var r=new window[e];return r.init(parentNode,l,t,o),r.makeBBoxUpdateList(),r},this.copyNode=function(e,t){return(t=void 0===t?new Array:t).id&&void 0!==t.id||(t.id=Math.random().toString().replace(",","").replace(".","")),e.copy(t)},this.getNodeOnPoint=function(e){var t=new Array;return f.root.isOverBBoxInklChildren(e,t,!1),0!=t.length?t[0]:null},this.getNodeListOnPoint=function(e,t){var o=new Array;return f.root.isOverBBoxInklChildren(e,o,!1,t),o},this.getNodeById=function(e){return f.root.searchNodeById(e)},this.getNodeByIntId=function(e){return f.root.searchNodeByIntId(e)},this.moveNode=function(e,t,o){return null!=e&&e.transform(SVG.TRANSFORM_MOVE,t,o)},this.rotateNode=function(e,t,o){return o=void 0===o||o,null!=e&&e.transform(SVG.TRANSFORM_ROTATE,t,o)},this.scaleNode=function(e,t,o,r){return null!=e&&e.transform(SVG.TRANSFORM_SCALE,t,o,r)},this.scaleNodeAll=function(e,t){return null!=e&&e.transform(SVG.TRANSFORM_SCALE,"center",t)},this.updateNodeBeforeTransformation=function(e,t){return null!=e&&(l.trigger("partEdited",{edited:"svg"}),e.beforeTransform(t))},this.updateNodeAfterTransformation=function(e,t,o){return null!=e&&e.afterTransform(!1,t,o)},this.fitAndCenterOnPart=function(e,t){var o,r,n,a;null!=(t=void 0===t?null:t)?(f.fit(e,t,!0),f.center(e,null,null,!0)):((t=null)!=e.getPart().bleed?t=Raphael.pathBBox(e.getPart().bleed):(a=2*f.px2mm,n=e.getPart().path,(t=Raphael.pathBBox(n)).x-=a,t.y-=a,t.x2+=a,t.y2+=a,t.width+=2*a,t.height+=2*a),n=t.width/t.height,a=e.boundingBox.width/e.boundingBox.height,o=!1,Math.abs(n-a)<.33&&(o=!0),n=1/(e.boundingBox.height/t.height),a=1/(e.boundingBox.width/t.width),s=1,s=o?Math.max(n,a):Math.min(n,a),e.beforeTransform(null,!0),e.transform(SVG.TRANSFORM_SCALE,"uni",s,0,0,0,0,!0),e.afterTransform(!0),o=e.getCenterPoint(!1),a=void(a=n=0)!==e.getPart().options.matrix?(r=Raphael.matrix(),r=e.getPart().toMatrix(e.getPart().options.matrix),n=t.cx-parseFloat(r.e)-o.x,t.cy-parseFloat(r.f)-o.y):(n=t.cx-o.x,t.cy-o.y),e.beforeTransform(null,!0),e.transform(SVG.TRANSFORM_MOVE,n,a,0,0,0,0,!0),e.afterTransform(!0))},this.fitAndCenter=function(e,t){f.fit(e,t),f.center(e)},this.fit=function(e,t,o,r,n,a){t=void 0===t?1:t,a=void 0!==(n=void 0!==n&&n)&&a,r=void 0!==r&&r;var i=1,s=1,o=((o=void 0!==o&&o)?(i=e.getPart().boundingBox.width/e.boundingBox.width,s=e.getPart().boundingBox.height/e.boundingBox.height,a&&null!=e.getPart().bleedPathNode&&(i=e.getPart().bleedPathNode.boundingBox.width/e.boundingBox.width,s=e.getPart().bleedPathNode.boundingBox.height/e.boundingBox.height)):(i=f.sheet.boundingBox.width/e.boundingBox.width,s=f.sheet.boundingBox.height/e.boundingBox.height),1);return((o=r?Math.max(i,s)*t:Math.min(i,s)*t)<1||n)&&(e.beforeTransform(null,!0),e.transform(SVG.TRANSFORM_SCALE,"uni",o,0,0,0,0,!0),e.afterTransform(!0)),o},this.setToScreenSize=function(e,t,o){var r=l.getScreenCTM().inverse(),r=(t=r.a*t,o=r.d*o,t/e.boundingBox.width),t=o/e.boundingBox.height,o=Math.min(r,t);e.beforeTransform(null,!0),e.transform(SVG.TRANSFORM_SCALE,"uni",o,0,0,0,0,!0),e.afterTransform(!0)},this.centerHorOrVer=function(e,t,o,r,n){t=void 0!==t&&t,o=void 0!==o&&o,r=void 0!==r&&r,n=void 0!==n&&n;var a,i=e.getCenterPoint(!1),o=o?f.sheet.getCenterPoint(!1):e.getPart().getCenterPoint(!0);n&&(n=Raphael.pathBBox(e.getPart().bleed),(a=l.svg.root.element.createSVGPoint()).x=n.x+(n.x2-n.x)/2,a.y=n.y+(n.y2-n.y)/2,o=a),r&&null!=e.collageObject&&((o=l.svg.root.element.createSVGPoint()).x=e.collageObject.path.center.x,o.y=e.collageObject.path.center.y),e.beforeTransform(null,!0),t?e.transform(SVG.TRANSFORM_MOVE,0,o.y-i.y,0,0,0,0,!0):e.transform(SVG.TRANSFORM_MOVE,o.x-i.x,0,0,0,0,0,!0),e.afterTransform(!0)},this.center=function(e,t,o,r){t=void 0===t?null:t,o=void 0===o?null:o,r=void 0!==r&&r;var n,a=e.getCenterPoint(!1);null==t||null==o?n=r?e.getPart().getCenterPoint(!0):f.sheet.getCenterPoint(!1):((n=f.root.element.createSVGPoint()).x=t,n.y=o),e.beforeTransform(null,!0),e.transform(SVG.TRANSFORM_MOVE,n.x-a.x,n.y-a.y,0,0,0,0,!0),e.afterTransform(!0)},this.hide=function(e){null!=e.element&&e.element.setAttribute("display","none")},this.show=function(e){null!=e.element&&e.element.setAttribute("display","inline")},this.setId=function(e,t){e.id=t},this.makeIcon=function(e,t){f.hide(e),f.setId(e,"icon"+t);t=f.getNodeById("iconLayer");e.moveToLayer(t),e.ignore=!0,e.overHandling=SVG.OVER_IGNORE,e.icon=!0},this.changeMode=function(e,t,o){f.changeModeBusy&&(clearTimeout(u),c&&c()),f.changeModeBusy=!0,o=void 0===o?f.noZoom:o;var r=!1;if(e==f.zoom&&(r=!0),e!=SVG.ZOOM_PART||t.type!=SVG.PART||t.isEditable){l.helpers.select.select(null),l.helpers.select.hover(null),f.zoom=e;var n=f.zoomSteps,a=f.zoomDelay;if(o&&(a=n=1),l.svg.filters.DisableDropShadow(),e!=SVG.ZOOM_SHEET||r)if(e==SVG.ZOOM_PART){null!=f.activePart&&f.activePart.deactivate(),f.activePart=t;for(var i=0;i<f.sheet.parts.length;i++)f.sheet.parts[i].intId!=f.activePart.intId?(f.sheet.parts[i].ignore=!0,f.sheet.parts[i].overHandling=SVG.OVER_IGNORE,$(f.sheet.parts[i].element).hide(),$(f.sheet.parts[i].pathNode.element).hide(),f.sheet.parts[i].bleedPathNode&&$(f.sheet.parts[i].bleedPathNode.element).hide()):(f.sheet.parts[i].ignore=!1,f.sheet.parts[i].overHandling=SVG.OVER_ZOOMED,$(f.sheet.parts[i].element).show(),$(f.sheet.parts[i].pathNode.element).show(),$(f.sheet.parts[i].pathNode.element).addClass("svgPartPath"),f.sheet.parts[i].bleedPathNode&&($(f.sheet.parts[i].bleedPathNode.element).show(),$(f.sheet.parts[i].bleedPathNode.element).addClass("svgPartBleedPath")));var s=t.boundingBox.x+" "+t.boundingBox.y+" "+t.boundingBox.width+" "+t.boundingBox.height;f.root.viewBoxNoMargin=s,d(f.addMarginToViewBox(s),0,n,a,function(){t.activate(),$(l).trigger("editorResize"),f.root.makeBBoxUpdateList(),l.svg.filters.EnableDropShadow(),l.helpers.preview.updatePreview(),f.shadow.updateShadow()})}else f.changeModeBusy=!1;else f.activePart.deactivate(),f.activePart=null,d(f.root.getSheetViewBox(),0,n,a,function(){f.shadow.clear();for(var e=0;e<f.sheet.parts.length;e++)f.sheet.parts[e].ignore=!1,f.sheet.parts[e].overHandling=SVG.OVER_BBOX,$(f.sheet.parts[e].element).show(),$(f.sheet.parts[e].pathNode.element).show(),$(f.sheet.parts[e].pathNode.element).addClass("svgPartPath"),f.sheet.parts[e].bleedPathNode&&($(f.sheet.parts[e].bleedPathNode.element).show(),$(f.sheet.parts[e].bleedPathNode.element).addClass("svgPartBleedPath"));$(l).trigger("editorResize"),f.root.makeBBoxUpdateList(),l.svg.filters.EnableDropShadow(),l.helpers.preview.updatePreview(),f.shadow.updateShadow()});r||l.trigger("editorZoomChange",f.zoom),l.helpers.preview.updatePreview(),f.shadow.updateShadow(),l.trigger("editorSVGChangeMode",{zoomMode:e,node:t,noZoom:o,change:!r})}},this.getStyle=function(e,t){for(var o=null,r=0;r<document.styleSheets.length;r++)if("svg"==document.styleSheets[r].title){o=document.styleSheets[r].rules||document.styleSheets[r].cssRules;break}if(null==o)return null;for(var n=0;n<o.length;n++)if(o[n].selectorText==e)return o[n].style.getPropertyValue(t)},this.refreshMargin=function(e){if(this.changeModeBusy)return!1;if(void 0===e&&(e=!1),f.root.viewBoxNoMargin=f.root.orgViewBox,f.root.sheetViewBox=f.addMarginToViewBox(f.root.orgViewBox),f.root.updateViewBox(f.root.sheetViewBox),null!=f.sheet)for(var t=0;t<f.sheet.parts.length;t++)f.sheet.parts[t].updatePath();0==e&&f.zoom==SVG.ZOOM_PART&&f.changeMode(SVG.ZOOM_PART,f.activePart,!0)},this.isPointerOverActivePartPath=function(e,t){if(null!=f.activePart&&(f.sheet.sheet_type==SVG.MODE_SINGLE||f.sheet.sheet_type==SVG.MODE_SHEET)){if(f.sheet.sheet_type==SVG.MODE_SHEET&&f.activePart.part_type==SVG.PART_TYPE_PATH)return!1;if(f.activePart.searchPathPointArray(e,t)<5)return!0}return!1},o.id="roots",f.createNode(SVG.LAYER_ROOT,o,function(){o.margin&&f.setMargin(o.margin),f.refreshMargin()})}SVG.SVG_NAMESPACE="http://www.w3.org/2000/svg",SVG.SVG_XLINK="http://www.w3.org/1999/xlink",SVG.STICKIT_NS="http://www.stickerapp.se",SVG.TRANSFORM_MOVE="translate",SVG.TRANSFORM_SCALE="scale",SVG.TRANSFORM_ROTATE="rotate",SVG.TRANSFORM_SKEW="skew",SVG.TRANSFORM_MATRIX="matrix",SVG.ZOOM_SHEET="sheet",SVG.ZOOM_PART="part",SVG.MODE_SHEET="sheet",SVG.MODE_SKIN="skin",SVG.MODE_CASE="case",SVG.MODE_SINGLE="single",SVG.OVER_ALWAYS="alwaysOver",SVG.OVER_LAYER="layerOver",SVG.OVER_BBOX="bboxOver",SVG.OVER_NEVER="neverOver",SVG.OVER_IGNORE="ignoreOver",SVG.OVER_ZOOMED="zoomedOver";'},30030:t=>{t.exports="function Shape(e){var a=e;new Node(a),a.isClickThrough=!1,a.isSelectable=!0,a.isOverable=!0,a.isTransformable=!0,a.isResizeable=!0,a.isRotateable=!0,a.isSkewable=!1,a.isMoveable=!0,a.remove=function(){a.parent.removeChild(a.parentIndex)},a.getMenuOptions=function(){var e=new Array;return a.isUpDownable&&(e.push(SELECT_MENU_UP),e.push(SELECT_MENU_DOWN)),a.isDeleteable&&e.push(SELECT_MENU_DELETE),e}}"},77212:t=>{t.exports='function ClipPath(){new Branch(this),this.type=SVG.CLIP_PATH,this.svgTag=SVG.CLIP_PATH_TAG;var i=this;i.clipPathPath=null,i.path=null,i.transform="",i.createElement=function(t){i.element.setAttribute("id",i.options.id),i.id=i.options.id,i.path=i.options.path,i.options.transform&&(i.transform=i.options.transform),i.clipPathPath=i.editor.svg.createNode(SVG.SHAPE_PATH,{parentId:i.id,transform:i.transform,id:i.id+"_path",d:i.path}),i.clipPathPath.ignore=!0,i.clipPathPath.overHandling=SVG.OVER_IGNORE,void 0!==t&&t(i)},i.createBBoxAndCenter=function(){}}SVG.CLIP_PATH="ClipPath",SVG.CLIP_PATH_TAG="clipPath";'},91552:t=>{t.exports='function Collage(){new Branch(this),this.type=SVG.COLLAGE,this.svgTag=SVG.COLLAGE_TAG;var c=this,p=(c.isClickThrough=!0,c.isSelectable=!1,c.isOverable=!1,c.isTransformable=!1,c.isResizeable=!1,c.isRotateable=!1,c.isSkewable=!1,c.isMoveable=!1,c.isDeleteable=!0,new Array);c.createElement=function(e){c.options.id="collage",c.element.setAttribute("id",c.options.id);var o=c.options.collage_id;if(c.options.import){for(var t=new ColPart,a=0;a<c.options.xml.childNodes.length;a++){for(var i=c.options.xml.childNodes[a],n=new Array,l=0;l<i.attributes.length;l++)n[(r=i.attributes[l]).name]=r.value;if(n.parentIntId=c.intId,"g"==i.nodeName&&(t.group=c.editor.svg.createNode(SVG.GROUP_STANDARD,n),0<i.childNodes.length)){for(var r,d=i.childNodes[0],g=new Array,l=0;l<d.attributes.length;l++)g[(r=d.attributes[l]).name]=r.value;g.parentIntId=t.group.intId;var s=new XMLSerializer,h=(g.svg=s.serializeToString(d.childNodes[0]),d.childNodes[0]);"g"==h.nodeName&&(h=h.childNodes[0]),node=c.editor.svg.createNode(SVG.SHAPE_MULTI,g,function(e){c.editor.svg.multiArr.push(e);for(var o=new Array,t=0;t<h.attributes.length;t++){var a=h.attributes[t];o[a.name]=a.value}o.parentIntId=e.intId,c.editor.svg.createNode(SVG.SHAPE_IMAGE,o,function(e){c.editor.helpers.dpi.addImageNode(e),e.checkDpi=!0})}),(t.imageNode=node).collageObject=t}"path"==i.nodeName&&(n.fill=null,n.stroke=null,n.class="svgCollagePath",t.path=c.editor.svg.createNode(SVG.SHAPE_PATH,n),(t.path.collageObject=t).path.isTransformable=!1,t.path.isResizeable=!1,t.path.isRotateable=!1,t.path.isSkewable=!1,t.path.isMoveable=!1,t.path.isDeleteable=!1,t.path.isUpDownable=!1,t.clipPath=c.editor.svg.createNode(SVG.CLIP_PATH,{id:"collageClip_"+t.path.id,path:n.d}),t.x=t.path.boundingBox.x,t.y=t.path.boundingBox.y),null!=t.group&&null!=t.path&&(p.push(t),t=new ColPart)}for(a=0;a<p.length;a++)null!=p[a].imageNode&&(p[a].path.isTransformable=!0,p[a].path.isMoveable=!0,c.hideImage(p[a].imageNode))}else $.ajax({async:!1,type:"POST",dataType:"json",url:"/editor/get_collage_paths/"+o,success:function(e){for(var o=0;o<e.paths.length;o++){var t=new ColPart;t.group=c.editor.svg.createNode(SVG.GROUP_STANDARD,{parentIntId:c.intId}),t.path=c.editor.svg.createNode(SVG.SHAPE_PATH,{d:e.paths[o],parentIntId:c.intId,class:"svgCollagePath"}),(t.path.collageObject=t).path.isTransformable=!1,t.path.isResizeable=!1,t.path.isRotateable=!1,t.path.isSkewable=!1,t.path.isMoveable=!1,t.path.isDeleteable=!1,t.path.isUpDownable=!1,t.clipPath=c.editor.svg.createNode(SVG.CLIP_PATH,{id:"collageClip_"+t.path.id,path:e.paths[o]}),t.x=t.path.boundingBox.x,t.y=t.path.boundingBox.y,p.push(t)}},error:function(e,o,t){console.log("error"),console.log(e),console.log(o),console.log(t)}});c.parent.moveChildDown(c),void 0!==e&&e(c)},c.createBBoxAndCenter=function(){c.boundingBox=c.editor.svg.root.element.createSVGRect(),c.boundingBox.width=0,c.boundingBox.height=0,c.boundingBox.x=1e6,c.boundingBox.y=1e6;for(var e=0;e<p.length;e++)p[e].path.boundingBox.x<c.boundingBox.x&&(c.boundingBox.x=p[e].path.boundingBox.x),p[e].path.boundingBox.y<c.boundingBox.y&&(c.boundingBox.y=p[e].path.boundingBox.y);for(e=0;e<p.length;e++)p[e].path.boundingBox.width+p[e].path.boundingBox.x>c.boundingBox.width+c.boundingBox.x&&(c.boundingBox.width=p[e].path.boundingBox.width+p[e].path.boundingBox.x-c.boundingBox.x),p[e].path.boundingBox.height+p[e].path.boundingBox.y>c.boundingBox.height+c.boundingBox.y&&(c.boundingBox.height=p[e].path.boundingBox.height+p[e].path.boundingBox.y-c.boundingBox.y);c.center=c.editor.svg.root.element.createSVGPoint(),c.center.x=c.boundingBox.x+c.boundingBox.width/2,c.center.y=c.boundingBox.y+c.boundingBox.height/2},c.addImage=function(e){var o,t,a=-1;if(null!=c.editor.svg.selected)for(var i=0;i<p.length;i++)if(p[i].path.intId==c.editor.svg.selected.intId&&null==p[i].imageNode){a=i;break}if(-1==a)for(i=0;i<p.length;i++)if(null==p[i].imageNode){a=i;break}-1!=a&&(p[a].imageNode=e,p[a].group.changeBranch(e),e.collageObject=p[a],e.collageObject.path.isTransformable=!0,e.collageObject.path.isMoveable=!0,e.createBBoxAndCenter(),t=(e.collageObject.path.boundingBox.width+2*c.editor.svg.px2mm)/e.boundingBox.width,o=(e.collageObject.path.boundingBox.height+2*c.editor.svg.px2mm)/e.boundingBox.height,t=Math.max(t,o),e.beforeTransform(null,!0),e.transform(SVG.TRANSFORM_SCALE,"uni",t,0,0,0,0,!0),e.afterTransform(!0),o=e.collageObject.path.center.x-e.center.x,t=e.collageObject.path.center.y-e.center.y,e.beforeTransform(null,!0),e.transform(SVG.TRANSFORM_MOVE,o,t,0,0,0,0,!0),e.afterTransform(!0),null!=c.editor.svg.selected&&null!=c.editor.svg.selected.collageObject&&c.editor.helpers.select.reDrawHoverAndSelect()),c.hideImage(e)},c.deleteImage=function(e){e.path.isTransformable=!1,e.path.isMoveable=!1,e.imageNode.preRemove(),e.group.removeChild(0,!0),e.imageNode=null},c.showImage=function(e){e.collageObject.group.element.removeAttribute("clip-path"),e.ignore=!1,e.overHandling=SVG.OVER_BBOX,c.editor.svg.shadow.addCollage(e.collageObject),e.createBBoxAndCenter(),e.collageObject.path.createBBoxAndCenter(),e.collageObject.group.createBBoxAndCenter(),c.editor.helpers.select.select(e);for(var o=0;o<p.length;o++)p[o].path.overHandling=SVG.OVER_IGNORE,p[o].path.ignore=!0,p[o].group.overHandling=SVG.OVER_IGNORE,p[o].group.ignore=!0;null!=c.editor.svg.activePart&&(c.editor.svg.activePart.overHandling=SVG.OVER_IGNORE,c.editor.svg.activePart.ignore=!0),e.collageObject},c.hideImage=function(e){if(null!=e.collageObject){e.collageObject.group.element.setAttribute("clip-path","url(#"+e.collageObject.clipPath.id+")"),e.ignore=!0,e.overHandling=SVG.OVER_NEVER,e.createBBoxAndCenter(),e.collageObject.group.createBBoxAndCenter(),c.editor.svg.shadow.removeCollage();for(var o=0;o<p.length;o++)p[o].path.overHandling=SVG.OVER_BBOX,p[o].path.ignore=!1,p[o].group.overHandling=SVG.OVER_IGNORE,p[o].group.ignore=!0}null!=c.editor.svg.activePart&&(c.editor.svg.activePart.overHandling=SVG.OVER_ZOOMED,c.editor.svg.activePart.ignore=!1),0},c.swapImages=function(e,o){var t;null!=e.imageNode&&(null==o.imageNode?(c.showImage(e.imageNode),o.imageNode=e.imageNode,o.imageNode.collageObject=o,e.imageNode=null,o.path.isTransformable=!0,o.path.isMoveable=!0,e.path.isTransformable=!1,e.path.isMoveable=!1,e.group.removeChild(0,!1),o.group.addChild(o.imageNode),o.imageNode.beforeTransform(),c.editor.svg.moveNode(o.imageNode,o.x-e.x,o.y-e.y),c.hideImage(o.imageNode),e.path.createBBoxAndCenter(),e.group.createBBoxAndCenter(),c.editor.helpers.select.select(null),o.imageNode.element.transform.baseVal.consolidate()):(c.showImage(e.imageNode),c.showImage(o.imageNode),t=o.imageNode,o.imageNode=e.imageNode,e.imageNode=t,o.imageNode.collageObject=o,e.imageNode.collageObject=e,o.group.removeChild(0,!1),e.group.removeChild(0,!1),o.group.addChild(o.imageNode),e.group.addChild(e.imageNode),o.imageNode.beforeTransform(),e.imageNode.beforeTransform(),c.editor.svg.moveNode(o.imageNode,o.x-e.x,o.y-e.y),c.editor.svg.moveNode(e.imageNode,e.x-o.x,e.y-o.y),c.hideImage(o.imageNode),c.hideImage(e.imageNode),e.path.createBBoxAndCenter(),o.path.createBBoxAndCenter(),e.group.createBBoxAndCenter(),o.group.createBBoxAndCenter(),c.editor.helpers.select.select(null),o.imageNode.element.transform.baseVal.consolidate(),e.imageNode.element.transform.baseVal.consolidate()))},c.getColParts=function(){return p}}function ColPart(){this.x=null,this.y=null,this.width=null,this.height=null,this.imageNode=null,this.path=null,this.group=null,this.clipPath=null,this.isVisible=!1}SVG.COLLAGE="Collage",SVG.COLLAGE_TAG="g";'},52272:t=>{t.exports='function Defs(){new Layer(this),this.type=SVG.DEFS,this.svgTag=SVG.DEFS_TAG;var e=this;e.createElement=function(t){e.options.id&&e.element.setAttribute("id",e.options.id),void 0!==t&&t(e)}}SVG.DEFS="Defs",SVG.DEFS_TAG="defs";'},97277:t=>{t.exports='function GroupStandard(){new Branch(this),this.type=SVG.GROUP_STANDARD,this.svgTag=SVG.GROUP_STANDARD_TAG;var a=this;a.isClickThrough=!0,a.isSelectable=!1,a.isOverable=!1,a.isTransformable=!1,a.isResizeable=!1,a.isRotateable=!1,a.isSkewable=!1,a.isMoveable=!1,a.isDeleteable=!0,a.isGrouped=!1,a.isStrangeCenter=!0,a.createElement=function(e){var i;a.options.id&&a.element.setAttribute("id",a.options.id),void 0!==a.options.flags&&a.deSerializeFlags(a.options.flags),a.options.transform&&(i=a.toMatrix(a.options.transform),(m=a.editor.svg.root.element.createSVGMatrix()).a=parseFloat(i.a),m.b=parseFloat(i.b),m.c=parseFloat(i.c),m.d=parseFloat(i.d),m.e=parseFloat(i.e),m.f=parseFloat(i.f),(i=a.editor.svg.root.element.createSVGTransform()).setMatrix(m),a.getTransformList(),a.element.transform.baseVal.initialize(i)),a.createBBoxAndCenter(),void 0!==e&&e(a)},a.createBBoxAndCenter=function(){if(a.editor.svg.runBBox){for(var e=1e5,i=1e5,o=-1e5,n=-1e5,r=0;r<a.children.length;r++)a.children[r].createBBoxAndCenter(),isNaN(a.children[r].boundingBox.x)||(e=Math.min(e,a.children[r].boundingBox.x)),isNaN(a.children[r].boundingBox.y)||(i=Math.min(i,a.children[r].boundingBox.y)),isNaN(a.children[r].boundingBox.x+a.children[r].boundingBox.width)||(o=Math.max(o,a.children[r].boundingBox.x+a.children[r].boundingBox.width)),isNaN(a.children[r].boundingBox.y+a.children[r].boundingBox.height)||(n=Math.max(n,a.children[r].boundingBox.y+a.children[r].boundingBox.height));1e5==e&&-1e5==o&&(o=e=0),1e5==i&&-1e5==n&&(n=i=0),a.boundingBox=a.editor.svg.root.element.createSVGRect(),a.boundingBox.width=o-e,a.boundingBox.height=n-i,a.boundingBox.x=e,a.boundingBox.y=i,a.center=a.editor.svg.root.element.createSVGPoint(),a.center.x=a.boundingBox.x+a.boundingBox.width/2,a.center.y=a.boundingBox.y+a.boundingBox.height/2}},a.group=function(){a.isClickThrough=!1,a.isSelectable=!0,a.isOverable=!0,a.isTransformable=!0,a.isResizeable=!0,a.isRotateable=!0,a.isSkewable=!1,a.isMoveable=!0,a.isGrouped=!0},a.ungroup=function(){a.isClickThrough=!0,a.isSelectable=!1,a.isOverable=!1,a.isTransformable=!1,a.isResizeable=!1,a.isRotateable=!1,a.isSkewable=!1,a.isMoveable=!1,a.isGrouped=!1},a.getMenuOptions=function(){var e=new Array;return e.push(SELECT_MENU_UP),e.push(SELECT_MENU_DOWN),a.editor.svg.extraCopy&&e.push(SELECT_MENU_COPY),e.push(SELECT_MENU_CENTER_HOR),e.push(SELECT_MENU_CENTER_VER),e.push(SELECT_MENU_DELETE),e},a.copy=function(e){var i,o=new Array;for(i in a.options)"id"!=i&&(o[i]=a.options[i]);var n=a.editor.svg.root.element.createSVGMatrix(),r=0,t=0;e.offX&&(r=e.offX),e.offY&&(t=e.offY),n=(n=n.multiply(a.element.transform.baseVal.consolidate().matrix)).translate(r,t),o.transform="matrix("+n.a+", "+n.b+", "+n.c+", "+n.d+", "+n.e+", "+n.f+")",o.flags=a.serializeFlags(),o.visibility="hidden",a.editor.svg.createNode(SVG.GROUP_STANDARD,o,function(o){for(var e=new XMLSerializer,i="",n=a.children.length-1;0<=n;n--)a.editor.helpers.exportHelper.serializeNodeFlags(a.children[n]),i+=e.serializeToString(a.children[n].element);var i=(i=i.replace(/\\sid="([^"]+)"/g," ")).replace(/ href=/g," xlink:href="),r=new RegExp("https:"+"//"+"stickerapp.com/","g");i=i.replace(r,""),a.editor.helpers.importHelper.importSVGData(i,o,function(e,i){a.editor.svg.refreshMargin(!1),a.editor.helpers.select.select(o)}),o.options.visibility="visible",$(o.element).css("visibility","visible")})}}SVG.GROUP_STANDARD="GroupStandard",SVG.GROUP_STANDARD_TAG="g";'},23004:t=>{t.exports='function LayerRoot(){new Layer(this),this.type=SVG.LAYER_ROOT,this.svgTag=SVG.LAYER_ROOT_TAG;var o=this;this.orgViewBox=null,this.sheetViewBox=null,this.viewBoxNoMargin=null,this.preserveAspectRatio=null,this.ignore=!0,this.overHandling=SVG.OVER_IGNORE,o.createElement=function(e){o.element.setAttribute("id",o.editor.svgRootID),o.updateViewBox(o.options.viewBox),o.orgViewBox=o.options.viewBox,o.viewBoxNoMargin=o.orgViewBox,o.options.preserveAspectRatio&&(o.element.setAttribute("preserveAspectRatio",o.options.preserveAspectRatio),this.preserveAspectRatio=o.options.preserveAspectRatio),o.options.width&&o.element.setAttribute("width",o.options.width),o.options.height&&o.element.setAttribute("height",o.options.height),o.element.setAttribute("xmlns",SVG.SVG_NAMESPACE),o.element.setAttribute("xmlns:xlink",SVG.SVG_XLINK),o.element.setAttribute("stickit",SVG.STICKIT_NS),o.element.setAttribute("class","no-text-select"),o.element.setAttribute("height","100%"),o.element.setAttribute("width","100%"),void 0!==e&&e()},o.getCenterPoint=function(e){var t=o.element.getAttribute("viewBox").split(" "),i=o.editor.svg.root.element.createSVGPoint();return i.x=(parseFloat(t[2])-parseFloat(t[0]))/2,i.y=(parseFloat(t[3])-parseFloat(t[1]))/2,i},o.getWidth=function(){var e=o.element.getAttribute("viewBox").split(" ");return parseFloat(e[2])},o.getHeight=function(){var e=o.element.getAttribute("viewBox").split(" ");return parseFloat(e[3])},o.getX=function(){var e=o.element.getAttribute("viewBox").split(" ");return parseFloat(e[0])},o.getY=function(){var e=o.element.getAttribute("viewBox").split(" ");return parseFloat(e[1])},o.getSheetViewBox=function(){return o.sheetViewBox},o.getViewBox=function(){return o.element.getAttribute("viewBox")},o.updateViewBox=function(e){o.element.setAttribute("viewBox",e)},o.isParentSelected=function(){return!1}}SVG.LAYER_ROOT="LayerRoot",SVG.LAYER_ROOT_TAG="svg";'},40744:t=>{t.exports='function LayerShadow(){new Layer(this),this.type=SVG.LAYER_SHADOW,this.svgTag=SVG.LAYER_SHADOW_TAG;var a=this;a.isClickThrough=!0,a.isSelectable=!1,a.isOverable=!1,a.overHandling=SVG.OVER_IGNORE,a.overlayPath=null,a.collageShadow=null,a.createElement=function(e){a.element.setAttribute("id",a.options.id),void 0!==e&&e(a)},a.clear=function(){},a.updateShadow=function(e){if(e=void 0===e?null:e,null!=a.overlayPath){if(a.editor.helpers.preview.status&&a.editor.svg.mode!=SVG.MODE_SHEET)return void $(a.overlayPath.element).hide();$(a.overlayPath.element).show()}var t=a.getShadowPath(10);null==e?(a.editor.svg.mode==SVG.MODE_SKIN&&(t+=" "+a.transformPathNode(a.editor.svg.activePart)),a.editor.svg.mode==SVG.MODE_SHEET&&(a.editor.svg.zoom==SVG.ZOOM_SHEET?t+=" "+a.transformPathNode(a.editor.svg.sheet.pathNode):t+=" "+a.transformPathNode(a.editor.svg.activePart)),a.editor.svg.mode==SVG.MODE_CASE&&(t+=" "+a.transformPathNode(a.editor.svg.activePart)),a.editor.svg.mode==SVG.MODE_SINGLE&&(t+=" "+a.transformPathNode(a.editor.svg.activePart))):t+=" "+e,null==a.overlayPath?(a.overlayPath=a.editor.svg.createNode(SVG.SHAPE_PATH,{d:t,"fill-rule":"evenodd",parentIntId:a.intId,class:"svgShadowOverlay"}),a.overlayPath.ignore=!0,a.overlayPath.overHandling=SVG.OVER_IGNORE):a.overlayPath.element.setAttribute("d",t)},a.transformPathNode=function(e){if(null==e)return"";var t=e.tempTransform.matrix,t=Raphael.matrix(t.a,t.b,t.c,t.d,t.e,t.f),o=e.orgPath;return"bleed"==a.editor.svg.fadePathId&&(o=e.bleed),Raphael.mapPath(o,t).toString()},a.addCollage=function(e){null!=a.collageShadow&&a.collageShadow.remove();var t=a.getShadowPath(10);t+=" "+e.path.orgPath,a.collageShadow=a.editor.svg.createNode(SVG.SHAPE_PATH,{d:t,parentIntId:a.intId,class:"svgCollageShadowOverlay"}),a.collageShadow.ignore=!0,a.collageShadow.overHandling=SVG.OVER_IGNORE},a.removeCollage=function(){null!=a.collageShadow&&a.collageShadow.remove(),a.collageShadow=null},a.getShadowPath=function(e){e=void 0===e?0:e;var t=a.editor.svg.root.element.createSVGPoint(),o=(t.x=a.editor.fixedLeft,t.y=a.editor.fixedTop,(t=t.matrixTransform(a.editor.getScreenCTM().inverse())).x-=e,t.y-=e,a.editor.svg.root.element.createSVGPoint());return o.x=a.editor.fixedLeft+a.editor.$container.innerWidth(),o.y=a.editor.fixedTop+a.editor.$container.innerHeight(),(o=o.matrixTransform(a.editor.getScreenCTM().inverse())).x+=e,o.y+=e,"M "+t.x+" "+t.y+" L "+t.x+" "+o.y+" L "+o.x+" "+o.y+" L "+o.x+" "+t.y+" z"},a.onInit=function(){a.editor.registerCallback(a.editor,"editorResize",function(){a.updateShadow()}),a.editor.registerCallback(window,"resize",function(){a.updateShadow()})}}SVG.LAYER_SHADOW="LayerShadow",SVG.LAYER_SHADOW_TAG="g";'},26486:t=>{t.exports='function LayerSheet(){new Layer(this),this.type=SVG.LAYER_SHEET,this.svgTag=SVG.LAYER_SHEET_TAG;var r,o=this;function i(){var e=o.editor.svg.root.element.viewBox.animVal.height,t=o.editor.svg.root.element.viewBox.animVal.width,n=$(o.editor.container).height(),a=$(o.editor.container).width();heightAspect=n/e,widthAspect=a/t,r=1/Math.min(heightAspect,widthAspect)}o.isClickThrough=!0,o.isSelectable=!1,o.isOverable=!1,o.isTransformable=!1,o.isResizeable=!1,o.isRotateable=!1,o.isSkewable=!1,o.isMoveable=!1,o.ignore=!0,o.overHandling=SVG.OVER_IGNORE,o.parts=new Array,o.path=null,o.shadow=null,o.width=0,o.height=0,o.sheet_type="",o.sheet_meta=null,o.bottomTextNode=null,o.topTextNode=null,o.leftTextNode=null,o.rightTextNode=null,o.pathNode=null,o.shadowPathNode1=null,o.shadowPathNode2=null,o.shadowPathNode3=null,o.shadowPathNode4=null,o.backgroundPattern=null,o.backgroundPatternLight=null,o.backgroundPatternDark=null,o.backgroundPatternSize=null,o.backgroundPatternHref=null,o.backgroundPatternWidth=null,o.backgroundPatternHeight=null,o.backprintDealSettings=null,o.createElement=function(e){var t=o.options.json,t=(t.width&&(o.width=parseFloat(t.width)),t.height&&(o.height=parseFloat(t.height)),o.sheet_type=t.sheet_type,t.backgroundPattern&&(o.backgroundPattern=t.backgroundPattern,o.backgroundPatternLight=t.backgroundPatternLight,o.backgroundPatternDark=t.backgroundPatternDark,o.backgroundPatternSize=t.backgroundPatternSize,o.backgroundPatternWidth=t.backgroundPatternWidth,o.backgroundPatternHeight=t.backgroundPatternHeight,o.backgroundPatternHref=t.backgroundPatternHref),t.meta&&(o.sheet_meta=t.meta),t.backprintDealSettings&&(o.backprintDealSettings=t.backprintDealSettings),"svgSheet "+o.sheet_type);o.element.setAttribute("class",t),o.id="sheet",void 0!==e&&e(o)},o.createSheetStep2=function(){var e="svgSheetPath "+o.sheet_type,t=o.editor.svg.getNodeById("partPathLayer");o.pathNode=o.editor.svg.createNode(SVG.SHAPE_PATH,{parentIntId:t.intId,class:e,d:o.sheetPath()}),o.pathNode.ignore=!0,o.pathNode.overHandling=SVG.OVER_IGNORE,o.createBBoxAndCenter(),"square"==o.backgroundPattern&&o.editor.svg.filters.CreateBackgroundPattern(o.backgroundPatternLight,o.backgroundPatternDark,o.backgroundPatternSize),"image"==o.backgroundPattern&&o.editor.svg.filters.CreateBackgroundImage(o.backgroundPatternHref,o.backgroundPatternWidth,o.backgroundPatternHeight),o.editor.model.editor.backPrintDealToolEnabled&&o.editor.svg.filters.CreateBackgroundImageForBackprintDeal(o.backprintDealSettings.backgroundPatternHref,o.backprintDealSettings.backgroundPatternHeight,o.backprintDealSettings.backgroundPatternWidth)},o.createBBoxAndCenter=function(){o.boundingBox=o.editor.svg.root.element.createSVGRect(),o.boundingBox.width=o.width*o.editor.svg.px2mm,o.boundingBox.height=o.height*o.editor.svg.px2mm,o.boundingBox.x=0,o.boundingBox.y=0,o.center=o.editor.svg.root.element.createSVGPoint(),o.center.x=o.boundingBox.width/2,o.center.y=o.boundingBox.height/2,o.element.setAttribute("d",o.sheetPath()),null!=o.pathNode&&o.pathNode.element.setAttribute("d",o.sheetPath())},o.sheetPath=function(){return"M 0 0 L 0 "+o.boundingBox.height+" L "+o.boundingBox.width+" "+o.boundingBox.height+" L "+o.boundingBox.width+" 0 z"},o.addPart=function(e,t){-1==(t=void 0===t?-1:t)?o.parts.splice(0,0,e):o.parts.splice(t,0,e)},o.showSize=function(){i();var e=0,t=0,t=o.editor.svg.imperial?(e=Math.round(o.width/2.54)/10,Math.round(o.height/2.54)/10):(e=Math.round(o.width)/10,Math.round(o.height)/10),n=(e+=o.editor.svg.language.cm,t+=o.editor.svg.language.cm,20*r),a=new Array;a.parentId="infoLayer",a.left=o.boundingBox.width/2,a.top=o.boundingBox.height+n,a.size=n,a.anchor="middle",a.text=e,a.class="svgSheetSizeText",o.bottomTextNode=o.editor.svg.createNode(SVG.SHAPE_TEXT,a),o.bottomTextNode.overHandling=SVG.OVER_NEVER,a.left=0-n,a.top=o.boundingBox.height/2,a.text=t,a.transform="rotate(-90 "+-n/2+","+(a.top-n/2)+") translate(0,"+-n/2+")",o.leftTextNode=o.editor.svg.createNode(SVG.SHAPE_TEXT,a),o.leftTextNode.overHandling=SVG.OVER_NEVER},o.updateSize=function(){i();var e=20*r;o.bottomTextNode.element.setAttribute("font-size",e),o.bottomTextNode.element.setAttribute("y",o.boundingBox.height+e),o.leftTextNode.element.setAttribute("font-size",e),o.leftTextNode.element.setAttribute("x",0-e)},o.updatePartsOrder=function(){if(1<o.parts.length){for(var e=o.parts.length-1;0<=e;e--){o.parts[e].element.parentNode.insertBefore(o.parts[e].element,o.editor.svg.getNodeById("shadowLayer").element);var t=o.editor.svg.getNodeById("shadowLayer");o.parent.children.splice(o.parts[e].parentIndex,1),o.parent.children.splice(t.parentIndex+1,0,o.parts[e]),o.parent.updateChildrensParentIndex()}for(e=o.parts.length-1;0<=e;e--)null!=o.parts[e].pathNode&&o.editor.svg.getNodeById("partPathLayer").element.appendChild(o.parts[e].pathNode.element)}}}SVG.LAYER_SHEET="LayerSheet",SVG.LAYER_SHEET_TAG="path",SHEET_VIEWBOX_MARGIN=10;'},18279:t=>{t.exports='function LayerStandard(){new Layer(this),this.type=SVG.LAYER_STANDARD,this.svgTag=SVG.LAYER_STANDARD_TAG;var n=this;n.part=null,this.elements=new Array,n.createElement=function(e){n.options.id&&n.element.setAttribute("id",n.options.id),void 0!==e&&e(n)},n.updateOptions=function(){n.options.part&&(n.part=n.editor.svg.getNodeById(n.options.part),n.moveToLayer(n.part))},this.addElement=function(e,t){t?$(n.element).append(e):$(n.element).prepend(e)},this.removeElement=function(e){n.element.removeChild(e)}}SVG.LAYER_STANDARD="LayerStandard",SVG.LAYER_STANDARD_TAG="g";'},40259:t=>{t.exports='function Part(){new Branch(this),this.type=SVG.PART,this.svgTag=SVG.PART_TAG;var v=this,d=(v.isClickThrough=!1,v.isSelectable=!0,v.isOverable=!0,v.isTransformable=!0,v.isResizeable=!0,v.isRotateable=!0,v.isSkewable=!1,v.isMoveable=!0,v.isDeleteable=!0,v.isAspectChangable=!0,v.isEditable=!0,v.isCopyable=!0,v.isLockedContent=!1,v.isTransformableTemp=!0,v.isResizeableTemp=!0,v.isRotateableTemp=!0,v.isSkewableTemp=!1,v.isMoveableTemp=!0,v.isDeleteableTemp=!0,v.isAspectChangableTemp=!0,v.isStrangeCenter=!0,v.sheet=null,v.orgPath=null,v.path=null,v.bleed=null,v.pathVariants=null,v.part_type=null,v.cornersRadius=0,v.height=0,v.width=0,v.originalPathBoundingBox=null,v.orgCornersRadius=0,v.orgHeight=0,v.orgWidth=0,v.backGroundNode=null,v.partGroupNode=null,v.pathNode=null,v.bleedPathNode=null,v.clipPathNode=null,1),h=(v.isReady=!1,v.scaleToFit=1,v.rBBox=null,v.bottomText=null,v.leftText=null,v.tempFilters="",v.preview=null,v.previewBack=null,v.previewFont=null,v.previewClipPath=null,v.stickSize=!1,new Array),n=-1,s=-1,g=-1;function p(e){v.options.matrix&&(t=Raphael.matrix(),t=v.toMatrix(v.options.matrix),(m=v.editor.svg.root.element.createSVGMatrix()).a=parseFloat(t.a),m.b=parseFloat(t.b),m.c=parseFloat(t.c),m.d=parseFloat(t.d),m.e=parseFloat(t.e),m.f=parseFloat(t.f),(t=v.editor.svg.root.element.createSVGTransform()).setMatrix(m),v.partGroupNode.element.transform.baseVal.initialize(t),void 0!==v.options.json&&void 0!==v.options.json.translate&&""!=v.options.json.translate&&2==(t=v.options.json.translate.split(",")).length&&((o=v.editor.svg.root.element.createSVGTransform()).setTranslate(parseFloat(t[0]),parseFloat(t[1])),v.partGroupNode.element.transform.baseVal.appendItem(o),v.partGroupNode.element.transform.baseVal.consolidate()),v.part_type==SVG.PART_TYPE_PATH&&(t=Raphael.mapPath(v.path,Raphael.matrix(m.a,m.b,m.c,m.d,m.e,m.f)),v.path=t.toString()),null!=v.bleed&&(o=Raphael.mapPath(v.bleed,Raphael.matrix(m.a,m.b,m.c,m.d,m.e,m.f)),v.bleed=o.toString())),v.orgPath=v.path,v.orgCornersRadius=v.cornersRadius,v.orgHeight=v.height,v.orgWidth=v.width,v.element.setAttribute("clip-path","url(#editorClip_"+v.options.id+")"),void 0!==v.options.json&&void 0!==v.options.json.sort_order?v.editor.svg.sheet.addPart(v,v.options.json.sort_order):v.editor.svg.sheet.addPart(v),v.editor.svg.sheet.updatePartsOrder(),v.clipPathNode=v.editor.svg.createNode(SVG.CLIP_PATH,{id:"editorClip_"+v.id,path:v.path}),v.tempTransform=v.editor.svg.root.element.createSVGTransform();var t=v.editor.svg.getNodeById("partPathLayer"),o="svgPartPath",o=(v.part_type==SVG.PART_TYPE_IMAGE&&(o+=" partImage"),v.pathNode=v.editor.svg.createNode(SVG.SHAPE_PATH,{parentIntId:t.intId,d:v.path,class:o}),v.pathNode.ignore=!0,v.pathNode.overHandling=SVG.OVER_IGNORE,v.options.visibility&&$(v.pathNode.element).css("visibility",v.options.visibility),v.pathNode.getTransformList(),v.pathNode.element.transform.baseVal.appendItem(v.tempTransform),null!=v.bleed&&(v.bleedPathNode=v.editor.svg.createNode(SVG.SHAPE_PATH,{parentIntId:t.intId,d:v.bleed,class:"svgPartBleedPath"}),v.bleedPathNode.ignore=!0,v.bleedPathNode.overHandling=SVG.OVER_IGNORE,v.bleedPathNode.getTransformList(),v.bleedPathNode.element.transform.baseVal.appendItem(v.tempTransform)),v.editor.svg.sheet.backgroundPattern&&"front"===v.side&&(v.options.background="url(#"+v.editor.id+"-BackgroundPattern)"),null==v.options.background&&(v.options.background="#FFFFFF"),v.path);"bleed"==v.editor.svg.fadePathId&&(o=v.bleed),v.backGroundNode=v.editor.svg.createNode(SVG.SHAPE_PATH,{id:v.id+"PartBackground",parentIntId:v.intId,d:o,fill:v.options.background,stroke:"none"}),v.backGroundNode.ignore=!0,v.backGroundNode.overHandling=SVG.OVER_IGNORE,v.moveChildFirst(v.backGroundNode),v.addDropShadow(),v.isReady=!0,1!=v.scaleToFit&&(v.createBBoxAndCenter(!0),v.beforeTransform(null,!0),v.transform(SVG.TRANSFORM_SCALE,"uni",v.scaleToFit,0,0,0,0,!0),v.afterTransform(!0),v.scaleToFit=1),v.createBBoxAndCenter(),v.editor.svg.sheet.sheet_type==SVG.MODE_SINGLE&&"aspect_scale_single_sticker_by_sheet_dimensions"!=v.editor.model.sheet.aspect&&v.triggerEditorSetWidthAndHeight(!1),v.partGroupNode.element.transform.baseVal.consolidate(),v.orgVariantTransform=v.partGroupNode.element.transform.baseVal.getItem(0),void 0!==e&&e(v)}function l(e,t,o,i,r){e=void 0===e?0:parseFloat(e),t=void 0===t?0:parseFloat(t),o=void 0===o?0:parseFloat(o),i=void 0===i?0:parseFloat(i),r=void 0===r?0:parseFloat(r),0==i&&(i=v.width),0==r&&(r=v.height);var a,n=v.editor.svg.px2mm,s="";if(v.part_type==SVG.PART_TYPE_RECT&&(h=a=0,a=i*n,h=r*n,s=0<v.cornersRadius?(v.haveRoundedCorners=!0,(s=(s=(s=(s="M "+e+", "+((b=Math.min(a,h)/2/100*v.cornersRadius)+t)+" ")+"A "+b+","+b+" 0 0,1 "+(b+e)+","+t+" L "+(a-b+e)+","+t+" ")+"A "+b+","+b+" 0 0,1 "+(a+e)+","+(b+t)+" L "+(a+e)+","+(h-b+t)+" ")+"A "+b+","+b+" 0 0,1 "+(a-b+e)+","+(h+t)+" L "+(b+e)+","+(h+t)+" ")+"A "+b+","+b+" 0 0,1 "+e+","+(h-b+t)+" Z"):(s=(s="M "+e+","+t+" ")+"L "+(a+e)+","+t+" L "+(a+e)+","+(h+t)+" ")+"L "+e+","+(h+t)+" Z"),v.part_type==SVG.PART_TYPE_ROUND&&(s="M "+e+","+((h=r*n)/2+t)+" ",s=(s+="A "+(a=i*n)/2+","+h/2+" 0 0,1 "+(a+e)+","+(h/2+t)+" ")+"A "+a/2+","+h/2+" 0 0,1 "+e+","+(h/2+t)+" Z"),v.part_type==SVG.PART_TYPE_TRIANGLE){var d=i*n,h=Math.sqrt(3)/2*d;if(0<v.cornersRadius){v.haveRoundedCorners=!0;for(var g=d,p=g,l=0;l<5;l++){d+=g-p;var h=Math.sqrt(3)/2*d,u=d/2*(v.cornersRadius/100),b=2*u/(2*Math.sqrt(3)),m=Math.sqrt(3)/2*u,p=d-u-u+b+b}s=(s=(s=(s="M "+(d/2-u/2+e)+","+(m+t)+" ")+("A "+b+","+b+" 0 0,1 "+(d/2+u/2+e)+","+(m+t)+" ")+("L "+(d-u/2+e)+","+(h-m+t)+" "))+("A "+b+","+b+" 0 0,1 "+(d-u+e)+","+(h+t)+" ")+("L "+(u+e)+","+(h+t)+" "))+("A "+b+","+b+" 0 0,1 "+(u/2+e)+","+(h-m+t)+" ")+"Z"}else s="M "+(d/2+e)+","+t+" ",s=(s+="L "+(d+e)+","+(h+t)+" ")+"L "+e+","+(h+t)+" Z"}return v.part_type==SVG.PART_TYPE_IMAGE&&(r=v.options.svg.indexOf("width="),i=v.options.svg.indexOf("height="),a=v.options.svg.substring(r+7),h=v.options.svg.substring(i+8),a=a.substring(0,a.indexOf(\'"\')).trim(),h=h.substring(0,h.indexOf(\'"\')).trim(),s=(s=(s="M "+e+","+t+" ")+"L "+((a=parseInt(a))+e)+","+t+" L "+(a+e)+","+((h=parseInt(h))+t)+" ")+"L "+e+","+(h+t)+" Z"),s=0!=o?Raphael.transformPath(s,"r"+o):s}function a(){var e=v.tempTransform.matrix,e=Raphael.matrix(e.a,e.b,e.c,e.d,e.e,e.f);v.path=Raphael.mapPath(v.path,e).toString(),v.partGroupNode.element.transform.baseVal.insertItemBefore(v.tempTransform,0),v.partGroupNode.element.transform.baseVal.consolidate(),v.element.transform.baseVal.clear(),v.tempTransform=v.editor.svg.root.element.createSVGTransform(),null!=v.backGroundNode&&v.backGroundNode.element.setAttribute("d",v.path),v.pathNode.element.transform.baseVal.clear(),v.pathNode.getTransformList(),v.pathNode.element.transform.baseVal.appendItem(v.tempTransform),v.pathNode.element.setAttribute("d",v.path),v.updatePath(),v.clipPathNode.clipPathPath.element.setAttribute("d",v.path),v.editor.svg.shadow.updateShadow()}function o(e){return e*e}function u(e,t){return o(e.x-t.x)+o(e.y-t.y)}function b(e,t){this.x=e,this.y=t}v.oldMatrix="",v.pathMarked=!1,v.oldMarkDash=null,v.oldMarkLine=null,v.background_cmyk=null,v.side=null,v.createElement=function(n){var e,t,s,o=!1,i=!1,r=(v.options.json&&((r=v.options.json).id&&(v.options.id=r.id),r.part_id&&(v.options.id=r.part_id),r.cuttingline&&(v.options.path=r.cuttingline),r.bleed&&(v.options.bleed=r.bleed),r.background&&(v.options.background=r.background),r.background_cmyk&&(v.options.background_cmyk=r.background_cmyk),r.backgroundPattern&&(v.options.backgroundPattern=r.backgroundPattern),r.part_type&&(v.options.part_type=r.part_type),r.width&&(v.options.width=r.width),r.height&&(v.options.height=r.height),r.cornersRadius&&(v.options.cornersRadius=parseInt(r.cornersRadius)),r.bleed_margin&&(v.options.bleed_margin=r.bleed_margin),r.svg&&(v.options.svg=r.svg),r.matrix&&(v.options.matrix=r.matrix),r.visibility&&(v.options.visibility=r.visibility),r.flags&&(v.options.flags=r.flags),void 0!==r.rotateable&&(v.options.rotateable=r.rotateable),void 0!==r.resizeable&&(v.options.resizeable=r.resizeable),void 0!==r.aspectchangable&&(v.options.aspectchangable=r.aspectchangable),void 0!==r.moveable&&(v.options.moveable=r.moveable),void 0!==r.skewable&&(v.options.skewable=r.skewable),void 0!==r.editable&&(v.options.editable=r.editable),void 0!==r.deleteable&&(v.options.deleteable=r.deleteable),void 0!==r.aspectChangable&&(v.options.aspectChangable=r.aspectChangable),void 0!==r.copyable&&(v.options.copyable=r.copyable),void 0!==r.lockedContent&&(v.options.lockedContent=r.lockedContent),void 0!==r._originalPathBoundingBox&&(v.originalPathBoundingBox=r._originalPathBoundingBox),r.meta&&r.meta.CMYK_BACKGROUND&&(v.options.background_cmyk=r.meta.CMYK_BACKGROUND),r.preview&&(v.options.preview=new Array,v.options.preview.back=r.preview.back,v.options.preview.front=r.preview.front,v.options.preview.clippath=r.preview.clippath),r.side&&(v.side=r.side)),0),a=0,d=0,h=0,g=0;if(v.options.svg&&(-1!=(t=v.options.svg.search("dataHeight"))&&(e=(t=v.options.svg.substring(t+12)).search(\'"\'),t=t.substring(0,e),a=parseFloat(t)),-1!=(e=v.options.svg.search("dataWidth"))&&(e=(t=v.options.svg.substring(e+11)).search(\'"\'),t=t.substring(0,e),r=parseFloat(t)),-1!=(e=v.options.svg.search("dataCornersRadius"))&&(e=(t=v.options.svg.substring(e+19)).search(\'"\'),t=t.substring(0,e),v.options.cornersRadius=parseFloat(t)),-1!=(e=v.options.svg.search("dataOffsetX"))&&(e=(t=v.options.svg.substring(e+13)).search(\'"\'),t=t.substring(0,e),d=parseFloat(t)),-1!=(e=v.options.svg.search("dataOffsetY"))&&(e=(t=v.options.svg.substring(e+13)).search(\'"\'),t=t.substring(0,e),h=parseFloat(t)),-1!=(e=v.options.svg.search("dataRotation"))&&(e=(t=v.options.svg.substring(e+14)).search(\'"\'),t=t.substring(0,e),g=parseFloat(t))),v.element.setAttribute("id",v.options.id),v.id=v.options.id,v.options.visibility&&$(v.element).css("visibility",v.options.visibility),v.options.background_cmyk&&(v.background_cmyk=v.options.background_cmyk),v.options.preview&&(v.preview=new Array,v.preview.back=v.options.preview.back,v.preview.front=v.options.preview.front,v.preview.clippath=v.options.preview.clippath,(s=new Array).parentIntId=v.editor.svg.getNodeById("preBottomLayer").intId,s.href=v.preview.back,v.previewBack=v.editor.svg.createNode(SVG.SHAPE_IMAGE,s,function(e){v.editor.helpers.preview.scaleImageToSheet(e),$(e.element).hide(),v.editor.helpers.preview.updatePreview()}),(s=new Array).parentIntId=v.editor.svg.getNodeById("preTopLayer").intId,s.href=v.preview.front,v.previewFont=v.editor.svg.createNode(SVG.SHAPE_IMAGE,s,function(e){v.editor.helpers.preview.scaleImageToSheet(e),$(e.element).hide(),v.editor.helpers.preview.updatePreview()}),(s=new Array).path=v.preview.clippath,v.previewClipPath=v.editor.svg.createNode(SVG.CLIP_PATH,s)),v.options.meta&&v.options.meta.background_cmyk&&(v.background_cmyk=v.options.meta.background_cmyk),v.options.height&&(v.height=v.options.height),v.options.width&&(v.width=v.options.width),v.options.cornersRadius&&(v.cornersRadius=parseInt(v.options.cornersRadius)),void 0!==v.options.flags&&v.deSerializeFlags(v.options.flags),void 0!==v.options.rotateable&&(v.isRotateable=v.options.rotateable),void 0!==v.options.resizeable&&(v.isResizeable=v.options.resizeable),void 0!==v.options.aspectchangable&&(v.isAspectChangable=v.options.aspectchangable),void 0!==v.options.moveable&&(v.isMoveable=v.options.moveable),void 0!==v.options.skewable&&(v.isSkewable=v.options.skewable),void 0!==v.options.editable&&(v.isEditable=v.options.editable),void 0!==v.options.deleteable&&(v.isDeleteable=v.options.deleteable),void 0!==v.options.copyable&&(v.isCopyable=v.options.copyable),void 0!==v.options.lockedContent&&(v.isLockedContent=v.options.lockedContent),v.options.part_type?v.part_type=v.options.part_type:v.part_type=SVG.PART_TYPE_PATH,v.options.svg&&""!=v.options.svg&&(o=!0),v.options.bleed&&(v.bleed=v.options.bleed),isNaN(v.options.height)&&(v.height=v.options.height=v.editor.svg.sheet.height),isNaN(v.options.width)&&(v.width=v.options.width=v.editor.svg.sheet.width),v.part_type==SVG.PART_TYPE_PATH)v.options.path?v.path=v.options.path:i=!0,v.isAspectChangable=!1;else{switch(v.part_type){case SVG.PART_TYPE_RECT:case SVG.PART_TYPE_ROUND:case SVG.PART_TYPE_TRIANGLE:v.isOptionSet("aspectchangable")||(v.isAspectChangable=!0);break;case SVG.PART_TYPE_IMAGE:v.isAspectChangable=!1,v.isEditable=!1}void 0!==v.options.aspectChangable&&(v.isAspectChangable=v.options.aspectChangable),v.path=l(d,h,g,r,a)}v.editor.svg.mode==SVG.MODE_SINGLE&&null!=v.path&&((s=new Array).path=v.path,v.previewClipPath=v.editor.svg.createNode(SVG.CLIP_PATH,s)),v.partGroupNode=v.editor.svg.createNode(SVG.GROUP_STANDARD,{parentIntId:v.intId,id:v.id+"_partGroup"}),v.partGroupNode.ignore=!0,v.partGroupNode.overHandling=SVG.OVER_IGNORE,v.partGroupNode.getTransformList(),o?v.editor.helpers.importHelper.importSVGData(v.options.svg,v.partGroupNode,function(e){var r,a;if(null==e)return o=!1,v.part_type=SVG.PART_TYPE_RECT,v.isAspectChangable=!0,e=2*v.editor.svg.px2mm,v.path=l(e,e,0,v.width,v.height),(s=new Array).path=v.path,v.previewClipPath=v.editor.svg.createNode(SVG.CLIP_PATH,s),v.scaleToFit=1,v.editor.error="editor_image_error",void p(n);i?1==v.partGroupNode.children.length&&v.partGroupNode.children[0].type==SVG.SHAPE_MULTI?(r=v.partGroupNode.children[0].children[0],a=0,a=v.height/r.imageHeight>v.width/r.imageWidth?r.imageHeight/v.height:r.imageWidth/v.width,v.editor.helpers.outline.outlineImg(r.link,r.imageWidth,r.imageHeight,a,v.width,v.height,function(e,t){var o,i;"rect"==e?(v.part_type=SVG.PART_TYPE_RECT,v.isAspectChangable=!0,o=2*v.editor.svg.px2mm,v.path=l(0,0,0,r.imageWidth/v.editor.svg.px2mm,r.imageHeight/v.editor.svg.px2mm),i=1,i=parseFloat(r.imageWidth)>parseFloat(r.imageHeight)?(parseFloat(r.imageWidth)+2*o)/parseFloat(r.imageWidth):(parseFloat(r.imageHeight)+2*o)/parseFloat(r.imageHeight),r.beforeTransform(null,!0),r.transform(SVG.TRANSFORM_SCALE,"center",i,0,0,0,0,!0),r.afterTransform(!0),(s=new Array).path=v.path,v.previewClipPath=v.editor.svg.createNode(SVG.CLIP_PATH,s),v.scaleToFit=1/(a/v.editor.svg.px2mm)):(v.path=e,v.pathVariants=t,(s=new Array).path=e,v.previewClipPath=v.editor.svg.createNode(SVG.CLIP_PATH,s),v.scaleToFit=v.scalePathToFitWidthAndHeight()),p(n)})):console.log("not image"):p(n)}):i||p(n)},v.isOptionSet=function(e){return void 0!==v.options[e]},v.triggerEditorSetWidthAndHeight=function(e){v.editor.svg.imperial?v.editor.trigger("editorSetWidthAndHeight",{width:Math.round(v.width/2.54)/10,height:Math.round(v.height/2.54)/10,triggerQuantity:e}):v.editor.trigger("editorSetWidthAndHeight",{width:Math.round(v.width)/10,height:Math.round(v.height)/10,triggerQuantity:e})},v.createBBoxAndCenter=function(){var e;v.editor.svg.runBBox&&v.isReady&&(e=v.getTransformationMatrix(),e=Raphael.mapPath(v.orgPath,Raphael.matrix(e.a,e.b,e.c,e.d,e.e,e.f)),v.path=e.toString(),e=Raphael.pathBBox(e),v.boundingBox=v.editor.svg.root.element.createSVGRect(),v.boundingBox.width=e.width,v.boundingBox.height=e.height,v.boundingBox.x=e.x,v.boundingBox.y=e.y,v.center=v.editor.svg.root.element.createSVGPoint(),v.center.x=e.x+(e.x2-e.x)/2,v.center.y=e.y+(e.y2-e.y)/2,v.updatePath(),v.rBBox=Raphael.pathBBox(v.path),v.height=v.boundingBox.height/v.editor.svg.px2mm,v.width=v.boundingBox.width/v.editor.svg.px2mm,v.orgHeight=v.height,v.orgWidth=v.width,v.editor.svg.mode==SVG.MODE_SINGLE&&(v.editor.svg.sheet.height=v.height,v.editor.svg.sheet.width=v.width,v.editor.svg.sheet.createBBoxAndCenter()))},v.addDropShadow=function(){v.editor.svg.mode==SVG.MODE_SINGLE&&(v.backGroundNode.element.setAttribute("filter","url(#drop_shadow)"),$(v.pathNode.element).addClass("dropShadow"))},v.removeDropShadow=function(){v.editor.svg.mode==SVG.MODE_SINGLE&&(v.backGroundNode.element.removeAttribute("filter"),$(v.pathNode.element).removeClass("dropShadow"))},v.updatePath=function(){e=v.editor.svg.root.element.viewBox.baseVal.height,t=v.editor.svg.root.element.viewBox.baseVal.width,i=$(v.editor.container).height(),o=$(v.editor.container).width(),i/=e,e=o/t,o=v.pathNode.getTransformationMatrix(),t=Math.sqrt(Math.pow(o.a,2)+Math.pow(o.b,2)),o=Math.sqrt(Math.pow(o.c,2)+Math.pow(o.d,2)),d=1/Math.min(i*t,e*o);var e,t,o,i=parseFloat(v.editor.svg.getStyle(".svgPartPath","stroke-width"));$(v.pathNode.element).css("stroke-width",(i*d).toString(10)),null!=v.bleedPathNode&&$(v.bleedPathNode.element).css("stroke-width",parseFloat(i*d)),v.createPathPointArray(100)},v.deactivate=function(){v.isClickThrough=!1,v.isSelectable=!0,v.isOverable=!0,v.isTransformable=v.isTransformableTemp,v.isResizeable=v.isResizeableTemp,v.isRotateable=v.isRotateableTemp,v.isSkewable=v.isSkewableTemp,v.isMoveable=v.isMoveableTemp,v.isDeleteable=v.isDeleteableTemp,v.isAspectChangable=v.isAspectChangableTemp,v.isGrouped=!0,v.element.setAttribute("clip-path","url(#editorClip_"+v.options.id+")")},v.activate=function(){v.isTransformableTemp=v.isTransformable,v.isResizeableTemp=v.isResizeable,v.isRotateableTemp=v.isRotateable,v.isSkewableTemp=v.isSkewable,v.isMoveableTemp=v.isMoveable,v.isDeleteableTemp=v.isDeleteable,v.isAspectChangableTemp=v.isAspectChangable,v.editor.svg.mode==SVG.MODE_SINGLE?(v.isSelectable=!0,v.isOverable=!0,v.isTransformable=!0):(v.editor.svg.mode==SVG.MODE_SHEET?(v.isSelectable=!0,v.isOverable=!0,v.isTransformable=!0):(v.isSelectable=!1,v.isOverable=!1,v.isTransformable=!1),v.isResizeable=!1),"back"!==v.side&&"back_deal"!==v.side||(v.isTransformable=!1,v.isAspectChangable=!1),v.isClickThrough=!0,v.isRotateable=!1,v.isSkewable=!1,v.isMoveable=!1,v.isGrouped=!1,v.element.setAttribute("clip-path","none")},v.setBackground=function(e){null!=v.backGroundNode?v.backGroundNode.element.setAttribute("fill",e):(v.backGroundNode=v.editor.svg.createNode(SVG.SHAPE_PATH,{id:v.id+"PartBackground",parentIntId:v.intId,d:v.path,fill:e,stroke:"none"}),v.backGroundNode.ignore=!0,v.backGroundNode.overHandling=SVG.OVER_IGNORE,v.moveChildFirst(v.backGroundNode))},v.setCMYKBackground=function(e){v.background_cmyk=e},v.getCMYKBackground=function(){return v.background_cmyk},v.changeAspect=function(e,t,o,i,r){i=void 0===i||i,r=void 0!==r&&r;var a=v.editor.svg.px2mm,n=0,s=0,d=v.width,h=v.height;if(v.part_type==SVG.PART_TYPE_PATH||r){var g=1;switch(e){case"height":g=o/v.height;break;case"width":g=t/v.width}v.height*g<SVG.PART_MIN_SIDE&&(g=SVG.PART_MIN_SIDE/v.height),v.width*g<SVG.PART_MIN_SIDE&&(g=SVG.PART_MIN_SIDE/v.width),v.beforeTransform(null,!0),v.transform(SVG.TRANSFORM_SCALE,"center",g,0,0,0,0,!0),v.afterTransform(!0,null)}else{switch(e){case"height":o=(h-(v.height=o))*a,v.part_type==SVG.PART_TYPE_TRIANGLE&&(v.width=v.height/(Math.sqrt(3)/2),n=o/2),s=o/2;break;case"width":t=(d-(v.width=t))*a,v.part_type==SVG.PART_TYPE_TRIANGLE&&(v.height=Math.sqrt(3)/2*v.width,s=Math.sqrt(3)/2*t/2),n=t/2;break;case"n":v.height=(v.orgHeight*a-o)/a,v.part_type==SVG.PART_TYPE_TRIANGLE&&(v.width=v.height/(Math.sqrt(3)/2),n=o/Math.sqrt(3)),s=o;break;case"ne":var p=(o-t)/2;v.height=(v.orgHeight*a-p)/a,v.width=(v.orgWidth*a-p)/a,s=p;break;case"e":v.width=(v.orgWidth*a-t)/a,v.part_type==SVG.PART_TYPE_TRIANGLE&&(v.height=Math.sqrt(3)/2*v.width,s=-Math.sqrt(3)/2*t/2),n=t;break;case"se":p=(-t-o)/2;v.height=(v.orgHeight*a-p)/a,v.width=(v.orgWidth*a-p)/a;break;case"s":v.height=(v.orgHeight*a+o)/a,v.part_type==SVG.PART_TYPE_TRIANGLE&&(v.width=v.height/(Math.sqrt(3)/2),n=-o/Math.sqrt(3));break;case"sw":p=(o-t)/2;v.height=(v.orgHeight*a+p)/a,v.width=(v.orgWidth*a+p)/a,n=-p;break;case"w":v.width=(v.orgWidth*a+t)/a,v.part_type==SVG.PART_TYPE_TRIANGLE&&(v.height=Math.sqrt(3)/2*v.width,s=Math.sqrt(3)/2*t/2);break;case"nw":p=(o+t)/2;v.height=(v.orgHeight*a-p)/a,v.width=(v.orgWidth*a-p)/a,n=s=p}v.height<SVG.PART_MIN_SIDE&&(v.height=SVG.PART_MIN_SIDE,0<o&&(s=(v.orgHeight-v.height)*a)),v.width<SVG.PART_MIN_SIDE&&(v.width=SVG.PART_MIN_SIDE,0<t&&(n=(v.orgWidth-v.width)*a)),v.editor.svg.sheet.sheet_type==SVG.MODE_SHEET?(n+=v.rBBox.x,(s+=v.rBBox.y)<0&&(v.height+=s/a,s=0),n<0&&(v.width+=n/a,n=0),s+v.height*a>v.editor.svg.sheet.boundingBox.height&&(v.height=(v.editor.svg.sheet.boundingBox.height-s)/a),n+v.width*a>v.editor.svg.sheet.boundingBox.width&&(v.width=(v.editor.svg.sheet.boundingBox.width-n)/a)):(v.height>v.editor.model.editor.max_size&&(v.height=SVG.PART_MAX_SIDE,o<0&&(s=(v.orgHeight-v.height)*a)),v.width>v.editor.model.editor.max_size&&(v.width=SVG.PART_MAX_SIDE,t<0&&(n=(v.orgWidth-v.width)*a))),v.path=l(n,s),v.clipPathNode.clipPathPath.element.setAttribute("d",v.path),v.pathNode.element.setAttribute("d",v.path),null!=v.backGroundNode&&v.backGroundNode.element.setAttribute("d",v.path),v.editor.svg.shadow.updateShadow(v.path),i&&v.editor.svg.sheet.sheet_type==SVG.MODE_SINGLE&&v.triggerEditorSetWidthAndHeight(!1)}},v.afterChangeAspect=function(e,t){var o,i,r;e=void 0===e||e,t=void 0!==t&&t,a(),v.orgPath=v.path,v.orgCornersRadius=v.cornersRadius,v.orgHeight=v.height,v.orgWidth=v.width,v.createBBoxAndCenter(),e&&v.editor.svg.sheet.sheet_type==SVG.MODE_SINGLE&&0!=Math.round(v.width)&&0!=Math.round(v.height)&&v.triggerEditorSetWidthAndHeight(!0),v.editor.svg.sheet.sheet_type!=SVG.MODE_SINGLE||t||(e=v.editor.svg.root.getX()-v.boundingBox.x,t=v.editor.svg.root.getY()-v.boundingBox.y,v.tempTransform.setTranslate(-1*v.boundingBox.x,-1*v.boundingBox.y),a(),v.orgPath=v.path,v.createBBoxAndCenter(),v.editor.svg.shadow.updateShadow(),v.editor.svg.root.updateViewBox(e+" "+t+" "+v.editor.svg.root.getWidth()+" "+v.editor.svg.root.getHeight()),v.editor.svg.zoom==SVG.ZOOM_PART&&v.editor.svg.changeMode(SVG.ZOOM_PART,v)),v.lastTransformType==SVG.TRANSFORM_ROTATE&&(v.boundingBox.height>v.editor.svg.sheet.boundingBox.height&&(o=v.editor.svg.sheet.boundingBox.height/v.boundingBox.height,o-=.01,v.beforeTransform(null,!0),v.transform(SVG.TRANSFORM_SCALE,"uni",o,0,0,0,0,!0),v.lastTransformType=SVG.TRANSFORM_ROTATE,v.afterTransform(!0)),v.boundingBox.width>v.editor.svg.sheet.boundingBox.width&&(o=v.editor.svg.sheet.boundingBox.width/v.boundingBox.width,o-=.01,v.beforeTransform(null,!0),v.transform(SVG.TRANSFORM_SCALE,"uni",o,0,0,0,0,!0),v.lastTransformType=SVG.TRANSFORM_ROTATE,v.afterTransform(!0)),v.boundingBox.x<v.editor.svg.sheet.boundingBox.x&&(i=v.editor.svg.sheet.boundingBox.x-v.boundingBox.x+1,v.beforeTransform(null,!0),v.transform(SVG.TRANSFORM_MOVE,i,0,0,0,0,0,!0),v.lastTransformType=SVG.TRANSFORM_ROTATE,v.afterTransform(!0)),v.boundingBox.y<v.editor.svg.sheet.boundingBox.y&&(r=v.editor.svg.sheet.boundingBox.y-v.boundingBox.y+1,v.beforeTransform(null,!0),v.transform(SVG.TRANSFORM_MOVE,0,r,0,0,0,0,!0),v.lastTransformType=SVG.TRANSFORM_ROTATE,v.afterTransform(!0)),v.boundingBox.x+v.boundingBox.width>v.editor.svg.sheet.boundingBox.x+v.editor.svg.sheet.boundingBox.width&&(i=v.editor.svg.sheet.boundingBox.x+v.editor.svg.sheet.boundingBox.width-(v.boundingBox.x+v.boundingBox.width)-1,v.beforeTransform(null,!0),v.transform(SVG.TRANSFORM_MOVE,i,0,0,0,0,0,!0),v.lastTransformType=SVG.TRANSFORM_ROTATE,v.afterTransform(!0)),v.boundingBox.y+v.boundingBox.height>v.editor.svg.sheet.boundingBox.y+v.editor.svg.sheet.boundingBox.height&&(r=v.editor.svg.sheet.boundingBox.y+v.editor.svg.sheet.boundingBox.height-(v.boundingBox.y+v.boundingBox.height)-1,v.beforeTransform(null,!0),v.transform(SVG.TRANSFORM_MOVE,0,r,0,0,0,0,!0),v.lastTransformType=SVG.TRANSFORM_ROTATE,v.afterTransform(!0))),v.lastTransformType=null},v.transforming=function(e,t,o){var i,r;if(e==SVG.TRANSFORM_SCALE)return e=v.height*t,i=v.width*t,r=t,v.editor.svg.sheet.sheet_type!=SVG.MODE_SINGLE?(("sw"==o||"se"==o)&&e*v.editor.svg.px2mm+v.boundingBox.y>v.editor.svg.sheet.boundingBox.height&&(r=(v.editor.svg.sheet.boundingBox.height-v.boundingBox.y)/v.editor.svg.px2mm/v.height,e=(v.editor.svg.sheet.boundingBox.height-v.boundingBox.y)/v.editor.svg.px2mm,i=v.width*r),("ne"==o||"se"==o)&&i*v.editor.svg.px2mm+v.boundingBox.x>v.editor.svg.sheet.boundingBox.width&&(r=(v.editor.svg.sheet.boundingBox.width-v.boundingBox.x)/v.editor.svg.px2mm/v.width,i=(v.editor.svg.sheet.boundingBox.width-v.boundingBox.x)/v.editor.svg.px2mm,e=v.height*r),("nw"==o||"ne"==o)&&v.boundingBox.height+v.boundingBox.y-e*v.editor.svg.px2mm<v.editor.svg.sheet.boundingBox.y&&(r=(v.boundingBox.height+v.boundingBox.y-v.editor.svg.sheet.boundingBox.y)/v.editor.svg.px2mm/v.height,e=(v.boundingBox.height+v.boundingBox.y-v.editor.svg.sheet.boundingBox.y)/v.editor.svg.px2mm,i=v.width*r),("nw"==o||"sw"==o)&&v.boundingBox.width+v.boundingBox.x-i*v.editor.svg.px2mm<v.editor.svg.sheet.boundingBox.x&&(r=(v.boundingBox.width+v.boundingBox.x-v.editor.svg.sheet.boundingBox.x)/v.editor.svg.px2mm/v.width,i=(v.boundingBox.width+v.boundingBox.x-v.editor.svg.sheet.boundingBox.x)/v.editor.svg.px2mm,e=v.height*r),"all"==o&&(e/2*v.editor.svg.px2mm+(v.boundingBox.y+v.boundingBox.height/2)>v.editor.svg.sheet.boundingBox.height&&(r=(v.editor.svg.sheet.boundingBox.height-(v.boundingBox.y+v.boundingBox.height/2))/v.editor.svg.px2mm/(v.height/2),e=(v.editor.svg.sheet.boundingBox.height-(v.boundingBox.y+v.boundingBox.height/2))/v.editor.svg.px2mm*2,i=v.width*r),i/2*v.editor.svg.px2mm+(v.boundingBox.x+v.boundingBox.width/2)>v.editor.svg.sheet.boundingBox.width&&(r=(v.editor.svg.sheet.boundingBox.width-(v.boundingBox.x+v.boundingBox.width/2))/v.editor.svg.px2mm/(v.width/2),i=(v.editor.svg.sheet.boundingBox.width-(v.boundingBox.x+v.boundingBox.width/2))/v.editor.svg.px2mm*2,e=v.height*r),v.boundingBox.height/2+v.boundingBox.y-e/2*v.editor.svg.px2mm<v.editor.svg.sheet.boundingBox.y&&(r=(v.boundingBox.height/2+v.boundingBox.y-v.editor.svg.sheet.boundingBox.y)/v.editor.svg.px2mm/(v.height/2),e=(v.boundingBox.height/2+v.boundingBox.y-v.editor.svg.sheet.boundingBox.y)/v.editor.svg.px2mm*2,i=v.width*r),v.boundingBox.width/2+v.boundingBox.x-i/2*v.editor.svg.px2mm<v.editor.svg.sheet.boundingBox.x&&(r=(v.boundingBox.width/2+v.boundingBox.x-v.editor.svg.sheet.boundingBox.x)/v.editor.svg.px2mm/(v.width/2),i=(v.boundingBox.width/2+v.boundingBox.x-v.editor.svg.sheet.boundingBox.x)/v.editor.svg.px2mm*2,e=v.height*r)),e<SVG.PART_MIN_SIDE&&(r=SVG.PART_MIN_SIDE/v.height,e=SVG.PART_MIN_SIDE,i=v.width*r),i<SVG.PART_MIN_SIDE&&(r=SVG.PART_MIN_SIDE/v.width,i=SVG.PART_MIN_SIDE,e=v.height*r),v.height=e,v.width=i,t=r):e<SVG.PART_MIN_SIDE||i<SVG.PART_MIN_SIDE?(t=SVG.PART_MIN_SIDE/Math.min(v.height,v.width),v.height=v.height*t,v.width=v.width*t):e>SVG.PART_MAX_SIDE||i>SVG.PART_MAX_SIDE?(t=SVG.PART_MAX_SIDE/Math.max(v.height,v.width),v.height=v.height*t,v.width=v.width*t):(v.height=e,v.width=i),v.editor.svg.sheet.sheet_type==SVG.MODE_SINGLE&&v.triggerEditorSetWidthAndHeight(!1),t},v.specialBeforeTransform=function(){v.tempFilters=v.backGroundNode.element.getAttribute("filter"),v.backGroundNode.element.setAttribute("filter","")},v.specialTransform=function(e){v.tempTransform.setMatrix(e),v.pathNode.element.transform.baseVal.initialize(v.tempTransform),v.updatePath(),v.editor.svg.shadow.updateShadow(),v.editor.svg.sheet.sheet_type!=SVG.MODE_SHEET&&1!=v.stickySizeLabels||v.showSize(e)},v.specialAfterTransform=function(e){null!=v.bottomText&&(v.bottomText.remove(),v.bottomText=null),null!=v.leftText&&(v.leftText.remove(),v.leftText=null),v.afterChangeAspect(),v.backGroundNode.element.setAttribute("filter",v.tempFilters),v.editor.svg.filters.UpdateDropShadow(),v.tempFilters=""},v.setCornersRadius=function(e){v.cornersRadius=parseInt(e);var t,e=0,o=0;v.editor.svg.sheet.sheet_type!=SVG.MODE_SINGLE&&(e=(t=v.partGroupNode.element.getAttribute("transform").match(/\\d+\\.?\\d*/g))[4],o=t[5]),v.path=l(e,o)},v.setPartType=function(e,o,t,i){i=void 0===i?null:i;var r=v.part_type;if("path-org"!=(v.part_type=e)&&"path-s"!=e&&"path-m"!=e&&"path-l"!=e&&"path-x"!=e&&"path-new-x"!=e||(v.part_type=SVG.PART_TYPE_PATH),"path-included"==e)v.path=i,v.part_type=SVG.PART_TYPE_PATH,v.isAspectChangable=!1,v.isAspectChangableTemp=!1,v.afterChangeAspect(),v.editor.svg.zoom==SVG.ZOOM_PART&&v.editor.svg.sheet.sheet_type==SVG.MODE_SHEET&&v.editor.svg.changeMode(SVG.ZOOM_PART,v),void 0!==o&&o();else if(v.part_type==SVG.PART_TYPE_PATH){if(0==v.partGroupNode.children.length)return v.editor.ui.showMessage(3,1,v.editor.helpers.message.getId(),"Part: "+v.id),v.part_type=r,!1;v.isAspectChangable=!1;for(var a=!(v.isAspectChangableTemp=!1),n=0;n<v.partGroupNode.children.length;n++)v.partGroupNode.children[n].type!=SVG.SHAPE_TEXT&&(a=!1);v.editor.helpers.outline.outlineSvg(v,function(e,t){t=void 0!==t&&t,v.path=e,v.afterChangeAspect(!0,!0);e=1;v.height<SVG.PART_MIN_SIDE&&(e=SVG.PART_MIN_SIDE/v.height),1<(e=v.width*e<SVG.PART_MIN_SIDE?SVG.PART_MIN_SIDE/v.width:e)?(v.beforeTransform(null,!0),v.transform(SVG.TRANSFORM_SCALE,"center",e,0,0,0,0,!0),v.afterTransform(!0)):v.editor.svg.sheet.sheet_type==SVG.MODE_SINGLE&&v.afterChangeAspect(),v.editor.svg.zoom==SVG.ZOOM_PART&&v.editor.svg.sheet.sheet_type==SVG.MODE_SHEET&&v.editor.svg.changeMode(SVG.ZOOM_PART,v),t?v.setPartType(SVG.PART_TYPE_RECT,o):void 0!==o&&o()},a,e)}else{switch(v.part_type){case SVG.PART_TYPE_RECT:case SVG.PART_TYPE_ROUND:case SVG.PART_TYPE_TRIANGLE:v.isAspectChangable=!0,v.isAspectChangableTemp=!0}i=0,r=0;v.editor.svg.sheet.sheet_type!=SVG.MODE_SINGLE&&(i=v.pathNode.boundingBox.x,r=v.pathNode.boundingBox.y),v.path=l(i,r),v.afterChangeAspect(),v.editor.svg.shadow.updateShadow(),void 0!==o&&o()}},v.adaptToContent=function(){var e,t;v.part_type==SVG.PART_TYPE_RECT&&(v.width=v.partGroupNode.boundingBox.width/v.editor.svg.px2mm+20,v.height=v.partGroupNode.boundingBox.height/v.editor.svg.px2mm+20,e=v.partGroupNode.boundingBox.x-10,t=v.partGroupNode.boundingBox.y-10,v.path=l(e,t),v.afterChangeAspect())},v.onSelect=function(){},v.onDeSelect=function(){v.editor.svg.sheet.sheet_type==SVG.MODE_SHEET&&v.editor.svg.zoom==SVG.ZOOM_SHEET&&(v.editor.svg.activePart=null)},v.scalePathToFitWidthAndHeight=function(){var e=Raphael.pathBBox(v.path),t=v.width/(e.width/v.editor.svg.px2mm),o=v.height/(e.height/v.editor.svg.px2mm),t=Math.min(t,o);return t=(t=t*(e.width/v.editor.svg.px2mm)<SVG.PART_MIN_SIDE?SVG.PART_MIN_SIDE/(e.width/v.editor.svg.px2mm):t)*(e.height/v.editor.svg.px2mm)<SVG.PART_MIN_SIDE?SVG.PART_MIN_SIDE/(e.height/v.editor.svg.px2mm):t},v.checkRotationBorder=function(e){e=Raphael.transformPath(v.path,"r"+e),e=Raphael.pathBBox(e);return!(e.x<v.editor.svg.sheet.boundingBox.x)&&(!(e.x2>v.editor.svg.sheet.boundingBox.x+v.editor.svg.sheet.boundingBox.width)&&(!(e.y<v.editor.svg.sheet.boundingBox.y)&&!(e.y2>v.editor.svg.sheet.boundingBox.y+v.editor.svg.sheet.boundingBox.height)))},v.getMenuOptions=function(){var e;return v.editor.svg.zoom==SVG.ZOOM_SHEET?(e=new Array,-1<window.location.href.indexOf("admin.")&&(e.push(SELECT_MENU_PART_UP),e.push(SELECT_MENU_PART_DOWN)),v.isEditable&&e.push(SELECT_MENU_EDIT),v.isCopyable&&e.push(SELECT_MENU_COPY),v.isMoveable&&(e.push(SELECT_MENU_CENTER_HOR),e.push(SELECT_MENU_CENTER_VER)),v.isDeleteable&&e.push(SELECT_MENU_DELETE),e):null},v.preRemove=function(e){for(var t=0;t<v.children.length;t++)v.children[t].preRemove();null!=v.backGroundNode&&v.backGroundNode.remove(),null!=v.pathNode&&v.pathNode.remove(),null!=v.bleedPathNode&&v.bleedPathNode.remove(),null!=v.clipPathNode&&v.clipPathNode.remove(),v.editor.svg.sheet.parts.splice(v.editor.svg.sheet.parts.indexOf(v),1),setTimeout(function(){void 0!==e&&e()},0)},v.onEditMenu=function(){v.editor.svg.sheetZoomable&&v.isEditable&&(v.editor.svg.zoom==SVG.ZOOM_SHEET?v.editor.svg.changeMode(SVG.ZOOM_PART,v):v.editor.svg.zoom==SVG.ZOOM_PART&&v.editor.svg.changeMode(SVG.ZOOM_SHEET))},v.hideSize=function(){if(v.stickySizeLabels)return!1;null!=v.bottomText&&(v.bottomText.remove(),v.bottomText=null),null!=v.leftText&&(v.leftText.remove(),v.leftText=null)},v.showSize=function(e){if(e=void 0===e?v.getBaseTransformationMatrix():e,0!=Math.atan2(e.b,e.a))return null!=v.bottomText&&(v.bottomText.remove(),v.bottomText=null),void(null!=v.leftText&&(v.leftText.remove(),v.leftText=null));var t=0,o=0,o=v.editor.svg.imperial?(t=Math.round(v.width/2.54)/10,Math.round(v.height/2.54)/10):(t=Math.round(v.width)/10,Math.round(v.height)/10),i=(a=v.isAspectChangable?Raphael.pathBBox(v.path):v.boundingBox,v.editor.svg.root.element.createSVGPoint()),r=(i.x=a.x,i.x||(i.x=1),i.y=a.y,i.y||(i.y=1),i=i.matrixTransform(e),v.editor.svg.root.element.createSVGPoint()),a=(r.x=a.x+a.width,r.x||(r.x=1),r.y=a.y+a.height,r.y||(r.y=1),r=r.matrixTransform(e),25*d*e.a),n=(isFinite(a)||(a=1),e=!0===v.editor.isLargeMode()?15*d*e.a:11*d*e.a,isFinite(e)||(e=1),new Array);n.top=r.y+a,v.editor.helpers.select.invertedRotation&&(n.top=i.y-a),n.parentId="infoLayer",n.left=(i.x+r.x)/2,n.size=e,n.anchor="middle",n.text=t+v.editor.svg.language.cm,n.class="svgPartSizeText","front"!=v.side&&null!=v.side||(null!=v.bottomText&&v.bottomText.remove(),v.bottomText=v.editor.svg.createNode(SVG.SHAPE_TEXT,n),v.bottomText.overHandling=SVG.OVER_NEVER,n.left=r.x+e,n.top=(i.y+r.y)/2,n.text=o+v.editor.svg.language.cm,n.transform="rotate(90 "+n.left+", "+n.top+")",null!=v.leftText&&v.leftText.remove(),v.leftText=v.editor.svg.createNode(SVG.SHAPE_TEXT,n),v.leftText.overHandling=SVG.OVER_NEVER)},v.copy=function(e){v.pathNode.createBBoxAndCenter(),v.partGroupNode.createBBoxAndCenter(),v.pathNode.element.transform.baseVal.consolidate(),v.partGroupNode.element.transform.baseVal.consolidate(),null!=v.backGroundNode&&(e.background=v.backGroundNode.element.getAttribute("fill")),void 0===e.offX&&(e.offX=0),void 0===e.offY&&(e.offY=0),void 0!==e.x&&(e.offX=parseFloat(e.x)-v.pathNode.boundingBox.x),void 0!==e.y&&(e.offY=parseFloat(e.y)-v.pathNode.boundingBox.y),e.part_type=SVG.PART_TYPE_PATH;var t,o=v.partGroupNode.element.transform.baseVal.consolidate().matrix,i=v.editor.svg.root.element.createSVGMatrix(),r=Raphael.mapPath(v.path,Raphael.matrix(o.a,o.b,o.c,o.d,o.e,o.f).invert());e.path=r.toString(),r=v.boundingBox.x+parseFloat(e.offX)-v.pathNode.boundingBox.x,t=v.boundingBox.y+parseFloat(e.offY)-v.pathNode.boundingBox.y,i=(i=i.translate(r,t)).multiply(o),e.matrix="matrix("+i.a+", "+i.b+", "+i.c+", "+i.d+", "+i.e+", "+i.f+")",e.svg=v.editor.helpers.exportHelper.serializedPart(v,!0),e.flags=v.serializeFlags(),e.visibility="hidden",v.editor.svg.createNode(SVG.PART,e,function(e){$(e.element).css("visibility","visible"),$(e.pathNode.element).css("visibility","visible"),v.editor.helpers.select.select(e)})},v.copyTo=function(e,n,s,d){n=void 0!==n&&n,s=void 0!==s&&s,null!=v.backGroundNode&&(null==e.backGroundNode?(e.backGroundNode=e.editor.svg.createNode(SVG.SHAPE_PATH,{id:e.id+"PartBackground",parentIntId:e.intId,d:e.path,fill:v.backGroundNode.element.getAttribute("fill"),stroke:"none"}),e.backGroundNode.ignore=!0,e.backGroundNode.overHandling=SVG.OVER_IGNORE,e.moveChildFirst(e.backGroundNode)):e.backGroundNode.element.setAttribute("fill",v.backGroundNode.element.getAttribute("fill"))),v.editor.helpers.importHelper.importSVGData(v.editor.helpers.exportHelper.serializedPart(v),e,function(e){var t=v.editor.svg.root.element.createSVGTransform(),o=v.editor.svg.root.element.createSVGMatrix(),i=v.partGroupNode.getTransformationMatrix(),r=e.boundingBox.x-v.boundingBox.x,a=e.boundingBox.y-v.boundingBox.y;o.a=i.a,o.b=i.b,o.c=i.c,o.d=i.d,o.e=r+i.e,o.f=a+i.f,t.setMatrix(o),e.partGroupNode.element.transform.baseVal.initialize(t),n&&(i=v.boundingBox.width/e.boundingBox.width,o=v.boundingBox.height/e.boundingBox.height,t=1/Math.min(i,o),(i=v.editor.svg.root.element.createSVGTransform()).setScale(t,t),e.partGroupNode.element.transform.baseVal.appendItem(i),e.partGroupNode.element.transform.baseVal.consolidate(),e.partGroupNode.createBBoxAndCenter(),r=e.boundingBox.x+e.boundingBox.width/2-(e.partGroupNode.boundingBox.x+e.partGroupNode.boundingBox.width/2),a=e.boundingBox.y+e.boundingBox.height/2-(e.partGroupNode.boundingBox.y+e.partGroupNode.boundingBox.height/2),(o=v.editor.svg.root.element.createSVGTransform()).setTranslate(r,a),e.partGroupNode.element.transform.baseVal.insertItemBefore(o,0),e.partGroupNode.element.transform.baseVal.consolidate()),s&&(e.partGroupNode.createBBoxAndCenter(),t=v.editor.svg.root.element.createSVGTransform(),partCenterX=(e.boundingBox.width-v.boundingBox.width)/2,partCenterY=(e.boundingBox.height-v.boundingBox.height)/2,t.setTranslate(partCenterX,partCenterY),e.partGroupNode.element.transform.baseVal.insertItemBefore(t,0),e.partGroupNode.element.transform.baseVal.consolidate()),void 0!==d&&d()})},v.isEmpty=function(){return 0==v.partGroupNode.children.length},v.createPathPointArray=function(e){if(isNaN(e)||e<=0)console.error("Erroneous steps.");else{var t=Raphael.parsePathString(v.path)[0],o=Raphael.getTotalLength(v.path);if(o!=n||t[1]!=s||t[2]!=g){n=o,s=t[1],g=t[2],h.length=0;var r=o/e;for(i=0;i<o;i+=r){var a=Raphael.getPointAtLength(v.path,i);h.push(new b(a.x,a.y))}}}},v.searchPathPointArray=function(e,t){for(var o=h.length,i=new b(e,t),r=-1,a=0;a<o-1;a++){var n=h[a],s=h[a+1],n=Math.sqrt(function(e,t,o){var i=u(t,o);if(0==i)return u(e,t);i=((e.x-t.x)*(o.x-t.x)+(e.y-t.y)*(o.y-t.y))/i;if(i<0)return u(e,t);if(1<i)return u(e,o);return u(e,{x:t.x+i*(o.x-t.x),y:t.y+i*(o.y-t.y)})}(i,n,s));(-1==r||n<r)&&(r=n)}return r/d},v.markPath=function(){var e,t;(null==v.editor.svg.selected||v.editor.svg.selected.intId==v.intId)&&null!=v.editor.svg.selected||v.pathMarked||(v.editor.helpers.preview.status&&$(v.pathNode.element).css("visibility","visible"),v.oldMarkDash=$(v.pathNode.element).css("stroke-dasharray"),v.oldMarkLine=$(v.pathNode.element).css("stroke-width"),t=v.pathNode.element.getAttribute("class"),v.pathNode.element.setAttribute("class",t+" svgPartPathHover"),t=parseFloat(v.editor.svg.getStyle(".svgPartPathHover","stroke-width")),e=v.editor.svg.getStyle(".svgPartPathHover","stroke-dasharray"),null==t||isNaN(t)||$(v.pathNode.element).css("stroke-width",(t*d).toString(10)),null!=e&&(t=e.split(","),e=parseFloat(t[0]),t=parseFloat(t[1]),isNaN(e)||isNaN(t)||$(v.pathNode.element).css("stroke-dasharray",e*d+","+t*d)),v.pathMarked=!0)},v.unMarkPath=function(){var e;v.pathMarked&&(v.editor.helpers.preview.status&&v.editor.svg.mode==SVG.MODE_SINGLE&&$(v.pathNode.element).css("visibility","hidden"),e=v.pathNode.element.getAttribute("class"),v.pathNode.element.setAttribute("class",e.replace(" svgPartPathHover","")),null!=v.oldMarkDash&&$(v.pathNode.element).css("stroke-dasharray",v.oldMarkDash),e=parseFloat(v.editor.svg.getStyle(".svgPartPath","stroke-width")),$(v.pathNode.element).css("stroke-width",(e*d).toString(10)),v.pathMarked=!1,v.updatePath())},v.movePartDown=function(){var e=v.editor.svg.sheet.parts,t=e.indexOf(v);t!=e.length-1&&(e[t]=e[t+1],(e[t+1]=v).editor.svg.sheet.updatePartsOrder())},v.movePartUp=function(){var e=v.editor.svg.sheet.parts,t=e.indexOf(v);0!=t&&(e[t]=e[t-1],(e[t-1]=v).editor.svg.sheet.updatePartsOrder())}}SVG.PART="Part",SVG.PART_TAG="g",SVG.PART_TYPE_PATH="path",SVG.PART_TYPE_RECT="rect",SVG.PART_TYPE_ROUND="round",SVG.PART_TYPE_TRIANGLE="triangle",SVG.PART_TYPE_IMAGE="image",SVG.PART_MIN_SIDE=30,SVG.PART_MAX_SIDE=1200;'},48920:t=>{t.exports='function ShapeCircle(){new Shape(this),this.type=SVG.SHAPE_CIRCLE,this.svgTag=SVG.SHAPE_CIRCLE_TAG;var n=this;n.createElement=function(t){n.element.setAttribute("cx",n.options.cx),n.element.setAttribute("cy",n.options.cy),n.element.setAttribute("r",n.options.r),n.options.fill&&n.element.setAttribute("fill",n.options.fill),n.options.id&&n.element.setAttribute("id",n.options.id),n.createBBoxAndCenter(),void 0!==t&&t(n),n.options.class&&n.element.setAttribute("class",n.options.class)},n.createBBoxAndCenter=function(){var t,e;n.editor.svg.runBBox&&(e=n.getTransformationMatrix(),n.center=n.editor.svg.root.element.createSVGPoint(),n.center.x=parseFloat(n.element.getAttribute("cx")),n.center.y=parseFloat(n.element.getAttribute("cy")),t=n.center.matrixTransform(e),e=Math.sqrt(e.a*e.a+e.b*e.b)*parseFloat(n.element.getAttribute("r")),n.boundingBox=n.editor.svg.root.element.createSVGRect(),n.boundingBox.width=2*e,n.boundingBox.height=2*e,n.boundingBox.x=t.x-e,n.boundingBox.y=t.y-e)}}SVG.SHAPE_CIRCLE="ShapeCircle",SVG.SHAPE_CIRCLE_TAG="circle";'},61940:t=>{t.exports='function GroupIcon(){new Branch(this),this.type=SVG.GROUP_ICON,this.svgTag=SVG.GROUP_ICON_TAG;var e=this;e.ignore=!0,e.overHandling=SVG.OVER_IGNORE,e.createElement=function(n){e.createBBoxAndCenter(),void 0!==n&&n(e)},e.createBBoxAndCenter=function(){}}SVG.GROUP_ICON="GroupIcon",SVG.GROUP_ICON_TAG="g";'},282:t=>{t.exports='function ShapeImage(){new Shape(this),this.type=SVG.SHAPE_IMAGE,this.svgTag=SVG.SHAPE_IMAGE_TAG;var p=this;p.imageWidth=0,p.imageHeight=0,p.dpi=0,p.widthPX=0,p.heightPX=0,p.link=null,p.clipartId=null,p.stickerId=null,p.attachmentId=null,p.uploadId=null,p.uploaded=!1,p.currentThumbVersion="sm",p.checkDpi=!1,p.vector=!1,p.outline=null,p.createElement=function(r,a){if(reload=void 0!==a,a=void 0===a?null:a,p.options.fileapp_id&&(p.element.setAttribute("fileapp_id",p.options.fileapp_id),p.element.setAttribute("fileapp_region",p.options.fileapp_region)),null==a)if(p.options.href)a=p.options.href;else{if(!p.options["xlink:href"])return void console.error("No image specified");a=p.options["xlink:href"]}void 0!==p.options.copyable&&(p.isCopyable=p.options.copyable),p.options.y&&(p.options.top=p.options.y),p.options.x&&(p.options.left=p.options.x),p.options.attachment_id&&(p.attachmentID=p.options.attachment_id),p.options.clipart_id&&(p.clipartId=p.options.clipart_id),p.options.sticker_id&&(p.stickerId=p.options.sticker_id),p.options.upload_id&&(p.uploadId=p.options.upload_id),p.options.uploaded&&(p.uploaded=p.options.uploaded),p.options.left||(p.options.left=0),p.options.top||(p.options.top=0),void 0!==p.options.flags&&p.deSerializeFlags(p.options.flags),p.options.transform&&(t=Raphael.matrix(),t=p.toMatrix(p.options.transform),(m=p.editor.svg.root.element.createSVGMatrix()).a=parseFloat(t.a),m.b=parseFloat(t.b),m.c=parseFloat(t.c),m.d=parseFloat(t.d),m.e=parseFloat(t.e),m.f=parseFloat(t.f),(t=p.editor.svg.root.element.createSVGTransform()).setMatrix(m),p.getTransformList(),p.element.transform.baseVal.initialize(t)),p.link=a;var t,s=new Image;$(s).on("load",function(t){p.options.width?p.imageWidth=p.options.width:p.imageWidth=s.width,p.options.height?p.imageHeight=p.options.height:p.imageHeight=s.height;var e,i=s.width,o=s.height,n=(0==i&&0==o||("width"in p.options||"height"in p.options?"width"in p.options?"height"in p.options?(n=p.options.width/p.options.height)!=(e=i/o)&&(n<e?p.options.height=p.options.width*(o/i):p.options.width=p.options.height*(i/o)):p.options.height=p.options.width*(o/i):p.options.width=p.options.height*(i/o):(p.options.width=i,p.options.height=o)),p.element.setAttribute("x",p.options.left),p.element.setAttribute("y",p.options.top),p.element.setAttribute("width",p.options.width),p.element.setAttribute("height",p.options.height),p.options.vector&&p.element.setAttribute("vector",p.options.vector),p.options.clipart_id&&p.element.setAttribute("clipart_id",p.options.clipart_id),p.options.attachment_id&&p.element.setAttribute("attachment_id",p.options.attachment_id),p.options.sticker_id&&p.element.setAttribute("sticker_id",p.options.sticker_id),p.options.upload_id&&p.element.setAttribute("upload_id",p.options.upload_id),p.options.fileapp_id&&p.element.setAttribute("fileapp_id",p.options.fileapp_id),p.options.uploaded&&p.element.setAttribute("uploaded",p.options.uploaded),p.options.id&&p.element.setAttribute("id",p.options.id),$("<a href="+a+">").prop("href"));p.element.setAttributeNS(SVG.SVG_XLINK,"xlink:href",n),p.createBBoxAndCenter(),void 0!==r&&r(p)}),$(s).on("error",function(t){var e;console.error("error loading image: "+a),reload?(s=null,void 0!==r&&r(null)):(console.error("Reloading image: "+a),e=(new Date).getTime(),a+="?random="+e,setTimeout(function(){p.createElement(r,a)},0))}),s.setAttribute("src",a)},p.createBBoxAndCenter=function(){if(p.editor.svg.runBBox){if(null==p.element.getAttribute("x")||null==p.element.getAttribute("y")||null==p.element.getAttribute("width")||null==p.element.getAttribute("height"))return p.boundingBox=p.editor.svg.root.element.createSVGRect(),p.boundingBox.width=0,p.boundingBox.height=0,p.boundingBox.x=0,p.boundingBox.y=0,p.center=p.editor.svg.root.element.createSVGPoint(),p.center.x=0,void(p.center.y=0);var t=p.getTransformationMatrix(),e=Math.sqrt(t.a*t.a+t.b*t.b),i=Math.sqrt(t.c*t.c+t.d*t.d),e=(p.widthPX=p.imageWidth*e*p.editor.helpers.input.svgTransMatrix.a,p.heightPX=p.imageHeight*i*p.editor.helpers.input.svgTransMatrix.d,parseFloat(p.element.getAttribute("x"))),i=parseFloat(p.element.getAttribute("y")),o=parseFloat(p.element.getAttribute("width")),n=parseFloat(p.element.getAttribute("height")),r=p.editor.svg.root.element.createSVGPoint(),a=(r.x=e,r.y=i,r=r.matrixTransform(t),p.editor.svg.root.element.createSVGPoint()),s=(a.x=e+o,a.y=i,a=a.matrixTransform(t),p.editor.svg.root.element.createSVGPoint()),o=(s.x=e+o,s.y=i+n,s=s.matrixTransform(t),p.editor.svg.root.element.createSVGPoint()),e=(o.x=e,o.y=i+n,o=o.matrixTransform(t),Math.min(a.x,r.x,o.x,s.x)),i=Math.min(a.y,r.y,o.y,s.y),n=Math.max(a.x,r.x,o.x,s.x)-e,t=Math.max(a.y,r.y,o.y,s.y)-i;p.boundingBox=p.editor.svg.root.element.createSVGRect(),p.boundingBox.width=n,p.boundingBox.height=t,p.boundingBox.x=e,p.boundingBox.y=i,p.center=p.editor.svg.root.element.createSVGPoint(),p.center.x=e+n/2,p.center.y=i+t/2,p.calcDPI()}},p.calcDPI=function(){var t=p.getTransformationMatrix(!0),e=Math.sqrt(t.a*t.a+t.b*t.b),t=Math.sqrt(t.c*t.c+t.d*t.d),e=(p.widthPX=p.imageWidth*e*p.editor.helpers.input.svgTransMatrix.a,p.heightPX=p.imageHeight*t*p.editor.helpers.input.svgTransMatrix.d,p.imageWidth/(p.imageWidth*e/p.editor.svg.px2mm)*25.4),t=p.imageHeight/(p.imageHeight*t/p.editor.svg.px2mm)*25.4;p.dpi=Math.min(e,t),p.checkDpi&&p.editor.helpers.dpi.checkDpi()},p.preRemove=function(t){p.editor.helpers.dpi.removeImageNode(p),p.editor.helpers.dpi.checkDpi(),void 0!==t&&t()},p.getMenuOptions=function(){var t=new Array;return t.push(SELECT_MENU_UP),t.push(SELECT_MENU_DOWN),p.editor.svg.extraCopy&&t.push(SELECT_MENU_COPY),t.push(SELECT_MENU_DELETE),t},p.copy=function(t){var e,i=new Array;for(e in p.options)"id"!=e&&(i[e]=p.options[e]);t.offX&&(i.x=parseFloat(i.left)+parseFloat(t.offX)),t.offY&&(i.y=parseFloat(i.top)+parseFloat(t.offY)),i.transform=p.element.getAttribute("transform"),i.flags=p.serializeFlags(),i.visibility="hidden",console.log(p.options),console.log(i),p.editor.svg.createNode(SVG.SHAPE_IMAGE,i,function(t){t.options.visibility="visible",$(t.element).css("visibility","visible")})}}SVG.SHAPE_IMAGE="ShapeImage",SVG.SHAPE_IMAGE_TAG="image";'},18346:t=>{t.exports='function ShapeMulti(){new Branch(this);var c=this;this.type=SVG.SHAPE_MULTI,this.svgTag=SVG.SHAPE_MULTI_TAG,c.isClickThrough=!1,c.isSelectable=!0,c.isOverable=!0,c.isTransformable=!0,c.isResizeable=!0,c.isRotateable=!0,c.isSkewable=!1,c.isMoveable=!0,c.orgBBox=null,c.createElement=function(e){var i;c.options.json&&((i=c.options.json).id&&(c.options.id=i.id),i.visibility&&(c.options.visibility=i.visibility)),c.options.visibility&&$(c.element).css("visibility",c.options.visibility),c.options.transform&&c.element.setAttribute("transform",c.options.transform),void 0!==c.options.copyable&&(c.isCopyable=c.options.copyable),c.element.setAttribute("id",c.options.id),void 0===c.options.flags||c.editor.model.editor.isAdmin||c.deSerializeFlags(c.options.flags),c.options.visibility&&$(c.element).css("visibility",c.options.visibility),c.createBBoxAndCenter(),void 0!==e&&e(c)},c.createBBoxAndCenter=function(){if(c.editor.svg.runBBox)if(c.calcBBox){for(var e=1e5,i=1e5,o=-1e5,t=-1e5,n=0;n<c.children.length;n++)c.children[n].createBBoxAndCenter(),isNaN(c.children[n].boundingBox.x)||(e=Math.min(e,c.children[n].boundingBox.x)),isNaN(c.children[n].boundingBox.y)||(i=Math.min(i,c.children[n].boundingBox.y)),isNaN(c.children[n].boundingBox.x+c.children[n].boundingBox.width)||(o=Math.max(o,c.children[n].boundingBox.x+c.children[n].boundingBox.width)),isNaN(c.children[n].boundingBox.y+c.children[n].boundingBox.height)||(t=Math.max(t,c.children[n].boundingBox.y+c.children[n].boundingBox.height));1e5==e&&-1e5==o&&(o=e=0),1e5==i&&-1e5==t&&(t=i=0),c.boundingBox=c.editor.svg.root.element.createSVGRect(),c.boundingBox.width=o-e,c.boundingBox.height=t-i,c.boundingBox.x=e,c.boundingBox.y=i,c.orgBBox=c.editor.svg.root.element.createSVGRect(),c.orgBBox.width=c.boundingBox.width,c.orgBBox.height=c.boundingBox.height,c.orgBBox.x=c.boundingBox.x,c.orgBBox.y=c.boundingBox.y,c.center=c.editor.svg.root.element.createSVGPoint(),c.center.x=c.boundingBox.x+c.boundingBox.width/2,c.center.y=c.boundingBox.y+c.boundingBox.height/2}else{var r=c.getTransformationMatrix(),s=c.orgBBox.x,l=c.orgBBox.y,a=c.orgBBox.width,d=c.orgBBox.height,g=c.editor.svg.root.element.createSVGPoint(),x=(g.x=s,g.y=l,g=g.matrixTransform(r),c.editor.svg.root.element.createSVGPoint()),h=(x.x=s+a,x.y=l,x=x.matrixTransform(r),c.editor.svg.root.element.createSVGPoint()),a=(h.x=s+a,h.y=l+d,h=h.matrixTransform(r),c.editor.svg.root.element.createSVGPoint()),s=(a.x=s,a.y=l+d,a=a.matrixTransform(r),Math.min(x.x,g.x,a.x,h.x)),l=Math.min(x.y,g.y,a.y,h.y),d=Math.max(x.x,g.x,a.x,h.x)-s,r=Math.max(x.y,g.y,a.y,h.y)-l;c.boundingBox=c.editor.svg.root.element.createSVGRect(),c.boundingBox.width=d,c.boundingBox.height=r,c.boundingBox.x=s,c.boundingBox.y=l,c.center=c.editor.svg.root.element.createSVGPoint(),c.center.x=s+d/2,c.center.y=l+r/2}},c.getMenuOptions=function(){var e=new Array;return this.isMoveable&&e.push(SELECT_MENU_UP),this.isMoveable&&e.push(SELECT_MENU_DOWN),c.editor.svg.extraCopy&&e.push(SELECT_MENU_COPY),this.isMoveable&&e.push(SELECT_MENU_CENTER_HOR),this.isMoveable&&e.push(SELECT_MENU_CENTER_VER),this.isDeleteable&&e.push(SELECT_MENU_DELETE),e.push(SELECT_MENU_COLLAGE),e},c.onDeleteMenu=function(){return null==c.collageObject||(c.editor.svg.collage.deleteImage(c.collageObject),!1)},c.onDeSelect=function(){null!=c.collageObject&&c.editor.svg.collage.hideImage(c)},c.copy=function(e){var i,o=new Array;for(i in c.options)"id"!=i&&(o[i]=c.options[i]);var t=c.editor.svg.root.element.createSVGMatrix(),n=0,r=0;e.offX&&(n=e.offX),e.offY&&(r=e.offY),t=(t=t.multiply(c.element.transform.baseVal.consolidate().matrix)).translate(n,r),o.transform="matrix("+t.a+", "+t.b+", "+t.c+", "+t.d+", "+t.e+", "+t.f+")",o.flags=c.serializeFlags(),o.visibility="hidden",c.editor.svg.createNode(SVG.SHAPE_MULTI,o,function(o){o.options.visibility="visible",$(o.element).css("visibility","visible"),c.editor.helpers.importHelper.importSVGData(o.options&&o.options.json&&o.options.json.svg?o.options.json.svg:c.element.innerHTML,o,function(e,i){c.editor.svg.refreshMargin(!1),c.editor.helpers.select.select(o)})})},c.preRemove=function(e){for(c.removeChildren(),i=0;i<c.editor.svg.multiArr.length;i++)c.editor.svg.multiArr[i].intId==c.intId&&c.editor.svg.multiArr.splice(i,1);void 0!==e&&e()}}SVG.SHAPE_MULTI="ShapeMulti",SVG.SHAPE_MULTI_TAG="g";'},54638:t=>{t.exports='function ShapePath(){new Shape(this),this.type=SVG.SHAPE_PATH,this.svgTag=SVG.SHAPE_PATH_TAG;var n=this;n.overDrop=null,n.orgPath=null,n.isStrangeCenter=!0,n.tempTransform=null,n.oldMatrix="",n.createElement=function(e){n.orgPath=n.options.d,n.element.setAttribute("d",n.options.d),n.options.fill&&n.element.setAttribute("fill",n.options.fill),n.options.stroke&&n.element.setAttribute("stroke",n.options.stroke),n.options.id&&n.element.setAttribute("id",n.options.id),n.options["fill-opacity"]&&n.element.setAttribute("fill-opacity",n.options["fill-opacity"]),n.options["fill-rule"]&&n.element.setAttribute("fill-rule",n.options["fill-rule"]),n.options["stroke-opacity"]&&n.element.setAttribute("stroke-opacity",n.options["stroke-opacity"]),n.options["stroke-dasharray"]&&n.element.setAttribute("stroke-dasharray",n.options["stroke-dasharray"]),n.options["stroke-width"]&&n.element.setAttribute("stroke-width",n.options["stroke-width"]),n.options.class&&n.element.setAttribute("class",n.options.class),n.options["clip-path"]&&n.element.setAttribute("clip-path",n.options["clip-path"]),n.options.transform&&n.element.setAttribute("transform",n.options.transform),n.tempTransform=n.editor.svg.root.element.createSVGTransform(),n.createBBoxAndCenter(),void 0!==e&&e(n)},n.createBBoxAndCenter=function(){var e;n.editor.svg.runBBox&&(e=n.getTransformationMatrix(),n.oldMatrix=e.a+" "+e.b+" "+e.c+" "+e.d+" "+e.e+" "+e.f,e=Raphael.mapPath(n.element.getAttribute("d"),Raphael.matrix(e.a,e.b,e.c,e.d,e.e,e.f)),e=Raphael.pathBBox(e),n.boundingBox=n.editor.svg.root.element.createSVGRect(),n.boundingBox.width=e.width,n.boundingBox.height=e.height,n.boundingBox.x=e.x,n.boundingBox.y=e.y,n.center=n.editor.svg.root.element.createSVGPoint(),n.center.x=e.x+(e.x2-e.x)/2,n.center.y=e.y+(e.y2-e.y)/2)},n.getMenuOptions=function(){var e;return null!=n.collageObject?(null!=n.collageObject.imageNode?((e=new Array).push(SELECT_MENU_EDIT),e.push(SELECT_MENU_DELETE)):(e=new Array).push(SELECT_MENU_UPLOAD),e):null},n.onEditMenu=function(){null!=n.collageObject&&(null!=n.collageObject.imageNode?n.editor.svg.collage.showImage(n.collageObject.imageNode):n.editor.ui.uploadFile())},n.onDeleteMenu=function(){return null!=n.collageObject&&n.editor.svg.collage.deleteImage(n.collageObject),!1},n.specialBeforeTransform=function(){null!=n.collageObject&&n.element.setAttribute("class","svgCollagePath drag")},n.specialAfterTransform=function(e){if(null!=n.collageObject&&n.element.setAttribute("class","svgCollagePath"),null!=n.overDrop&&(n.overDrop.element.setAttribute("class","svgCollagePath"),n.overDrop=null),null!=n.collageObject&&null!=e){n.createBBoxAndCenter(),n.editor.svg.moveNode(n,n.collageObject.x-n.boundingBox.x,n.collageObject.y-n.boundingBox.y),n.element.transform.baseVal.consolidate();for(var t=n.editor.svg.getNodeListOnPoint(e),o=0;o<t.length;o++)t[o].type==SVG.SHAPE_PATH&&t[o].id!=n.id&&null!=t[o].collageObject&&n.editor.svg.collage.swapImages(n.collageObject,t[o].collageObject)}},n.specialDrag=function(e){if(null!=n.collageObject){for(var t=n.editor.svg.getNodeListOnPoint(e),o=!0,l=0;l<t.length;l++)t[l].type==SVG.SHAPE_PATH&&t[l].id!=n.id&&null!=t[l].collageObject&&(o=!1,null!=n.overDrop&&n.overDrop.intId!=t[l].intId&&(n.overDrop.element.setAttribute("class","svgCollagePath"),n.overDrop=null),null==n.overDrop&&(n.overDrop=t[l],n.overDrop.element.setAttribute("class","svgCollagePath drop")));o&&null!=n.overDrop&&(n.overDrop.element.setAttribute("class","svgCollagePath"),n.overDrop=null)}}}SVG.SHAPE_PATH="ShapePath",SVG.SHAPE_PATH_TAG="path";'},69678:t=>{t.exports='function ShapeRect(){new Shape(this),this.type=SVG.SHAPE_RECT,this.svgTag=SVG.SHAPE_RECT_TAG;var l=this;l.createElement=function(t){l.options.x&&l.element.setAttribute("x",l.options.x),l.options.left&&l.element.setAttribute("x",l.options.left),l.options.y&&l.element.setAttribute("y",l.options.y),l.options.top&&l.element.setAttribute("y",l.options.top),l.element.setAttribute("width",l.options.width),l.element.setAttribute("height",l.options.height),l.options.mask&&l.element.setAttribute("clip-path","url(#"+l.options.mask+")"),l.options.fill&&l.element.setAttribute("fill",l.options.fill),l.options.stroke&&l.element.setAttribute("stroke",l.options.stroke),l.options["stroke-width"]&&l.element.setAttribute("stroke-width",l.options["stroke-width"]),l.options["fill-opacity"]&&l.element.setAttribute("fill-opacity",l.options["fill-opacity"]),l.options.rx&&l.element.setAttribute("rx",l.options.rx),l.options.ry&&l.element.setAttribute("ry",l.options.ry),l.options.class&&l.element.setAttribute("class",l.options.class),l.options.id&&l.element.setAttribute("id",l.options.id),l.createBBoxAndCenter(),void 0!==t&&t(l)},l.createBBoxAndCenter=function(){var t,e,o,i,n,r,s,a;l.editor.svg.runBBox&&(a=l.getTransformationMatrix(),n=parseFloat(l.element.getAttribute("x")),r=parseFloat(l.element.getAttribute("y")),i=parseFloat(l.element.getAttribute("width")),s=parseFloat(l.element.getAttribute("height")),(t=l.editor.svg.root.element.createSVGPoint()).x=n,t.y=r,t=t.matrixTransform(a),(e=l.editor.svg.root.element.createSVGPoint()).x=n+i,e.y=r,e=e.matrixTransform(a),(o=l.editor.svg.root.element.createSVGPoint()).x=n+i,o.y=r+s,o=o.matrixTransform(a),(i=l.editor.svg.root.element.createSVGPoint()).x=n,i.y=r+s,i=i.matrixTransform(a),n=Math.min(e.x,t.x,i.x,o.x),r=Math.min(e.y,t.y,i.y,o.y),s=Math.max(e.x,t.x,i.x,o.x)-n,a=Math.max(e.y,t.y,i.y,o.y)-r,l.boundingBox=l.editor.svg.root.element.createSVGRect(),l.boundingBox.width=s,l.boundingBox.height=a,l.boundingBox.x=n,l.boundingBox.y=r,l.center=l.editor.svg.root.element.createSVGPoint(),l.center.x=n+s/2,l.center.y=r+a/2)}}SVG.SHAPE_RECT="ShapeRect",SVG.SHAPE_RECT_TAG="rect";'},17026:t=>{t.exports='function ShapeText(){new Shape(this),this.type=SVG.SHAPE_TEXT,this.svgTag=SVG.SHAPE_TEXT_TAG;var l=this,f="";function n(){for(var t=$(l.element).clone(),t=($(t).empty(),$(t).insertBefore(l.element),$(l.element).remove(),l.element=$(t).get(0),l.element),e=parseFloat(t.getAttribute("font-size")),o=(isNaN(e)&&(e=10),l.element.hasAttribute("x")?parseFloat(l.element.getAttribute("x")):0),n=l.element.hasAttribute("y")?parseFloat(l.element.getAttribute("y")):0,i=f.split("\\n"),r=0;r<i.length;r++){var s=document.createElementNS(SVG.SVG_NAMESPACE,"tspan"),a=(null!=l.element.getAttribute("font-family")&&s.setAttribute("font-family",l.element.getAttribute("font-family").replace(/\'/g,"")),s.setAttribute("x",o),s.setAttribute("y",n+e*r),document.createTextNode(i[r].trim()));s.appendChild(a),l.element.appendChild(s)}}l.createElement=function(t){var e;l.options.left&&l.element.setAttribute("x",l.options.left),l.options.x&&l.element.setAttribute("x",l.options.x),l.options.top&&l.element.setAttribute("y",l.options.top),l.options.y&&l.element.setAttribute("y",l.options.y),l.options.fill&&l.element.setAttribute("fill",l.options.fill),l.options.class&&l.element.setAttribute("class",l.options.class),l.options.id&&l.element.setAttribute("id",l.options.id),l.options.transform&&l.element.setAttribute("transform",l.options.transform),l.element.setAttribute("space","preserve"),l.options.size&&l.element.setAttribute("font-size",l.options.size),l.options["font-size"]&&l.element.setAttribute("font-size",l.options["font-size"]),l.options.font&&(l.options.font=l.options.font.replace(/\'/g,""),l.element.setAttribute("font-family",l.options.font)),l.options["font-family"]&&(l.options["font-family"]=l.options["font-family"].replace(/\'/g,""),l.element.setAttribute("font-family",l.options["font-family"])),l.options.anchor&&l.element.setAttribute("text-anchor",l.options.anchor),l.options["text-anchor"]&&l.element.setAttribute("text-anchor",l.options["text-anchor"]),void 0!==l.options.flags&&l.deSerializeFlags(l.options.flags),void 0!==l.options.copyable&&(l.isCopyable=l.options.copyable),l.options.transform&&(e=l.toMatrix(l.options.transform),(m=l.editor.svg.root.element.createSVGMatrix()).a=parseFloat(e.a),m.b=parseFloat(e.b),m.c=parseFloat(e.c),m.d=parseFloat(e.d),m.e=parseFloat(e.e),m.f=parseFloat(e.f),(e=l.editor.svg.root.element.createSVGTransform()).setMatrix(m),l.getTransformList(),l.element.transform.baseVal.initialize(e)),f=l.options.text,n(),l.createBBoxAndCenter(),void 0!==t&&t(l),!0===l.options.locked&&(l.isResizeable=!1,l.editor.svg.centerHorOrVer(l,!0,!0,!1,!1))},l.changeText=function(t){var e,o;t.text&&(f=t.text),t.align&&(e=l.element.getAttribute("text-anchor"),o=t.align,offX=0,e!=o&&("start"==e&&("middle"==o&&(offX=l.boundingBox.width/2),"end"==o&&(offX=l.boundingBox.width)),"middle"==e&&("start"==o&&(offX=l.boundingBox.width/2*-1),"end"==o&&(offX=l.boundingBox.width/2)),"end"==e&&("start"==o&&(offX=-1*l.boundingBox.width),"middle"==o&&(offX=l.boundingBox.width/2*-1)),l.beforeTransform(null,!0),l.transform(SVG.TRANSFORM_MOVE,offX,0,0,0,0,0,!0),l.element.setAttribute("text-anchor",t.align),l.afterTransform(!0))),t.size&&l.element.setAttribute("font-size",t.size),t.color&&l.element.setAttribute("fill",t.color),t.font&&(t.font=t.font.replace(/\'/g,""),l.element.setAttribute("font-family",t.font)),n(),l.createBBoxAndCenter()},l.changeColor=function(t){l.element.setAttribute("fill",t)},l.createBBoxAndCenter=function(){if(l.editor.svg.runBBox){var e=0,o=0,n=0,i=0;try{var t=l.element.getBBox(),e=t.x,o=t.y,n=t.width,i=t.height}catch(t){e=(el=$(l.element)).offset().left,o=el.offset().top,n=el.width(),i=el.height()}var t=l.getTransformationMatrix(),r=l.editor.svg.root.element.createSVGPoint(),s=(r.x=e,r.y=o,r=r.matrixTransform(t),l.editor.svg.root.element.createSVGPoint()),a=(s.x=e+n,s.y=o,s=s.matrixTransform(t),l.editor.svg.root.element.createSVGPoint()),n=(a.x=e+n,a.y=o+i,a=a.matrixTransform(t),l.editor.svg.root.element.createSVGPoint()),e=(n.x=e,n.y=o+i,n=n.matrixTransform(t),Math.min(s.x,r.x,n.x,a.x)),o=Math.min(s.y,r.y,n.y,a.y),i=Math.max(s.x,r.x,n.x,a.x)-e,t=Math.max(s.y,r.y,n.y,a.y)-o;l.boundingBox=l.editor.svg.root.element.createSVGRect(),l.boundingBox.width=i,l.boundingBox.height=t,l.boundingBox.x=e,l.boundingBox.y=o,l.center=l.editor.svg.root.element.createSVGPoint(),l.center.x=e+i/2,l.center.y=o+t/2}},l.getTextAsJson=function(){var t={text:""};return l.editor.$("#"+l.element.id+" tspan").each(function(){t.text+=$(this).text()+"\\r\\n"}),""!=t.text&&(t.text=t.text.substr(0,t.text.length-2)),t.font=$(l.element).css("font-family").replace(/\'/g,"").replace(/"/g,""),t.color=$(l.element).attr("fill"),t.align=$(l.element).attr("text-anchor"),t},l.onSelect=function(){l.editor.svg.noOnSelect||l.editor.ui.setText(l.getTextAsJson())},l.onDeSelect=function(){},l.getMenuOptions=function(){var t=new Array;return t.push(SELECT_MENU_UP),t.push(SELECT_MENU_DOWN),l.editor.isLandscapeOrientation()||t.push(SELECT_MENU_EDIT),l.editor.svg.extraCopy&&t.push(SELECT_MENU_COPY),t.push(SELECT_MENU_CENTER_HOR),t.push(SELECT_MENU_CENTER_VER),t.push(SELECT_MENU_DELETE),t},l.onEditMenu=function(){l.editor.ui.setText(l.getTextAsJson());var t=l.editor.api.GetActivePartSide();console.log(t),l.editor.isLandscapeOrientation()||("back_deal"===t?l.editor.ui.backPrintDealtextTool:l.editor.ui.textTool).show()},l.copy=function(t){var e,o=new Array;for(e in l.options)"id"!=e&&(o[e]=l.options[e]);var n=l.getTextAsJson();o.text=n.text,o.font=n.font.replace(/\'/g,""),o.fill=n.color,o.color=n.color,o.align=n.align,o.anchor=n.align,o.transform=l.element.getAttribute("transform"),t.offX&&(o.left+=parseFloat(t.offX)),t.offY&&(o.top+=parseFloat(t.offY)),o.flags=l.serializeFlags(),o.visibility="hidden",l.editor.svg.createNode(SVG.SHAPE_TEXT,o,function(t){t.options.visibility="visible",$(t.element).css("visibility","visible"),l.editor.svg.refreshMargin(!1),l.editor.helpers.select.select(t)})}}SVG.SHAPE_TEXT="ShapeText",SVG.SHAPE_TEXT_TAG="text";'},69685:t=>{t.exports=function(t){function e(t){"undefined"!=typeof console&&(console.error||console.log)("[Script Loader]",t)}try{"undefined"!=typeof execScript&&"undefined"!=typeof attachEvent&&"undefined"==typeof addEventListener?execScript(t):"undefined"!=typeof eval?eval.call(null,t):e("EvalError: No eval function available")}catch(t){e(t)}}},47662:(t,e,o)=>{o(69685)(o(87201))},89761:(t,e,o)=>{o(69685)(o(33165))},8830:(t,e,o)=>{o(69685)(o(39007))},75255:(t,e,o)=>{o(69685)(o(5810))},93318:(t,e,o)=>{o(69685)(o(77377))},55215:(t,e,o)=>{o(69685)(o(83293))},2170:(t,e,o)=>{o(69685)(o(85678))},63353:(t,e,o)=>{o(69685)(o(30030))},11174:(t,e,o)=>{o(69685)(o(77212))},13708:(t,e,o)=>{o(69685)(o(91552))},8417:(t,e,o)=>{o(69685)(o(52272))},13400:(t,e,o)=>{o(69685)(o(97277))},20375:(t,e,o)=>{o(69685)(o(23004))},62342:(t,e,o)=>{o(69685)(o(40744))},90277:(t,e,o)=>{o(69685)(o(26486))},61118:(t,e,o)=>{o(69685)(o(18279))},85804:(t,e,o)=>{o(69685)(o(40259))},62008:(t,e,o)=>{o(69685)(o(48920))},33926:(t,e,o)=>{o(69685)(o(61940))},44142:(t,e,o)=>{o(69685)(o(282))},40940:(t,e,o)=>{o(69685)(o(18346))},62788:(t,e,o)=>{o(69685)(o(54638))},73508:(t,e,o)=>{o(69685)(o(69678))},94461:(t,e,o)=>{o(69685)(o(17026))},32724:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.CheckoutNavbarButton=void 0;var r=e(15839),n=e(37463),s=e(29421),a=function(t){function e(e){var o=t.call(this,e)||this;return o._animatedInClass="slideInDown",o._animatedOutClass="slideOutUp",o._millisecondsFlashing=2e3,o._focus=!1,o._numItems=parseInt(o.$numItems.html()),o._outerWidth=o.$el.outerWidth(),o.on("affix.bs.affix",(function(t){return o.onAffix(t)})),o.on("affix-top.bs.affix",(function(t){return o.onAffixTop(t)})),o.on(s.CSSEventType.ANIMATION_END,(function(t){return o.onAnimationEnd()})),$(window).on("scroll",(function(t){return o.onWindowScroll()})),$("body").on(n.CartEventType.UPDATE,(function(t){return o.onCartUpdate(t)})),o.on("mouseover",(function(){return o._focus=!0})),o.on("mouseout",(function(){return o._focus=!1})),o}return i(e,t),e.prototype.refresh=function(){var t=this;this.state!=e.STATE_REFRESHING&&(this._state=e.STATE_REFRESHING,$.ajax("/checkout/get_cart_num_items",{success:function(e){return t.onGetCartNumItems(e)},error:function(t){}}))},e.prototype.updateCartIndicator=function(){$.ajax("/checkout/get_cart_num_items",{success:function(t){var e=$("#cart-indicator");t!==e.text()&&e.text(t)},error:function(t){}})},e.prototype.renderPosition=function(){this.flashing?this.visible?this.renderPositionAffixTop():this.renderPositionAffix():this.renderPositionAffixTop()},e.prototype.renderPositionAffix=function(){this.$el.addClass("affix").removeClass("affix-top"),this.onAffix(null)},e.prototype.renderPositionAffixTop=function(){this.$el.addClass("affix-top").removeClass("affix"),this.onAffixTop(null)},e.prototype.flash=function(){this._flashing=!0,this.renderPosition(),this._state=e.STATE_ANIMATE_IN,this.animateIn()},e.prototype.animateIn=function(){return this.$el.animateCSS(this._animatedInClass),this.$el},e.prototype.animateOut=function(){return this.visible?this.onAnimationEnd():this.$el.animateCSS(this._animatedOutClass),this.$el},e.prototype.maybeAnimateOut=function(){var t=this;this._focus?this.visible?this.state==e.STATE_ANIMATE_OUT&&this.onAnimationEnd():setTimeout((function(){return t.maybeAnimateOut()}),this._millisecondsFlashing):(this._state=e.STATE_ANIMATE_OUT,this.animateOut())},e.prototype.animateItems=function(){return this.visible?this.$el.animateCSS("flipInX"):this.$inner.animateCSS("flipInX"),this.$numItems.html(this.numItems.toString()),this.onAnimationEnd(),this.$numItems},Object.defineProperty(e.prototype,"flashing",{get:function(){return this._flashing},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"numItems",{get:function(){return this._numItems},set:function(t){this._numItems=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$numItems",{get:function(){return this.$(".num-items")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$navBar",{get:function(){return this.$el.closest(".navbar")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$inner",{get:function(){return this.$(".inner")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"visible",{get:function(){return!(this._scrollTop>this.$navBar.outerHeight()/2)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),Object.defineProperty(e,"STATE_REFRESHING",{get:function(){return"state_refreshing"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"STATE_ANIMATE_IN",{get:function(){return"state_animate_in"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"STATE_ANIMATE_OUT",{get:function(){return"state_animate_out"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"STATE_ANIMATE_ITEMS",{get:function(){return"state_animate_items"},enumerable:!1,configurable:!0}),e.prototype.onAnimationEnd=function(){var t=this;switch(this.state){case e.STATE_ANIMATE_OUT:this._outerWidth=this.$el.outerWidth(),this._state=null,this._flashing=!1,this.renderPosition();break;case e.STATE_ANIMATE_IN:this._state=e.STATE_ANIMATE_ITEMS,this.animateItems();break;case e.STATE_ANIMATE_ITEMS:setTimeout((function(){return t.maybeAnimateOut()}),this._millisecondsFlashing)}},e.prototype.onAffix=function(t){this.$el.css("margin-left","-"+this._outerWidth+"px")},e.prototype.onAffixTop=function(t){this.$el.css("margin-left","0")},e.prototype.onWindowScroll=function(){this._scrollTop=$("body").scrollTop(),this.renderPosition()},e.prototype.onCartUpdate=function(t){this.refresh()},e.prototype.onGetCartNumItems=function(t){this._state=null;var o=!1,i=parseInt(t);i!=this.numItems&&(o=!0),this.numItems=i,o&&(this.visible||this.flashing?(this._state=e.STATE_ANIMATE_ITEMS,this.animateItems()):this.flash(),this.trigger(n.CartEventType.CHANGE))},e}(r.ViewComponent);exports.CheckoutNavbarButton=a},65642:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.ConfirmModal=void 0;var r=function(t){function e(o){var i=t.call(this,o)||this;return e._instance||(i._buttons=[],i._$btnConfirm=$('<button class="btn btn-default btn-confirm"></button>'),i._$btnConfirm.text(i.$el.data("lang-ok")),i._$btnCancel=$('<button class="btn btn-warning btn-cancel"></button>'),i._$btnCancel.text(i.$el.data("lang-cancel")),i._$btnYes=$('<button class="btn btn-default btn-yes"></button>'),i._$btnYes.text(i.$el.data("lang-yes")),i._$btnNo=$('<button class="btn btn-warning btn-no"></button>'),i._$btnNo.text(i.$el.data("lang-no")),i._title=$('<div class="f-col-12 f-justify-center text-center title h3"></div>'),i.on("click","button",(function(t){return i.onButtonClick(t)})),i.on("click",".btn-confirm, .btn-yes",(function(t){return i.onConfirm(t)})),i.on("click",".btn-cancel, .btn-no",(function(t){return i.onCancel(t)}))),i}return i(e,t),e.prototype.confirm=function(t,e){void 0===e&&(e=null),this.clearTitle(),this.clearButtons(),this.text=t,this.addButton(this._$btnConfirm),this._onConfirmClick=e,this.show()},e.prototype.yesOrNo=function(t,e,o){void 0===o&&(o=null),this.clearTitle(),this.clearButtons(),this.text=t,this.addButton(this._$btnNo),this.addButton(this._$btnYes),this._onConfirmClick=e,this._onCancelClick=o,this.show()},e.prototype.confirmOrCancel=function(t,e,o){void 0===o&&(o=null),this.clearTitle(),this.clearButtons(),this.text=t,this.addButton(this._$btnCancel),this.addButton(this._$btnConfirm),this._onConfirmClick=e,this._onCancelClick=o,this.show()},e.prototype.addButton=function(t){var e=$('<div class="f-col f-none p-l-0"></div>');e.append(t),this.$actionsRow.append(e),this._buttons.push(t)},e.prototype.clearButtons=function(){$(this._buttons).each((function(t,e){return e.remove()})),this._buttons=[],this.$actionsRow.html("")},e.prototype.show=function(){this.$el.addClass("in")},e.prototype.hide=function(){this.$el.removeClass("in")},Object.defineProperty(e,"ELEMENT_ID",{get:function(){return"confirm-modal"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"instance",{get:function(){return e._instance||(e._instance=new e($("#"+e.ELEMENT_ID))),e._instance},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$contentRow",{get:function(){return this.$(".content")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$actionsRow",{get:function(){return this.$(".actions")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"text",{set:function(t){this.$contentRow.text(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"html",{set:function(t){this.$contentRow.html(t)},enumerable:!1,configurable:!0}),e.prototype.onConfirm=function(t){t.preventDefault(),this.hide(),this._onConfirmClick&&this._onConfirmClick(t)},e.prototype.onCancel=function(t){t.preventDefault(),this.hide(),this._onCancelClick&&this._onCancelClick(t)},e.prototype.onButtonClick=function(t){t.preventDefault()},e.prototype.clearTitle=function(){this.$el.removeClass("title-design"),this._title.remove()},Object.defineProperty(e.prototype,"title",{set:function(t){this._title.html(t),this.$contentRow.parent().prepend(this._title)},enumerable:!1,configurable:!0}),e.prototype.confirmWithTitle=function(t,e,o){void 0===o&&(o=null),this.clearTitle(),this.clearButtons(),this.$el.addClass("title-design"),this.text=t,this.title=e,this.addButton(this._$btnConfirm),this._onConfirmClick=o,this.show()},e.prototype.confirmOrCancelWithTitle=function(t,e,o,i){void 0===o&&(o=null),void 0===i&&(i=null),this.clearTitle(),this.clearButtons(),this.$el.addClass("title-design"),this.text=t,this.title=e,this.addButton(this._$btnConfirm),this.addButton(this._$btnCancel),this._onConfirmClick=o,this._onCancelClick=i,this.show()},e}(e(15839).ViewComponent);exports.ConfirmModal=r},44985:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.Editor=void 0;var r=e(15839),n=e(87066),s=e(41476),a=e(94538),l=e(90624),d=e(49020),c=e(88834),h=e(78698),u=e(37026),p=e(75782),f=e(4293),g=e(631),v=e(15568),m=e(64638),_=e(28762),b=e(88459),y=e(89376),E=e(18415),T=e(82064),x=e(58028),S=e(78694),w=e(26446),P=e(98283),C=e(13228),O=e(13880),A=e(35896),k=e(90107),N=e(20664),I=e(15073),M=e(10388),R=e(15802),B=e(52850),G=e(20756),V=e(22302),D=e(48663),L=e(97821),j=e(88270),H=e(79948),F=e(93041),U=e(26856),z=e(74160),Y=e(84082),q=e(57254),W=e(68435),X=e(10554),Z=function(t){function e(e,o){var i=t.call(this,e)||this;return i.isReady=!1,i._destroyed=!1,i._focus=null,i.model=window.editorData_=s.ObjectUtil.removeEmpty(o),i._ui=document.menuApi=new n.EditorUI(e,i),i._controller=new S.EditorController(i),i}return i(e,t),Object.defineProperty(e,"currentEditor",{get:function(){return e._currentEditor},set:function(t){e._currentEditor=t},enumerable:!1,configurable:!0}),e.getInstance=function(t){if(d.EditorCollection.getInstance().has(t))return d.EditorCollection.getInstance().get(t);for(var o="#"+t,i=JSON.parse($(o).find("textarea").first().text()),r=0,n=i.parts;r<n.length;r++){var s=n[r];null!=s&&void 0!==s.svg&&null!==s.svg&&(s.svg=s.svg.replace(/&(?!amp;)/g,"&amp;"),s.svg=s.svg.replace(/(<tspan.*?>)(.*?)(<\/tspan>)/g,(function(t,e,o,i){return e+(o=(o=(o=o.replace(/</g,"&lt;")).replace(/>/g,"&gt;")).replace(/"/g,"&quot;"))+i})))}var a=new e($(o),i);return d.EditorCollection.getInstance().add(t,a),e.currentEditor=a,a.init(),a},e.constructUniqueID=function(){return"editor-"+(d.EditorCollection.getInstance().length+1)},e.prototype.init=function(){this.prepModel(),this.prepView(),this.prepController(),this.rebuildSVG(this.model),this.trigger(A.EditorEventType.INITIATED),this.isCartFull()},e.prototype.prepModel=function(){this._size=this.$el.data("size")},e.prototype.prepView=function(){this.ui.init(),this._svgFilters=new Filters(this),this.api=new l.EditorAPI(this),this.helpers=new a.EditorHelper(this),this.$container.attr("id",this.containerID)},e.prototype.prepController=function(){var t=this,e=new w.EditorWindowResizeCommand;this.registerCommand(window,"resize orientationchange",e),D.MediaUtil.isTouchDevice()&&(this.registerCommand("body","focusin",new H.EditorFocusInCommand,"input, textarea"),this.registerCommand("body","blur",e,"input, textarea")),this.registerCommand(document,"mousedown",new O.EditorDocumentMouseDownCommand),this.registerCommand(this,"editorClick",new c.EditorClickCommand),this.registerCommand(this,"editorDblClick",new h.EditorDblClickCommand),this.registerCommand(this,"editorStartDrag",new u.EditorStartDragCommand),this.registerCommand(this,"editorMoveDrag",new p.EditorMoveDragCommand),this.registerCommand(this,"editorEndDrag",new f.EditorEndDragCommand),this.registerCommand(this,A.EditorEventType.MOUSE_MOVE_NO_DRAG,new g.EditorMoveNoDragCommand),this.registerCommand(this,"editorLeaveSVG",new v.EditorLeaveSVGCommand),this.registerCommand(this,"editorStartTouch",new m.EditorStartTouchCommand),this.registerCommand(this,"editorRotate",new _.EditorRotateCommand),this.registerCommand(this,"editorZoom",new b.EditorZoomCommand),this.registerCommand(this,"editorEndTouch",new y.EditorEndTouchCommand),this.registerCommand(this,"editorSwapTranform",new E.EditorSwapTransformCommand),this.registerCommand(this,A.EditorEventType.SVG_CREATED,new P.EditorSVGCreatedCommand),this.registerCommand(this,A.EditorEventType.SVG_PART_CREATED,new V.EditorSVGPartCreatedCommand),this.registerCommand(this,A.EditorEventType.SVG_PARTS_LOADED,new C.EditorSVGPartsLoadedCommand),this.registerCommand(this.$container,"dragover",new T.EditorDragOverCommand),this.registerCommand(this.$container,"drop",new x.EditorDropCommand),this.registerCallback(window,"beforeunload",(function(e){return t.onWindowBeforeUnload(e)})),this.registerCommand(this.$el,A.EditorEventType.CHANGE_MATERIAL,new k.EditorChangeMaterialCommand),this.registerCommand(this.$el,A.EditorEventType.CHANGE_TEMPLATE,new B.EditorChangeTemplateCommand),this.registerCommand(this.$el,A.EditorEventType.CHANGE_TEMPLATE_TYPE,new R.EditorChangeTemplateTypeCommand),this.registerCommand(this.$el,A.EditorEventType.OPEN_TEMPLATE_TYPE_SELECTOR,new G.EditorOpenTemplateTypeSelectorCommand),this.registerCommand(this.$el,A.EditorEventType.CHANGE_NOTE,new I.EditorChangeNoteCommand),this.registerCommand(this.$el,A.EditorEventType.REQUEST_UPDATE,new N.EditorUpdateCommand),this.registerCommand(this.$el,A.EditorEventType.SAVE,new M.EditorSaveCommand),this.registerCommand(this.$el,A.EditorEventType.PRE_CHECKOUT_ACTION,new X.EditorPreCheckoutCommand);var o=new L.UpdateStickySizeLabelCommand;this.registerCommand(this.$el,A.EditorEventType.ORIENTATION_UPDATE,o),this.registerCommand(this.$el,A.EditorEventType.SET_WIDTH_AND_HEIGHT,o),this.on(A.EditorEventType.DESELECT_NODE,(function(e,o){return t.trigger(A.EditorEventType.PREVIEW_ON)})),this.on(A.EditorEventType.SELECT_NODE,(function(e,o){return t.trigger(A.EditorEventType.PREVIEW_OFF)}));var i=new z.EditorOnPartEditedCommand;this.registerCommand(this.$el,A.EditorEventType.PART_EDITED,i),this.model.editor.backPrintToolEnabled&&this.model.parts.length>1&&this.prepPaperBackPrintCommands()},e.prototype.prepPaperBackPrintCommands=function(){var t=this;this.registerCommand(this.$el,A.EditorEventType.SET_ACTIVE_PART,new U.EditorUpdateUIOnPartChange),this.registerCommand(this.$el,A.EditorEventType.BACKSIDEPRINT_MODIFIED,new W.BackprintModifiedCommand),this.registerCommand(this.$el,A.EditorEventType.REQUEST_UPDATE,new Y.RequestUpdateBackprintCommand),this.registerCommand(this.$el,A.EditorEventType.UPDATE_BACKPRINT_PATH,new F.EditorUpdateBacksidePartCommand),this.registerCommand(this.$el,A.EditorEventType.BACKSIDEPRINT_UPDATED,new q.BackprintUpdatedCommand),this.on(A.EditorEventType.PRE_SAVE,(function(){t.api.sheetHasBackprint()||t.api.ClearBackParts()}))},e.prototype.rebuildSVG=function(t,e){void 0===e&&(e=!1),this.svg&&$(this.svg.root.element).detach(),this.$container.empty(),this.trigger(A.EditorEventType.SVG_DESTROYED),this._controller.off(),this.model=t,this.model.editor.px2mm=void 0===this.model.editor.px2mm?1:this.model.editor.px2mm,void 0===this.model.editor.viewBox&&(this.model.editor.viewBox="0 0 "+parseFloat(this.model.sheet.width)*this.model.editor.px2mm+" "+parseFloat(this.model.sheet.height)*this.model.editor.px2mm),this.model.editor.preserveAspectRatio=void 0===this.model.editor.preserveAspectRatio?"xMidYMid meet":this.model.editor.preserveAspectRatio,this.model.editor.manualMargin?this.model.editor.margin=this.model.editor.manualMargin:this.model.editor.margin=this.formatSVGMargins();var o=this;switch(this.svg=new SVG(this,{preserveAspectRatio:this.model.editor.preserveAspectRatio,viewBox:this.model.editor.viewBox,margin:this.model.editor.margin,px2mm:this.model.editor.px2mm,noZoom:this.model.editor.noZoom,zoomDelay:this.model.editor.zoomDelay,zoomSteps:this.model.editor.zoomSteps,imperial:this.model.editor.imperial,language:this.model.language,extraCopy:this.model.editor.extraCopy,min_size:this.model.editor.min_size,max_size:this.model.editor.max_size,fadePathId:this.model.editor.fadePathId}),this.svg.filters=this._svgFilters,this.model.sheet.sheet_type){case"skin":this.svg.mode=SVG.MODE_SKIN,this.svg.sheetZoomable=!1;break;case"sheet":this.svg.mode=SVG.MODE_SHEET,this.svg.sheetZoomable=!0;break;case"case":this.svg.mode=SVG.MODE_CASE,this.svg.sheetZoomable=!1;break;case"single":this.svg.mode=SVG.MODE_SINGLE,this.svg.sheetZoomable=!1;break;default:return}this.svg.defs=this.svg.createNode(SVG.DEFS,{id:"defsLayer"}),this.svg.defs.ignore=!0,this.svg.defs.overHandling=SVG.OVER_NEVER,this.svg.filters.CreateFilters();var i=this.svg.createNode(SVG.LAYER_STANDARD,{id:"preBottomLayer"});i.ignore=!0,i.overHandling=SVG.OVER_NEVER;var r=new Array;this.model.sheet.width<Number(this.model.editor.min_size)&&0!=Number(this.model.editor.min_size)&&0!=this.model.sheet.width&&(this.model.sheet.width=Number(this.model.editor.min_size)),this.model.sheet.height<Number(this.model.editor.min_size)&&0!=Number(this.model.editor.min_size)&&0!=this.model.sheet.height&&(this.model.sheet.height=Number(this.model.editor.min_size)),this.model.sheet.width>Number(this.model.editor.max_size)&&0!=Number(this.model.editor.max_size)&&0!=this.model.sheet.width&&(this.model.sheet.width=Number(this.model.editor.max_size)),this.model.sheet.height>Number(this.model.editor.max_size)&&0!=Number(this.model.editor.max_size)&&0!=this.model.sheet.height&&(this.model.sheet.height=Number(this.model.editor.max_size)),r.json=this.model.sheet,this._controller.on(),this.svg.createNode(SVG.LAYER_SHEET,r,(function(t){o.svg.sheet=t,o.svg.mode==SVG.MODE_SHEET&&(o.svg.imperial?o.trigger(A.EditorEventType.SET_WIDTH_AND_HEIGHT,{width:Math.round(t.width/2.54)/10,height:Math.round(t.height/2.54)/10,triggerQuantity:!0}):o.trigger(A.EditorEventType.SET_WIDTH_AND_HEIGHT,{width:Math.round(t.width)/10,height:Math.round(t.height)/10,triggerQuantity:!0}))})),this.svg.shadow=this.svg.createNode(SVG.LAYER_SHADOW,{id:"shadowLayer"});var n=this.svg.createNode(SVG.LAYER_STANDARD,{id:"partPathLayer"});n.ignore=!0,n.overHandling=SVG.OVER_NEVER;var s=this.svg.createNode(SVG.LAYER_STANDARD,{id:"preTopLayer"});s.ignore=!0,s.overHandling=SVG.OVER_NEVER,this.svg.infoLayer=this.svg.createNode(SVG.LAYER_STANDARD,{id:"infoLayer"}),this.svg.infoLayer.ignore=!0,this.svg.infoLayer.overHandling=SVG.OVER_NEVER,this.svg.sheet.createSheetStep2(),this.model.outline&&this.helpers.outline.jsonSettings(this.model.outline),$(this).trigger(A.EditorEventType.SVG_CREATED),null!=this.svg.activePart&&e&&this.trigger(A.EditorEventType.PART_EDITED,{edited:"rebuild"})},e.prototype.rotateSnap=function(t,e){var o=this.svg.selected.getBaseTransformationMatrix(),i=Math.atan2(o.b,o.a)*(180/Math.PI),r=i+t;return r>180&&(r=r-180-180),r<-180&&(r=180+(r+180)),r>0-e&&r<0+e&&(t=0-i),r>90-e&&r<90+e&&(t=90-i),r>-90-e&&r<-90+e&&(t=-90-i),(r>180-e||r<-180+e)&&(t=180-i),t},e.prototype.destroy=function(){this.$el.trigger(A.EditorEventType.DESTROY),this._controller.off(),this._controller.destroy(),this.helpers.destroy(),this._ui.destroy(),this.$container.html(""),this._destroyed=!0},e.prototype.registerCommand=function(t,e,o,i){return this._controller.registerCommand(t,e,o,i)},e.prototype.registerCallback=function(t,e,o,i){return this._controller.registerCallback(t,e,o,i)},e.prototype.on=function(t,e,o){return this.registerCallback(this.$el,t,e,o),this.$el},e.prototype.once=function(t,e,o){var i=this;this.on(t,e,(function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];i.off(t,e,o),(o||e).apply(void 0,r)}))},e.prototype.refreshBoundingClientRect=function(){this._boundingClientRect=this.container.getBoundingClientRect()},e.prototype.exportAndSanitizeData=function(t){var e=this.api.Export();return e.sheet.sheet_id=this.model.sheet.sheet_id,e.sheet.sheet_type=this.model.sheet.sheet_type_save_as?this.model.sheet.sheet_type_save_as:this.model.sheet.sheet_type,e.sheet.sheet_name=this.model.sheet.sheet_name,e.sheet.design_id=this.model.sheet.design_id,e.sheet.admin_type=this.model.sheet.admin_type,e.sheet.width=Math.round(e.sheet.width),e.sheet.height=Math.round(e.sheet.height),e.sheet.preview=this.$(".preview-image").first().attr("src"),e.sheet.quantity=this.ui.quantity,e.sheet.material=this.model.sheet.material,e.sheet.laminate=this.model.sheet.laminate,e.sheet.note=this.model.sheet.note?this.model.sheet.note:"","single"==e.sheet.sheet_type&&(e.sheet.aspect="aspect_scale_single_sticker_by_sheet_dimensions"),null!=this.svg.collage&&(e.sheet._hasCollage=!0),e.sheet.meta||(e.sheet.meta={}),e.sheet.meta.IS_CHANGED&&"1"==e.sheet.meta.IS_CHANGED||(e.sheet.meta.IS_CHANGED=this.api.isChanged()?"1":"0"),e.intent=t,e},e.prototype.formatSVGMargins=function(){return"7 7 7 7 7 7 7 7"},e.prototype.createSVGMatrix=function(){return this.svg.root.element.createSVGMatrix()},e.prototype.createSVGTransform=function(){return this.svg.root.element.createSVGTransform()},e.prototype.isLargeMode=function(){return this.$el.hasClass(e.SIZE_LARGE)},e.prototype.isLandscapeOrientation=function(){return this.$el.hasClass(e.ORIENTATION_LANDSCAPE)},e.prototype.isEmbededInModal=function(){return this.$editorModal.length>0},e.prototype.getScreenCTM=function(){var t=this.svg.root.element.getScreenCTM();if(t||(t=this.createSVGMatrix()),this.isModal&&navigator.userAgent.indexOf("Firefox")>-1){var e=t.e-$(window).width()/2,o=t.f-$(window).height()/2;e>-1&&o>-1&&(t.e=e,t.f=o)}return t},e.isLandscape=function(t,e){return D.MediaUtil.isLandscape(t,e)&&e>480},e.isLarge=function(t,e){return D.MediaUtil.isLarge(t,e)},Object.defineProperty(e.prototype,"$editorModal",{get:function(){return this.$el.closest("#"+j.EditorModal.ELEMENT_ID)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"destroyed",{get:function(){return this._destroyed},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isModal",{get:function(){return!!this.$el.closest(".editor-modal").length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$container",{get:function(){return this.$(".editor-container")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"container",{get:function(){return this.$(".editor-container").get(0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ui",{get:function(){return this._ui},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._size&&"auto"!=this._size?this._size:currentSize_},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fixedTop",{get:function(){return this.boundingClientRect.top},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fixedLeft",{get:function(){return this.boundingClientRect.left},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"boundingClientRect",{get:function(){return this._boundingClientRect||this.refreshBoundingClientRect(),this._boundingClientRect},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this.$el.attr("id")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"svgRootID",{get:function(){return this.id+"-svgroot"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"containerID",{get:function(){return this.id+"-container"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"controller",{get:function(){return this._controller},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"orientation",{get:function(){return this.$el.hasClass(e.ORIENTATION_LANDSCAPE)?e.ORIENTATION_LANDSCAPE:this.$el.hasClass(e.ORIENTATION_PORTRAIT)?e.ORIENTATION_PORTRAIT:null},set:function(t){switch(t){case e.ORIENTATION_PORTRAIT:this.$el.removeClass(e.ORIENTATION_LANDSCAPE).addClass(e.ORIENTATION_PORTRAIT);break;case e.ORIENTATION_LANDSCAPE:this.$el.removeClass(e.ORIENTATION_PORTRAIT).addClass(e.ORIENTATION_LANDSCAPE)}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"focus",{get:function(){return this._focus},set:function(t){this._focus=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"ORIENTATION_LANDSCAPE",{get:function(){return"editor-orientation-landscape"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"ORIENTATION_PORTRAIT",{get:function(){return"editor-orientation-portrait"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"SIZE_LARGE",{get:function(){return"editor-size-lg"},enumerable:!1,configurable:!0}),e.prototype.onWindowBeforeUnload=function(t){if(this.model.editor.askBeforeExit&&this.api.isChanged())return t.returnValue=this.model.language.unload_warning,this.model.language.unload_warning},e.prototype.isCartFull=function(){this.model.editor.isCartFull&&!this.model.sheet.sheet_id&&$("#modal-full-cart-warning").modal("show")},e}(r.ViewComponent);exports.Editor=Z},90624:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.EditorAPI=void 0;var r=e(94297),n=e(35896),s=e(28977),a=e(27385),l=e(70946),d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.AddPart=function(t,e,o,i,r,n,s,a,l,d,c){e=void 0===e?null:e,o=void 0===o?null:o,i=void 0===i?Math.random().toString().replace(",","").replace(".",""):i,r=void 0===r||r,n=void 0===n||n,s=void 0===s||s,a=void 0===a||a,l=void 0!==l&&l,d=void 0===d?null:d,c=void 0===c?null:c,this.editor.svg.createNode(SVG.PART,{id:i,path:t,background:o,editable:r,resizable:s,matrix:d,bleed:e,part_type:c})},e.prototype.GetInversedMatrixString=function(t,e){return"matrix("+-Math.abs(t.a)+", "+t.b+","+t.c+","+t.d+","+e+","+t.f+")"},e.prototype.AddSVG=function(t,e,o){void 0===o&&(o=!0);var i=this,r=this.jsonToObject(t);this.editor.helpers.menu.AddSVG(r,(function(t){if(null!=t){var r=!0;t.type==SVG.SHAPE_MULTI&&(t.children[0].vector||null!=i.editor.svg.collage&&i.editor.svg.collage.getPart().intId==i.editor.svg.activePart.intId&&(i.editor.svg.collage.addImage(t),r=!1));var n=!1;i.editor.svg.sheet.sheet_type==SVG.MODE_CASE&&(n=!0);var s=!1;t.type==SVG.SHAPE_MULTI&&null!=i.editor.svg.collage&&(s=!0),o&&(i.editor.svg.centerHorOrVer(t,!1,!1,s,n),i.editor.svg.centerHorOrVer(t,!0,!1,s,n)),r&&(i.editor.svg.zoom==SVG.ZOOM_SHEET?i.editor.helpers.select.select(t.getPart()):i.editor.helpers.select.select(t)),void 0!==e&&e(t)}else void 0!==e&&e(null)}))},e.prototype.SetMargin=function(t){this.editor.svg.setMargin(t),this.editor.svg.refreshMargin(),$(this.editor).trigger(n.EditorEventType.EDITOR_RESIZE)},e.prototype.Export=function(){var t=this.editor.helpers.exportHelper.exportSheet();return t.sheet.meta&&t.sheet.meta.hasOwnProperty("IS_CHANGED")&&"0"==t.sheet.meta.IS_CHANGED&&(t.sheet.meta.IS_CHANGED=this.editor.api.isChanged()?"1":"0"),t},e.prototype.ChangeText=function(t){var e=this.jsonToObject(t),o=null,i=!1;if(null!=this.editor.svg.selected&&this.editor.svg.selected.type==SVG.SHAPE_TEXT||null!=this.specialTextSelection){if((o=null!=this.specialTextSelection?this.specialTextSelection:this.editor.svg.selected).changeText(e),this.editor.svg.zoom==SVG.ZOOM_PART){if(this.editor.svg.sheet.sheet_type!=SVG.MODE_SHEET&&(o.boundingBox.width>.8*this.editor.svg.activePart.boundingBox.width||o.boundingBox.height>.8*this.editor.svg.activePart.boundingBox.height)&&void 0!==e.text){var r={},n=.8*this.editor.svg.activePart.boundingBox.width/o.boundingBox.width,s=.8*this.editor.svg.activePart.boundingBox.height/o.boundingBox.height,a=Math.min(n,s);r.size=o.element.getAttribute("font-size")*a,o.changeText(r)}}else(o.boundingBox.width>.8*this.editor.svg.sheet.boundingBox.width||o.boundingBox.height>.8*this.editor.svg.sheet.boundingBox.height)&&(r={},n=.8*this.editor.svg.sheet.boundingBox.width/o.boundingBox.width,s=.8*this.editor.svg.sheet.boundingBox.height/o.boundingBox.height,a=Math.min(n,s),r.size=o.element.getAttribute("font-size")*a,o.changeText(r)),o.makeBBoxUpdateList(),this.editor.svg.activePart.adaptToContent();o.makeBBoxUpdateList(),i&&this.editor.svg.activePart.adaptToContent(),this.editor.helpers.select.reDrawHoverAndSelect()}else{if(void 0===e.text||""==e.text)return;if(null==this.editor.svg.activePart){var l=this.editor.svg.sheet.height,d=this.editor.svg.sheet.width;this.editor.svg.activePart=this.editor.svg.createNode(SVG.PART,{part_type:SVG.PART_TYPE_RECT,width:d,height:l}),i=!0}var c=[],h=this.editor.svg.root.element.createSVGPoint();h.x=this.editor.svg.activePart.center.x,h.y=this.editor.svg.activePart.center.y,h=h.matrixTransform(this.editor.svg.activePart.partGroupNode.element.transform.baseVal.getItem(0).matrix.inverse());var u=1*this.editor.svg.activePart.boundingBox.height/this.editor.svg.activePart.partGroupNode.element.transform.baseVal.getItem(0).matrix.d/5;c.left=h.x,c.top=h.y,c.font=void 0===e.font?"ariel":e.font,c.fill=void 0===e.color?"#000000":e.color,c.size=void 0===e.size?u:e.size,c.anchor=void 0===e.align?"middle":e.align,c.text=void 0===e.text?"":e.text,c.id=Math.random().toString().replace(",","").replace(".",""),c.part=this.editor.svg.activePart.id,c.locked=void 0!==e.locked&&e.locked,this.editor.helpers.select.select(null),o=this.editor.svg.createNode(SVG.SHAPE_TEXT,c),i&&this.editor.svg.activePart.adaptToContent(),this.editor.svg.zoom==SVG.ZOOM_SHEET?this.specialTextSelection=o:this.editor.helpers.select.select(o)}},e.prototype.ChangeTextColor=function(t){(null!=this.editor.svg.selected&&this.editor.svg.selected.type==SVG.SHAPE_TEXT||null!=this.specialTextSelection)&&(null!=this.specialTextSelection?this.specialTextSelection.changeColor(t):this.editor.svg.selected.changeColor(t))},e.prototype.GetText=function(){var t={text:""};return null!=this.editor.svg.selected&&this.editor.svg.selected.type==SVG.SHAPE_TEXT&&(t=this.editor.svg.selected.getTextAsJson()),t},e.prototype.ChangeBackground=function(t){var e=this.jsonToObject(t);if(e.sync)for(var o=this.editor.svg.sheet.parts,i=0;i<o.length;i++)o[i].setBackground(e.color);else null!=this.editor.svg.activePart&&this.editor.svg.activePart.setBackground(e.color)},e.prototype.SetCMYKBackgound=function(t){null!=this.editor.svg.activePart&&this.editor.svg.activePart.setCMYKBackground(t)},e.prototype.SetWhiteLayer=function(t){null!=this.editor.svg.activePart&&this.editor.svg.activePart.setWhiteLayer(t)},e.prototype.GetBackground=function(){if(null!=this.editor.svg.activePart)return null!=this.editor.svg.activePart.backGroundNode?this.editor.svg.activePart.backGroundNode.element.getAttribute("fill"):"none"},e.prototype.GetCmykBackground=function(){return null!=this.editor.svg.activePart?this.editor.svg.activePart.getCMYKBackground():null},e.prototype.GetWhiteLayer=function(){return null!=this.editor.svg.activePart?this.editor.svg.activePart.getWhiteLayer():null},e.prototype.GetParts=function(){for(var t=this.editor.svg.sheet.parts,e=[],o=0;o<t.length;o++)e.push(t[o].id);return e},e.prototype.GetActivePartId=function(){return null!=this.editor.svg.activePart&&this.editor.svg.activePart.id},e.prototype.GetActivePartSide=function(){return null!=this.editor.svg.activePart&&this.editor.svg.activePart.side},e.prototype.GetFrontPart=function(){return this.editor.svg.sheet.parts.filter((function(t){return t.side==l.EditorActivePartSide.FRONT}))[0]||!1},e.prototype.GetBackPart=function(){return this.editor.svg.sheet.parts.filter((function(t){return t.side==l.EditorActivePartSide.BACK}))[0]||!1},e.prototype.GetBackDealPart=function(){return this.editor.svg.sheet.parts.filter((function(t){return t.side==l.EditorActivePartSide.BACK_DEAL}))[0]||!1},e.prototype.ChangeActivePart=function(t){this.editor.svg.changeMode(SVG.ZOOM_PART,this.editor.svg.getNodeById(t))},e.prototype.GetSheetData=function(){var t={};return t.width=this.editor.svg.sheet.width,t.height=this.editor.svg.sheet.height,t.sheet_type=this.editor.svg.sheet.sheet_type,t},e.prototype.UpdatePart=function(){null!=this.editor.svg.activePart&&this.editor.svg.activePart.afterChangeAspect()},e.prototype.ChangePart=function(t,e){var o=this.jsonToObject(t),i=Object.keys(o).length;void 0!==o.path&&i--,null!=this.editor.svg.activePart?(o.corner_radius&&(o.part_type&&o.part_type==SVG.PART_TYPE_PATH||this.editor.svg.activePart.setCornersRadius(parseInt(o.corner_radius)),--i,void 0!==e&&i<=0&&e()),o.part_type&&(null!=this.editor.svg.sheet.sheet_meta?(this.editor.svg.sheet.sheet_meta.LAST_OUTLINE=o.part_type,o.corner_radius&&o.part_type==SVG.PART_TYPE_RECT&&(this.editor.svg.sheet.sheet_meta.LAST_OUTLINE=o.part_type+" "+o.corner_radius)):(this.editor.svg.sheet.sheet_meta={LAST_OUTLINE:o.part_type},o.corner_radius&&o.part_type==SVG.PART_TYPE_RECT&&(this.editor.svg.sheet.sheet_meta.LAST_OUTLINE=o.part_type+" "+o.corner_radius)),this.editor.svg.activePart.setPartType(o.part_type,(function(){--i,void 0!==e&&i<=0&&e()}),!1,o.path)),o.width&&(this.editor.svg.imperial&&(o.width=2.54*o.width),this.editor.svg.activePart.changeAspect("width",o.width,0,!1),this.editor.svg.activePart.part_type!=SVG.PART_TYPE_PATH&&this.editor.svg.activePart.afterChangeAspect(!1),--i,void 0!==e&&i<=0&&e()),o.height&&(this.editor.svg.imperial&&(o.height=2.54*o.height),this.editor.svg.activePart.changeAspect("height",0,o.height,!1),this.editor.svg.activePart.part_type!=SVG.PART_TYPE_PATH&&this.editor.svg.activePart.afterChangeAspect(!1),--i,void 0!==e&&i<=0&&e())):void 0!==e&&e()},e.prototype.DeSelect=function(){this.editor.helpers.select.select(null)},e.prototype.SelectPart=function(t){this.editor.helpers.select.select(this.editor.svg.getNodeById(t))},e.prototype.isChanged2=function(){for(var t=this.editor.svg.sheet.parts,e=0;t.length>e;e++)if((0,s.getBoolean)(t[e].edited))return!0;return!1},e.prototype.isChanged=function(t){if(void 0===t&&(t=!1),!this.editor.changed)return!1;for(var e=!1,o=JSON.stringify(this.editor.changed),i=this.allIndexOf(o,"flags"),r=0;r<i.length;r++){var n=i[r]+8,s=o.substr(n).indexOf('"'),a=new Array(s+1).join("1");o=o.substr(0,n)+a+o.substr(n+s)}var l=JSON.stringify(this.editor.helpers.exportHelper.exportSheet()),d=this.allIndexOf(l,"flags");for(r=0;r<d.length;r++)n=d[r]+8,s=l.substr(n).indexOf('"'),a=new Array(s+1).join("1"),l=l.substr(0,n)+a+l.substr(n+s);return o!=l&&(e=!0),t&&(this.editor.changed=this.editor.helpers.exportHelper.exportSheet()),e},e.prototype.zoomOut=function(){this.editor.svg.zoom==SVG.ZOOM_PART&&this.editor.svg.changeMode(SVG.ZOOM_SHEET)},e.prototype.isZoomed=function(){return this.editor.svg.zoom==SVG.ZOOM_PART},e.prototype.fill=function(t){null!=this.editor.svg.selected?this.editor.helpers.fill.gridFill(this.editor.svg.selected,t):(this.editor.ui.showMessage(4,2,this.editor.helpers.message.getId(),"Nothing selected"),void 0!==t&&t())},e.prototype.HighlightMessageSender=function(t){this.editor.helpers.dpi.highlight(t)},e.prototype.MakeManyParts=function(t,e,o,i,r,n){var s=(this.editor.svg.sheet.width-r)/e-r,a=(this.editor.svg.sheet.height-r)/t-r;if(n){var l=Math.min(s,a);s=l,a=l}for(var d=0;d<e;d++)for(var c=0;c<t;c++){var h={};h.part_type=o,h.width=s,h.height=a,h.cornersRadius=i,h.matrix="matrix(1,0,0,1,"+(d*(s+r)+r)*this.editor.svg.px2mm+","+(c*(a+r)+r)*this.editor.svg.px2mm+")",h.rotateable=!1,h.resizeable=!1,h.moveable=!1,h.skewable=!1,h.deleteable=!1,h.aspectChangable=!1,this.editor.svg.createNode(SVG.PART,h)}},e.prototype.CopyPartContent=function(t,e,o){if(t=void 0!==t&&t,e=void 0!==e&&e,null!=this.editor.svg.selected)for(var i=this.editor.svg.sheet.parts,r=0;r<i.length;r++)i[r].intId!=this.editor.svg.selected.intId&&(e||i[r].isEmpty())&&(e&&i[r].partGroupNode.removeChildren(),this.editor.svg.selected.copyTo(i[r],t,o));else this.editor.ui.showMessage(5,2,this.editor.helpers.message.getId(),"Nothing selected")},e.prototype.SetOutlineValues=function(t,e,o,i){this.editor.helpers.outline.settings(t,e,o,i)},e.prototype.ClearSheet=function(){for(var t=this.editor.svg.sheet.parts.length-1;t>=0;t--)this.editor.svg.sheet.parts[t].isDeleteable?this.editor.svg.sheet.parts[t].remove():(this.editor.helpers.select.select(null),this.editor.svg.sheet.parts[t].partGroupNode.removeChildren(),null!=this.editor.svg.sheet.parts[t].backGroundNode&&this.editor.svg.sheet.parts[t].setBackground("#FFF"))},e.prototype.ClearActivePart=function(){var t=this.editor.svg.getNodeById(this.GetActivePartId());$("#"+t.partGroupNode.element.id).empty(),t.setBackground("#FFF"),t.partGroupNode.removeChildren()},e.prototype.ClearBackParts=function(){for(var t=this.editor.svg.sheet.parts.length-1;t>=0;t--)"back"!=this.editor.svg.sheet.parts[t].side&&"back_deal"!=this.editor.svg.sheet.parts[t].side||(this.editor.svg.sheet.parts[t].isDeleteable?this.editor.svg.sheet.parts[t].remove():(this.editor.helpers.select.select(null),this.editor.svg.sheet.parts[t].partGroupNode.removeChildren(),null!=this.editor.svg.sheet.parts[t].backGroundNode&&this.editor.svg.sheet.parts[t].setBackground("#FFF")))},e.prototype.GetTopLeftPart=function(){if(0==this.editor.svg.sheet.parts.length)return null;for(var t=0,e=this.editor.svg.sheet.parts[0].boundingBox.x+this.editor.svg.sheet.parts[0].boundingBox.y,o=1;o<this.editor.svg.sheet.parts.length;o++){var i=this.editor.svg.sheet.parts[o].boundingBox.x+this.editor.svg.sheet.parts[o].boundingBox.y;i<e&&(t=o,e=i)}var r={};r.part_id=this.editor.svg.sheet.parts[t].id;var n=this.editor.getScreenCTM(),s=this.editor.svg.root.element.createSVGPoint();s.x=this.editor.svg.sheet.parts[t].boundingBox.x,s.y=this.editor.svg.sheet.parts[t].boundingBox.y,s=s.matrixTransform(n),r.point1=s;var a=this.editor.svg.root.element.createSVGPoint();return a.x=this.editor.svg.sheet.parts[t].boundingBox.x+this.editor.svg.sheet.parts[t].boundingBox.width,a.y=this.editor.svg.sheet.parts[t].boundingBox.x+this.editor.svg.sheet.parts[t].boundingBox.height,a=a.matrixTransform(n),r.point2=a,r},e.prototype.AnyEmptyParts=function(){for(var t=this.editor.svg.sheet.parts,e=0;e<t.length;e++)if(null==t[e].backGroundNode)for(var o=t[e].children,i=0;i<o.length&&o[i].type==SVG.GROUP_STANDARD&&0==o[i].children.length;i++)if(i==o.length-1)return!0;return!1},e.prototype.ChangeCollage=function(t){var e=this;if(0!=t){this.RemoveCollage();var o=[];o.collage_id=t,o.parentId="back",this.editor.svg.createNode(SVG.COLLAGE,o,(function(t){t.parent.moveChildToPos(t,t.parent.children.length-1),t.isIndexLocked=!0,t.ignore=!0,t.overHandling=SVG.OVER_LAYER,e.editor.svg.collage=t;for(var o=0;o<e.editor.svg.multiArr.length;o++)e.editor.svg.collage.getPart().intId==e.editor.svg.multiArr[o].getPart().intId&&(e.editor.svg.multiArr[o].collageObject=null,e.editor.svg.multiArr[o].type==SVG.SHAPE_MULTI&&null==e.editor.svg.multiArr[o].collageObject&&e.editor.svg.collage.addImage(e.editor.svg.multiArr[o]))}));for(var i=!1,r=0;r<this.editor.svg.multiArr.length;r++)null==this.editor.svg.multiArr[r].collageObject&&this.editor.svg.collage.getPart().intId==this.editor.svg.multiArr[r].getPart().intId&&(i=!0,this.editor.svg.multiArr[r].remove());i&&this.editor.ui.showMessage(7,1,this.editor.helpers.message.getId(),"Too many images"),this.editor.helpers.select.select(null),this.editor.trigger(n.EditorEventType.ACTIVATE_COLLAGE)}else this.RemoveCollage()},e.prototype.RemoveCollage=function(){if(null!=this.editor.svg.collage){for(var t=this.editor.svg.collage.getColParts(),e=0;e<t.length;e++)null!=t[e].imageNode&&(t[e].imageNode.ignore=!1,t[e].imageNode.overHandling=SVG.OVER_BBOX,t[e].imageNode.createBBoxAndCenter(),t[e].imageNode.collageObject=null,this.editor.svg.activePart.partGroupNode.changeBranch(t[e].imageNode));this.editor.svg.collage.remove(),this.editor.svg.collage=null,this.editor.trigger(n.EditorEventType.DEACTIVATE_COLLAGE)}},e.prototype.isTooManyImages=function(){return this.editor.helpers.menu.isTooManyImages()},e.prototype.getStickerSizes=function(){var t={};return null!=this.editor.svg.sheet&&(t.heightMM=this.editor.svg.sheet.height,t.widthMM=this.editor.svg.sheet.width,t.widthPX=this.editor.svg.sheet.pathNode.boundingBox.width/this.editor.helpers.select.lineWidthScale,t.heightPX=this.editor.svg.sheet.pathNode.boundingBox.height/this.editor.helpers.select.lineWidthScale),t},e.prototype.jsonToObject=function(t){if("string"==typeof t)try{var e=JSON.parse(t)}catch(t){return null}else{if("object"!=typeof t)return null;e=t}return e},e.prototype.allIndexOf=function(t,e){for(var o=[],i=t.indexOf(e);-1!==i;i=t.indexOf(e,i+1))o.push(i);return o},e.prototype.sheetHasBackprint=function(){return(0,s.getBoolean)(this.editor.model.sheet.meta.BACKPRINT_MODIFIED)||(0,s.getBoolean)(this.editor.model.sheet.meta.BACKPRINT_DEAL_ENABLED)},e.prototype.sheetHasValidBackprintMaterial=function(){if(void 0!==this.editor.model.editor.backPrintMaterialPresets&&this.editor.model.editor.backPrintMaterialPresets.length>0)for(var t=0,e=this.editor.model.editor.backPrintMaterialPresets;t<e.length;t++)if(e[t].preset_name===this.editor.model.sheet.materialPresetName)return!0;return!1},e.prototype.backPrintRequirementsFulfilled=function(){return this.sheetHasValidBackprintMaterial()&&a.BackprintHelper.sizeIsValidForPaperbackprintSticker(this.editor.model.sheet.width,this.editor.model.sheet.height)},e}(r.EditorComponent);exports.EditorAPI=d},94297:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.EditorComponent=void 0;var e=function(){function t(t){this.editor_=t}return Object.defineProperty(t.prototype,"editor",{get:function(){return this.editor_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"editor2",{get:function(){return this.editor_},enumerable:!1,configurable:!0}),t}();exports.EditorComponent=e},87066:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.EditorUI=void 0;var r=e(15839),n=e(44985),s=e(35896),a=e(92013),l=e(63200),d=e(62754),c=e(65642),h=e(48663),u=e(28977),p=e(88270),f=function(t){function e(e,o){var i=t.call(this,e)||this;return i._settingSizeAndOrientation=!1,i._currentlyFocusing=!1,i._editor=o,i}return i(e,t),e.prototype.destroy=function(){this.uploadTool.destroy(),this._toolpane.destroy()},e.prototype.$=function(t){return this.editor.$(t)},e.prototype.on=function(t,e,o){return this.editor.on(t,e,o)},e.prototype.registerCallback=function(t,e,o,i){return this.editor.registerCallback(t,e,o,i)},e.prototype.init=function(){this.prepModel(),this.prepView(),this.prepController()},e.prototype.prepModel=function(){this.model.ui||(this.model.ui={})},e.prototype.prepView=function(){this.editor.$el.removeClass("hidden"),this.setSizeAndOrientation(),this._toolpane=new l.EditorToolPane(this.$(".tool-pane"),this.editor),this._$spanTotalPriceFormatted=this.model.ui.spanTotalPriceFormatted?$(this.model.ui.spanTotalPriceFormatted):this.$(".summary-total"),this._$inputWidth=this.model.ui.inputWidth?$(this.model.ui.inputWidth):this.$(".summary-width"),this._$inputWidth.attr("data-container","#"+this.editor.id),this._$inputHeight=this.model.ui.inputHeight?$(this.model.ui.inputHeight):this.$(".summary-height"),this._$inputHeight.attr("data-container","#"+this.editor.id),this._$h1=this.$(".editor-header h1"),this._notificationTool=new a.NotificationEditorTool(this.$("section.editor-notifications"),this.editor),this.renderPrice(this.model.sheet.price,this.model.sheet.total,this.model.sheet.priceFrontPrint),this.renderMinAndMaxSize(this.model.editor.min_size,this.model.editor.max_size),this.$("input[type=number]").numbervalidator(),this.$("[class*=f-col] .content.input").each((function(){var t=$(this).find("label"),e=$("#"+t.attr("for"));if(t.length&&!e.length){var o=$(this).find("input");o.length&&(o.attr("id")||o.attr("id",d.StringUtil.uniqueID()),t.attr("for",o.attr("id")),o.on("focus",(function(){o.closest("[class*=f-col]").addClass("focus")})),o.on("blur",(function(){o.closest("[class*=f-col]").removeClass("focus")})))}}))},e.prototype.prepController=function(){var t=this;this.on(s.EditorEventType.READY,(function(e){return t.onEditorCreated(e)})),this.on("click",".tool-emojis",(function(){return t.editor.helpers.emoji.fixEmoji()})),this.on("click",".btn-save-sticker",(function(e){return t.editor.api.zoomOut(),e.preventDefault()})),this.on("click",".btn-save-case",(function(){return t.editor.trigger(jQuery.Event(s.EditorEventType.PREVIEW_ON)),t.editor.api.DeSelect()})),this.on("click",".btn-save-skin",(function(){return t.editor.trigger(jQuery.Event(s.EditorEventType.PREVIEW_ON)),t.editor.api.DeSelect()})),this.on("click",".btn-save-nail",(function(){return t.onSaveNail()})),this.on("click",".tool-fill-sheet:not(.disabled)",(function(){return t.onFillSheet()})),this.on("click",".btn-edit",(function(){return t.editor.trigger(jQuery.Event(s.EditorEventType.PREVIEW_OFF))})),this.on("click",".tool-empty-sheet",(function(e){return t.onClickEmptySheet(e)})),this.registerCallback(this._toolpane.quantityTool.$input,"update",(function(e){return t.update(!1)})),this.registerCallback(this._$inputWidth,"update",(function(e){return t.onUpdateWidth(e)})),this.registerCallback(this._$inputHeight,"update",(function(e){return t.onUpdateHeight(e)})),this.on(s.EditorEventType.SET_WIDTH_AND_HEIGHT,(function(e,o){return t.setSize(o.width,o.height,o.triggerQuantity)})),this.on("shown.bs.modal",".modal-editor",(function(e){return t.onShowModal(e)})),this.on(s.EditorEventType.DESELECT_NODE,(function(e,o){return t.$(".tool-fill-sheet").addClass("disabled"),t.$(".tip-template").hide()})),this.on(s.EditorEventType.SELECT_NODE,(function(e,o){return t.$(".tool-fill-sheet").removeClass("disabled")})),this.on(s.EditorEventType.ZOOM_CHANGE,(function(e,o){return t.onEditorZoomChange(o)})),this.on(s.EditorEventType.PREVIEW_OFF,(function(){return t.renderPreviewOff()})),this.on(s.EditorEventType.PREVIEW_ON,(function(){return t.renderPreviewOn()})),this.registerCallback(this.editor,s.EditorEventType.EDITOR_RESIZE,(function(e){return t.setSizeAndOrientation()})),this.toolPane.on(s.EditorEventType.TOOL_PANE_STATE_CHANGE,(function(e){return t.onEditorToolPaneStateChange(e)})),this.registerCallback(this.$homeButton,"click",(function(e){return t.onHomeClick(e)})),this.on("focus focusout","textarea, input",(function(e){return t.onFocusEvent(e)})),this.on("click",".tool.tool-close",(function(e){t.closeEditor(e)})),this.on("change",".tool.tool-size",(function(e){return t.editor.trigger(s.EditorEventType.PART_EDITED,{edited:"size"})})),$(".type-popover").popover({trigger:"click",placement:"bottom",container:$("#tool-content-title")})},e.prototype.closeEditor=function(t){this.editor.isModal?(this.model.editor.askBeforeExit&&this.editor.api.isChanged2()?p.EditorModal._instance.confirmHide():p.EditorModal._instance.hide(),$(".sticker-wizard").trigger("init_model"),$(".shape.item.active").trigger("click")):window.location.replace($(t.target).closest("div").data("backhref"))},e.prototype.hideTooltipsAndPopovers=function(){this.editor.$(".popover:not(.editor-popover)").popover("hide"),this.editor.$(".tooltip").tooltip("hide")},e.prototype.repositionTooltipsAndPopovers=function(){this.editor.$(".popover.in").popover("show"),this.editor.$(".tooltip.in").tooltip("show"),this.showTemplateTip(!0)},e.prototype.showTemplateTip=function(t){if(void 0===t&&(t=!1),this.$(".tip-template").length){var e=this.editor.api.GetTopLeftPart(),o=this.editor.$el.get(0).getBoundingClientRect();t||(this.editor.api.SelectPart(e.part_id),this.$(".tip-template").removeClass("hidden")),this.$(".tip-template").css({top:e.point1.y-this.$(".tip-template").height()/2-50-o.top+"px",left:e.point2.x-this.$(".tip-template").width()/2+36-o.left+"px"})}},e.prototype.setSizeAndOrientation=function(){if(!this._settingSizeAndOrientation){this._settingSizeAndOrientation=!0;var t=this.editor.isEmbededInModal()?this.editor.$editorModal.width():this.editor.$el.outerWidth(),e=this.editor.isEmbededInModal()?this.editor.$editorModal.height():this.editor.$el.outerHeight(),o=this.editor.orientation;if(this.editor.orientation=n.Editor.isLandscape(t,e)?n.Editor.ORIENTATION_LANDSCAPE:n.Editor.ORIENTATION_PORTRAIT,n.Editor.isLarge(t,e)?this.editor.$el.addClass(n.Editor.SIZE_LARGE):this.editor.$el.removeClass(n.Editor.SIZE_LARGE),this.editor.orientation===n.Editor.ORIENTATION_PORTRAIT){var i=0;if(this.$(".tool-backside-print.appended").is(":visible")&&(i=this.$(".tool-backside-print.appended").heightInt()+parseInt(this.$(".tool-backside-print.appended").css("top"))-$(".editor-header").heightInt()),this.$(".tool-backside-print.appended").css("width",this.editor.container.offsetWidth+"px"),this.editor.isModal||(i-=$(".navbar-header").heightInt()),this.$(".editor-container").css("padding-top",i+"px"),this._toolpane&&this._toolpane.state!=l.EditorToolPane.STATE_TOOL_OPEN){var r=this.$(".tool-pane").heightInt()+this.$("> .tool-bar").heightInt();r!=parseFloat(this.$(".editor-container").css("bottom"))&&(this.$(".editor-container").css("bottom",r+"px"),this.$(".editor-spinner").css("bottom",r+"px"),this.$("> .tool-pane").css("bottom",this.editor.$("> .tool-bar").outerHeight()+"px"),this.$(".editor-container").css("padding-bottom",""),$(window).trigger("resize"))}}else{var a=0;this.$(".tool-backside-print.appended").is(":visible")&&(a=this.$(".tool-backside-print.appended").heightInt()+parseInt(this.$(".tool-backside-print.appended").css("bottom"))+20),this.$(".editor-container").css("padding-bottom",a+"px"),this.$(".tool-backside-print.appended").css("width",this.editor.container.offsetWidth+"px"),this.$(".editor-container").css("bottom","0"),this.$(".editor-spinner").css("bottom","0"),this.$("> .tool-pane").css("bottom","")}this.$el.trigger(s.EditorEventType.ORIENTATION_UPDATE,{isLandscape:this.editor.isLandscapeOrientation(),isLarge:this.editor.isLargeMode()}),this.editor.orientation!=o&&this.$el.trigger(s.EditorEventType.ORIENTATION_CHANGE,{isLandscape:this.editor.isLandscapeOrientation(),isLarge:this.editor.isLargeMode()}),this._settingSizeAndOrientation=!1}},e.prototype.showSpinner=function(){this.$(".editor-spinner").removeClass("hidden")},e.prototype.hideSpinner=function(){this.$(".editor-spinner").addClass("hidden")},e.prototype.renderPreviewOff=function(){this.editor.$el.removeClass("preview-on").addClass("preview-off"),this.$(".visible-preview").hide()},e.prototype.renderPreviewOn=function(){this.editor.$el.removeClass("preview-off").addClass("preview-on"),this.setSizeCompare(),this.$(".visible-preview").show()},e.prototype.renderMinAndMaxSize=function(t,e){if(t){var o=this.model.editor.imperial?Math.round(t/25.4):t/10;"StickersThatStick"==SITE&&"us"==LANG&&0==o&&(o=.2),this._$inputWidth.prop({min:o}),this._$inputHeight.prop({min:o})}if(e){var i=this.model.editor.imperial?Math.round(e/25.4):e/10;this._$inputWidth.prop({max:i}),this._$inputHeight.prop({max:i})}},e.prototype.renderPrice=function(t,e,o){this.$(".quantity-loader").hide(),this.$(".summary-price").html(t).show();var i=this._$spanTotalPriceFormatted.html();if(this._$spanTotalPriceFormatted.html(e).show(),this.editor.svg&&this.editor.svg.mode==SVG.MODE_SINGLE&&this.editor.model.editor.materialPresets){var r=this.editor.model.sheet.material,n=this.editor.model.editor.materialPresets.filter((function(t){return t.materialName===r}))[0];n&&this.$(".price_front_material").html(n.title.split("(")[0]),this.$(".sticker_amount").html(o)}i!=e&&this._$spanTotalPriceFormatted.animateCSS("fadeIn")},e.prototype.renderPriceDetails=function(t){this.$(".paperback_amount").html(t),(0,u.getBoolean)(this.editor.svg.sheet.sheet_meta.BACKPRINT_MODIFIED)||(0,u.getBoolean)(this.editor.svg.sheet.sheet_meta.BACKPRINT_DEAL_ENABLED)?((0,u.getBoolean)(this.editor.svg.sheet.sheet_meta.BACKPRINT_DEAL_ENABLED)?(this.$(".editor-header .paperback_description").html(this.editor.model.language.incl_paperback_print_deal),this.$(".footer-landscape .paperback_description").html(this.editor.model.language.paper_backprint_deal)):(this.$(".editor-header .paperback_description, .price_desc").html(this.editor.model.language.incl_paperback_print),this.$(".footer-landscape .paperback_description").html(this.editor.model.language.paper_backprint)),this.$(".backprint_price_portrait").removeClass("hidden"),this.$(".paperback_price_container").removeClass("hidden"),this.$(".paper_back_amount").html(t)):(this.$(".backprint_price_portrait").addClass("hidden"),this.$(".paperback_price_container").addClass("hidden"))},e.prototype.renderQuantities=function(t,e,o){this._toolpane.quantityTool.minQuantity=t,this._toolpane.quantityTool.oldQuantity=this._toolpane.quantityTool.quantity=e,this._toolpane.quantityTool.options=o,this.$quantitySelector.prop("min",t)},e.prototype.update=function(t){void 0===t&&(t=!0),this.editor.trigger(s.EditorEventType.REQUEST_UPDATE,{renderQuantities:t})},e.prototype.save=function(){this.trigger(s.EditorEventType.SAVE)},e.prototype.setText=function(t){"back_deal"==this.editor.api.GetActivePartSide()?this.backPrintDealtextTool.setTextByJSON(t):this.textTool.setTextByJSON(t)},e.prototype.showMessage=function(t,e,o,i){this._notificationTool.add(t,e,o,i)},e.prototype.hideMessage=function(t){this._notificationTool.remove(t)},e.prototype.highlightMessageSender=function(t){this.editor.api.HighlightMessageSender(t)},e.prototype.getCurrentMediaSize=function(){return currentSize_},e.prototype.uploadFile=function(){this.uploadTool.open()},e.prototype.setSize=function(t,e,o){null!=t&&(this.model.sheet.width=10*t,this.model.editor.imperial&&(this.model.sheet.width=2.54*this.model.sheet.width),this._$inputWidth.val(t).html(t).attr("old",t),!h.MediaUtil.isTouchDevice()&&this._$inputWidth.is(":focus")&&this._$inputWidth.trigger("blur").trigger("focus")),null!=e&&(this.model.sheet.height=10*e,this.model.editor.imperial&&(this.model.sheet.height=2.54*this.model.sheet.height),this._$inputHeight.val(e).html(e).attr("old",e),!h.MediaUtil.isTouchDevice()&&this._$inputHeight.is(":focus")&&this._$inputHeight.trigger("blur").trigger("focus")),o&&this.update()},e.prototype.setSizeCompare=function(){if(!this.$("#size-compare").length)return!1;var t=this.$("#size-compare").data("width-mm"),e=this.editor.api.getStickerSizes(),o=t*(e.widthPX/e.widthMM);this.$("#size-compare").css({width:o+"px",height:.063*o+"px",left:"110px",bottom:"0px"}).show()},Object.defineProperty(e.prototype,"$homeButton",{get:function(){return this.$(".editor-header .cta.home")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"uploadTool",{get:function(){return this.toolPane.uploadTool},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$messages",{get:function(){return this.$("section.messages")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$uploadMessages",{get:function(){return this.$("section.messages .upload")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"quantity",{get:function(){return parseInt(this._toolpane.quantityTool.quantity)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"editor",{get:function(){return this._editor},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"editor2",{get:function(){return this._editor},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"model",{get:function(){return this.editor.model},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"textTool",{get:function(){return this._toolpane.textTool},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"backPrintDealtextTool",{get:function(){return this._toolpane.backPrintDealTextTool},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"toolPane",{get:function(){return this._toolpane},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$fileupload",{get:function(){return this.$("input.fileupload")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentlyFocusing",{get:function(){return this._currentlyFocusing},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"notificationTool",{get:function(){return this._notificationTool},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$quantitySelector",{get:function(){return $(".form-control.quantity-selector")},enumerable:!1,configurable:!0}),e.prototype.onEditorZoomChange=function(t){"sheet"==t?this.editor.$el.removeClass("zoomed"):this.editor.$el.addClass("zoomed")},e.prototype.onEditorCreated=function(t){var e=this;this._toolpane.prepTools(),this.renderMinAndMaxSize(this.model.editor.min_size,this.model.editor.max_size),$("#overlay").hide(),this._$h1.text(this.model.editor.title),this.showTemplateTip();var o=parseFloat(this.editor.model.sheet.width),i=parseFloat(this.editor.model.sheet.height);if(this.model.editor.imperial&&(o=Math.round(o/2.54),i=Math.round(i/2.54)),o/=10,i/=10,this.setSize(o,i),this.editor.api.UpdatePart(),this.editor.trigger(jQuery.Event(s.EditorEventType.PREVIEW_ON)),null!=this.editor.error){var r=this.model.language[this.editor.error];this.$messages.prepend('<div class="alert alert-danger upload">'+r+"</div>"),this.$uploadMessages.delay(8e3).fadeOut("fast")}this.editor.changed||(this.editor.changed=this.editor.helpers.exportHelper.exportSheet()),$("body").trigger("stickerapp.editorjs.ready"),$("#size-compare")&&this.registerCallback(this.editor,s.EditorEventType.EDITOR_RESIZE,(function(){return e.setSizeCompare()}))},e.prototype.onFillSheet=function(){var t=this;$("#overlay").fadeIn("fast",(function(){t.$(".tool-fill-sheet").hasClass("template")?(t.editor.api.CopyPartContent(!1,!0,!0),$("#overlay").hide()):t.editor.api.fill((function(){$("#overlay").hide()}))}))},e.prototype.onSaveNail=function(){this.editor.api.AnyEmptyParts()?this.$(".modal-save-nail").modal("show"):this.save()},e.prototype.onClickEmptySheet=function(t){var e=this;c.ConfirmModal.instance.confirmOrCancel(this.model.language.empty_sheet,(function(){return e.editor.api.ClearSheet(),e.editor.api.DeSelect()}))},e.prototype.onUpdateWidth=function(t){this.editor.api.ChangePart({width:10*$(t.currentTarget).val()}),this.setSize($(t.currentTarget).val(),null,!0)},e.prototype.onUpdateHeight=function(t){this.editor.api.ChangePart({height:10*$(t.currentTarget).val()}),this.setSize(null,$(t.currentTarget).val(),!0)},e.prototype.onShowModal=function(t){"phone"!=currentSize_&&($(".modal-backdrop").hide(),$(".modal.editor").not(t.currentTarget).modal("hide"))},e.prototype.onEditorToolPaneStateChange=function(t){switch(this.toolPane.state){case l.EditorToolPane.STATE_TOOLS_OVERVIEW:this.$homeButton.addClass("disabled");break;case l.EditorToolPane.STATE_TOOL_OPEN:this.$homeButton.removeClass("disabled")}},e.prototype.onHomeClick=function(t){this.toolPane.currentTool&&this.toolPane.currentTool.$backButton.trigger("click")},e.prototype.onFocusEvent=function(t){"focusout"!=t.type?this._currentlyFocusing=!0:this._currentlyFocusing=!1},e}(r.ViewComponent);exports.EditorUI=f},70946:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.EditorActivePartSide=void 0;var e=function(){function t(){}return Object.defineProperty(t,"FRONT",{get:function(){return"front"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"BACK",{get:function(){return"back"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"BACK_DEAL",{get:function(){return"back_deal"},enumerable:!1,configurable:!0}),t}();exports.EditorActivePartSide=e},78694:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.EditorController=void 0;var o=e(7353),i=e(84363),r=function(){function t(t){this._status="off",this._editor=t,this._eventReferenceCollection=new o.Collection,this._events=0}return t.prototype.executeCommand=function(t,e,o){this._eventReferenceCollection.get(t)&&this._eventReferenceCollection.get(t).callback(e,o)},t.prototype.registerCommand=function(t,e,o,r){this._events++;var n=this._events.toString(),s=new i.EventReference(t,e,r||"",(function(t,e){return o.execute(t,e)}));return this._eventReferenceCollection.add(n,s),o.editor=this._editor,"on"==this._status&&this.turnOn(s),n},t.prototype.registerCallback=function(t,e,o,r){this._events++;var n=this._events.toString(),s=new i.EventReference(t,e,r?o:null,r||o);return this._eventReferenceCollection.add(n,s),"on"==this._status&&this.turnOn(s),n},t.prototype.unregister=function(t,e){for(var o,i=1;i<this._events;i++)(o=this._eventReferenceCollection.get(i.toString()))&&o.object==t&&o.eventName==e&&(o.selector&&o.selector.length?$(o.object).off(o.eventName,o.selector,o.callback):$(o.object).off(o.eventName,o.callback),this._eventReferenceCollection.delete(i.toString()))},t.prototype.getEventReference=function(t){return this._eventReferenceCollection.get(t)},t.prototype.off=function(){if("off"!=this._status){for(var t,e=1;e<=this._events;e++)(t=this._eventReferenceCollection.get(e.toString()))&&this.turnOff(t);this._status="off"}},t.prototype.destroy=function(){for(var t=1;t<=this._events;t++)this._eventReferenceCollection.delete(t.toString())},t.prototype.unregisterAllByEventName=function(t){for(var e,o=1;o<=this._events;o++)(e=this._eventReferenceCollection.get(o.toString()))&&e.eventName==t&&(this.turnOff(e),this._eventReferenceCollection.delete(o.toString()))},t.prototype.offByEventName=function(t){for(var e,o=1;o<=this._events;o++)(e=this._eventReferenceCollection.get(o.toString()))&&e.eventName==t&&this.turnOff(e)},t.prototype.onByEventName=function(t){for(var e,o=1;o<=this._events;o++)(e=this._eventReferenceCollection.get(o.toString()))&&e.eventName==t&&this.turnOn(e)},t.prototype.turnOff=function(t){"string"==typeof t.selector&&t.selector.length?$(t.object).off(t.eventName,t.selector,t.callback):$(t.object).off(t.eventName,t.callback)},t.prototype.turnOn=function(t){"string"==typeof t.selector&&t.selector.length?$(t.object).on(t.eventName,t.selector,t.callback):$(t.object).on(t.eventName,t.callback)},t.prototype.on=function(){if("on"!=this._status){for(var t,e=1;e<=this._events;e++)(t=this._eventReferenceCollection.get(e.toString()))&&this.turnOn(t);this._status="on"}},Object.defineProperty(t.prototype,"status",{get:function(){return this._status},enumerable:!1,configurable:!0}),t}();exports.EditorController=r},35896:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.EditorEventType=void 0;var e=function(){function t(){}return Object.defineProperty(t,"UPLOAD_START",{get:function(){return"editorUploadStart"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"UPLOAD_CANCEL",{get:function(){return"editorUploadCancel"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"UPLOAD_END",{get:function(){return"editorUploadEnd"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"INITIATED",{get:function(){return"editorInitiated"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"MOUSE_MOVE_NO_DRAG",{get:function(){return"editorMoveNoDrag"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"DESTROY",{get:function(){return"editorDestroy"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"TOOL_PANE_STATE_CHANGE",{get:function(){return"editorToolPaneStateChange"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"ORIENTATION_CHANGE",{get:function(){return"editorOrientationChange"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"ORIENTATION_UPDATE",{get:function(){return"editorOrientationUpdate"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"CLOSE_TOOL",{get:function(){return"editorCloseTool"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"OPEN_TOOL",{get:function(){return"editorOpenTool"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"REMOVE_NOTIFICATION",{get:function(){return"editorRemoveNotification"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"ADD_NOTIFICATION",{get:function(){return"editorAddNotification"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"DEACTIVATE_COLLAGE",{get:function(){return"editorDeactivateCollage"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"ACTIVATE_COLLAGE",{get:function(){return"editorActivateCollage"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"PRE_SAVE",{get:function(){return"editorPreSave"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"SAVE",{get:function(){return"editorSave"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"SET_ACTIVE_PART",{get:function(){return"editorSetActivePart"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"SELECT_NODE",{get:function(){return"editorSelectNode"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"DESELECT_NODE",{get:function(){return"editorDeselectNode"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"REQUEST_UPDATE",{get:function(){return"editorRequestUpdate"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"UPDATED",{get:function(){return"editorUpdated"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"CHANGE_MATERIAL",{get:function(){return"editorChangeMaterial"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"CHANGE_TEMPLATE",{get:function(){return"editorChangeTemplate"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"CHANGE_TEMPLATE_TYPE",{get:function(){return"editorChangeTemplateType"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"OPEN_TEMPLATE_TYPE_SELECTOR",{get:function(){return"editorOpenTemplateTypeSelector"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"CHANGE_NOTE",{get:function(){return"editorChangeNote"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"READY",{get:function(){return"editorReady"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"SVG_CHANGE_MODE",{get:function(){return"editorSVGChangeMode"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"EDITOR_RESIZE",{get:function(){return"editorResize"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"EDITOR_CONTAINER_CLICK",{get:function(){return"editorClick"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"SVG_CREATED",{get:function(){return"editorSVGCreated"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"SVG_DESTROYED",{get:function(){return"editorSVGDestroyed"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"SVG_PARTS_LOADED",{get:function(){return"editorSVGPartsLoaded"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"SVG_PART_CREATED",{get:function(){return"editorSVGPartCreated"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"DATA_POSTED",{get:function(){return"editorDataPosted"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"SET_WIDTH_AND_HEIGHT",{get:function(){return"editorSetWidthAndHeight"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"PREVIEW_OFF",{get:function(){return"editorPreviewOFF"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"PREVIEW_ON",{get:function(){return"editorPreviewON"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"ZOOM_CHANGE",{get:function(){return"editorZoomChange"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"BACKSIDEPRINT_MODIFIED",{get:function(){return"backsidePrintModified"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"PART_EDITED",{get:function(){return"partEdited"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"UPDATE_BACKPRINT_PATH",{get:function(){return"updateBackPrintPath"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"BACKSIDEPRINT_UPDATED",{get:function(){return"backSidePrintUpdated"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"PRE_CHECKOUT_ACTION",{get:function(){return"preCheckoutAction"},enumerable:!1,configurable:!0}),t}();exports.EditorEventType=e},33566:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.EditorToolName=void 0;var e=function(){function t(){}return Object.defineProperty(t,"UPLOAD",{get:function(){return"upload"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"CUTLINE",{get:function(){return"cutline"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"MATERIAL_PRESET",{get:function(){return"material-preset"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"CLIPARTS",{get:function(){return"cliparts"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"EFFECT_LAYER_UPLOAD",{get:function(){return"effect_layer_upload"},enumerable:!1,configurable:!0}),t}();exports.EditorToolName=e},33047:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.EditorUploadStatus=void 0;var e=function(){function t(){}return Object.defineProperty(t,"IDLE",{get:function(){return"idle"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"START",{get:function(){return"start"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"DONE",{get:function(){return"done"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"ERROR",{get:function(){return"error"},enumerable:!1,configurable:!0}),t}();exports.EditorUploadStatus=e},68435:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.BackprintModifiedCommand=void 0;var r=e(27568),n=e(28977),s=e(35896),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.execute=function(t,e){(0,n.getBoolean)(this.editor.svg.sheet.sheet_meta.BACKPRINT_MODIFIED)||(this.editor.svg.sheet.sheet_meta.BACKPRINT_MODIFIED=!0,this.editor.ui.toolPane.removeBackPrintTool.setEnabled(!0),this.editor.ui.update(),this.editor.trigger(s.EditorEventType.BACKSIDEPRINT_UPDATED))},e}(r.EditorCommand);exports.BackprintModifiedCommand=a},57254:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.BackprintUpdatedCommand=void 0;var r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.execute=function(t,e){this.editor.ui.toolPane.saveButtonTool.setEnabled(!0),this.editor.ui.toolPane.backPrintEditorTool.enableButtons()},e}(e(27568).EditorCommand);exports.BackprintUpdatedCommand=r},90107:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.EditorChangeMaterialCommand=void 0;var r=e(27568),n=e(35896),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.execute=function(t,e){this.editor.model.sheet.material=e.materialName,this.editor.model.sheet.laminate=e.laminateName,this.editor.svg.mode!=SVG.MODE_CASE&&this.editor.svg.mode!=SVG.MODE_SKIN&&($("#overlay").show(),this.editor.trigger(n.EditorEventType.REQUEST_UPDATE,{rebuildSVG:!0,partChanged:!0}))},e}(r.EditorCommand);exports.EditorChangeMaterialCommand=s},15073:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.EditorChangeNoteCommand=void 0;var r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.execute=function(t,e){this.editor.model.sheet.note=e},e}(e(27568).EditorCommand);exports.EditorChangeNoteCommand=r},52850:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.EditorChangeTemplateCommand=void 0;var r=e(27568),n=e(35896),s=e(400),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.execute=function(t,e){$("#overlay").show(),s.GTMService.changeTemplate(this.editor.model.sheet.sheet_name,e.templateName),this.editor.model.sheet.sheet_name=e.templateName,this.editor.trigger(n.EditorEventType.REQUEST_UPDATE,{rebuildSVG:!0})},e}(r.EditorCommand);exports.EditorChangeTemplateCommand=a},15802:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.EditorChangeTemplateTypeCommand=void 0;var r=e(27568),n=e(35896),s=e(400),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.execute=function(t,e){$("#overlay").show(),s.GTMService.changeTemplate(this.editor.model.sheet.sheet_name,e.templateName),this.editor.model.sheet.sheet_name=e.templateName,this.editor.trigger(n.EditorEventType.REQUEST_UPDATE,{rebuildSVG:!0})},e}(r.EditorCommand);exports.EditorChangeTemplateTypeCommand=a},88834:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.EditorClickCommand=void 0;var r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.execute=function(t){var e=this._editor.helpers.icon.overIcon(t.point);if(null!=e)$(e.element).trigger("click");else if(this._editor.svg.isPointerOverActivePartPath(t.point.x,t.point.y)&&(null!=this._editor.svg.selected&&this._editor.svg.selected.intId!=this._editor.svg.activePart.intId||null==this._editor.svg.selected))this._editor.helpers.select.select(this._editor.svg.activePart);else{var o=this._editor.svg.getNodeOnPoint(t.point);this._editor.helpers.select.select(o)}this.editor.ui.hideTooltipsAndPopovers()},e}(e(27568).EditorCommand);exports.EditorClickCommand=r},27568:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.EditorCommand=void 0;var e=function(){function t(){}return t.prototype.execute=function(t,e){},Object.defineProperty(t.prototype,"editor",{get:function(){return this._editor},set:function(t){this._editor=t},enumerable:!1,configurable:!0}),t}();exports.EditorCommand=e},78698:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.EditorDblClickCommand=void 0;var r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.execute=function(t){var e=this._editor.helpers.icon.overIcon(t.point);if(null!=e){if("selectRotateIcon"==(e=e.id)){var o=this._editor.svg.selected.getBaseTransformationMatrix(),i=Math.round(Math.atan2(o.b,o.a)*(180/Math.PI));i=0==i||90==i||180==i||270==i||-90==i||-180==i||-270==i?this._editor.rotateSnap(90,45):this._editor.rotateSnap(0,45),this._editor.svg.updateNodeBeforeTransformation(this._editor.svg.selected,t),this._editor.svg.rotateNode(this._editor.svg.selected,i),this._editor.svg.updateNodeAfterTransformation(this._editor.svg.selected,window.SELECT_TOOL_ROTATE,t.point)}window.location.href.indexOf("admin.")>-1&&("selectNWIcon"!=e&&"selectNEIcon"!=e&&"selectSEIcon"!=e&&"selectSWIcon"!=e||(this._editor.svg.fit(this._editor.svg.selected,1,!0,!0,!0,!0),this._editor.svg.center(this._editor.svg.selected)))}else if(this._editor.svg.sheetZoomable)if(this._editor.svg.zoom==SVG.ZOOM_SHEET){var r=this._editor.svg.getNodeOnPoint(t.point);null!=r&&this._editor.svg.changeMode(SVG.ZOOM_PART,r)}else this._editor.svg.zoom==SVG.ZOOM_PART&&this._editor.svg.changeMode(SVG.ZOOM_SHEET);else{var n=this._editor.svg.getNodeOnPoint(t.point);null!=n&&n.onEditMenu()}},e}(e(27568).EditorCommand);exports.EditorDblClickCommand=r},13880:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.EditorDocumentMouseDownCommand=void 0;var r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.execute=function(t){this.editor.$el.has(t.target).length?$(t.target).hasClass("tool-pane")||this.editor.$(".tool-pane").has(t.target).length:this.editor.api.DeSelect(),this.editor.ui.hideTooltipsAndPopovers()},e}(e(27568).EditorCommand);exports.EditorDocumentMouseDownCommand=r},82064:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.EditorDragOverCommand=void 0;var r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.execute=function(t){t.preventDefault()},e}(e(27568).EditorCommand);exports.EditorDragOverCommand=r},58028:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.EditorDropCommand=void 0;var r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.execute=function(t){t.preventDefault();var e=this;if(""!=t.originalEvent.dataTransfer.getData("Image")){var o=t.originalEvent.dataTransfer.getData("Image"),i=o.substring(o.lastIndexOf("/")+1),r=o.substring(0,o.indexOf("."));if(null==this._editor.svg.activePart);else var n=this._editor.svg.createNode(SVG.SHAPE_IMAGE,{id:r,href:"/edit2/upload/"+i,part:this._editor.svg.activePart.id},(function(){e._editor.svg.fitAndCenterOnPart(n)}))}},e}(e(27568).EditorCommand);exports.EditorDropCommand=r},4293:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.EditorEndDragCommand=void 0;var r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.execute=function(t){var e=!1;if(null!=this._editor.svg.selected){if(this._editor.svg.selected.isTransformable)switch(this._editor.helpers.select.selectedTool){case window.SELECT_TOOL_MOVE:this._editor.svg.selected.isMoveable&&(e=!0);break;case window.SELECT_TOOL_ROTATE:case window.SELECT_TOOL_ROTATE_INVERSE:this._editor.svg.selected.isRotateable&&(e=!0);break;case window.SELECT_TOOL_NW_RESIZE:case window.SELECT_TOOL_NE_RESIZE:case window.SELECT_TOOL_SE_RESIZE:case window.SELECT_TOOL_SW_RESIZE:this._editor.svg.selected.isResizeable&&(e=!0);break;case window.SELECT_TOOL_N_RESIZE:case window.SELECT_TOOL_E_RESIZE:case window.SELECT_TOOL_S_RESIZE:case window.SELECT_TOOL_W_RESIZE:this._editor.svg.selected.isAspectChangable&&(e=!0)}if(e){var o=this._editor.helpers.select.selectedTool;this._editor.helpers.select.lockTool=!1,this._editor.helpers.select.selectedTool=null,this._editor.svg.updateNodeAfterTransformation(this._editor.svg.selected,o,t.point)}}},e}(e(27568).EditorCommand);exports.EditorEndDragCommand=r},89376:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.EditorEndTouchCommand=void 0;var r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.execute=function(t){null!=this._editor.svg.selected&&this._editor.svg.updateNodeAfterTransformation(this._editor.svg.selected)},e}(e(27568).EditorCommand);exports.EditorEndTouchCommand=r},79948:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.EditorFocusInCommand=void 0;var r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.execute=function(t,e){this.editor.focus=t.target},e}(e(27568).EditorCommand);exports.EditorFocusInCommand=r},15568:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.EditorLeaveSVGCommand=void 0;var r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.execute=function(t){this._editor.helpers.select.hover(null)},e}(e(27568).EditorCommand);exports.EditorLeaveSVGCommand=r},75782:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.EditorMoveDragCommand=void 0;var r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.execute=function(t){var e=this._editor.helpers.select.selectedTool;if(null!=this._editor.svg.selected){if(e==window.SELECT_TOOL_MOVE&&this._editor.svg.selected.isMoveable&&(this._editor.svg.moveNode(this._editor.svg.selected,t.point.x-this._editor.startDragX,t.point.y-this._editor.startDragY),this._editor.svg.selected.type==SVG.SHAPE_PATH&&this._editor.svg.selected.specialDrag(t.point)),e==window.SELECT_TOOL_ROTATE&&this._editor.svg.selected.isRotateable&&null!=this._editor.svg.selected){var o=this._editor.svg.selected.getCenterPoint(!1),i=t.point,r=o.y-i.y,n=o.x-i.x,s=180*Math.atan2(n,r)/Math.PI*-1;s=this._editor.rotateSnap(s,2),this._editor.svg.rotateNode(this._editor.svg.selected,s)}if(e==window.SELECT_TOOL_ROTATE_INVERSE&&this._editor.svg.selected.isRotateable&&null!=this._editor.svg.selected&&(o=this._editor.svg.selected.getCenterPoint(!1),r=(i=t.point).y-o.y,n=i.x-o.x,s=180*Math.atan2(n,r)/Math.PI*-1,s=this._editor.rotateSnap(s,2),this._editor.svg.rotateNode(this._editor.svg.selected,s)),(e==window.SELECT_TOOL_NW_RESIZE||e==window.SELECT_TOOL_NE_RESIZE||e==window.SELECT_TOOL_SE_RESIZE||e==window.SELECT_TOOL_SW_RESIZE)&&this._editor.svg.selected.isResizeable&&null!=this._editor.svg.selected){switch(e){case window.SELECT_TOOL_NW_RESIZE:a="nw";break;case window.SELECT_TOOL_NE_RESIZE:a="ne";break;case window.SELECT_TOOL_SE_RESIZE:a="se";break;case window.SELECT_TOOL_SW_RESIZE:a="sw"}this._editor.svg.sheet.sheet_type==SVG.MODE_SINGLE&&this._editor.svg.selected.type==SVG.PART&&this._editor.svg.selected.part_type!=SVG.PART_TYPE_PATH?this._editor.svg.selected.changeAspect(a,t.point.x-this._editor.startDragX,t.point.y-this._editor.startDragY):this._editor.svg.scaleNode(this._editor.svg.selected,a,t.point.x,t.point.y)}if((e==window.SELECT_TOOL_N_RESIZE||e==window.SELECT_TOOL_E_RESIZE||e==window.SELECT_TOOL_S_RESIZE||e==window.SELECT_TOOL_W_RESIZE)&&this._editor.svg.selected.isAspectChangable&&null!=this._editor.svg.selected){var a;switch(e){case window.SELECT_TOOL_N_RESIZE:a="n";break;case window.SELECT_TOOL_E_RESIZE:a="e";break;case window.SELECT_TOOL_S_RESIZE:a="s";break;case window.SELECT_TOOL_W_RESIZE:a="w"}this._editor.svg.selected.type==SVG.PART&&this._editor.svg.selected.changeAspect(a,t.point.x-this._editor.startDragX,t.point.y-this._editor.startDragY)}}},e}(e(27568).EditorCommand);exports.EditorMoveDragCommand=r},631:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.EditorMoveNoDragCommand=void 0;var r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.execute=function(t){var e=this._editor.svg.getNodeOnPoint(t.point);this._editor.helpers.select.lockTool?this._editor.helpers.select.hover(null):this._editor.svg.isPointerOverActivePartPath(t.point.x,t.point.y)&&(null!=this._editor.svg.selected&&this._editor.svg.selected.intId!=this._editor.svg.activePart.intId||null==this._editor.svg.selected)?(this._editor.svg.activePart.markPath(),this._editor.helpers.select.hover(this._editor.svg.activePart)):this._editor.svg.selected!=e?this._editor.helpers.select.hover(e):this._editor.helpers.select.hover(null)},e}(e(27568).EditorCommand);exports.EditorMoveNoDragCommand=r},74160:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.EditorOnPartEditedCommand=void 0;var r=e(27568),n=e(28977),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.execute=function(t,e){this.editor.svg.activePart&&!(0,n.getBoolean)(this.editor.svg.activePart.edited)&&(this.editor.svg.activePart.edited=!0)},e}(r.EditorCommand);exports.EditorOnPartEditedCommand=s},20756:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.EditorOpenTemplateTypeSelectorCommand=void 0;var r=e(27568),n=e(400),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.execute=function(t,e){$("#overlay").show(),n.GTMService.openTemplateTypeSelector(e)},e}(r.EditorCommand);exports.EditorOpenTemplateTypeSelectorCommand=s},10554:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.EditorPreCheckoutCommand=void 0;var r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.execute=function(t,e){var o=this,i=e.modal,r=e.action;switch(r){case"duplicateAndEdit":i.loading(r,!0),setTimeout((function(){i.loading(r,!1),i.done(r,!0),setTimeout((function(){i.hide()}),750)}),750);break;case"goToCheckout":i.loading(r,!0),setTimeout((function(){o.editor.model.editor.askBeforeExit=!1,window.location.pathname="checkout"}),500);break;case"makeNewSticker":i.loading(r,!0),setTimeout((function(){o.editor.model.editor.askBeforeExit=!1,o.editor.isModal?(i.hide(),o.editor.ui.closeEditor(t)):window.location.pathname="custom-stickers"}),500);break;default:i.hide()}},e}(e(27568).EditorCommand);exports.EditorPreCheckoutCommand=r},28762:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.EditorRotateCommand=void 0;var r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.execute=function(t){if(null!=this._editor.svg.selected){this._editor.svg.selected.getCenterPoint(!1);var e=t.angle;e=this._editor.rotateSnap(e,2),this._editor.svg.rotateNode(this._editor.svg.selected,e,!1)}},e}(e(27568).EditorCommand);exports.EditorRotateCommand=r},98283:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.EditorSVGCreatedCommand=void 0;var r=e(27568),n=e(35896),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.execute=function(t){this.editor.helpers.select.onEditorSVGCreated(),this.loadParts()},e.prototype.loadParts=function(){var t=this;if(void 0!==this.editor.model.parts){var e=this.editor.model.parts.length;if(0==e)$(this.editor).trigger(n.EditorEventType.SVG_PARTS_LOADED);else for(var o=function(o){var r=i.editor.model.parts[o];r.visibility="hidden",i.editor.svg.mode!=SVG.MODE_SHEET&&(r.deleteable=!1),r.visibility="hidden",i.editor.svg.createNode(SVG.PART,{json:r},(function(o){r._node=o,$(t.editor).trigger(n.EditorEventType.SVG_PART_CREATED,r),--e<=0&&$(t.editor).trigger(n.EditorEventType.SVG_PARTS_LOADED)}))},i=this,r=0;r<this.editor.model.parts.length;r++)o(r)}else $(this.editor).trigger(n.EditorEventType.SVG_PARTS_LOADED)},e}(r.EditorCommand);exports.EditorSVGCreatedCommand=s},22302:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.EditorSVGPartCreatedCommand=void 0;var r=e(27568),n=e(35896),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.execute=function(t,e){switch(this.editor.svg.mode){case SVG.MODE_SKIN:case SVG.MODE_CASE:this.onTemplatePartCreated(e),this.onCaseOrSkinPartCreated(e);break;case SVG.MODE_SINGLE:this.onSingleStickerCreated(e)}this.showPart(e)},e.prototype.showPart=function(t){$(t._node.element).css("visibility","visible"),$(t._node.pathNode.element).css("visibility","visible")},e.prototype.onTemplatePartCreated=function(t){t._node.originalPathBoundingBox&&!this.editor.svg.collage&&(this.editor.helpers.importHelper.rearrangeChildrenToNewPath(t._node.partGroupNode.children,t._node.originalPathBoundingBox,Raphael.pathBBox(t._node.path)),$(this.editor).trigger(n.EditorEventType.EDITOR_RESIZE))},e.prototype.onCaseOrSkinPartCreated=function(t){if(t._originallyDesignedSVG){var e=this.editor.helpers.exportHelper.findAttachmentIDs(t._originallyDesignedSVG);$.each(e,(function(e,o){var i=t._node.findChildWithOption("attachment_id",o);i&&i.parent.onDeleteMenu()&&(i.parent.isDeleteable=!0,i.parent.remove())})),this.editor.helpers.importHelper.importSVGData(t._originallyDesignedSVG,t._node,(function(t,e){$(window).trigger("resize"),$.each(e,(function(t,e){for(var o=e;o.parent&&o.parent.type!=SVG.GROUP_STANDARD;)o=o.parent;o.parent&&o.parent.type==SVG.GROUP_STANDARD&&o.parent.moveChildToPos(o,o.parent.children.length-1)}))}))}},e.prototype.onSingleStickerCreated=function(t){t&&t.side&&"front"!=t.side||("aspect_scale_single_sticker_by_sheet_dimensions"===this.editor.model.sheet.aspect&&(t._node.changeAspect("width",parseFloat(this.editor.model.sheet.width),0,!1,!0),t._node.changeAspect("height",0,parseFloat(this.editor.model.sheet.height),!1,!0),t._node.afterChangeAspect(!1)),t._node.stickySizeLabels=!0,t._node.showSize())},e}(r.EditorCommand);exports.EditorSVGPartCreatedCommand=s},13228:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.EditorSVGPartsLoadedCommand=void 0;var r=e(27568),n=e(35896),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.execute=function(t){var e=this;if(this.editor.model.parts&&this.editor.model.parts.length)for(var o=0;o<this.editor.model.parts.length;o++){var i=this.editor.model.parts[o];if(i.selectPartOnLoad){var r=!1;i._node.type==SVG.SHAPE_MULTI&&null!=this.editor.svg.collage&&(r=!0),this.editor.svg.centerHorOrVer(i._node,!1,!0,r),this.editor.svg.centerHorOrVer(i._node,!0,!0,r),this.editor.helpers.select.select(i._node)}}if(this.editor.svg.sheet.updatePartsOrder(),this.editor.svg.sheet.sheet_type==SVG.MODE_SHEET&&(this.editor.svg.sheet.showSize(),this.editor.registerCallback(window,"resize",(function(){return e.editor.svg.sheet.updateSize()}))),void 0===this.editor.model.editor.part_id&&this.editor.svg.sheet.parts.length>0&&(this.editor.api.GetFrontPart()?this.editor.model.editor.part_id=this.editor.api.GetFrontPart().id:this.editor.model.editor.part_id=this.editor.svg.sheet.parts[0].id),this.editor.model.editor.mode&&this.editor.model.editor.mode==SVG.ZOOM_PART){var s;s=this.editor.api.GetFrontPart()?this.editor.api.GetFrontPart().id:this.editor.model.editor.part_id,this.editor.svg.defaultBranch=this.editor.svg.getNodeById(s),this.editor.svg.changeMode(SVG.ZOOM_PART,this.editor.svg.getNodeById(s),!0)}else this.editor.trigger(n.EditorEventType.ZOOM_CHANGE,this.editor.svg.zoom);this.editor.svg.shadow.updateShadow(),this.editor.isReady=!0,$(window).trigger("resize"),this.editor.trigger(n.EditorEventType.READY,this.editor)},e}(r.EditorCommand);exports.EditorSVGPartsLoadedCommand=s},10388:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.EditorSaveCommand=void 0;var r=e(35896),n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.execute=function(t,e){var o=this,i=this.editor.exportAndSanitizeData(e);$.ajax({type:"POST",url:"/editor/save",data:i,success:function(t){return o.onSuccess({request:i,response:t,intent:e})},error:function(t){return o.onError(t)}}),this.editor.controller.off()},e.prototype.onSuccess=function(t){this.editor.api.isChanged(!0),t.response.redirectURL?window.location=t.response.redirectURL:this.editor.controller.on(),this.editor.trigger(r.EditorEventType.DATA_POSTED,[t.request,t.response,t.intent])},e.prototype.onError=function(t){$("#connection-error").modal("show"),$("#overlay").hide()},e}(e(27568).EditorCommand);exports.EditorSaveCommand=n},37026:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.EditorStartDragCommand=void 0;var r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.execute=function(t){var e=null;if(null==this._editor.helpers.icon.overIcon(t.point)&&(e=this._editor.svg.getNodeOnPoint(t.point)),null!=t.tool&&(this._editor.helpers.select.selectedTool=t.tool),null==this._editor.helpers.select.selectedTool&&(this._editor.helpers.select.selectedTool=window.SELECT_TOOL_MOVE),null!=e&&e!=this._editor.svg.selected&&this._editor.helpers.select.select(e),null!=this._editor.svg.selected){this._editor.helpers.select.lockTool=!0,this._editor.startDragX=t.point.x,this._editor.startDragY=t.point.y;var o=!1;if(this._editor.svg.selected.isTransformable)switch(this._editor.helpers.select.selectedTool){case window.SELECT_TOOL_MOVE:this._editor.svg.selected.isMoveable&&(o=!0);break;case window.SELECT_TOOL_ROTATE:case window.SELECT_TOOL_ROTATE_INVERSE:this._editor.svg.selected.isRotateable&&(o=!0);break;case window.SELECT_TOOL_NW_RESIZE:case window.SELECT_TOOL_NE_RESIZE:case window.SELECT_TOOL_SE_RESIZE:case window.SELECT_TOOL_SW_RESIZE:this._editor.svg.selected.isResizeable&&(o=!0);break;case window.SELECT_TOOL_N_RESIZE:case window.SELECT_TOOL_E_RESIZE:case window.SELECT_TOOL_S_RESIZE:case window.SELECT_TOOL_W_RESIZE:this._editor.svg.selected.isAspectChangable&&(o=!0)}o?this._editor.svg.updateNodeBeforeTransformation(this._editor.svg.selected,t):this._editor.helpers.select.lockTool=!1}},e}(e(27568).EditorCommand);exports.EditorStartDragCommand=r},64638:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.EditorStartTouchCommand=void 0;var r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.execute=function(t){if(null==this._editor.svg.selected){var e=this._editor.svg.getNodeOnPoint(t.point);this._editor.helpers.select.select(e)}null!=this._editor.svg.selected&&this._editor.svg.updateNodeBeforeTransformation(this._editor.svg.selected,null)},e}(e(27568).EditorCommand);exports.EditorStartTouchCommand=r},18415:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.EditorSwapTransformCommand=void 0;var r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.execute=function(t){null!=this._editor.svg.selected&&this._editor.svg.selected.swapTranform()},e}(e(27568).EditorCommand);exports.EditorSwapTransformCommand=r},93041:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.EditorUpdateBacksidePartCommand=void 0;var r=e(27568),n=e(27385),s=e(35896),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.execute=function(t,e){var o=this;if(this._extra=e,null==this._extra||!this._extra.hasOwnProperty("renderQuantities")||!0===this._extra.renderQuantities)if(this.editor.api.backPrintRequirementsFulfilled()){if(this.editor.api.backPrintRequirementsFulfilled()&&this.editor.ui.toolPane.backPrintEditorTool.setEnabled(!0),this.editor.ui.toolPane.backPrintEditorTool.enabled){var i=this.editor.api.GetBackPart(),r=this.editor.api.GetFrontPart(),n=this.editor.api.GetBackDealPart();(r&&i||r&&n)&&"front"===this.editor.api.GetActivePartSide()&&this.getPathCall(r).then((function(t){o.updatePaths(t,r,i,n)})).catch((function(i){setTimeout((function(i){o.execute(t,e)}),5e3)}))}}else this.disable()},e.prototype.getPathCall=function(t){var e=this;return new Promise((function(o,i){var r=t.pathNode.element.getAttribute("d");$.ajax({mimeType:"text/plain; charset=x-user-defined",url:TOOLS_URL+"/transformpath",method:"POST",data:{matrix:e.editor.api.GetInversedMatrixString(t.getTransformationMatrix(),t.rBBox.x2),path:r},success:function(t){o(t)},error:function(t){i(t)}})}))},e.prototype.updatePaths=function(t,e,o,i){var r="";o&&(r=o.pathNode.element.getAttribute("d"),this.applyPathToPart(o,t,e,r)),i&&(r=i.pathNode.element.getAttribute("d"),this.applyPathToPart(i,t,e,r),i.backGroundNode.element.setAttribute("fill","url(#"+this.editor.id+"-BackPrintDealPattern)")),this.editor.trigger(s.EditorEventType.BACKSIDEPRINT_UPDATED)},e.prototype.applyPathToPart=function(t,e,o,i){t.pathNode.element.setAttribute("d",e),t.backGroundNode.element.setAttribute("d",e),t.setPaths(e,e),t.setPartTypeOnPart(o.part_type),t.setBoundingBox(o.boundingBox.x,o.boundingBox.y,o.boundingBox.height,o.boundingBox.width),this.editor.helpers.importHelper.rearrangeChildrenToNewPath(t.partGroupNode.children,Raphael.pathBBox(i),Raphael.pathBBox(e))},e.prototype.disable=function(){var t,e;this.editor.api.sheetHasValidBackprintMaterial()?n.BackprintHelper.sizeIsValidForPaperbackprintSticker(this.editor.model.sheet.width,this.editor.model.sheet.height)||(t=this.editor.model.language.sticker_is_too_big_for_backprint_warning_title,e=this.editor.model.language.sticker_is_too_big_for_backprint_warning_text):(t=this.editor.model.language.backprint_material_warning_title,e=this.editor.model.language.backprint_material_warning_text),this.editor.ui.toolPane.backPrintEditorTool.setEnabled(!1,e,t)},e}(r.EditorCommand);exports.EditorUpdateBacksidePartCommand=a},20664:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.EditorUpdateCommand=void 0;var r=e(27568),n=e(15046),s=e(35896),a=e(28977),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.execute=function(t,e){var o=this;this._extra=e,this._exportedData=this.editor.exportAndSanitizeData();var i={sheet_type:this.editor.model.sheet.sheet_type_save_as?this.editor.model.sheet.sheet_type_save_as:this.editor.model.sheet.sheet_type,sheet_name:this.editor.model.sheet.sheet_name,sheet_meta:this.editor.model.sheet.meta,sheet_id:this.editor.model.sheet.sheet_id,design_id:this.editor.model.sheet.design_id?this.editor.model.sheet.design_id:"0",width:this._exportedData?this._exportedData.sheet.width:this.editor.model.sheet.width,height:this._exportedData?this._exportedData.sheet.height:this.editor.model.sheet.height,lang:this.editor.model.editor.lang,quantity:this.editor.ui.quantity,material:this._exportedData.sheet.material,laminate:this._exportedData.sheet.laminate?this._exportedData.sheet.laminate:0};this._exportedData.sheet.meta&&this._exportedData.sheet.meta.FIGURE_ID&&(i.design_id=this._exportedData.sheet.meta.FIGURE_ID);var r=!1;this.editor.model.editor.backPrintToolEnabled&&this.editor.api.GetParts().length>1&&(void 0!==i.sheet_meta&&(0,a.getBoolean)(i.sheet_meta.BACKPRINT_DEAL_ENABLED)?r=!1:void 0!==i.sheet_meta&&void 0!==i.sheet_meta.BACKPRINT_MODIFIED&&(r=(0,a.getBoolean)(i.sheet_meta.BACKPRINT_MODIFIED)));var s=n.BackendServiceUtil.getEditorAsJSONURI(i.sheet_type,i.sheet_name,i.design_id,i.quantity,i.width,i.height,i.material,i.laminate,i.lang,this.editor.model.editor.incVAT,(0,a.getBoolean)(r));this._xhr&&this._xhr.abort(),this._xhr=$.ajax(s,{error:function(t){"abort"!=t.statusText&&$("#connection-error").modal("show")},success:function(t){return o.onResult(t)}})},e.prototype.onResult=function(t){var e=JSON.parse(t);if(this.editor.ui.renderPrice(e.sheet.price,e.sheet.total,e.sheet.priceFrontPrint),this.editor.model.editor.backPrintToolEnabled&&this.editor.ui.renderPriceDetails(e.sheet.pricePaperbackPrint),null!=this._extra&&this._extra.hasOwnProperty("renderQuantities")&&1==this._extra.renderQuantities&&this.editor.ui.renderQuantities(e.sheet.min_quantity,e.sheet.quantity,e.editor.quantityAndPriceOptions),null!=this._extra&&this._extra.hasOwnProperty("rebuildSVG")&&1==this._extra.rebuildSVG){e.editor.askBeforeExit=this.editor.model.editor.askBeforeExit,e.sheet.sheet_id=this._exportedData.sheet.sheet_id,e.sheet.note=this._exportedData.sheet.note,e.sheet.aspect=this._exportedData.sheet.aspect,e.sheet.meta=this._exportedData.sheet.meta;var o=void 0;if(e.parts.length>1&&"single"!=e.sheet.sheet_type||"case"==e.sheet.sheet_type||"skin"==e.sheet.sheet_type){o=[];for(var i=function(){var t=e.parts[n],i=r.findExportedPart(t.part_id);if(r._exportedData.sheet._hasCollage&&(i=null),i){var s=!1;if(e.sheet.design_id&&"0"!=e.sheet.design_id&&!r.editor.svg.collage&&i.svg.indexOf("<text")<0){var a=r.editor.helpers.exportHelper.findAttachmentIDs(t.svg);$(i.attachmentIDs).each((function(t,e){a.indexOf(e)<0&&(s=!0)})),s||i.svg.indexOf("<image")!=i.svg.lastIndexOf("<image")&&(s=!0)}else s=!0;s&&(t._originallyDesignedSVG=t.svg,t.svg=i.svg,t._originalPathBoundingBox=i._originalPathBoundingBox,t.background=i.background)}o.push(t)},r=this,n=0;n<e.parts.length;n++)i()}else if(e.parts.length>1&&"single"==e.sheet.sheet_type){var l=e.parts.filter((function(t){return"front"===t.side}));o=$.extend(!0,l,this._exportedData.parts)}else o=$.extend(!0,e.parts,this._exportedData.parts);e.parts=o,this.editor.rebuildSVG(e,(0,a.getBoolean)(this._extra.partChanged))}null!=this._extra&&this._extra.hasOwnProperty("renderQuantities")&&1==this._extra.renderQuantities&&this.editor.trigger(s.EditorEventType.UPDATE_BACKPRINT_PATH,this._extra),this.editor.trigger(s.EditorEventType.UPDATED,e)},e.prototype.findExportedPart=function(t){for(var e=0;e<this._exportedData.parts.length;e++){var o=this._exportedData.parts[e];if(o.part_id==t)return o}return null},e}(r.EditorCommand);exports.EditorUpdateCommand=l},26856:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.EditorUpdateUIOnPartChange=void 0;var r=e(27568),n=e(28977),s=e(70946),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.execute=function(t,e){var o=this.editor.api.GetActivePartSide(),i=this.editor.ui.toolPane;switch(o){case s.EditorActivePartSide.FRONT:this.frontToolState(i);break;case s.EditorActivePartSide.BACK:this.backToolState(i);break;case s.EditorActivePartSide.BACK_DEAL:this.backDealToolState(i)}},e.prototype.frontToolState=function(t){$.inArray(this.editor.svg.sheet.options.json.material,this.editor.model.editor.backgroundMaterials)>-1?t.backgroundTool.setEnabled(!1):t.backgroundTool.setEnabled(!0),t.textTool.setEnabled(this.model.editor.textSelectorEnabled),t.materialPresetsTool.setEnabled(this.model.editor.materialPresetsSelectorEnabled),t.cutlineTool.setEnabled(this.model.editor.cuttinglineSelectorEnabled),t.uploadTool.setEnabled(this.model.editor.uploadEnabled),t.clipartsTool.setEnabled(this.model.editor.clipartSelectorEnabled),t.effectLayerTool.setEnabled(this.model.editor.effectLayerToolEnabled),t.backPrintDealTextTool.setEnabled(!1),t.removeBackPrintTool.setEnabled(!1),t.backPrintDealTool.setEnabled(!1),$(".tool.tool-size").removeClass("hidden"),this.editor.isLandscapeOrientation()?t.uploadTool.show():($(".tool-size").removeClass("hidden"),t.noteTool.setEnabled(this.model.editor.noteButtonEnabled))},e.prototype.backToolState=function(t){this.editor.api.GetParts().length>1&&this.editor.model.editor.backPrintDealToolEnabled?t.backPrintDealTool.setEnabled(!0):t.backPrintDealTool.setEnabled(!1),t.textTool.setEnabled(!0),t.uploadTool.setEnabled(!0),t.clipartsTool.setEnabled(!0),t.backgroundTool.setEnabled(!0),t.backPrintDealTextTool.setEnabled(!1),t.materialPresetsTool.setEnabled(!1),t.cutlineTool.setEnabled(!1),t.effectLayerTool.setEnabled(!1),$(".tool.tool-size").addClass("hidden"),t.removeBackPrintTool.setEnabled(!0),(0,n.getBoolean)(this.editor.svg.sheet.sheet_meta.BACKPRINT_MODIFIED)?t.removeBackPrintTool.setDisabled(!1):t.removeBackPrintTool.setDisabled(!0),this.editor.isLandscapeOrientation()?t.uploadTool.show():($(".tool-size").addClass("hidden"),t.noteTool.setEnabled(!1))},e.prototype.backDealToolState=function(t){this.editor.api.GetParts().length>1&&this.editor.model.editor.backPrintDealToolEnabled?t.backPrintDealTool.setEnabled(!0):t.backPrintDealTool.setEnabled(!1),t.backPrintDealTextTool.setEnabled(!0),t.materialPresetsTool.setEnabled(!1),t.cutlineTool.setEnabled(!1),t.removeBackPrintTool.setEnabled(!1),$(".tool.tool-size").addClass("hidden"),t.clipartsTool.disable(),t.uploadTool.disable(),t.backgroundTool.disable(),this.editor.isLandscapeOrientation()?(t.textTool.disable(),t.backPrintDealTextTool.$el.css("display","none"),t.backPrintDealTextTool.show()):(t.textTool.setEnabled(!1),t.backPrintDealTextTool.$el.css("display","block"),t.noteTool.setEnabled(!1))},Object.defineProperty(e.prototype,"model",{get:function(){return this.editor.model},enumerable:!1,configurable:!0}),e}(r.EditorCommand);exports.EditorUpdateUIOnPartChange=a},26446:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.EditorWindowResizeCommand=void 0;var r=e(27568),n=e(35896),s=e(48663),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.execute=function(t){this._timeOutMilliSeconds=250,"resize"!=t.type&&"orientationchange"!=t.type&&(this._isHidingKeyboardEvent=!0,this.editor.focus=null),this._selectedNode=this.editor.svg.selected,"orientationchange"==t.type&&(this._timeOutMilliSeconds=500),this.editor.ui.repositionTooltipsAndPopovers(),s.MediaUtil.isTouchDevice()&&"resize"==t.type&&this.editor.ui.currentlyFocusing||this.nextStep()},e.prototype.nextStep=function(){var t=this;this.editor.ui.setSizeAndOrientation(),this._timeout&&clearTimeout(this._timeout),this._timeout=setTimeout((function(){return t.onTimeout()}),this._timeOutMilliSeconds)},e.prototype.onTimeout=function(){this.editor.destroyed||this._isHidingKeyboardEvent&&!this.editor.isLandscapeOrientation()&&this.editor.ui.toolPane.isOpenToolState()||(this._isHidingKeyboardEvent&&this.editor.controller.offByEventName(n.EditorEventType.DESELECT_NODE),this.editor.refreshBoundingClientRect(),this.editor.svg.refreshMargin(!1),$(this.editor).trigger(n.EditorEventType.EDITOR_RESIZE),this._selectedNode&&this.editor.helpers.select.select(this._selectedNode),this._isHidingKeyboardEvent&&this.editor.controller.onByEventName(n.EditorEventType.DESELECT_NODE))},e}(r.EditorCommand);exports.EditorWindowResizeCommand=a},88459:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.EditorZoomCommand=void 0;var r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.execute=function(t){null!=this._editor.svg.selected&&this._editor.svg.scaleNodeAll(this._editor.svg.selected,t.zoom)},e}(e(27568).EditorCommand);exports.EditorZoomCommand=r},84082:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.RequestUpdateBackprintCommand=void 0;var r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.execute=function(t,e){this._extra=e,null!=this._extra&&this._extra.hasOwnProperty("renderQuantities")&&!0!==this._extra.renderQuantities?this.editor.ui.toolPane.saveButtonTool.setEnabled(!0):(this.editor.api.sheetHasBackprint()&&this.editor.ui.toolPane.backPrintEditorTool.enabled?this.editor.ui.toolPane.saveButtonTool.setEnabled(!1):this.editor.ui.toolPane.saveButtonTool.setEnabled(!0),this.editor.ui.toolPane.backPrintEditorTool.disableButtons())},e}(e(27568).EditorCommand);exports.RequestUpdateBackprintCommand=r},97821:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.UpdateStickySizeLabelCommand=void 0;var r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.execute=function(t,e){this.editor.svg.activePart&&!0===this.editor.svg.activePart.stickySizeLabels&&this.editor.svg.activePart.showSize()},e}(e(27568).EditorCommand);exports.UpdateStickySizeLabelCommand=r},27385:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.BackprintHelper=void 0;var e=function(){function t(){}return Object.defineProperty(t,"MAX_HEIGHT_MM",{get:function(){return 270},enumerable:!1,configurable:!0}),Object.defineProperty(t,"MAX_WIDTH_MM",{get:function(){return 270},enumerable:!1,configurable:!0}),t.sizeIsValidForPaperbackprintSticker=function(e,o){return e<t.MAX_WIDTH_MM&&o<t.MAX_HEIGHT_MM},t}();exports.BackprintHelper=e},45913:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.CaseappModalHelper=void 0;var r=e(35896),n=e(94297),s=e(32724),a=function(t){function e(e){var o=t.call(this,e)||this;return o.editor.on(r.EditorEventType.DATA_POSTED,(function(t,e,i){return o.onDataPosted(t,i)})),o}return i(e,t),e.prototype.onDataPosted=function(t,e){$("body").hasClass("checkout")||(this.editor.api.isChanged(!0),$(".cart .hybrid-drawer-trigger").trigger("click"),s.CheckoutNavbarButton.prototype.updateCartIndicator())},e}(n.EditorComponent);exports.CaseappModalHelper=a},94538:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.EditorHelper=void 0;var r=e(82096),n=e(37304),s=e(97338),a=e(92361),l=e(29160),d=e(58960),c=e(94107),h=e(67705),u=e(99914),p=e(71815),f=e(82323),g=e(94297),v=e(83542),m=e(30733),_=e(38820),b=e(9844),y=e(20754),E=e(45913),T=e(87999),x=function(t){function e(e){var o=t.call(this,e)||this;return o.icon=new r.IconHelper(e),o.input=new n.InputHelper(e),o.select=new s.SelectHelper(e),o.importHelper=new a.ImportHelper(e),o.exportHelper=new l.ExportHelper(e),o.menu=new d.MenuHelper(e),o.outline=new c.OutlineHelper(e),o.fill=new h.FillHelper(e),o.dpi=new u.DPIHelper(e),o.message=new p.MessageHelper(e),o.preview=new f.PreviewHelper(e),o.emoji=new m.EmojiHelper(e),o.thumbnail=new T.ThumbnailHelper(e),($("body").hasClass("figure")||$("body").hasClass("customer")||e.model.editor.helpers&&e.model.editor.helpers.indexOf("helper_admin_figure")>-1)&&(o.figure=new v.FigureHelper(e)),e.model.editor.helpers&&e.model.editor.helpers.indexOf("helper_modal")>-1&&new _.ModalHelper(e),e.model.editor.helpers&&e.model.editor.helpers.indexOf("helper_stickerapp_modal")>-1&&new b.StickerappModalHelper(e),e.model.editor.helpers&&e.model.editor.helpers.indexOf("helper_caseapp_modal")>-1&&new E.CaseappModalHelper(e),e.model.editor.helpers&&e.model.editor.helpers.indexOf("helper_stickerapp_inline_editor")>-1&&new y.StickerappInlineEditorHelper(e),o}return i(e,t),e.prototype.destroy=function(){this.input.touch.removeEventListeners()},e}(g.EditorComponent);exports.EditorHelper=x},29160:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.ExportHelper=void 0;var r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.exportSheet=function(){var t={},e={px2mm:0,lang:this.editor.model.editor.lang},o={width:0,height:0,sheet_type:"",sheet_name:"",meta:null,material:"",laminate:""},i=[];o.width=this.editor.model.editor.useDimensionTypeSVG?Math.round(this.editor_.svg.sheet.width):Math.round(this.editor.model.sheet.width),o.height=this.editor.model.editor.useDimensionTypeSVG?Math.round(this.editor_.svg.sheet.height):Math.round(this.editor.model.sheet.height),o.sheet_type=this.editor_.svg.sheet.sheet_type,o.material=this.editor.model.sheet.material,o.laminate=this.editor.model.sheet.laminate,o.sheet_name=this.editor.model.sheet.sheet_name,null!=this.editor_.svg.sheet.sheet_meta&&(o.meta=this.editor_.svg.sheet.sheet_meta),e.px2mm=this.editor_.svg.px2mm;for(var r=this.editor_.svg.sheet.parts,n=0;n<r.length;n++){var s={meta:{},cuttingline:null,bleed:null,part_id:null,sort_order:null,part_type:null,width:null,height:null,cornersRadius:null,flags:null,svg:null,matrix:null,background:null,attachmentIDs:null},a=r[n].partGroupNode.element.transform.baseVal.consolidate().matrix;if(r[n].part_type!=SVG.PART_TYPE_IMAGE){s.cuttingline=r[n].path;var l=Raphael.mapPath(s.cuttingline,Raphael.matrix(a.a,a.b,a.c,a.d,a.e,a.f).invert());s.cuttingline=l.toString(),s.cuttingline=s.cuttingline.replace(/\,/g," ");var d=["M","Z","L","H","V","C","S","A","Q","T"];$(d).each((function(t,e){var o=new RegExp(e,"g");s.cuttingline=s.cuttingline.replace(o," "+e+" ")})),s.cuttingline=s.cuttingline.trim();var c=s.cuttingline.split(" ");s.cuttingline="",$(c).each((function(t,e){isNaN(e)?s.cuttingline+=e+" ":s.cuttingline+=Math.round(100*parseFloat(e))/100+" "})),s.cuttingline=s.cuttingline.trim()}else s.cuttingline="";if(null!=r[n].bleed){s.bleed=r[n].bleed;var h=Raphael.mapPath(s.bleed,Raphael.matrix(a.a,a.b,a.c,a.d,a.e,a.f).invert());s.bleed=h.toString(),s.bleed=s.bleed.replace(/\,/g," "),$(d).each((function(t,e){var o=new RegExp(e,"g");s.bleed=s.bleed.replace(o," "+e+" ")})),s.bleed=s.bleed.trim(),c=s.bleed.split(" "),s.bleed="",$(c).each((function(t,e){isNaN(e)?s.bleed+=e+" ":s.bleed+=Math.round(100*parseFloat(e))/100+" "})),s.bleed=s.bleed.trim()}s.part_id=r[n].id,s.sort_order=n,s.part_type=r[n].part_type,s.width=Math.round(r[n].width),s.height=Math.round(r[n].height),s.cornersRadius=r[n].cornersRadius,s.side=r[n].side,s.flags=r[n].serializeFlags(),s.svg=this.serializedPart(r[n]),s.svg=s.svg.replace(/xmlns:xlink="http:\/\/www.w3.org\/1999\/xlink"/g,""),s.svg=s.svg.replace(/xmlns="http:\/\/www.w3.org\/2000\/svg"/g,""),s.svg=s.svg.replace(/\?random\=\d*/g,"");var u=Math.atan2(a.b,a.a)*(180/Math.PI),p=r[n].path;0!=u&&(s.svg='<defs dataRotation="'+u+'" ></defs>'+s.svg,p=Raphael.transformPath(p,"r"+-1*u));var f=Raphael.pathBBox(p);if(s._originalPathBoundingBox=f,r[n].height&&0!=r[n].height&&(s.svg='<defs dataHeight="'+f.height/this.editor_.svg.px2mm+'" ></defs>'+s.svg),r[n].width&&0!=r[n].width&&(s.svg='<defs dataWidth="'+f.width/this.editor_.svg.px2mm+'" ></defs>'+s.svg),r[n].cornersRadius&&0!=r[n].cornersRadius&&(s.svg='<defs dataCornersRadius="'+r[n].cornersRadius+'" ></defs>'+s.svg),0!=f.x&&(s.svg='<defs dataOffsetX="'+f.x+'" ></defs>'+s.svg),0!=f.y&&(s.svg='<defs dataOffsetY="'+f.y+'" ></defs>'+s.svg),null!=this.editor_.svg.collage){for(var g=this.editor_.svg.collage.getColParts(),v="<defs>",m=0;m<g.length;m++)g[m].clipPath.path,v+='<clipPath id="'+g[m].clipPath.id+'"><path d="'+g[m].clipPath.path+'" id="'+g[m].clipPath.id+'_path"></path></clipPath>';v+="</defs>",s.svg=v+s.svg,s.svg=s.svg.replace(/class="svgCollagePath"/g,'fill="none" stroke="none"')}s.matrix="matrix("+a.a+","+a.b+","+a.c+","+a.d+","+a.e+","+a.f+")",null!=r[n].backGroundNode?(this.editor_.svg.sheet.backgroundPattern&&"front"==s.side?s.background="none":s.background=r[n].backGroundNode.element.getAttribute("fill"),"url"==s.background.substring(0,3)&&(s.background="none")):s.background="none",s.meta.CMYK_BACKGROUND=r[n].background_cmyk,s.meta.SIDE=r[n].side;var _=this.getIndicesOf("<text",s.svg,!1);for(m=0;m<_.length;m++){var b=s.svg.substring(_[m],s.svg.indexOf(">",_[m])+1);if(-1==b.indexOf("font-size",b)){var y=_[m]+6+14*m;s.svg=[s.svg.slice(0,y),'font-size="14"',s.svg.slice(y)].join("")}}s.attachmentIDs=this.findAttachmentIDs(s.svg);var E="(&quot;";E=E.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1");var T=new RegExp(E,"g");s.svg=s.svg.replace(T,"(");var x="&quot;)";x=x.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1");var S=new RegExp(x,"g");s.svg=s.svg.replace(S,")"),i.push(s)}return t.editor=e,t.sheet=o,t.parts=i,t},e.prototype.serializedPart=function(t,e){e=void 0!==e&&e;for(var o=new XMLSerializer,i="",r=t.partGroupNode.children,n=r.length-1;n>=0;n--)this.serializeNodeFlags(r[n]),i+=o.serializeToString(r[n].element);e&&(i=i.replace(/\sid="([^"]+)"/g," ")),i=(i=(i=i.replace(/ href=/g," xlink:href=")).replace(/_thumb_lg\./g,"_thumb.")).replace(/_thumb_md\./g,"_thumb.");var s=new RegExp(window.location.protocol+"//"+window.location.host,"g");return i.replace(s,"")},e.prototype.serializeNodeFlags=function(t){t.element.setAttribute("flags",t.serializeFlags());for(var e=0;e<t.children.length;e++)this.serializeNodeFlags(t.children[e])},e.prototype.printPartTrees=function(){for(var t=0;t<this.editor_.svg.sheet.parts.length;t++)this.printChildrenTrees(this.editor_.svg.sheet.parts[t].children,"  ")},e.prototype.printChildrenTrees=function(t,e){for(var o=0;o<t.length;o++)this.printOptions(t[o].options,e),this.printChildrenTrees(t[o].children,e+"    ")},e.prototype.printOptions=function(t,e){for(var o in t)"object"==typeof t[o]&&this.printOptions(t[o],e+"  ")},e.prototype.getIndicesOf=function(t,e,o){var i,r=0,n=t.length,s=[];if(n<1)return s;for(o||(e=e.toLowerCase(),t=t.toLowerCase());(i=e.indexOf(t,r))>-1&&(s.push(i),!((r=i+n)>=e.length)););return s},e.prototype.findAttachmentIDs=function(t){for(var e=[],o=this.getIndicesOf('attachment_id="',t,!1),i=0;i<o.length;i++){var r=o[i]+15,n=t.substring(r,t.indexOf('"',r));e.push(n)}return e},e}(e(94297).EditorComponent);exports.ExportHelper=r},83542:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.FigureHelper=void 0;var r=e(94297),n=e(35896),s=function(t){function e(e){var o=t.call(this,e)||this;return o._partsLoaded=0,o._totalParts=0,o._$form=$('<form id="figure-template" class="hidden" method="post"></form>'),$("body").append(o._$form),o._$form.attr("action",e.model.editor.postURL),e.on(n.EditorEventType.INITIATED,(function(t){return o.onEditorInit()})),o._$form.on("submit",(function(){return o.onSubmit()})),o}return i(e,t),e.prototype.submit=function(){if(this.editor.isModal){var t=this,e={},o=this._$form.serializeArray();for(var i in o)e[o[i].name]=o[i].value;$.ajax(this.editor.model.editor.postURL,{data:e,method:"POST",success:function(o){t.editor.api.isChanged(!0),$("#overlay").hide(),$(t.editor.$el).trigger(n.EditorEventType.DATA_POSTED,[e,o])},error:function(t){$("#connection-error").modal("show"),$("#overlay").hide()}})}else this._$form.trigger("submit")},e.prototype.findImageNodeAndMergeWithParentMatrix=function(t){for(var e=this.findImage(t),o=e.element.transform.baseVal.consolidate().matrix;e;)e.parent.element.transform.baseVal.numberOfItems>0&&(o=e.parent.element.transform.baseVal.consolidate().matrix.multiply(o)),e="Part"==e.type?null:e.parent;return o},e.prototype.findImage=function(t){var e=this;if("ShapeImage"==t.type)return t;if(t.children.length){var o=null;return $(t.children).each((function(){var t=e.findImage(this);o||(o=t)})),o}return null},e.prototype.onSaveClick=function(t){t.preventDefault();var e=this;$("#overlay").show();var o=this.editor.api.Export();this._$form.append('<textarea name="sheet_width_mm" class="nodisplay">'+o.sheet.width+"</textarea>"),this._$form.append('<textarea name="sheet_height_mm" class="nodisplay">'+o.sheet.height+"</textarea>"),this._$form.append('<textarea name="translateX" class="nodisplay">0</textarea>'),this._$form.append('<textarea name="translateY" class="nodisplay">0</textarea>'),this._$form.append('<textarea name="nonce" class="nodisplay">'+this.editor.model.editor.postNonce+"</textarea>"),this._totalParts=this.editor.svg.sheet.parts.length,$(this.editor.svg.sheet.parts).each((function(){this.scalePathToFitWidthAndHeight(),this.partGroupNode;var t="single"==e.editor.model.sheet.sheet_type?"svg":this.id,i=e.findImage(this),r=e.findImageNodeAndMergeWithParentMatrix(i),n=i.element.getAttribute("transform"),s="matrix("+r.a+","+r.b+","+r.c+","+r.d+","+r.e+","+r.f+")";i.element.setAttribute("transform",s),i.element.outerHTML;var a=i.element.getAttribute("attachment_id");$.ajax("/ajax/getAttachmentAsImageNode/"+a,{data:{transform:s},success:function(o){e.onPartLoaded(t,o)},error:function(t){}}),e._$form.append('<textarea name="cuttingline" class="nodisplay">'+this.path+"</textarea>"),e._$form.append('<textarea name="background" class="nodisplay">'+o.parts[0].background+"</textarea>"),i.element.setAttribute("transform",n)}))},e.prototype.onPartLoaded=function(t,e){this._$form.append('<textarea name="'+t+'" class="nodisplay">'+e+"</textarea>"),this._partsLoaded++,this._partsLoaded==this._totalParts&&this.submit()},e.prototype.onSubmit=function(){this.editor.api.isChanged(!0)},e.prototype.onEditorInit=function(){var t=this;this.editor.controller.unregisterAllByEventName(n.EditorEventType.SAVE),this.editor.on(n.EditorEventType.SAVE,(function(e){return t.onSaveClick(e)}))},e}(r.EditorComponent);exports.FigureHelper=s},67705:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.FillHelper=void 0;var r=e(58430),n=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.maxGridWidth_=null,e.maxGridHeight_=null,e.gridWidth_=null,e.gridHeight_=null,e.nodeCounter_=0,e.notFreeCounter_=0,e.checkingNodesCounter_=0,e.freeCounter_=0,e}return i(e,t),e.prototype.gridFill=function(t,e){this.nodeCounter_=0,this.notFreeCounter_=0,this.checkingNodesCounter_=0,this.freeCounter_=0,this.maxGridWidth_=t.boundingBox.width/10,this.maxGridHeight_=t.boundingBox.height/10;var o=new r.TreeNodeVO(0,0,this.editor_.svg.sheet.boundingBox.width,this.editor_.svg.sheet.boundingBox.height,this.editor_.svg.root);this.makeTree(o),this.checkIfFree(o);for(var i,n=1,s=1,a=1;s<this.nodeCounter_;)n++,s+=a*=4;i=Math.pow(2,n);var l=this.editor_.svg.sheet.boundingBox.width/i,d=this.editor_.svg.sheet.boundingBox.height/i,c=Math.ceil(t.boundingBox.width/l),h=Math.ceil(t.boundingBox.height/d),u=[];this.treeToGrid(o,u,0,0,n);for(var p=0;p<i;p++)for(var f=0;f<i;f++)if(u[p][f].free){for(var g=!0,v=0;v<c;v++){for(var m=0;m<h;m++){if(p+v>=i||f+m>=i){g=!1;break}if(!u[p+v][f+m].free){g=!1;break}}if(!g)break}if(g){this.freeCounter_++;var _=new Array;for(_.x=u[p][f].p1.x,_.y=u[p][f].p1.y,this.editor_.svg.copyNode(t,_),v=0;v<c;v++)for(m=0;m<h;m++)u[p+v][f+m].free=!1}}void 0!==e&&e()},e.prototype.treeToGrid=function(t,e,o,i,r){r--;var n=Math.pow(2,r);if(null==t.children[0])return void 0===e[o]&&(e[o]=new Array),void(e[o][i]=t);this.treeToGrid(t.children[0],e,o,i,r),this.treeToGrid(t.children[1],e,o+n,i,r),this.treeToGrid(t.children[2],e,o,i+n,r),this.treeToGrid(t.children[3],e,o+n,i+n,r)},e.prototype.makeTree=function(t){this.nodeCounter_++;var e=t.p1.x,o=t.p1.y,i=(t.p1.x+t.p2.x)/2,n=t.p1.y,s=(t.p2.x,t.p1.y,t.p1.x),a=(t.p1.y+t.p2.y)/2,l=(t.p1.x+t.p2.x)/2,d=(t.p1.y+t.p2.y)/2,c=t.p2.x,h=(t.p1.y+t.p2.y)/2,u=(t.p1.x,t.p2.y,(t.p1.x+t.p2.x)/2),p=t.p2.y,f=t.p2.x,g=t.p2.y;t.children[0]=new r.TreeNodeVO(e,o,l,d,this.editor_.svg.root),t.children[1]=new r.TreeNodeVO(i,n,c,h,this.editor_.svg.root),t.children[2]=new r.TreeNodeVO(s,a,u,p,this.editor_.svg.root),t.children[3]=new r.TreeNodeVO(l,d,f,g,this.editor_.svg.root),i-e>this.maxGridWidth_&&a-o>this.maxGridHeight_&&(this.makeTree(t.children[0]),this.makeTree(t.children[1]),this.makeTree(t.children[2]),this.makeTree(t.children[3]))},e.prototype.fillFree=function(t){var e=document.createElementNS(SVG.SVG_NAMESPACE,"rect");e.setAttribute("x",t.p1.x),e.setAttribute("y",t.p1.y),e.setAttribute("width",(t.p2.x-t.p1.x).toString()),e.setAttribute("height",(t.p2.y-t.p1.y).toString()),e.setAttribute("stroke","black"),e.setAttribute("stroke-width","0.5"),e.setAttribute("fill","none"),t.free,$("#svgroot").append(e),null!=t.children[0]&&this.fillFree(t.children[0]),null!=t.children[1]&&this.fillFree(t.children[1]),null!=t.children[2]&&this.fillFree(t.children[2]),null!=t.children[3]&&this.fillFree(t.children[3])},e.prototype.checkIfFree=function(t){this.checkingNodesCounter_++;for(var e=this.editor_.svg.sheet.parts,o=0;o<e.length;o++)if(!(e[o].boundingBox.x+e[o].boundingBox.width<t.p1.x||e[o].boundingBox.x>t.p2.x||e[o].boundingBox.y+e[o].boundingBox.height<t.p1.y||e[o].boundingBox.y>t.p2.y)){t.free=!1,this.notFreeCounter_++;break}t.free||(null!=t.children[0]&&this.checkIfFree(t.children[0]),null!=t.children[1]&&this.checkIfFree(t.children[1]),null!=t.children[2]&&this.checkIfFree(t.children[2]),null!=t.children[3]&&this.checkIfFree(t.children[3]))},e}(e(94297).EditorComponent);exports.FillHelper=n},92361:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.ImportHelper=void 0;var r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.rearrangeChildrenToNewPath=function(t,e,o){for(var i=0;i<t.length;i++){var r=t[i],n=r.element.getAttribute("id");r.children.length<=1&&n.indexOf("_partGroup")<0&&n.indexOf("PartBackground")<0?this.rearrangeNodeToNewPath(r,e,o):this.rearrangeChildrenToNewPath(r.children,e,o)}},e.prototype.rearrangeNodeToNewPath=function(t,e,o){if(t.createBBoxAndCenter(),t.getTransformList(),t.type==SVG.SHAPE_TEXT)return this.rearrangeTextToNewPath(t,e,o);t.children&&1==t.children.length&&"g"==t.svgTag&&this.multiplyMatrixWithParent(t);var i=this.transformStringToMatrix(t.element.getAttribute("transform")),r=this.editor.createSVGMatrix(),n=this.editor.createSVGTransform(),s=Math.atan2(i.b,i.a)*(180/Math.PI),a=t.boundingBox.width,l=t.boundingBox.height;t.element.getAttribute("transform"),isNaN(s)||0==s||(t.beforeTransform(null),t.transform(SVG.TRANSFORM_ROTATE,s>0?-s:Math.abs(s),!1),t.createBBoxAndCenter(),t.element.getAttribute("transform"),i=this.transformStringToMatrix(t.element.getAttribute("transform")),a=t.boundingBox.width,l=t.boundingBox.height),t.getCenterPoint(!1);var d=i.e+a/2,c=i.f+l/2,h=a/i.a,u=l/i.d,p=a/e.width,f=(e.height,p*o.width/h),g=(o.height,f*h),v=f*u,m=(d-e.x)/e.width,_=(c-e.y)/e.height,b=m*o.width+o.x-g/2,y=_*o.height+o.y-v/2;r.a=f,r.b=i.b*(r.a/i.a),r.c=i.c*(r.a/i.a),r.d=f,r.e=b,r.f=y,n.setMatrix(r),t.element.transform.baseVal.initialize(n),isNaN(s)||0==s||(t.transform(SVG.TRANSFORM_ROTATE,s,!1),t.afterTransform(!0,SVG.TRANSFORM_ROTATE))},e.prototype.rearrangeTextToNewPath=function(t,e,o){var i=t.center,r=this.transformStringToMatrix(t.element.getAttribute("transform")),n=o.width/e.width,s=(i.x-e.x)/(e.cx-e.x),a=(i.y-e.y)/(e.cy-e.y),l=n*t.element.getAttribute("font-size");t.element.setAttribute("x",o.cx),t.element.setAttribute("y",o.cy),t.changeText({size:l}),t.createBBoxAndCenter();var d=s*(o.cx-o.x)-(t.center.x-o.x)+r.e,c=a*(o.cy-o.y)-(t.center.y-o.y)+r.f,h=this.editor.createSVGMatrix(),u=this.editor.createSVGTransform();h.a=r.a,h.b=r.b,h.c=r.c,h.d=r.d,h.e=r.e,h.f=r.f,h.e=d,h.f=c,u.setMatrix(h),t.element.transform.baseVal.initialize(u)},e.prototype.multiplyMatrixWithParent=function(t,e,o){if(e||(e=t.children),o||(o=t.element.transform.baseVal.consolidate().matrix),!e||!e.length||e.length>1)return o;for(var i=0;i<e.length;i++){var r=e[i];r.getTransformList();var n=r.element.transform.baseVal.consolidate().matrix;o=o.multiply(n);var s=this.editor.createSVGTransform();s.setMatrix(this.editor.createSVGMatrix()),r.element.transform.baseVal.initialize(s),r.children.length&&(o=this.multiplyMatrixWithParent(t,r.children,o))}var a=this.editor.createSVGTransform();return a.setMatrix(o),t.getTransformList(),t.element.transform.baseVal.initialize(a),o},e.prototype.transformStringToMatrix=function(t){for(var e=t.replace(/,/g," ").replace(/\(/g," ").replace(/\)/g,"|").replace(/  /g," ").split("|"),o=Raphael.matrix(),i=["matrix","translate","rotate","scale"],r=0;r<e.length;r++){t=e[r].split(" ");for(var n=0;n<t.length;n++){var s=t[n];if(i.indexOf(s)>=0){for(var a=[],l=1;n+l<t.length;l++){var d=t[n+l];if(!(i.indexOf(d)<0))break;a.push(d)}switch(s){case"matrix":o.add.apply(o,a);break;case"rotate":o.rotate.apply(o,a);break;case"translate":o.translate.apply(o,a);break;case"scale":o.scale.apply(o,a)}break}}}return o},e.prototype.importSvgFile=function(t,e){var o=this;$.get(t,(function(t){e(o.editor_.helpers.importHelper.importData(t))}))},e.prototype.importData=function(t){var e=t.documentElement;"svg"==e.firstChild.nodeName&&(e=e.firstChild);var o=this.traverseChildren(e);return this.editor_.svg.fitAndCenter(o,.5),o.group(),o},e.prototype.importSVGData=function(t,e,o){"<image"!=t.trim().substring(0,6)||t.split(">").length-1!=1&&t.split("</").length-1!=1||(t="<g>"+t+"</g>");var i=(new DOMParser).parseFromString('<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">'+t+"</svg>","image/svg+xml").documentElement,r=[],n=i.childNodes.length;if(0==n)void 0!==o&&o(e,r);else for(var s=0;s<i.childNodes.length;s++){var a=i.childNodes[s];this.traverseChildren(a,e.intId,(function(t){void 0===t||null!=t?(r.push(t),--n<=0&&void 0!==o&&o(e,r)):o(null,r)}))}},e.prototype.traverseChildren=function(t,e,o){var i=this;e=void 0===e?null:e;var r=null;switch(t.nodeName){case"g":r=SVG.GROUP_STANDARD;break;case"rect":r=SVG.SHAPE_RECT;break;case"circle":r=SVG.SHAPE_CIRCLE;break;case"path":r=SVG.SHAPE_PATH;break;case"image":r=SVG.SHAPE_IMAGE;break;case"text":r=SVG.SHAPE_TEXT;break;default:return void o()}if(null!=r){for(var n=new Array,s=0;s<t.attributes.length;s++){var a=t.attributes[s];n[a.name]=a.value}if(null!=e&&(n.parentIntId=e),r==SVG.GROUP_STANDARD&&void 0!==t.childNodes[0]&&"image"==t.childNodes[0].nodeName&&(r=SVG.SHAPE_MULTI),r==SVG.GROUP_STANDARD&&"collage"==t.getAttribute("id"))r=SVG.COLLAGE,n.import=!0,n.xml=t,this.editor_.svg.createNode(r,n,(function(t){t.ignore=!0,t.overHandling=SVG.OVER_LAYER,i.editor_.svg.collage=t,o(t)}));else if(r==SVG.SHAPE_TEXT){var l="";for(s=0;s<t.childNodes.length;s++)if(void 0!==t.childNodes[s].innerHTML&&t.childNodes[s].innerHTML.indexOf("emoji_")>-1){var d=t.childNodes[s].innerHTML;l+=(d=d.replace(/(<([^>]+)>)/gi,""))+"\n"}else void 0!==t.childNodes[s].childNodes[0]?l+=t.childNodes[s].childNodes[0].data+"\n":l+="\n";if(void 0!==t.childNodes[0].getAttribute("x")&&void 0!==n.x){var c=parseFloat(n.x)-parseFloat(t.childNodes[0].getAttribute("x"));isNaN(c)||(n.x=parseFloat(n.x)-c)}void 0!==t.childNodes[0].getAttribute("y")&&void 0!==n.y&&(c=parseFloat(n.y)-parseFloat(t.childNodes[0].getAttribute("y")),isNaN(c)||(n.y=parseFloat(n.y)-c)),l=l.substr(0,l.length-1),n.text=l,this.editor_.svg.createNode(r,n,(function(t){o(t)}))}else r==SVG.SHAPE_IMAGE?this.editor_.svg.createNode(r,n,(function(t){null!=t?(void 0!==n.vector&&n.vector?t.vector=!0:(i.editor_.helpers.dpi.addImageNode(t),t.checkDpi=!0,i.editor_.svg.multiArr.push(t.parent)),o(t)):o(null)})):this.editor_.svg.createNode(r,n,(function(e){var r=t.childNodes.length;if(0!=r)for(var n=0;n<t.childNodes.length;n++){var s=t.childNodes[n];i.traverseChildren(s,e.intId,(function(t){null!=t?--r<=0&&o(t):o(null)}))}else o(e)}))}},e}(e(94297).EditorComponent);exports.ImportHelper=r},58960:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.MenuHelper=void 0;var r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.AddImage=function(t,e){var o=this,i=t.substring(t.lastIndexOf("/")+1),r=i.substring(0,i.indexOf("."));if(null==this.editor_.svg.activePart||this.editor_.svg.zoom==SVG.ZOOM_SHEET){var n={};n.part_type=SVG.PART_TYPE_PATH,n.width=this.editor_.svg.sheet.height/2,n.height=this.editor_.svg.sheet.width/2,n.svg='<image xlink:href="https://stickerapp.com'+t+'"/>',this.editor_.svg.activePart=this.editor_.svg.createNode(SVG.PART,{json:n},(function(t){o.editor_.svg.center(t),void 0!==e&&e()}))}else var s=this.editor_.svg.createNode(SVG.SHAPE_IMAGE,{id:r,href:t,part:this.editor_.svg.activePart.id},(function(){o.editor_.svg.fitAndCenterOnPart(s,1),void 0!==e&&e()}))},e.prototype.isTooManyImages=function(){var t=this;if(null!=this.editor_.svg.collage){if(null==this.editor_.svg.activePart||this.editor_.svg.collage.getPart().intId!=this.editor_.svg.activePart.intId)return!1;if($(document.getElementById(this.editor.svgRootID).getElementsByTagName("image")).map((function(){for(var e=$(this),o=$(this).parent(),i=0;i<5;i++){if(o.is($(t.editor_.svg.collage.element)))return $(e).attr("xlink:href");o=o.parent()}})).get().length>=this.editor_.svg.collage.getColParts().length)return!0}return!1},e.prototype.AddSVG=function(t,e){var o=!0,i=this;if(this.isTooManyImages()&&-1==t.svg.search("clipart_id")&&-1==t.svg.search("sticker_id")&&-1==t.svg.search("attachment_id"))return this.editor.ui.showMessage(6,1,this.editor_.helpers.message.getId(),"Too many images"),void(void 0!==e&&e(null));if(null==this.editor_.svg.activePart||this.editor_.svg.zoom==SVG.ZOOM_SHEET){var r;if(!t.cuttingline)return(r={}).editable=t.editable,r.visibility="hidden",r.part_type=SVG.PART_TYPE_PATH,r.width=this.editor_.svg.sheet.height/2,r.height=this.editor_.svg.sheet.width/2,void 0!==t.editable&&(r.editable=t.editable),r.svg=t.svg,void(this.editor_.svg.activePart=this.editor_.svg.createNode(SVG.PART,{json:r},(function(t){i.editor_.svg.center(t),$(t.element).css("visibility","visible"),$(t.pathNode.element).css("visibility","visible"),void 0!==e&&e(t)})));(r={visibility:"hidden"}).cuttingline=t.cuttingline,void 0!==t.editable&&(r.editable=t.editable),t.id&&(r.id="part_"+t.id),t.part_id&&(r.id="part_"+t.part_id),t.background&&(r.background=t.background),r.part_type=SVG.PART_TYPE_PATH,this.editor_.svg.activePart=this.editor_.svg.createNode(SVG.PART,{json:r}),o=!1}this.editor_.svg.runBBox=!1,t.visibility="hidden",this.editor_.svg.createNode(SVG.SHAPE_MULTI,{json:t,part:this.editor_.svg.activePart.id},(function(r){i.editor_.helpers.importHelper.importSVGData(t.svg,r,(function(t){i.editor_.svg.runBBox=!0,setTimeout((function(){if(null==t||0==t.children.length)return r.remove(),void(void 0!==e&&e(null));r.makeBBoxUpdateList(),o?i.editor_.svg.fitAndCenterOnPart(r):i.editor_.svg.fitAndCenter(i.editor_.svg.activePart,.5),$(r.element).css("visibility","visible"),$(i.editor_.svg.activePart.element).css("visibility","visible"),$(i.editor_.svg.activePart.pathNode.element).css("visibility","visible"),void 0!==e&&e(r)}),0)}))}))},e}(e(94297).EditorComponent);exports.MenuHelper=r},71815:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.MessageHelper=void 0;var r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.id=0,e}return i(e,t),e.prototype.getId=function(){return this.id++,this.id},e}(e(94297).EditorComponent);exports.MessageHelper=r},38820:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.ModalHelper=void 0;var r=e(94297),n=e(35896),s=function(t){function e(e){var o=t.call(this,e)||this;return e.on(n.EditorEventType.INITIATED,(function(t){return o.onEditorInit()})),o}return i(e,t),e.prototype.onSaveClick=function(t,e){t.preventDefault();var o=this;$("#overlay").show();var i=this.editor.exportAndSanitizeData(e);i.returnEditorModel=!0,$.ajax({type:"POST",url:this.editor.model.editor.postURL,data:i,success:function(t){o.editor.api.isChanged(!0),$("#overlay").hide(),$(o.editor.$el).trigger(n.EditorEventType.DATA_POSTED,[i,t,e])},error:function(t){$("#connection-error").modal("show"),$("#overlay").hide()}})},e.prototype.onEditorInit=function(){var t=this;this.editor.controller.unregisterAllByEventName(n.EditorEventType.SAVE),this.editor.on(n.EditorEventType.SAVE,(function(e,o){return t.onSaveClick(e,o)}))},e}(r.EditorComponent);exports.ModalHelper=s},94107:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.OutlineHelper=void 0;var r=e(94297),n=e(15046),s=e(17106),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.outlineSmoothing=3,e.outlinePadding=15,e.outlineCornerless=1,e.outlineImageSize=500,e.outlineSmoothingText=5,e.outlinePaddingText=50,e.outlineCornerlessText=2,e}return i(e,t),e.prototype.settings=function(t,e,o,i){null!=t&&(this.outlineSmoothing=t),null!=e&&(this.outlinePadding=e),null!=o&&(this.outlineCornerless=o),null!=i&&(this.outlineImageSize=i)},e.prototype.jsonSettings=function(t){t.smoothing&&(this.outlineSmoothing=t.smoothing),t.padding&&(this.outlinePadding=t.padding),t.cornerless&&(this.outlineCornerless=t.cornerless),t.imageSize&&(this.outlineImageSize=t.imageSize)},e.prototype.outlineSvg=function(t,e,o,i){var r=this;if(i=void 0===i?"path-m":i,null!=this.editor_.svg.sheet.sheet_meta?this.editor_.svg.sheet.sheet_meta.LAST_OUTLINE=i:this.editor_.svg.sheet.sheet_meta={LAST_OUTLINE:i},"path-org"!=i){for(var a=t.partGroupNode.element.getBBox(),l=this.outlineImageSize/a.height,d=new XMLSerializer,c="",h=t.partGroupNode.children,u=h.length-1;u>=0;u--)c+=d.serializeToString(h[u].element);var p=(c=(c=c.replace(/xlink:href=/g,'xmlns:xlink="'+SVG.SVG_XLINK+'" xlink:href=')).replace(/ href=/g," xlink:href=")).indexOf('xmlns:xlink="http://www.w3.org/1999/xlink"'),f=c.lastIndexOf('xmlns:xlink="http://www.w3.org/1999/xlink"');if(p!=f){var g=c.substring(0,f),v=c.substring(f+42);c=g+v}for(var m=c.match(/<(.*?)>/g),_=0;_<m.length;_++)if(2==m[_].split('xmlns:xlink="http://www.w3.org/1999/xlink"').length-1){var b=m[_],y=m[_].indexOf('xmlns:xlink="http://www.w3.org/1999/xlink"'),E=m[_].substring(0,y)+" "+m[_].substring(y+42);c=c.replace(b,E)}c='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">'+(c='<g transform="scale('+l+", "+l+") translate("+-a.x+", "+-a.y+') ">'+c+"</g>")+"</svg>";var T=a.height*l/t.height,x={fileappId:!1};switch(x.host=window.location.hostname,x.svg=c,x.x=String(Math.round(a.x*l)),x.y=String(Math.round(a.y*l)),x.width=String(Math.round(a.width*l)),x.height=String(Math.round(a.height*l)),x.widthmm=String(Math.round(t.width)),x.heightmm=String(Math.round(t.height)),x.px2mm=String(T),x.type="svg",null!=this.editor_.svg.activePart&&null!=this.editor_.svg.activePart.backGroundNode&&(x.bgcolor=this.editor_.svg.activePart.backGroundNode.element.getAttribute("fill")),x.settings={},i){case"path-s":x.settings.size=String(800),x.settings.threshold1=String(200),x.settings.gaussian=String(1),x.settings.k=String(.5),x.settings.a=String(1.2),x.settings.O=String(.1),x.settings.expand=String(1.7),x.settings.contract=String(.1),x.settings.keep=!1,x.settings.auto=!0,x.settings.overcut=!1,x.settings.padding=!0,x.settings.findEmbedded=!1,x.settings.contractEmbedded=String(0),x.settings.expandEmbedded=String(0),x.settings.gaussianEmbedded=String(0),x.settings.kEmbedded=String(.9);break;case"path-m":default:x.settings.size=String(800),x.settings.threshold1=String(200),x.settings.gaussian=String(2),x.settings.k=String(.5),x.settings.a=String(1.2),x.settings.O=String(.1),x.settings.expand=String(2.9),x.settings.contract=String(.1),x.settings.keep=!1,x.settings.auto=!0,x.settings.overcut=!1,x.settings.padding=!0,x.settings.findEmbedded=!1,x.settings.contractEmbedded=String(0),x.settings.expandEmbedded=String(0),x.settings.gaussianEmbedded=String(0),x.settings.kEmbedded=String(.9);break;case"path-l":x.settings.size=String(800),x.settings.threshold1=String(200),x.settings.gaussian=String(3),x.settings.k=String(.5),x.settings.a=String(1.2),x.settings.O=String(.1),x.settings.expand=String(4),x.settings.contract=String(.1),x.settings.keep=!1,x.settings.auto=!0,x.settings.overcut=!1,x.settings.padding=!0,x.settings.findEmbedded=!1,x.settings.contractEmbedded=String(0),x.settings.expandEmbedded=String(0),x.settings.gaussianEmbedded=String(0),x.settings.kEmbedded=String(.9);break;case"path-new-x":x.settings.size=this.editor.$("[name=new-outline-size]").val(),x.settings.threshold1=this.editor.$("[name=new-outline-threshold1]").val(),x.settings.gaussian=this.editor.$("[name=new-outline-gaussian]").val(),x.settings.k=this.editor.$("[name=new-outline-k]").val(),x.settings.a=this.editor.$("[name=new-outline-a]").val(),x.settings.O=this.editor.$("[name=new-outline-O]").val(),x.settings.expand=this.editor.$("[name=new-outline-expand]").val(),x.settings.contract=this.editor.$("[name=new-outline-contract]").val(),x.settings.keep=this.editor.$("[name=new-outline-keep]").is(":checked"),x.settings.auto=this.editor.$("[name=new-outline-auto]").is(":checked"),x.settings.overcut=this.editor.$("[name=new-outline-overcut]").is(":checked"),x.settings.padding=this.editor.$("[name=new-outline-padding]").is(":checked"),x.settings.findEmbedded=this.editor.$("[name=new-outline-findEmbedded]").is(":checked"),x.settings.expandEmbedded=this.editor.$("[name=new-outline-expandEmbedded]").val(),x.settings.contractEmbedded=this.editor.$("[name=new-outline-contractEmbedded]").val(),x.settings.gaussianEmbedded=this.editor.$("[name=new-outline-gaussianEmbedded]").val(),x.settings.kEmbedded=this.editor.$("[name=new-outline-kEmbedded]").val()}if((new Date).getTime(),this.editor.model.editor.fileAppEnabled){if(!this.fileAppRegion){var S=s.FileAppService.getRegionFromSvg(x.svg);S&&(this.fileAppRegion=S)}new s.FileAppService(this.fileAppRegion).getImageOutline(x,(function(o){var i=JSON.parse(o.target.responseText).path,n=r.editor_.svg.root.element.createSVGMatrix();n=(n=(n=n.multiply(t.partGroupNode.element.transform.baseVal.getItem(0).matrix)).translate(a.x,a.y)).scale(1/l);var s=Raphael.matrix(n.a,n.b,n.c,n.d,n.e,n.f),d=Raphael.mapPath(i,s);e(d.toString())}))}else{var w=n.BackendServiceUtil.getURL(n.BackendServiceUtil.METHOD_URI_OUTLINE);$.ajax({crossDomain:!0,url:w,type:"POST",dataType:"text",async:!0,data:encodeURIComponent(JSON.stringify(x)),contentType:"application/json;charset=utf-8",mimeType:"application/json;charset=utf-8",success:function(o){"null"==(o=o.trim()).substring(0,4)&&(o=o.substring(5,o.length-1));var i=(x=JSON.parse(o)).rect,n=("embedded"in x&&x.embedded,"embeddedTransform"in x&&x.embeddedTransform,x.paths[0].path),s=r.editor_.svg.root.element.createSVGMatrix();s=(s=(s=s.multiply(t.partGroupNode.element.transform.baseVal.getItem(0).matrix)).translate(a.x,a.y)).scale(1/l);var d=Raphael.matrix(s.a,s.b,s.c,s.d,s.e,s.f),c=Raphael.mapPath(n,d);i?e(c.toString(),!0):e(c.toString())},error:function(t,e,o){}})}}else this.oldOutline(t,e,o)},e.prototype.oldOutline=function(t,e,o){var i=this;o=void 0!==o&&o;var r=this.outlineCornerless,n=this.outlinePadding,s=this.outlineSmoothing;o&&(r=this.outlineCornerlessText,n=this.outlinePaddingText,s=this.outlineSmoothingText);for(var a=t.partGroupNode.element.getBBox(),l=this.outlineImageSize/a.height,d=new XMLSerializer,c="",h=t.partGroupNode.children,u=h.length-1;u>=0;u--)c+=d.serializeToString(h[u].element);$("#OUTLINE_imageContainer").attr("width",a.width*l),$("#OUTLINE_imageContainer").attr("height",a.height*l),$("#OUTLINE_canvas").attr("width",a.width*l),$("#OUTLINE_canvas").attr("height",a.height*l);var p=(c=(c=c.replace(/xlink:href=/g,'xmlns:xlink="'+SVG.SVG_XLINK+'" xlink:href=')).replace(/ href=/g," xlink:href=")).indexOf('xmlns:xlink="http://www.w3.org/1999/xlink"'),f=c.lastIndexOf('xmlns:xlink="http://www.w3.org/1999/xlink"');if(p!=f){var g=c.substring(0,f),v=c.substring(f+42);c=g+v}for(var m=c.match(/<(.*?)>/g),_=0;_<m.length;_++)if(2==m[_].split('xmlns:xlink="http://www.w3.org/1999/xlink"').length-1){var b=m[_],y=m[_].indexOf('xmlns:xlink="http://www.w3.org/1999/xlink"'),E=m[_].substring(0,y)+" "+m[_].substring(y+42);c=c.replace(b,E)}c='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">'+(c='<g transform="scale('+l+", "+l+") translate("+-a.x+", "+-a.y+') ">'+c+"</g>")+"</svg>",canvg("OUTLINE_canvas",c,{ignoreMouse:!0,ignoreAnimation:!0,renderCallback:function(){OUTLINE.imageURL="",OUTLINE.imageWidth=a.width*l,OUTLINE.imageHeight=a.height*l,OUTLINE.imageTranslateX=0,OUTLINE.imageTranslateY=0,OUTLINE.cornerless=parseFloat(r.toString()),OUTLINE.padding=parseFloat(n.toString()),OUTLINE.smoothing=parseFloat(s.toString()),OUTLINE.imageKind="canvas",OUTLINE.imageCanvas=document.getElementById("OUTLINE_canvas"),OUTLINE.outline(0,(function(){if(1==OUTLINE.rect)var o=OUTLINE.rectWidth,r=OUTLINE.rectHeight,n=OUTLINE.rectX,s=OUTLINE.rectY,d=OUTLINE.rectImageTranslateX,c=OUTLINE.rectImageTranslateY,h="M "+n+","+s+" "+(n+o)+","+s+" "+(n+o)+","+(s+r)+" "+n+","+(s+r)+"z";else d=OUTLINE.imageTranslateX,c=OUTLINE.imageTranslateY,h=OUTLINE.d;var u=i.editor_.svg.root.element.createSVGMatrix();u=(u=(u=(u=u.multiply(t.partGroupNode.element.transform.baseVal.getItem(0).matrix)).translate(a.x,a.y)).scale(1/l)).translate(-d,-c);var p=Raphael.matrix(u.a,u.b,u.c,u.d,u.e,u.f),f=Raphael.mapPath(h,p);e(f.toString())}),0)},ignoreDimensions:!1})},e.prototype.outlineImg=function(t,e,o,i,r,a,l){null!=this.editor_.svg.sheet.sheet_meta?this.editor_.svg.sheet.sheet_meta.LAST_OUTLINE="image":this.editor_.svg.sheet.sheet_meta={LAST_OUTLINE:"image"};var d={fileappId:!1};d.host=window.location.hostname,d.folder=t.substring(1,t.lastIndexOf("/")+1),d.file=t.substring(t.lastIndexOf("/")+1),d.x=String(0),d.y=String(0),d.width=String(e),d.height=String(o),d.widthmm=String(parseInt(r)),d.heightmm=String(parseInt(a)),d.px2mm=i.toString(),d.type="img",d.settings={},d.settings.size=String(800),d.settings.threshold1=String(200),d.settings.gaussian=String(1),d.settings.k=String(.5),d.settings.a=String(1.2),d.settings.O=String(.1),d.settings.expand=String(3),d.settings.contract=String(.1),d.settings.keep=!1,d.settings.auto=!0,d.settings.overcut=!1,d.settings.padding=!0,d.settings.findEmbedded=!0,d.settings.contractEmbedded=String(0),d.settings.expandEmbedded=String(0),d.settings.gaussianEmbedded=String(0),d.settings.kEmbedded=String(.9),(new Date).getTime();var c=n.BackendServiceUtil.getURL(n.BackendServiceUtil.METHOD_URI_OUTLINE);if(this.editor.model.editor.fileAppEnabled){var h=t.split(".")[2];this.fileAppRegion=h;var u=t.split("/")[3].split("_")[0],p=new s.FileAppService(h);d.fileappId=u,p.getImageOutline(d,(function(t){var e=JSON.parse(t.target.responseText);if(e.rect)l("rect",null);else{var o=e.path;l(o,t.paths)}}))}else $.ajax({crossDomain:!0,url:c,type:"POST",dataType:"text",data:encodeURIComponent(JSON.stringify(d)),contentType:"application/json;charset=utf-8",mimeType:"application/json;charset=utf-8",success:function(t){if("null"==(t=t.trim()).substring(0,4)&&(t=t.substring(5,t.length-1)),(d=JSON.parse(t)).rect)l("rect",null);else{var e=d.paths[0].path;l(e,t.paths)}},error:function(t,e,o){}})},e}(r.EditorComponent);exports.OutlineHelper=a},82323:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.PreviewHelper=void 0;var r=e(94297),n=e(35896),s=function(t){function e(e){var o=t.call(this,e)||this;return o.status=!1,o.lineWidthScale_=1,o.editor.on(n.EditorEventType.PREVIEW_ON,(function(t){return o.onPreviewOn(t)})),o.editor.on(n.EditorEventType.PREVIEW_OFF,(function(t){return o.onPreviewOff(t)})),o}return i(e,t),e.prototype.updatePreview=function(){if(this.calcLinePathWidthScale(),this.editor_.svg.mode==SVG.MODE_SKIN||this.editor_.svg.mode==SVG.MODE_CASE)for(var t=0;t<this.editor_.svg.sheet.parts.length;t++)null!=this.editor_.svg.sheet.parts[t]&&null!=this.editor_.svg.activePart&&(this.editor_.svg.sheet.parts[t].intId!=this.editor_.svg.activePart.intId?this.hidePreview(this.editor_.svg.sheet.parts[t],!1):this.status?this.showPreview(this.editor_.svg.sheet.parts[t],!0):this.hidePreview(this.editor_.svg.sheet.parts[t],!0));else if(this.editor_.svg.mode==SVG.MODE_SINGLE)if(this.status){null!=this.editor_.svg.selected&&this.editor_.helpers.select.select(null);var e=this.editor_.svg.activePart.path,o=this.editor_.svg.activePart.previewClipPath.clipPathPath;o.element.setAttribute("d",e);var i=this.editor_.svg.root.element.createSVGTransform();i.setMatrix(this.editor_.svg.activePart.partGroupNode.getTransformationMatrix().inverse()),o.getTransformList(),o.element.transform.baseVal.initialize(i),this.editor_.svg.activePart.partGroupNode.element.setAttribute("clip-path","url(#"+this.editor_.svg.activePart.previewClipPath.id+")"),$(this.editor_.svg.activePart.pathNode.element).css("visibility","hidden"),this.editor_.svg.activePart.backGroundNode.element.setAttribute("stroke","#A0A0A0"),this.editor_.svg.activePart.backGroundNode.element.setAttribute("stroke-width",1*this.lineWidthScale_),this.editor_.svg.activePart.addDropShadow()}else this.editor_.svg.activePart.partGroupNode.element.setAttribute("clip-path","none"),$(this.editor_.svg.activePart.pathNode.element).css("visibility","visible"),this.editor_.svg.activePart.backGroundNode.element.setAttribute("stroke","none"),this.editor_.svg.activePart.backGroundNode.element.setAttribute("stroke-width","0"),this.editor_.svg.activePart.removeDropShadow();this.editor_.svg.shadow.updateShadow(),this.editor.svg.activePart&&this.editor.svg.activePart.stickySizeLabels&&this.editor.svg.activePart.showSize()},e.prototype.scaleImageToSheet=function(t){var e=this.editor_.svg.sheet.width*this.editor_.svg.px2mm/t.imageWidth,o=this.editor_.svg.sheet.height*this.editor_.svg.px2mm/t.imageHeight,i=this.editor_.svg.root.element.createSVGMatrix();i.a=parseFloat(e.toString()),i.b=0,i.c=0,i.d=parseFloat(o.toString()),i.e=0,i.f=0;var r=this.editor_.svg.root.element.createSVGTransform();r.setMatrix(i),t.getTransformList(),t.element.transform.baseVal.initialize(r)},e.prototype.hidePreview=function(t,e){null!=t.previewBack&&$(t.previewBack.element).hide(),null!=t.previewFont&&$(t.previewFont.element).hide(),null!=t.previewClipPath&&t.element.setAttribute("clip-path","none"),e?($(t.pathNode.element).show(),null!=t.bleedPathNode&&$(t.bleedPathNode.element).show()):($(t.pathNode.element).hide(),null!=t.bleedPathNode&&$(t.bleedPathNode.element).hide()),null!=t.backGroundNode&&t.backGroundNode.element.setAttribute("d",t.backGroundNode.orgPath),null!=this.editor_.svg.collage&&this.editor_.svg.collage.getPart().intId==t.intId&&$(".svgCollagePath").show()},e.prototype.showPreview=function(t,e){null!=t.previewBack&&$(t.previewBack.element).show(),null!=t.previewFont&&$(t.previewFont.element).show(),null!=t.previewClipPath&&t.element.setAttribute("clip-path","url(#"+t.previewClipPath.id+")"),e?($(t.pathNode.element).hide(),null!=t.bleedPathNode&&$(t.bleedPathNode.element).hide(),null!=t.backGroundNode&&t.backGroundNode.element.setAttribute("d",t.previewClipPath.path)):($(t.pathNode.element).show(),null!=t.bleedPathNode&&$(t.bleedPathNode.element).show(),null!=t.backGroundNode&&t.backGroundNode.element.setAttribute("d",t.backGroundNode.orgPath)),null!=this.editor_.svg.collage&&this.editor_.svg.collage.getPart().intId==t.intId&&$(".svgCollagePath").hide()},e.prototype.calcLinePathWidthScale=function(){if(null!=this.editor_.svg.activePart){var t=this.editor_.svg.root.element.viewBox.baseVal.height,e=this.editor_.svg.root.element.viewBox.baseVal.width,o=$(this.editor_.container).height()/t,i=$(this.editor_.container).width()/e,r=this.editor_.svg.activePart.getTransformationMatrix(),n=Math.sqrt(Math.pow(r.a,2)+Math.pow(r.b,2)),s=Math.sqrt(Math.pow(r.c,2)+Math.pow(r.d,2));this.lineWidthScale_=1/Math.min(o*n,i*s)}},e.prototype.onPreviewOn=function(t){this.status=!0,this.updatePreview()},e.prototype.onPreviewOff=function(t){this.status=!1,this.updatePreview()},e}(r.EditorComponent);exports.PreviewHelper=s},97338:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.SelectHelper=void 0;var r=e(94297),n=e(35896),s=function(t){function e(e){var o=t.call(this,e)||this;return o.lockTool=!1,o.invertedRotation=!1,o.selectedTool=null,o.SELECTCORNERSIZE=12,o.MENUOFFSETX=30,o.MENUOFFSETY=10,o.MENUOFFSETITEM=22,o.MENUPADDING=3,o.MENUTOUCHOFFSETX=40,o.MENUTOUCHOFFSETY=12,o.MENUTOUCHOFFSETITEM=40,o.MENUTOUCHPADDING=8,o.oldHover_=null,o.oldSelect_=null,o.selectGroup_=null,o.editor.registerCallback(o.editor,n.EditorEventType.EDITOR_RESIZE,(function(){return o.reDrawHoverAndSelect()})),o.editor.registerCallback(o.editor,"editorIsTouch",(function(t){return o.onEditorIsTouch(t)})),o.editor.registerCallback(o.editor.$el,n.EditorEventType.SVG_DESTROYED,(function(t){return o.reset()})),o}return i(e,t),e.prototype.reDrawHoverAndSelect=function(){this.calcLineWidthScale(),null!=this.oldHover_&&this.hoverOn(this.oldHover_,!0),null!=this.oldSelect_&&(this.hideSelect(this.oldSelect_),this.selectOn(this.oldSelect_,!0))},e.prototype.reset=function(){this.oldHover_=null,this.oldSelect_=null,this.selectGroup_=null,this._lineWidthScale=null},e.prototype.hover=function(t,e){if(e=void 0===e?null:e,null!=t&&t.type!=SVG.PART&&t.getPart().isLockedContent&&(t=t.getPart()),!(null!=t&&t.type==SVG.PART&&this.editor_.svg.sheet.sheet_type!=SVG.MODE_SHEET&&this.editor_.svg.sheet.sheet_type!=SVG.MODE_SINGLE||null!=t&&t.type==SVG.PART&&this.editor_.svg.sheet.sheet_type==SVG.MODE_SHEET&&t.part_type==SVG.PART_TYPE_PATH&&this.editor_.svg.zoom==SVG.ZOOM_PART)){if(null==t&&null!=this.oldHover_)return this.hoverOff(this.oldHover_),void(this.oldHover_=null);if(null!=t||null!=this.oldHover_)return null==this.oldHover_?(this.hoverOn(t,!1,e),void(this.oldHover_=t)):void(t.intId!=this.oldHover_.intId&&(this.hoverOff(this.oldHover_),this.hoverOn(t,!1,e),this.oldHover_=t))}},e.prototype.hideSelect=function(t){t.selectElement=null,null!=this.selectGroup_&&($(this.selectGroup_.element).css("display","none"),this.editor_.helpers.icon.clearIconsList(),t.type==SVG.PART&&this.editor_.svg.sheet.sheet_type==SVG.MODE_SHEET&&(null!=t.bottomText&&(t.bottomText.remove(),t.bottomText=null),null!=t.leftText&&(t.leftText.remove(),t.leftText=null)))},e.prototype.showSelect=function(t){this.selectOn(t,!1)},e.prototype.select=function(t){if(null!=t&&t.type!=SVG.PART&&t.getPart().isLockedContent&&(t=t.getPart()),null!=t&&null!=t.selectRedirect&&(t=t.selectRedirect),null==t||t.type!=SVG.PART||this.editor_.svg.sheet.sheet_type==SVG.MODE_SHEET||this.editor_.svg.sheet.sheet_type==SVG.MODE_SINGLE)if(null==t||t.type!=SVG.PART||this.editor_.svg.sheet.sheet_type!=SVG.MODE_SHEET||t.part_type!=SVG.PART_TYPE_PATH||this.editor_.svg.zoom!=SVG.ZOOM_PART){if(null!=this.editor_.api.specialTextSelection&&(this.editor.trigger(n.EditorEventType.DESELECT_NODE,this.editor_.api.specialTextSelection.type),this.editor_.api.specialTextSelection=null),null==t&&null!=this.oldSelect_)return this.selectOff(this.oldSelect_),void(this.oldSelect_=null);if(null!=t||null!=this.oldSelect_)return null==this.oldSelect_?(this.oldSelect_=t,void this.selectOn(t,!1)):void(t.intId!=this.oldSelect_.intId&&(t.intId!=this.editor.svg.selected.intId&&this.selectOff(this.oldSelect_),this.oldSelect_=t,this.selectOn(t,!1)))}else null!=this.oldSelect_&&(this.selectOff(this.oldSelect_),this.oldSelect_=null);else null!=this.oldSelect_&&(this.selectOff(this.oldSelect_),this.oldSelect_=null)},e.prototype.createMenu=function(t,e){this.editor_.helpers.input.touch.isTouch?(null!=this.editor_.svg.getStyle(".svgIconMenuTouch","margin-left")&&(this.MENUOFFSETX=parseInt(this.editor_.svg.getStyle(".svgIconMenuTouch","margin-left"))),null!=this.editor_.svg.getStyle(".svgIconMenuTouch","margin-top")&&(this.MENUOFFSETITEM=parseInt(this.editor_.svg.getStyle(".svgIconMenuTouch","margin-top")))):(null!=this.editor_.svg.getStyle(".svgIconMenu","margin-left")&&(this.MENUOFFSETX=parseInt(this.editor_.svg.getStyle(".svgIconMenu","margin-left"))),null!=this.editor_.svg.getStyle(".svgIconMenu","margin-top")&&(this.MENUOFFSETITEM=parseInt(this.editor_.svg.getStyle(".svgIconMenu","margin-top"))));var o,i,r,n,s,a=t.boundingBox,l=0,d=a.y+this.MENUOFFSETY*this._lineWidthScale,c=this.MENUOFFSETITEM*this._lineWidthScale,h=0,u=this,p=this.editor_.svg.root.element.createSVGPoint();if(p.x=this.editor.fixedLeft+$(this.editor_.container).innerWidth(),p.y=this.editor.fixedTop+$(this.editor_.container).innerHeight(),n=(p=p.matrixTransform(this.editor_.getScreenCTM().inverse())).x-this.MENUOFFSETX*this._lineWidthScale*1.7,s=p.y,o=n,p.x=this.editor.fixedLeft,p.y=this.editor.fixedTop,p.y+=50,i=(p=p.matrixTransform(this.editor_.getScreenCTM().inverse())).x+this.MENUOFFSETY*this._lineWidthScale*2,r=p.y+this.MENUOFFSETY*this._lineWidthScale*2,(l=a.x+a.width<o?a.x+a.width+this.MENUOFFSETX*this._lineWidthScale:a.x-this.MENUOFFSETX*this._lineWidthScale)<i&&(l=n+this.MENUOFFSETX*this._lineWidthScale,d+=this.MENUOFFSETX*this._lineWidthScale/2),d<r&&(d=r+this.MENUOFFSETY*this._lineWidthScale),-1!=$.inArray(window.SELECT_MENU_EDIT,e)){var f=this.editor_.helpers.icon.createIcon("selectEditIcon","icon_editor_Edit","selectGroup",this.MENUPADDING,SVG.SHAPE_RECT,!0);this.editor_.svg.moveNode(f,l+0*h,d+c*h),h++,f.element.setAttribute("class","svgSelectIcon"),f.element.setAttribute("pointer-events","all"),$(f.element).on("click",(function(e){e.stopPropagation(),t.onEditMenu()}))}if(-1!=$.inArray(window.SELECT_MENU_UP,e)&&!t.parent.isChildFirst(t,!1)){var g=this.editor_.helpers.icon.createIcon("selectUpIcon","icon_editor_Up","selectGroup",this.MENUPADDING,SVG.SHAPE_RECT,!0);this.editor_.svg.moveNode(g,l+0*h,d+c*h),h++,g.element.setAttribute("class","svgSelectIcon"),g.element.setAttribute("pointer-events","all"),$(g.element).on("click",(function(e){e.stopPropagation(),t.parent.moveChildUp(t),u.reDrawHoverAndSelect()}))}if(-1!=$.inArray(window.SELECT_MENU_DOWN,e)&&!t.parent.isChildLast(t,!1)){var v=this.editor_.helpers.icon.createIcon("selectDownIcon","icon_editor_Down","selectGroup",this.MENUPADDING,SVG.SHAPE_RECT,!0);this.editor_.svg.moveNode(v,l+0*h,d+c*h),h++,v.element.setAttribute("class","svgSelectIcon"),v.element.setAttribute("pointer-events","all"),$(v.element).on("click",(function(e){e.stopPropagation(),t.parent.moveChildDown(t),u.reDrawHoverAndSelect()}))}if(-1!=$.inArray(window.SELECT_MENU_PART_UP,e)){var m=this.editor_.helpers.icon.createIcon("selectPartUpIcon","icon_editor_Up","selectGroup",this.MENUPADDING,SVG.SHAPE_RECT,!0);this.editor_.svg.moveNode(m,l+0*h,d+c*h),h++,m.element.setAttribute("class","svgSelectIcon"),m.element.setAttribute("pointer-events","all"),$(m.element).on("click",(function(e){e.stopPropagation(),t.movePartUp(),u.reDrawHoverAndSelect()}))}if(-1!=$.inArray(window.SELECT_MENU_PART_DOWN,e)){var _=this.editor_.helpers.icon.createIcon("selectPartDownIcon","icon_editor_Down","selectGroup",this.MENUPADDING,SVG.SHAPE_RECT,!0);this.editor_.svg.moveNode(_,l+0*h,d+c*h),h++,_.element.setAttribute("class","svgSelectIcon"),_.element.setAttribute("pointer-events","all"),$(_.element).on("click",(function(e){e.stopPropagation(),t.movePartDown(),u.reDrawHoverAndSelect()}))}if(-1!=$.inArray(window.SELECT_MENU_COPY,e)){var b=this.editor_.helpers.icon.createIcon("selectCopyIcon","icon_editor_Copy","selectGroup",this.MENUPADDING,SVG.SHAPE_RECT,!0);this.editor_.svg.moveNode(b,l+0*h,d+c*h),h++,b.element.setAttribute("class","svgSelectIcon"),b.element.setAttribute("pointer-events","all"),$(b.element).on("click",(function(e){e.stopPropagation();var o=new Array;o.offX=10,o.offY=10,t.type==SVG.PART&&u.editor.svg.sheet.sheet_type==SVG.MODE_SHEET&&(t.boundingBox.y+t.boundingBox.height+o.offY>u.editor.svg.sheet.boundingBox.height&&(o.offY=-o.offY),t.boundingBox.x+t.boundingBox.width+o.offX>u.editor.svg.sheet.boundingBox.width&&(o.offX=-o.offX)),u.editor.svg.copyNode(t,o),u.reDrawHoverAndSelect()}))}if(-1!=$.inArray(window.SELECT_MENU_CENTER_HOR,e)){var y=this.editor_.helpers.icon.createIcon("selectCenterHorIcon","icon_editor_Center_hor","selectGroup",this.MENUPADDING,SVG.SHAPE_RECT,!0);this.editor_.svg.moveNode(y,l+0*h,d+c*h),h++,y.element.setAttribute("class","svgSelectIcon"),y.element.setAttribute("pointer-events","all"),$(y.element).on("click",(function(e){e.stopPropagation();var o=!1,i=!1,r=!1;t.type==SVG.PART&&u.editor.svg.sheet.sheet_type==SVG.MODE_SHEET&&(o=!0),t.type==SVG.SHAPE_MULTI&&null!=u.editor.svg.collage&&(i=!0),u.editor.svg.sheet.sheet_type==SVG.MODE_CASE&&(r=!0),u.editor.svg.centerHorOrVer(t,!0,o,i,r),u.reDrawHoverAndSelect()}))}if(-1!=$.inArray(window.SELECT_MENU_CENTER_VER,e)){var E=this.editor_.helpers.icon.createIcon("selectCenterVerIcon","icon_editor_Center_ver","selectGroup",this.MENUPADDING,SVG.SHAPE_RECT,!0);this.editor_.svg.moveNode(E,l+0*h,d+c*h),h++,E.element.setAttribute("class","svgSelectIcon"),E.element.setAttribute("pointer-events","all"),$(E.element).on("click",(function(e){e.stopPropagation();var o=!1,i=!1,r=!1;t.type==SVG.PART&&u.editor.svg.sheet.sheet_type==SVG.MODE_SHEET&&(o=!0),t.type==SVG.SHAPE_MULTI&&null!=u.editor.svg.collage&&(i=!0),u.editor.svg.sheet.sheet_type==SVG.MODE_CASE&&(r=!0),u.editor.svg.centerHorOrVer(t,!1,o,i,r),u.reDrawHoverAndSelect()}))}if(-1!=$.inArray(window.SELECT_MENU_DELETE,e)){var T=this.editor_.helpers.icon.createIcon("selectDeleteIcon","icon_editor_Delete","selectGroup",this.MENUPADDING,SVG.SHAPE_RECT,!0);this.editor_.svg.moveNode(T,l+0*h,d+c*h),h++,T.element.setAttribute("class","svgSelectIcon"),T.element.setAttribute("pointer-events","all"),$(T.element).on("click",(function(e){e.stopPropagation(),t.onDeleteMenu()&&t.remove(),u.editor.helpers.select.select(null)}))}if(-1!=$.inArray(window.SELECT_MENU_COLLAGE,e)&&null!=this.editor_.svg.collage&&null!=t.collageObject){var x=this.editor_.helpers.icon.createIcon("selectCollageIcon","icon_editor_Ok","selectGroup",this.MENUPADDING,SVG.SHAPE_RECT,!0);this.editor_.svg.moveNode(x,l+0*h,d+c*h),h++,x.element.setAttribute("class","svgSelectIcon"),x.element.setAttribute("pointer-events","all"),$(x.element).on("click",(function(t){t.stopPropagation(),u.editor.helpers.select.select(null)}))}if(-1!=$.inArray(window.SELECT_MENU_UPLOAD,e)){var S=this.editor_.helpers.icon.createIcon("selectUploadIcon","icon_editor_Upload","selectGroup",this.MENUPADDING,SVG.SHAPE_RECT,!0);this.editor_.svg.moveNode(S,l+0*h,d+c*h),h++,S.element.setAttribute("class","svgSelectIcon"),S.element.setAttribute("pointer-events","all"),$(S.element).on("click",(function(t){t.stopPropagation(),u.editor.ui.uploadFile()}))}if(d+c*h>s)for(var w=s-(d+c*h),P=["#selectEditIcon","#selectUpIcon","#selectDownIcon","#selectCopyIcon","#selectCenterHorIcon","#selectCenterVerIcon","#selectUploadIcon","#selectCollageIcon","#selectDeleteIcon"],C=0;C<P.length;++C){var O=$(P[C]).attr("transform");void 0!==O&&!1!==O&&$(P[C]).attr("transform","translate(0,"+w+") "+O)}},e.prototype.showDpi=function(t){},e.prototype.drawRotateLine=function(t){if(null!=t){null!=t.selectToolElement1&&(this.selectBranch.removeElement(t.selectToolElement1),t.selectToolElement1=null);var e=this.editor_.helpers.input.position.x,o=this.editor_.helpers.input.position.y,i=t.getCenterPoint(!1),r=document.createElementNS(SVG.SVG_NAMESPACE,"line");r.setAttribute("x1",e),r.setAttribute("y1",o),r.setAttribute("x2",i.x),r.setAttribute("y2",i.y),r.setAttribute("class","svgSelectRotateLine"),t.selectToolElement1=r,this.selectBranch.addElement(t.selectToolElement1,!0);var n=parseFloat(this.editor_.svg.getStyle(".svgSelectRotateLine","stroke-width"));$(t.selectToolElement1).css("stroke-width",parseFloat((n*this._lineWidthScale).toString())+"px")}},e.prototype.removeRotateLine=function(t){null!=t.selectToolElement1&&(this.selectBranch.removeElement(t.selectToolElement1),t.selectToolElement1=null)},e.prototype.createSelectElement=function(t){var e=this,o=t.boundingBox,i=new Array;i.id="selectGroup",i.parentId="selectLayer",null!=this.selectGroup_&&this.selectGroup_.removeInklChildren(),this.selectGroup_=this.editor_.svg.createNode(SVG.GROUP_STANDARD,i),this.selectGroup_.overHandling=SVG.OVER_IGNORE;var r=this.selectGroup_.element,n=document.createElementNS(SVG.SVG_NAMESPACE,"rect");n.setAttribute("x",o.x),n.setAttribute("y",o.y),n.setAttribute("width",o.width),n.setAttribute("height",o.height),n.setAttribute("class","svgSelect"),n.setAttribute("pointer-events","all"),r.appendChild(n);var s=parseFloat(this.editor_.svg.getStyle(".svgSelect","stroke-width"));if($(n).css("stroke-width",parseFloat((s*this._lineWidthScale).toString())),t.isMoveable?($(n).on("mouseenter",(function(){e.lockTool||(e.selectedTool=window.SELECT_TOOL_MOVE)})),$(n).on("mouseleave",(function(){e.lockTool||(e.selectedTool=null)}))):($(n).css("stroke-width",parseFloat((s*this._lineWidthScale).toString())+"px"),$(n).css("cursor","default")),t.isResizeable)for(var a=[[o.x,o.y,"nw"],[o.x+o.width,o.y,"ne"],[o.x+o.width,o.y+o.height,"se"],[o.x,o.y+o.height,"sw"]],l=0;l<a.length;l++)switch(a[l][2]){case"nw":var d=this.editor_.helpers.icon.createIcon("selectNWIcon","icon_editor_NWResize","selectGroup",2,SVG.SHAPE_RECT);this.editor_.svg.moveNode(d,a[l][0],a[l][1]),d.element.setAttribute("class","svgSelectNW"),d.element.setAttribute("pointer-events","all"),$(d.element).on("mouseenter",(function(){e.lockTool||(e.selectedTool=window.SELECT_TOOL_NW_RESIZE)})),$(d.element).on("mouseleave",(function(){e.lockTool||(e.selectedTool=null)}));break;case"ne":var c=this.editor_.helpers.icon.createIcon("selectNEIcon","icon_editor_NEResize","selectGroup",2,SVG.SHAPE_RECT);this.editor_.svg.moveNode(c,a[l][0],a[l][1]),c.element.setAttribute("class","svgSelectNE"),c.element.setAttribute("pointer-events","all"),$(c.element).on("mouseenter",(function(){e.lockTool||(e.selectedTool=window.SELECT_TOOL_NE_RESIZE)})),$(c.element).on("mouseleave",(function(){e.lockTool||(e.selectedTool=null)}));break;case"se":var h=this.editor_.helpers.icon.createIcon("selectSEIcon","icon_editor_SEResize","selectGroup",2,SVG.SHAPE_RECT);this.editor_.svg.moveNode(h,a[l][0],a[l][1]),h.element.setAttribute("class","svgSelectSE"),h.element.setAttribute("pointer-events","all"),$(h.element).on("mouseenter",(function(){e.lockTool||(e.selectedTool=window.SELECT_TOOL_SE_RESIZE)})),$(h.element).on("mouseleave",(function(){e.lockTool||(e.selectedTool=null)}));break;case"sw":var u=this.editor_.helpers.icon.createIcon("selectSWIcon","icon_editor_SWResize","selectGroup",2,SVG.SHAPE_RECT);this.editor_.svg.moveNode(u,a[l][0],a[l][1]),u.element.setAttribute("class","svgSelectSW"),u.element.setAttribute("pointer-events","all"),$(u.element).on("mouseenter",(function(){e.lockTool||(e.selectedTool=window.SELECT_TOOL_SW_RESIZE)})),$(u.element).on("mouseleave",(function(){e.lockTool||(e.selectedTool=null)}))}if(t.isAspectChangable&&this.editor_.svg.zoom==SVG.ZOOM_PART)for(a=[[o.x+o.width/2,o.y,"n"],[o.x+o.width,o.y+o.height/2,"w"],[o.x+o.width/2,o.y+o.height,"s"],[o.x,o.y+o.height/2,"e"]],l=0;l<a.length;l++)switch(a[l][2]){case"n":var p=this.editor_.helpers.icon.createIcon("selectNIcon","icon_editor_NResize","selectGroup",2,SVG.SHAPE_RECT);this.editor_.svg.moveNode(p,a[l][0],a[l][1]),p.element.setAttribute("class","svgSelectN"),p.element.setAttribute("pointer-events","all"),$(p.element).on("mouseenter",(function(){e.lockTool||(e.selectedTool=window.SELECT_TOOL_N_RESIZE)})),$(p.element).on("mouseleave",(function(){e.lockTool||(e.selectedTool=null)}));break;case"e":var f=this.editor_.helpers.icon.createIcon("selectEIcon","icon_editor_EResize","selectGroup",2,SVG.SHAPE_RECT);this.editor_.svg.moveNode(f,a[l][0],a[l][1]),f.element.setAttribute("class","svgSelectE"),f.element.setAttribute("pointer-events","all"),$(f.element).on("mouseenter",(function(){e.lockTool||(e.selectedTool=window.SELECT_TOOL_E_RESIZE)})),$(f.element).on("mouseleave",(function(){e.lockTool||(e.selectedTool=null)}));break;case"s":var g=this.editor_.helpers.icon.createIcon("selectSIcon","icon_editor_SResize","selectGroup",2,SVG.SHAPE_RECT);this.editor_.svg.moveNode(g,a[l][0],a[l][1]),g.element.setAttribute("class","svgSelectS"),g.element.setAttribute("pointer-events","all"),$(g.element).on("mouseenter",(function(){e.lockTool||(e.selectedTool=window.SELECT_TOOL_S_RESIZE)})),$(g.element).on("mouseleave",(function(){e.lockTool||(e.selectedTool=null)}));break;case"w":var v=this.editor_.helpers.icon.createIcon("selectWIcon","icon_editor_WResize","selectGroup",2,SVG.SHAPE_RECT);this.editor_.svg.moveNode(v,a[l][0],a[l][1]),v.element.setAttribute("class","svgSelectW"),v.element.setAttribute("pointer-events","all"),$(v.element).on("mouseenter",(function(){e.lockTool||(e.selectedTool=window.SELECT_TOOL_W_RESIZE)})),$(v.element).on("mouseleave",(function(){e.lockTool||(e.selectedTool=null)}))}if(t.isRotateable){var m,_=t.getCenterPoint(!1),b=o.x+o.width/2,y=0,E=0,T=null,x=this.editor_.svg.root.element.createSVGPoint();x.x=this.editor.fixedLeft+this.editor_.svg.editorMargin.left,x.y=this.editor.fixedTop+this.editor_.svg.editorMargin.top,m=(x=x.matrixTransform(this.editor_.getScreenCTM().inverse())).y+50+10,o.y>m?(y=o.y-this.SELECTCORNERSIZE*this._lineWidthScale*2,E=o.y,T=window.SELECT_TOOL_ROTATE,this.invertedRotation=!1):(y=o.y+o.height+this.SELECTCORNERSIZE*this._lineWidthScale*2,E=o.y+o.height,T=window.SELECT_TOOL_ROTATE_INVERSE,this.invertedRotation=!0);var S=document.createElementNS(SVG.SVG_NAMESPACE,"line");S.setAttribute("x1",b),S.setAttribute("y1",y.toString()),S.setAttribute("x2",_.x),S.setAttribute("y2",E),S.setAttribute("class","svgSelect"),r.appendChild(S),$(S).css("stroke-width",parseFloat((s*this._lineWidthScale).toString())+"px");var w=this.editor_.helpers.icon.createIcon("selectRotateIcon","icon_editor_Rotate","selectGroup",1);this.editor_.svg.moveNode(w,b,y),w.element.setAttribute("class","svgSelectRotate"),w.element.setAttribute("pointer-events","all"),$(w.element).on("mouseenter",(function(){e.lockTool||(e.selectedTool=T)})),$(w.element).on("mouseleave",(function(){e.lockTool||(e.selectedTool=null)}))}var P=t.getMenuOptions();return null!=P&&this.createMenu(t,P),t.type==SVG.PART&&this.editor_.svg.sheet.sheet_type==SVG.MODE_SHEET&&t.showSize(),r},e.prototype.selectOff=function(t){t.selectElement=null,this.editor_.svg.selected=null,$(this.selectGroup_.element).css("display","none"),this.editor_.helpers.icon.clearIconsList(),t.onDeSelect(),this.editor_.helpers.dpi.calcAndCheckDpi(),this.editor_.api.specialTextSelection=null,this.editor.trigger(n.EditorEventType.DESELECT_NODE,t.type),t.type==SVG.PART&&this.editor_.svg.sheet.sheet_type==SVG.MODE_SHEET&&t.hideSize()},e.prototype.selectOn=function(t,e){this.editor_.svg.selected=t,(null==t.selectElement||e)&&(e||t.onSelect(),t.selectElement=this.createSelectElement(t),this.selectBranch.addElement(t.selectElement,!0),this.editor.trigger(n.EditorEventType.SELECT_NODE,t.type)),this.editor_.helpers.dpi.calcAndCheckDpi()},e.prototype.hoverOff=function(t){null!=t.hoverElement&&(this.selectBranch.removeElement(t.hoverElement),t.hoverElement=null),this.editor_.svg.hovered=null,t.type==SVG.PART&&t.unMarkPath()},e.prototype.hoverOn=function(t,e,o){if(o=void 0===o?null:o,null==t.hoverElement||e)if(e&&this.selectBranch.removeElement(t.hoverElement),t.type==SVG.PART){t.hoverElement=document.createElementNS(SVG.SVG_NAMESPACE,"path"),t.hoverElement.setAttribute("d",t.path),this.selectBranch.addElement(t.hoverElement,!1),$(t.hoverElement).css("cursor","pointer"),$(t.hoverElement).css("pointer-events","all"),$(t.hoverElement).css("visibility","hidden");var i=10;$(t.hoverElement).css("stroke-width",parseFloat((i*this._lineWidthScale).toString())+"px"),$(t.hoverElement).on("mouseover",(function(){t.markPath()})).on("mouseout",(function(){t.unMarkPath()}))}else t.hoverElement=document.createElementNS(SVG.SVG_NAMESPACE,"rect"),t.hoverElement.setAttribute("x",t.boundingBox.x),t.hoverElement.setAttribute("y",t.boundingBox.y),t.hoverElement.setAttribute("width",t.boundingBox.width),t.hoverElement.setAttribute("height",t.boundingBox.height),null!=o?t.hoverElement.setAttribute("class",o):t.hoverElement.setAttribute("class","svgHover"),t.hoverElement.setAttribute("pointer-events","all"),this.selectBranch.addElement(t.hoverElement,!1),i=1,i=null!=o?parseFloat(this.editor_.svg.getStyle("."+o,"stroke-width")):parseFloat(this.editor_.svg.getStyle(".svgHover","stroke-width")),$(t.hoverElement).css("stroke-width",parseFloat((i*this._lineWidthScale).toString())+"px");t.type==SVG.SHAPE_PATH&&null!=t.collageObject&&null!=t.collageObject.imageNode&&t.hoverElement.setAttribute("class","svgHover move"),this.editor_.svg.hovered=t},e.prototype.calcLineWidthScale=function(){var t=this.editor_.svg.root.element.viewBox.animVal.height,e=this.editor_.svg.root.element.viewBox.animVal.width,o=$(this.editor_.container).height()/t,i=$(this.editor_.container).width()/e;this._lineWidthScale=1/Math.min(o,i)},Object.defineProperty(e.prototype,"lineWidthScale",{get:function(){return this._lineWidthScale},enumerable:!1,configurable:!0}),e.prototype.onEditorIsTouch=function(t){this.MENUOFFSETX=this.MENUTOUCHOFFSETX,this.MENUOFFSETY=this.MENUTOUCHOFFSETY,this.MENUOFFSETITEM=this.MENUTOUCHOFFSETITEM,this.MENUPADDING=this.MENUTOUCHPADDING},e.prototype.onEditorSVGCreated=function(){this.calcLineWidthScale(),this.selectBranch=this.editor.svg.createNode(SVG.LAYER_STANDARD,{id:"selectLayer"}),this.selectBranch.ignore=!0,this.selectBranch.overHandling=SVG.OVER_NEVER},e}(r.EditorComponent);exports.SelectHelper=s},20754:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.StickerappInlineEditorHelper=void 0;var r=e(94297),n=e(37463),s=e(35896),a=function(t){function e(e){var o=t.call(this,e)||this;return e.on(s.EditorEventType.INITIATED,(function(t){return o.onEditorInit()})),o}return i(e,t),e.prototype.onSaveClick=function(t,e){t.preventDefault();var o=this,i=this.editor.exportAndSanitizeData(e);$.ajax({type:"POST",url:this.editor.model.editor.postURL,data:i,success:function(t){$(o.editor.$el).trigger(n.CartEventType.UPDATE,i)},error:function(t){$("#connection-error").modal("show"),$("#overlay").hide()}})},e.prototype.onEditorInit=function(){var t=this;this.editor.controller.unregisterAllByEventName(s.EditorEventType.SAVE),this.editor.on(s.EditorEventType.SAVE,(function(e,o){return t.onSaveClick(e,o)}))},e}(r.EditorComponent);exports.StickerappInlineEditorHelper=a},9844:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.StickerappModalHelper=void 0;var r=e(35896),n=function(t){function e(e){var o=t.call(this,e)||this;return o.editor.on(r.EditorEventType.DATA_POSTED,(function(t,e,i,r){return o.onDataPosted(t,i,r)})),o}return i(e,t),e.prototype.onDataPosted=function(t,e,o){$("body").hasClass("checkout")||(this.editor.api.isChanged(!0),e.redirectURL&&(window.location=e.redirectURL))},e}(e(94297).EditorComponent);exports.StickerappModalHelper=n},87999:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.ThumbnailHelper=void 0;var r=e(94297),n=e(7353),s=e(17106),a=function(t){function e(e){var o=t.call(this,e)||this;return o._queue=[],o._busy=!1,o._nodeCollection=new n.Collection,o._thumbVersionCollection=new n.Collection,o}return i(e,t),e.prototype.requestThumb=function(t,e){var o=t.intId;this._thumbVersionCollection.get(o)!=e&&(this._nodeCollection.add(o,t),this._thumbVersionCollection.add(o,e),this._queue.indexOf(o)<0&&this._queue.push(o),this.processNext())},e.prototype.processNext=function(){var t=this;if(this._queue.length&&!this._busy){var e=this._queue.shift(),o=this._nodeCollection.get(e),i=this._thumbVersionCollection.get(e),r=void 0,n=void 0;if(o&&o.element&&(r=o.element.getAttribute("fileapp_id"),n=o.element.getAttribute("fileapp_region")),e&&o&&i){if(this.editor.ui.showSpinner(),this._busy=!0,null!==r&&null!==n){var a=this;new s.FileAppService(n).getThumbnail("","",i,(function(t){null!==t&&t.thumbUrl?a.onResult(e,t.thumbUrl):a.onError(e,t)}))};return}}this._busy||this.editor.ui.hideSpinner()},e.prototype.onResult=function(t,e){var o=this._nodeCollection.get(t),i=this._thumbVersionCollection.get(t);o.currentThumbVersion=i,o.element.setAttribute("xlink:href",e),this._nodeCollection.delete(t),this._thumbVersionCollection.delete(t),this._busy=!1,this._queue.length?this.processNext():this.editor.ui.hideSpinner()},e.prototype.onError=function(t,e){var o=this._nodeCollection.get(t),i=this._thumbVersionCollection.get(t);500==e.status&&(o.currentThumbVersion=i,this._nodeCollection.delete(t),this._thumbVersionCollection.delete(t)),this._busy=!1,this._queue.length?this.processNext():this.editor.ui.hideSpinner()},e}(r.EditorComponent);exports.ThumbnailHelper=a},99914:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.DPIHelper=void 0;var r=e(56689),n=function(t){function e(e){var o=t.call(this,e)||this;return o.images=[],o.messages=[],o.oldMessages=[],o.id=0,o}return i(e,t),e.prototype.addImageNode=function(t){this.images.push(t)},e.prototype.removeImageNode=function(t){for(var e=0;e<this.images.length;e++)if(t.id==this.images[e].id){this.images.splice(e,1);break}this.removeMessage(t)},e.prototype.calcAndCheckDpi=function(){for(var t=0;t<this.images.length;t++){var e=this.images[t].checkDpi;this.images[t].checkDpi=!1,this.images[t].calcDPI(),this.images[t].checkDpi=e}this.checkDpi()},e.prototype.checkDpi=function(){for(var t=0;t<this.images.length;t++){var e=this.images[t];e.dpi<100?(this.removeMessage(e,1,2),this.addMessage(e,1,1,e.dpi)):e.dpi<200?(this.removeMessage(e,1,1),this.addMessage(e,1,2,e.dpi)):this.removeMessage(e,1)}this.displayMessages()},e.prototype.highlight=function(t){for(var e=0;e<this.messages.length;e++)if(this.messages[e].id==t){if(this.editor_.svg.zoom!=SVG.ZOOM_SHEET){null!=this.messages[e].node&&this.editor_.helpers.select.select(this.messages[e].node);break}this.editor_.helpers.select.select(this.messages[e].node.getPart())}},e.prototype.addMessage=function(t,e,o,i){for(var n=!0,s=0;s<this.messages.length;s++)if(this.messages[s].node.id==t.id&&this.messages[s].code==e&&this.messages[s].type==o){n=!1;break}if(n){this.id++;var a=new r.MessageVO(this.editor_.helpers.message.getId(),t,e,o,i,!1);this.messages.push(a)}},e.prototype.removeMessage=function(t,e,o){o=void 0===o?0:o,e=void 0===e?0:e;for(var i=0;i<this.messages.length;i++)null!=t?this.messages[i].node.id!=t.id||this.messages[i].code!=e&&0!=e||this.messages[i].type!=o&&0!=o||(this.messages.splice(i,1),i--):this.messages[i].code!=e&&0!=e||(this.messages.splice(i,1),i--)},e.prototype.displayMessages=function(){for(var t=0;t<this.messages.length;t++)this.messages[t].node.isParentSelected()&&!this.messages[t].visable&&(this.editor.ui.showMessage(this.messages[t].code,this.messages[t].type,this.messages[t].id,this.messages[t].data),this.messages[t].visable=!0),!this.messages[t].node.isParentSelected()&&this.messages[t].visable&&(this.editor.ui.hideMessage(this.messages[t].id),this.messages[t].visable=!1),6==this.messages[t].code&&(this.editor.ui.showMessage(this.messages[t].code,this.messages[t].type,this.messages[t].id,this.messages[t].data),this.messages[t].visable=!0);for(t=0;t<this.oldMessages.length;t++){for(var e=!0,o=0;o<this.messages.length;o++)this.messages[o].id==this.oldMessages[t].id&&(e=!1);e&&this.oldMessages[t].visable&&(this.editor.ui.hideMessage(this.oldMessages[t].id),this.oldMessages[t].visable=!1)}if(this.editor_.svg.zoom==SVG.ZOOM_SHEET)for(t=0;t<this.messages.length;t++)if(this.messages[t].visable)for(o=0;o<this.messages.length;o++)this.messages[t].node.getPart().id,this.messages[o].visable&&t!=o&&this.messages[o].type>=this.messages[t].type&&(this.editor.ui.hideMessage(this.messages[o].id),this.messages[o].visable=!1);this.oldMessages=this.messages.slice(0)},e}(e(94297).EditorComponent);exports.DPIHelper=n},30733:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.EmojiHelper=void 0;var r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.fixEmoji=function(){var t=this;$.getJSON("https://stickerapp.com/static/images/web/emoji/index.json",(function(e){for(var o=e,i=t.editor.container.getElementsByTagName("svg")[0],r=i.getElementsByTagName("tspan"),n=new Array,s=0;s<r.length;s++){var a=r[s];if("text"==a.parentNode.tagName){var l=$(a).html(),d=t.ucs2decode(l);if(null!=d)for(var c=0;c<d.length;c++)for(var h=d.length-1;h>=c;h--){for(var u=d[c].toString(16),p=c+1;p<=h;p++)u+="-"+d[p].toString(16);if(-1!=o.indexOf(u)){n.push(u),c=h;break}}}}i.getAttribute("viewBox").split(" ");var f=t.editor.svg.activePart.boundingBox.height/8,g=0;g=null!=t.editor.svg.activePart.bleedPathNode?t.editor.svg.activePart.bleedPathNode.boundingBox.x-f-f/4:t.editor.svg.activePart.boundingBox.x-f-f/4;var v=t.editor.svg.activePart.boundingBox.y,m=0;for(s=0;s<n.length;s++){++m>8&&(g-=f,v=t.editor.svg.activePart.boundingBox.y,m=1);var _={};_.svg='<image xlink:href="https://stickerapp.com/static/images/web/emoji/'+n[s]+'.png" x="'+g+'" y="'+v+'" height="'+f+'" width="'+f+'" />',_.id="emoji_img_"+n[s];var b=t.editor.svg.createNode(SVG.SHAPE_MULTI,{json:_,part:t.editor.svg.activePart.id});t.editor.helpers.importHelper.importSVGData(_.svg,b,(function(){t.editor.svg.runBBox=!0,setTimeout((function(){b.makeBBoxUpdateList()}),0)})),v+=f}})).fail((function(){}))},e.prototype.ucs2encode=function(t){return this.map(t,(function(t){var e="";return t>65535&&(t-=65536,e+=String.fromCharCode(t>>>10&1023|55296),t=56320|1023&t),e+String.fromCharCode(t)})).join("")},e.prototype.ucs2decode=function(t){if(null==t||void 0===t)return null;for(var e,o,i=[],r=0,n=t.length;r<n;)(e=t.charCodeAt(r++))>=55296&&e<=56319&&r<n?56320==(64512&(o=t.charCodeAt(r++)))?i.push(((1023&e)<<10)+(1023&o)+65536):(i.push(e),r--):i.push(e);return i},e.prototype.map=function(t,e){for(var o=t.length,i=[];o--;)i[o]=e(t[o]);return i},e}(e(94297).EditorComponent);exports.EmojiHelper=r},82096:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.IconHelper=void 0;var r=e(46376),n=e(94297),s=e(35896),a=function(t){function e(e){var o=t.call(this,e)||this;return o.iconNodes=[],o.editor.registerCallback(o.editor,s.EditorEventType.EDITOR_RESIZE,(function(t){return o.onEditorResize(t)})),o.editor.registerCallback(o.editor,s.EditorEventType.SVG_CREATED,(function(t){return o.onEditorResize(t)})),o}return i(e,t),Object.defineProperty(e,"TOUCH_SENSITIVITY",{get:function(){return 10},enumerable:!1,configurable:!0}),e.getIcon=function(t){return e.iconCollection||(e.iconCollection=new r.EditorIconCollection),e.iconCollection.has(t)?e.iconCollection.get(t):null},e.prototype.overIcon=function(t){for(var o=0;o<this.iconNodes.length;o++)if(null!=this.iconNodes[o].children[1]){this.calcLineWidthScale();var i=e.TOUCH_SENSITIVITY*this.lineWidthScale_;this.iconNodes[o].children[1].createBBoxAndCenter();var r=this.iconNodes[o].children[1].boundingBox;if(!(t.x<r.x-i||t.x>r.x+r.width+i||t.y<r.y-i||t.y>r.y+r.height+i))return this.iconNodes[o]}return null},e.prototype.createIcon=function(t,o,i,r,n,s){i=void 0===i?null:i,r=void 0===r?0:r,n=void 0===n?SVG.SHAPE_CIRCLE:n,s=void 0!==s&&s;var a=e.getIcon(o),l=a.imageName,d=a.size,c=a.x,h=a.y,u=new Array;u.id=t,null!=i&&(u.parentId=i);var p=this.editor_.svg.createNode(SVG.GROUP_STANDARD,u);p.ignore=!0,p.overHandling=SVG.OVER_IGNORE;var f=this.editor_.svg.getStyle(".svgIconRound","padding");f=null==f?r:parseInt(f);var g=this.editor_.svg.getStyle(".svgIconRect","padding");g=null==g?r:parseInt(g);var v=this.editor_.svg.getStyle(".svgIconRect","border-radius");if(v=null==v?0:parseInt(v),s&&(null!=this.editor_.svg.getStyle(".svgIconMenu","padding")&&(g=parseInt(this.editor_.svg.getStyle(".svgIconMenu","padding"))),null!=this.editor_.svg.getStyle(".svgIconMenu","border-radius")&&(v=parseInt(this.editor_.svg.getStyle(".svgIconMenu","border-radius")))),n==SVG.SHAPE_CIRCLE){var m,_,b=Math.sqrt(Math.pow(d,2)/2)+f;(m=new Array).id=t+"IconBackground",m.cx=c+d/2,m.cy=h+d/2,m.r=b,m.parentId=t,m.class="svgIcon",(_=this.editor_.svg.createNode(SVG.SHAPE_CIRCLE,m)).ignore=!0,_.overHandling=SVG.OVER_IGNORE}n==SVG.SHAPE_RECT&&((m=new Array).id=t+"IconBackground",m.left=c-g,m.top=h-g,m.width=d+2*g,m.height=d+2*g,m.parentId=t,s?this.editor_.helpers.input.touch.isTouch?m.class="svgIconMenuTouch":m.class="svgIconMenu":m.class="svgIcon",m.rx=v,m.ry=v,(_=this.editor_.svg.createNode(SVG.SHAPE_RECT,m)).ignore=!0,_.overHandling=SVG.OVER_IGNORE),_.element.setAttribute("pointer-events","all");var y=new Array;y.id=t+"IconSecondGroup",y.parentId=t;var E=this.editor_.svg.createNode(SVG.GROUP_STANDARD,y);E.ignore=!0,E.overHandling=SVG.OVER_IGNORE,E.element.setAttribute("pointer-events","none");var T=document.createElementNS(SVG.SVG_NAMESPACE,"clipPath");$(p.element).prepend(T),T.setAttribute("id",t+"IconClipPath");var x,S=document.createElementNS(SVG.SVG_NAMESPACE,"rect");switch($(T).append(S),S.setAttribute("x",c.toString()),S.setAttribute("y",h.toString()),S.setAttribute("width",d.toString()),S.setAttribute("height",d.toString()),E.element.setAttribute("clip-path","url(#"+t+"IconClipPath)"),l){case"EditorIcons":x="https://stickerapp.com/static/images/web/sprites/editor.png";break;case"EditorIconsVector":x="https://stickerapp.com/static/images/web/sprites/editor-icons.svg"}p.isTransformable=!0,p.isMoveable=!0,p.isResizeable=!0;var w=new Array;w.href=x,w.id=t+"IconImage",w.top=0,w.left=0,w.parentIntId=E.intId,w.width=550,w.height=550,this.editor_.svg.createNode(SVG.SHAPE_IMAGE,w,(function(t){t.ignore=!0}));var P=Math.min(this.svgTransMatrixInv_.a,this.svgTransMatrixInv_.d);return P*=.15,p.beforeTransform(),p.transform(SVG.TRANSFORM_MOVE,-1*c*P-d*P/2,-1*h*P-d*P/2),p.afterTransform(),p.beforeTransform(null,!0),p.transform(SVG.TRANSFORM_SCALE,"uni",P,0,0,0,0,!0),p.afterTransform(!0),this.iconNodes.push(p),p},e.prototype.clearIconsList=function(){this.iconNodes=[]},e.prototype.calcLineWidthScale=function(){var t=this.editor_.svg.root.element.viewBox.animVal.height,e=this.editor_.svg.root.element.viewBox.animVal.width,o=$(this.editor_.container).height()/t,i=$(this.editor_.container).width()/e;this.lineWidthScale_=1/Math.min(o,i)},e.prototype.onEditorResize=function(t){this.svgTransMatrixInv_=this.editor_.getScreenCTM().inverse()},e}(n.EditorComponent);exports.IconHelper=a},37304:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.InputHelper=void 0;var r=e(22927),n=e(47144),s=e(32262),a=e(94297),l=e(35896),d=function(t){function e(e){var o=t.call(this,e)||this;return o.position=null,o.mouse=new r.MouseHelper(o.editor_,o),o.keyboard=new n.KeyboardHelper(o.editor_,o),o.touch=new s.TouchHelper(o.editor_,o),o.editor.registerCallback(o.editor,l.EditorEventType.EDITOR_RESIZE,(function(){return o.refresh()})),o.editor.registerCallback(o.editor,l.EditorEventType.SVG_CREATED,(function(){return o.refresh()})),o}return i(e,t),e.prototype.eventToSvgCoords=function(t){var e=this.editor_.svg.root.element.createSVGPoint();return e.x=t.clientX,e.y=t.clientY,e.matrixTransform(this.svgTransMatrixInv)},e.prototype.calcLineWidthScale=function(){var t=this.editor_.svg.root.element.viewBox.animVal.height,e=this.editor_.svg.root.element.viewBox.animVal.width,o=$(this.editor_.container).height()/t,i=$(this.editor_.container).width()/e;return 1/Math.min(o,i)},e.prototype.refresh=function(){this._svgTransMatrix=this.editor.getScreenCTM(),this._svgTransMatrixInv=this._svgTransMatrix.inverse()},Object.defineProperty(e.prototype,"svgTransMatrixInv",{get:function(){return this._svgTransMatrixInv||this.refresh(),this._svgTransMatrixInv},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"svgTransMatrix",{get:function(){return this._svgTransMatrix||this.refresh(),this._svgTransMatrix},enumerable:!1,configurable:!0}),e}(a.EditorComponent);exports.InputHelper=d},47144:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.KeyboardHelper=void 0;var r=function(t){function e(e,o){var i=t.call(this,e)||this;return i.inputHelper_=o,i.editor.registerCallback(document,"keydown",(function(t){return i.onDocumentKeyDown(t)})),i}return i(e,t),Object.defineProperty(e,"KEY_LEFT",{get:function(){return 37},enumerable:!1,configurable:!0}),Object.defineProperty(e,"KEY_UP",{get:function(){return 38},enumerable:!1,configurable:!0}),Object.defineProperty(e,"KEY_RIGHT",{get:function(){return 39},enumerable:!1,configurable:!0}),Object.defineProperty(e,"KEY_DOWN",{get:function(){return 40},enumerable:!1,configurable:!0}),Object.defineProperty(e,"KEY_DEL",{get:function(){return 46},enumerable:!1,configurable:!0}),Object.defineProperty(e,"MOVE_FACTOR",{get:function(){return 2},enumerable:!1,configurable:!0}),e.prototype.onDocumentKeyDown=function(t){if("BODY"==document.activeElement.tagName){var o=this.inputHelper_.calcLineWidthScale(),i=0,r=0;switch(t.which){case e.KEY_UP:r=-e.MOVE_FACTOR*o;break;case e.KEY_DOWN:r=e.MOVE_FACTOR*o;break;case e.KEY_LEFT:i=-e.MOVE_FACTOR*o;break;case e.KEY_RIGHT:i=e.MOVE_FACTOR*o}null!=this.editor_.svg.selected&&(0==i&&0==r||(this.editor_.svg.noOnSelect=!0,this.editor_.svg.updateNodeBeforeTransformation(this.editor_.svg.selected),this.editor_.svg.moveNode(this.editor_.svg.selected,i,r),this.editor_.svg.updateNodeAfterTransformation(this.editor_.svg.selected),this.editor_.svg.noOnSelect=!1))}},e}(e(94297).EditorComponent);exports.KeyboardHelper=r},22927:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.MouseHelper=void 0;var r=e(94297),n=e(35896),s=function(t){function e(e,o){var i=t.call(this,e)||this;return i.isMouseDown_=!1,i.isDrag_=!1,i.isMaybeDrag_=!1,i.allowClick_=!0,i.allowDblClick_=!0,i.startDragX_=0,i.startDragY_=0,i.startTool_=null,i.clickStop_=!1,i.inputHelper_=o,i.editor.registerCallback(i.editor.$container,"click",(function(t){return i.onClick(t)})),i.editor.registerCallback(i.editor.$container,"dblclick",(function(t){return i.onDoubleClick(t)})),i.editor.registerCallback(i.editor.$container,"mousedown",(function(t){return i.onMouseDown(t)})),i.editor.registerCallback(i.editor.$container,"mouseenter",(function(t){return i.onMouseEnter(t)})),i.editor.registerCallback(i.editor.$container,"mouseleave",(function(t){return i.onMouseLeave(t)})),i.editor.registerCallback(i.editor.$container,"mousemove",(function(t){return i.onMouseMove(t)})),i.editor.registerCallback(document,"mouseup",(function(t){return i.mouseUpCheck(t)})),i.editor.registerCallback(document,"mouseleave",(function(t){return i.mouseUpCheck(t)})),i.editor.registerCallback(document,"mousemove",(function(t){return i.onDocumentMouseMove(t)})),i}return i(e,t),Object.defineProperty(e,"DRAGSENSITIVITYPIXELS",{get:function(){return 10},enumerable:!1,configurable:!0}),e.prototype.triggerEditorEvent=function(t,e,o){o=void 0!==o&&o;var i=jQuery.Event(t);if(o){var r=this.editor_.svg.root.element.createSVGPoint();r.x=this.startDragX_,r.y=this.startDragY_,r=r.matrixTransform(this.inputHelper_.svgTransMatrixInv),i.tool=this.startTool_,i.point=r,i.pageX=this.startDragX_,i.pageY=this.startDragY_}else i.tool=null,i.point=this.inputHelper_.eventToSvgCoords(e),i.pageX=e.clientX,i.pageY=e.clientY;$(this.editor_).trigger(i)},e.prototype.mouseUpCheck=function(t){this.isMouseDown_=!1,this.isMaybeDrag_=!1,this.isDrag_?(this.allowClick_=!1,this.allowDblClick_=!1,this.isDrag_=!1,$("body").removeClass("noSelect"),this.triggerEditorEvent("editorEndDrag",t)):(this.allowClick_=!0,this.allowDblClick_=!0)},e.prototype.onClick=function(t){t.stopPropagation(),this.clickStop_||(this.allowClick_?(this.clickStop_=!0,this.triggerEditorEvent("editorClick",t),this.clickStop_=!1):this.allowClick_=!0)},e.prototype.onDoubleClick=function(t){t.stopPropagation(),jQuery.isEmptyObject(window.getSelection)?jQuery.isEmptyObject(document.selection)||$(document.selection).empty():window.getSelection().removeAllRanges(),this.allowDblClick_?this.triggerEditorEvent("editorDblClick",t):this.allowDblClick_=!0},e.prototype.onMouseDown=function(t){t.stopPropagation(),this.isMouseDown_=!0},e.prototype.onMouseEnter=function(t){this.triggerEditorEvent("editorEnterSVG",t)},e.prototype.onMouseLeave=function(t){this.triggerEditorEvent("editorLeaveSVG",t)},e.prototype.onMouseMove=function(t){this.isMouseDown_||this.triggerEditorEvent(n.EditorEventType.MOUSE_MOVE_NO_DRAG,t)},e.prototype.onDocumentMouseMove=function(t){this.inputHelper_.position=this.inputHelper_.eventToSvgCoords(t),this.isMouseDown_?this.isMaybeDrag_?this.isDrag_?(t.stopPropagation(),this.triggerEditorEvent("editorMoveDrag",t)):(t.pageX<this.startDragX_-e.DRAGSENSITIVITYPIXELS||t.pageX>this.startDragX_+e.DRAGSENSITIVITYPIXELS||t.pageY<this.startDragY_-e.DRAGSENSITIVITYPIXELS||t.pageY>this.startDragY_+e.DRAGSENSITIVITYPIXELS)&&(this.isDrag_=!0,this.triggerEditorEvent("editorStartDrag",t,!0)):(this.isMaybeDrag_=!0,this.startDragX_=t.clientX,this.startDragY_=t.clientY,this.startTool_=this.editor_.helpers.select.selectedTool,$("body").addClass("noSelect")):(this.allowClick_=!0,this.allowDblClick_=!0)},e}(r.EditorComponent);exports.MouseHelper=s},32262:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.TouchHelper=void 0;var r=function(t){function e(e,o){var i=t.call(this,e)||this;return i.isTouch=!1,i.isTouchDown_=!1,i.isDrag_=!1,i.isMaybeDrag_=!1,i.isClick=!1,i.isMaybeMulti_=!1,i.isGesture_=!1,i.isRotate_=!1,i.isZoom_=!1,i.blockClick=!1,i.startDragX_=0,i.startDragY_=0,i.X_=0,i.Y_=0,i.X1_=0,i.Y1_=0,i.X2_=0,i.Y2_=0,i.XZ1_=0,i.YZ1_=0,i.XZ2_=0,i.YZ2_=0,i.preYDiff_=0,i.preXDiff_=0,i.fingers_=0,i.lPxDiff_=0,i.aPxDiff_=0,i.swapCounter=0,i.eventCheckX=0,i.eventCheckY=0,i.inputHelper_=o,i.editor_.container.addEventListener("touchstart",(function(t){return i.onTouchStart(t)}),!1),i.editor_.container.addEventListener("touchmove",(function(t){return i.onTouchMove(t)}),!1),i.editor_.container.addEventListener("touchend",(function(t){return i.onTouchEnd(t)}),!1),i.editor_.container.addEventListener("touchcancel",(function(t){return i.onTouchCancel(t)}),!1),i}return i(e,t),Object.defineProperty(e,"DRAGSENSITIVITYPIXELS",{get:function(){return 10},enumerable:!1,configurable:!0}),e.prototype.removeEventListeners=function(){var t=this;this.editor_.container.removeEventListener("touchstart",(function(e){return t.onTouchStart(e)}),!1),this.editor_.container.removeEventListener("touchmove",(function(e){return t.onTouchMove(e)}),!1),this.editor_.container.removeEventListener("touchend",(function(e){return t.onTouchEnd(e)}),!1),this.editor_.container.removeEventListener("touchcancel",(function(e){return t.onTouchCancel(e)}),!1)},e.prototype.triggerEditorEvent=function(t,e,o){var i=jQuery.Event(t),r=this.editor_.svg.root.element.createSVGPoint();r.x=e,r.y=o,r=r.matrixTransform(this.inputHelper_.svgTransMatrixInv),i.point=r,i.clientX=r.x,i.clientY=r.y,i.touch=!0,$(this.editor_).trigger(i)},e.prototype.touchUpCheck=function(t){var e=this;if(this.isMaybeDrag_=!1,this.isMaybeMulti_||this.isGesture_){if(this.isGesture_){var o=jQuery.Event("editorEndTouch");o.touch=!0,$(this.editor_).trigger(o)}this.isMaybeMulti_=!1,this.isGesture_=!1,this.isRotate_=!1,this.isZoom_=!1,this.blockClick=!0,setTimeout((function(){return e.blockClick=!1}),300)}else this.isDrag_?(this.isDrag_=!1,this.isClick=!1,this.triggerEditorEvent("editorEndDrag",this.X_,this.Y_)):this.blockClick||(jQuery.isEmptyObject(window.getSelection)?jQuery.isEmptyObject(document.selection)||$(document.selection).empty():window.getSelection().removeAllRanges(),this.isClick?(this.isClick=!1,this.triggerEditorEvent("editorDblClick",this.X_,this.Y_)):(this.isClick=!0,this.triggerEditorEvent("editorClick",this.X_,this.Y_),setTimeout((function(){return e.isClick=!1}),300)))},e.prototype.checkIcon=function(){var t=this.editor_.svg.root.element.createSVGPoint();t.x=this.X_,t.y=this.Y_,t=t.matrixTransform(this.inputHelper_.svgTransMatrixInv);var e=this.editor_.helpers.icon.overIcon(t);if(null!=e)switch(e.id){case"selectRotateIcon":this.editor_.helpers.select.selectedTool=window.SELECT_TOOL_ROTATE;break;case"selectNWIcon":this.editor_.helpers.select.selectedTool=window.SELECT_TOOL_NW_RESIZE;break;case"selectNEIcon":this.editor_.helpers.select.selectedTool=window.SELECT_TOOL_NE_RESIZE;break;case"selectSEIcon":this.editor_.helpers.select.selectedTool=window.SELECT_TOOL_SE_RESIZE;break;case"selectSWIcon":this.editor_.helpers.select.selectedTool=window.SELECT_TOOL_SW_RESIZE;break;case"selectNIcon":this.editor_.helpers.select.selectedTool=window.SELECT_TOOL_N_RESIZE;break;case"selectEIcon":this.editor_.helpers.select.selectedTool=window.SELECT_TOOL_E_RESIZE;break;case"selectSIcon":this.editor_.helpers.select.selectedTool=window.SELECT_TOOL_S_RESIZE;break;case"selectWIcon":this.editor_.helpers.select.selectedTool=window.SELECT_TOOL_W_RESIZE}},e.prototype.calcLengthDiff=function(t,e){var o=parseInt(t.clientX),i=parseInt(t.clientY),r=parseInt(e.clientX),n=parseInt(e.clientY),s=Math.sqrt(Math.pow(this.XZ2_-this.XZ1_,2)+Math.pow(this.YZ2_-this.YZ1_,2)),a=Math.sqrt(Math.pow(r-o,2)+Math.pow(n-i,2));return this.lPxDiff_=Math.abs(a-s),Math.round(a/s*100)/100},e.prototype.calcAngleDiff=function(t,e){var o=parseInt(t.clientX),i=parseInt(t.clientY),r=parseInt(e.clientX),n=parseInt(e.clientY),s=r-o,a=n-i,l=Math.atan2(a,s)*(180/Math.PI),d=this.X2_-this.X1_,c=this.Y2_-this.Y1_,h=Math.atan2(c,d)*(180/Math.PI),u=Math.atan2(this.preYDiff_,this.preXDiff_)*(180/Math.PI),p=Math.sqrt(Math.pow(r-o,2)+Math.pow(n-i,2))*Math.PI;return this.aPxDiff_=p*(Math.abs(l-u)/360),this.preXDiff_=r-o,this.preYDiff_=n-i,l-h},e.prototype.getGesture=function(t,e){var o=this.calcLengthDiff(t,e),i=this.calcAngleDiff(t,e);if(i>5||i<-5?(this.isGesture_=!0,this.isRotate_=!0,this.isZoom_=!1):(o>1.1||o<.9)&&(this.isGesture_=!0,this.isZoom_=!0,this.isRotate_=!1),this.isGesture_){var r=jQuery.Event("editorStartTouch"),n=this.editor_.svg.root.element.createSVGPoint();n.x=(this.X1_+this.X2_)/2,n.y=(this.Y1_+this.Y2_)/2,n=n.matrixTransform(this.inputHelper_.svgTransMatrixInv),r.point=n,r.touch=!0,$(this.editor_).trigger(r)}},e.prototype.onTouchStart=function(t){this.isTouch||(this.isTouch=!0,$(this.editor_).trigger("editorIsTouch")),this.fingers_=t.touches.length;var e=t.touches[0];this.X_=e.clientX,this.Y_=e.clientY,t.stopPropagation(),t.preventDefault(),this.checkIcon()},e.prototype.onTouchMove=function(t){if(t.stopPropagation(),t.preventDefault(),(t.touches[0].clientX!=this.eventCheckX||t.touches[0].clientY!=this.eventCheckY)&&!(t.touches[0].clientX<0||t.touches[0].clientY<0))if(this.eventCheckX=t.touches[0].clientX,this.eventCheckY=t.touches[0].clientY,1==this.fingers_){var o=t.touches[0];this.inputHelper_.position=this.inputHelper_.eventToSvgCoords(o),this.X_=o.clientX,this.Y_=o.clientY,this.isMaybeDrag_?this.isDrag_?this.triggerEditorEvent("editorMoveDrag",this.X_,this.Y_):(this.X_<this.startDragX_-e.DRAGSENSITIVITYPIXELS||this.X_>this.startDragX_+e.DRAGSENSITIVITYPIXELS||this.Y_<this.startDragY_-e.DRAGSENSITIVITYPIXELS||this.Y_>this.startDragY_+e.DRAGSENSITIVITYPIXELS)&&(this.isDrag_=!0,this.triggerEditorEvent("editorStartDrag",this.startDragX_,this.startDragY_)):(this.isMaybeDrag_=!0,this.startDragX_=this.X_,this.startDragY_=this.Y_)}else if(2==this.fingers_){var i=t.touches[0],r=t.touches[1];if(i&&r)if(this.isGesture_){var n=this.calcLengthDiff(i,r),s=this.calcAngleDiff(i,r);if(this.XZ1_=parseInt(i.clientX),this.YZ1_=parseInt(i.clientY),this.XZ2_=parseInt(r.clientX),this.YZ2_=parseInt(r.clientY),this.isRotate_&&((a=jQuery.Event("editorRotate")).angle=s,a.touch=!0,$(this.editor_).trigger(a),this.lPxDiff_>this.aPxDiff_?this.swapCounter++:this.swapCounter=0),this.isZoom_){var a,l=parseFloat(n.toString());(a=jQuery.Event("editorZoom")).zoom=l,a.touch=!0,$(this.editor_).trigger(a),this.aPxDiff_>this.lPxDiff_?this.swapCounter++:this.swapCounter=0}this.swapCounter>3&&((a=jQuery.Event("editorSwapTranform")).touch=!0,$(this.editor_).trigger(a),this.isRotate_?(this.isRotate_=!1,this.isZoom_=!0):(this.isZoom_=!1,this.isRotate_=!0,this.X1_=parseInt(i.clientX),this.Y1_=parseInt(i.clientY),this.X2_=parseInt(r.clientX),this.Y2_=parseInt(r.clientY)))}else this.isMaybeMulti_?(Math.abs(this.X1_-i.clientX)>e.DRAGSENSITIVITYPIXELS||Math.abs(this.Y1_-i.clientY)>e.DRAGSENSITIVITYPIXELS||Math.abs(this.X2_-r.clientX)>e.DRAGSENSITIVITYPIXELS||Math.abs(this.Y2_-r.clientY)>e.DRAGSENSITIVITYPIXELS)&&this.getGesture(i,r):(this.isMaybeMulti_=!0,this.X1_=parseInt(i.clientX),this.Y1_=parseInt(i.clientY),this.X2_=parseInt(r.clientX),this.Y2_=parseInt(r.clientY),this.XZ1_=parseInt(i.clientX),this.YZ1_=parseInt(i.clientY),this.XZ2_=parseInt(r.clientX),this.YZ2_=parseInt(r.clientY),this.preXDiff_=this.X2_-this.X1_,this.preYDiff_=this.Y2_-this.Y1_)}},e.prototype.onTouchEnd=function(t){this.fingers_=t.touches.length,t.stopPropagation(),t.preventDefault(),this.touchUpCheck(t)},e.prototype.onTouchCancel=function(t){this.fingers_=0,t.stopPropagation(),t.preventDefault(),this.touchUpCheck(t)},e}(e(94297).EditorComponent);exports.TouchHelper=r},56716:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.PreCheckoutModal=void 0;var r=e(400),n=e(15839),s=e(35896),a=["goToCheckout","makeNewSticker","duplicateAndEdit"],l=function(t){function e(e,o){var i=t.call(this,e)||this;if(i.handleAnimationEnd=function(){i.loadingModal?(i.$el.removeClass("loading"),setTimeout((function(){i.$el.addClass("waiting"),i.$el.addClass("loading")}),0)):(i.$el.removeClass("waiting"),i.$el.removeClass("loading"))},i.onButtonClick=function(t){return a.indexOf(t),function(e){i.$buttons.prop("disabled",!0),i.editor.trigger(s.EditorEventType.PRE_CHECKOUT_ACTION,{modal:i,action:t}),r.GTMService.preCheckoutModal(t)}},i.editor=o,i.isActive)for(var n=0,l=a;n<l.length;n++){var d=l[n];i.$button(d).on("click",i.onButtonClick(d))}return i.$el.on("animationend",i.handleAnimationEnd),i}return i(e,t),e.prototype.show=function(){this.$el.removeClass("hidden"),r.GTMService.preCheckoutModal("shown")},e.prototype.hide=function(){this.$el.addClass("hidden"),this.$buttons.removeClass("loading"),this.$buttons.removeClass("done")},e.prototype.enable=function(){this.loadingModal=!1,this.$buttons.prop("disabled",!1)},e.prototype.disable=function(){this.loadingModal=!0,this.$el.addClass("loading"),this.$buttons.prop("disabled",!0)},e.prototype.loading=function(t,e){if(void 0===e)return this.$button(t).hasClass("loading");e?this.$button(t).addClass("loading"):this.$button(t).removeClass("loading")},e.prototype.done=function(t,e){if(void 0===e)return this.$button(t).hasClass("done");e?this.$button(t).addClass("done"):this.$button(t).removeClass("done")},Object.defineProperty(e.prototype,"$buttons",{get:function(){return this.$el.find(".action-section button")},enumerable:!1,configurable:!0}),e.prototype.$button=function(t){return this.$buttons.filter('[data-action="'.concat(t,'"]'))},Object.defineProperty(e.prototype,"isActive",{get:function(){return this.editor.model.editor.preCheckoutModalActive&&!$("body").hasClass("checkout")},enumerable:!1,configurable:!0}),e}(n.ViewComponent);exports.PreCheckoutModal=l},49020:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.EditorCollection=void 0;var r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.getInstance=function(){return e._instance||(e._instance=new e),e._instance},e}(e(7353).Collection);exports.EditorCollection=r},46376:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.EditorIconCollection=void 0;var r=e(39454),n=function(t){function e(){var e=t.call(this)||this;return e.add("icon_editor_Down",new r.EditorIconVO("EditorIconsVector",100,0,0)),e.add("icon_editor_Up",new r.EditorIconVO("EditorIconsVector",100,150,0)),e.add("icon_editor_SWResize",new r.EditorIconVO("EditorIconsVector",100,300,0)),e.add("icon_editor_NEResize",new r.EditorIconVO("EditorIconsVector",100,300,0)),e.add("icon_editor_NWResize",new r.EditorIconVO("EditorIconsVector",100,450,0)),e.add("icon_editor_SEResize",new r.EditorIconVO("EditorIconsVector",100,450,0)),e.add("icon_editor_NResize",new r.EditorIconVO("EditorIconsVector",100,0,150)),e.add("icon_editor_SResize",new r.EditorIconVO("EditorIconsVector",100,0,150)),e.add("icon_editor_EResize",new r.EditorIconVO("EditorIconsVector",100,150,150)),e.add("icon_editor_WResize",new r.EditorIconVO("EditorIconsVector",100,150,150)),e.add("icon_editor_Center_ver",new r.EditorIconVO("EditorIconsVector",100,300,150)),e.add("icon_editor_Center_hor",new r.EditorIconVO("EditorIconsVector",100,450,150)),e.add("icon_editor_Ok",new r.EditorIconVO("EditorIconsVector",100,0,300)),e.add("icon_editor_Delete",new r.EditorIconVO("EditorIconsVector",100,150,300)),e.add("icon_editor_Rotate",new r.EditorIconVO("EditorIconsVector",100,300,300)),e.add("icon_editor_Edit",new r.EditorIconVO("EditorIconsVector",100,450,300)),e.add("icon_editor_Copy",new r.EditorIconVO("EditorIconsVector",100,0,450)),e.add("icon_editor_Upload",new r.EditorIconVO("EditorIconsVector",100,150,450)),e}return i(e,t),e.prototype.get=function(e){return t.prototype.get.call(this,e)},e}(e(7353).Collection);exports.EditorIconCollection=n},39454:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.EditorIconVO=void 0;var e=function(){function t(t,e,o,i){this._imageName=t,this._size=e,this._x=o,this._y=i}return Object.defineProperty(t.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._size},set:function(t){this._size=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"imageName",{get:function(){return this._imageName},set:function(t){this._imageName=t},enumerable:!1,configurable:!0}),t}();exports.EditorIconVO=e},56689:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MessageVO=void 0;exports.MessageVO=function(t,e,o,i,r,n){this.id=t,this.node=e,this.code=o,this.type=i,this.data=r,this.part=n,this.visable=!1}},58430:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TreeNodeVO=void 0;exports.TreeNodeVO=function(t,e,o,i,r){this.p1=r.element.createSVGPoint(),this.p1.x=t,this.p1.y=e,this.p2=r.element.createSVGPoint(),this.p2.x=o,this.p2.y=i,this.children=[],this.children[0]=null,this.children[1]=null,this.children[2]=null,this.children[3]=null,this.free=!0}},17106:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.FileAppService=void 0;var e=function(){function t(t){void 0===t&&(t=null),this._sharpMimeTypes=["image/jpeg","image/png","image/tiff","image/webp","image/svg+xml","image/gif","image/avif"],"undefined"==typeof ENVIRONMENT||"development"!=ENVIRONMENT&&"testing"!=ENVIRONMENT?this._fileAppDomain="fileapp.io":this._fileAppDomain="fileapp.eu",t?this._fileAppRegion=t:this.updateRegion()}return t.prototype.updateRegion=function(){var t=new XMLHttpRequest;if(t.open("GET","https://global.".concat(this._fileAppDomain,"/v1/region?time=").concat(Date.now()),!1),t.send(),200==t.status){var e=JSON.parse(t.responseText);this._fileAppRegion=e.region}},t.prototype.getSignedUrls=function(t,e){var o=this.formatFileAppSignedUrlRequestBody(t),i=new XMLHttpRequest,r="https://"+this._fileAppRegion+"."+this._fileAppDomain+"/upload-url";i.addEventListener("load",(function(){if(200===i.status){var o=JSON.parse(i.response).result,r=void 0;for(r in t)t[r].file.name===o[r].originalFileName&&t[r].file.type===o[r].fileType&&t[r].file.size===o[r].fileSize&&(o[r].fileInput=t[r].file,t[r].fileAppId=o[r].id,t[r].fileAppRegion=o[r].region,t[r].signedUrl=o[r].signedUrl);e()}else e(null)})),i.open("POST",r),i.setRequestHeader("Content-Type","application/json"),i.send(JSON.stringify({data:o}))},t.prototype.uploadOriginalFile=function(t,e,o,i){var r=new XMLHttpRequest;r.open("PUT",t.signedUrl),r.upload.id=t.fileAppId,o&&r.upload.addEventListener("progress",(function(t){return o(t,e)}),!1),r.onload=function(t){return i(t,e)},r.setRequestHeader("Content-Type",t.file.type),r.send(t.file)},t.prototype.getThumbnail=function(t,e,o,i){void 0===o&&(o="default");var r=new XMLHttpRequest,n="https://".concat(this._fileAppRegion,".").concat(this._fileAppDomain,"/thumb/").concat(t,"?size=").concat(o);r.addEventListener("load",(function(){if(200==r.status){var t=JSON.parse(r.response);i(t)}else i(null)})),r.open("GET",n),r.setRequestHeader("Content-Type","application/json"),r.send()},t.prototype.formatFileAppSignedUrlRequestBody=function(t){var e,o={files:[]};for(e in t)o.files.push({name:t[e].file.name,type:t[e].file.type,size:t[e].file.size,lastModified:t[e].file.lastModified});return o},t.prototype.getImageOutline=function(t,e){var o=new XMLHttpRequest,i={data:{json:t}};o.addEventListener("load",(function(t){return e(t)})),o.open("POST","https://".concat(this._fileAppRegion,".").concat(this._fileAppDomain,"/outline3")),o.setRequestHeader("Content-Type","application/json"),o.send(JSON.stringify(i))},t.getRegionFromSvg=function(t){var e=null,o=/fileapp_region="(.*?)"/.exec(t);return o&&o[1]&&(e=o[1]),e},t}();exports.FileAppService=e},3551:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.EditorViewComponent=void 0;var r=e(15839),n=e(7353),s=function(t){function e(e,o){var i=t.call(this,e)||this;return i._listeners=new n.Collection,i._listenersActive=!0,i._enabled=!0,i._editor=o,i}return i(e,t),e.prototype.on=function(t,e,o){var i=this,r=this.editor.registerCallback(this.$el,t,e,(function(t,e){return i._onCallback(r,t,e)}));return this._listeners.add(r,o||e),this.$el},e.prototype.registerCallback=function(t,e,o,i){var r=this,n=this.editor.registerCallback(t,e,i?o:function(t,e){return r._onCallback(n,t,e)},i?function(t,e){return r._onCallback(n,t,e)}:null);return this._listeners.add(n,i||o),n},e.prototype.setEnabled=function(t){t&&this.$el.removeClass("disabled"),this._enabled=t,this.listenersActive=t},Object.defineProperty(e.prototype,"editor",{get:function(){return this._editor},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"enabled",{get:function(){return this._enabled},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"listenersActive",{get:function(){return this._listenersActive},set:function(t){this._listenersActive=t},enumerable:!1,configurable:!0}),e.prototype._onCallback=function(t,e,o){this.listenersActive&&"off"!=this.editor.controller.status&&this._listeners.get(t)(e,o)},e}(r.ViewComponent);exports.EditorViewComponent=s},92013:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.NotificationEditorTool=void 0;var r=e(3551),n=e(35896),s=function(t){function e(e,o){var i=t.call(this,e,o)||this;return i.registerCallback(o.$el,n.EditorEventType.ADD_NOTIFICATION,(function(t,e){return i.add(e.category,e.type,e.id,e.data)})),i.registerCallback(o.$el,n.EditorEventType.REMOVE_NOTIFICATION,(function(t,e){return i.remove(e)})),i}return i(e,t),e.prototype.clear=function(){this.$el.html("")},e.prototype.add=function(t,o,i,r){switch(t){case e.CATEGORY_DPI:this.clear(),1==o?this.$el.append('<div class="alert alert-danger" id="'+this.formatNotificationID(i)+'"><i class="glyphicon glyphicon-exclamation-sign"></i> '+this.editor.model.language.dpi_bad+"</div>"):2==o&&this.$el.append('<div class="alert alert-warning" id="'+this.formatNotificationID(i)+'"><i class="glyphicon glyphicon-info-sign"></i> '+this.editor.model.language.dpi_ok+"</div>");break;case 3:$("#overlay").hide(),this.editor.ui.toolPane.cutlineTool.showStickerEmptyAlert();break;case 4:case 5:break;case 6:case 7:this.$el.html('<div class="alert alert-danger alert-dismissable" id="'+this.formatNotificationID(i)+'"><button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button><i class="glyphicon glyphicon-exclamation-sign"></i> '+this.editor.model.language.too_many_images+"</div>");break;case e.CATEGORY_UPLOAD:if("error"==o){this.$(".alert-upload-error").remove();var n=$('<div class="alert alert-danger alert-upload-error">'+r+"</div>");this.$el.prepend(n),n.delay(8e3).fadeOut("fast")}}},e.prototype.remove=function(t){this.$("#"+this.formatNotificationID(t)).remove()},e.prototype.formatNotificationID=function(t){return this.notificationBaseID+"-"+t},e.prototype.isEmpty=function(){return 0==this.$el.children().length},Object.defineProperty(e.prototype,"notificationBaseID",{get:function(){return this.editor.id+"-notification"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"CATEGORY_DPI",{get:function(){return 1},enumerable:!1,configurable:!0}),Object.defineProperty(e,"CATEGORY_UPLOAD",{get:function(){return"upload"},enumerable:!1,configurable:!0}),e}(r.EditorViewComponent);exports.NotificationEditorTool=s},50849:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.RemoveBackPrintEditorTool=void 0;var r=e(3551),n=e(65642),s=e(35896),a=function(t){function e(e,o){var i=t.call(this,e,o)||this;return i.on("click","button",(function(t){return i.onRemove(t)})),i}return i(e,t),e.prototype.onRemove=function(t){var e=this;t.preventDefault(),this.isDisabled()?n.ConfirmModal.instance.confirmWithTitle(this.editor.model.language.nothing_to_remove_backprint_text,this.editor.model.language.nothing_to_remove,(function(){e.editor.isLandscapeOrientation()&&e.editor.ui.uploadTool.show()})):n.ConfirmModal.instance.confirmOrCancelWithTitle(this.editor.model.language.are_you_sure_you_want_to_continue,this.editor.model.language.remove_paper_back_print,(function(){e.editor.svg.sheet.sheet_meta.BACKPRINT_MODIFIED=!1,e.editor.api.ClearActivePart(),e.editor.isLandscapeOrientation()&&e.editor.ui.uploadTool.show(),e.setDisabled(!0),e.editor.trigger(s.EditorEventType.REQUEST_UPDATE),e.editor.trigger(s.EditorEventType.BACKSIDEPRINT_UPDATED)}))},e.prototype.setEnabled=function(e){t.prototype.setEnabled.call(this,e),e?this.$el.removeClass("hidden"):this.$el.addClass("hidden")},e.prototype.setDisabled=function(t){t?this.$el.addClass("disabled"):this.$el.removeClass("disabled")},e.prototype.isDisabled=function(){return this.$el.hasClass("disabled")},e}(r.EditorViewComponent);exports.RemoveBackPrintEditorTool=a},89023:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.TemplatePartEditorTool=void 0;var r=e(3551),n=e(35896),s=function(t){function e(e,o){var i=t.call(this,e,o)||this;return i.on("click","a",(function(t){return i.onSelectPart(t)})),i}return i(e,t),e.prototype.render=function(){this.enabled?(this.$el.removeClass("hidden"),this.editor.$el.addClass("has-parts-selector"),this.editor.$el.removeClass("has-no-parts-selector"),this.$("a").removeClass("active"),this.$("a[data-id="+this.editor.api.GetActivePartId()+"]").addClass("active")):(this.editor.$el.addClass("has-no-parts-selector"),this.editor.$el.removeClass("has-parts-selector"),this.$el.addClass("hidden"))},e.prototype.setEnabled=function(e){t.prototype.setEnabled.call(this,e),this.render()},e.prototype.onSelectPart=function(t){t.preventDefault();var e=$(t.currentTarget).data("id");e!=this.editor.api.GetActivePartId()&&(this.editor.api.ChangeActivePart(e),this.$("a").removeClass("active"),this.$("a[data-id="+e+"]").addClass("active"),this.editor.trigger(n.EditorEventType.SET_ACTIVE_PART,e),this.editor.trigger(jQuery.Event(n.EditorEventType.PREVIEW_ON)))},e}(r.EditorViewComponent);exports.TemplatePartEditorTool=s},38218:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.BackPrintDealTextTool=void 0;var r=e(389),n=e(35896),s=function(t){function e(e,o){var i=t.call(this,e,o)||this;return i.dealText=!1,i._name="text_deal",i.align="center",i.fontName="Bree Serif",i.color="#ffdb00",i.locked=!0,i}return i(e,t),e.prototype.registerCallBacks=function(){var e=this;t.prototype.registerCallBacks.call(this),this.registerCallback(this.$content,"click","textarea",(function(t){e.selectDealText()})),this.registerCallback(this.editor.$el,n.EditorEventType.DESELECT_NODE,(function(t){e.editor.svg.activePart.partGroupNode.children.length<1&&(e.dealText=!1,e.text="")}))},e.prototype.render=function(){this.enabled?this.$el.removeClass("hidden"):(this.$el.addClass("hidden"),this.hide())},e.prototype.reset=function(){},e.prototype.hide=function(){t.prototype.hide.call(this)},e.prototype.show=function(){t.prototype.show.call(this)},e.prototype.setEnabled=function(e){t.prototype.setEnabled.call(this,e)},e.prototype.setTextByJSON=function(e){t.prototype.setTextByJSON.call(this,e)},e.prototype.onOpenTool=function(e){t.prototype.onOpenTool.call(this,e)},e.prototype.onTransitionInDone=function(){t.prototype.onTransitionInDone.call(this)},e.prototype.onInputText=function(e){this.editor.svg.selected&&this.editor.svg.selected.type===SVG.SHAPE_TEXT||this.selectDealText(),-1==this.text.indexOf("@")&&(this.text="@"+this.text),"@"!==this.text[0]&&(this.text=this.text.substr(this.text.indexOf("@"))+this.text.substr(0,this.text.indexOf("@"))),t.prototype.onInputText.call(this,e)},e.prototype.onChangeTextColor=function(t,e){void 0===e&&(e=!0)},e.prototype.onRGBTextInputTypeChange=function(){t.prototype.onRGBTextInputTypeChange.call(this)},e.prototype.onSelectFont=function(t){},e.prototype.onClickAlignment=function(t){},e.prototype.onClick=function(e){return t.prototype.onClick.call(this,e)},e.prototype.selectDealText=function(){this.dealText&&this.editor.svg.activePart.partGroupNode.children.length<1&&(this.dealText=!1),!this.dealText&&this.editor.svg.activePart.partGroupNode.children.length>0&&(this.dealText=this.editor.svg.activePart.partGroupNode.children[0]),this.dealText&&this.editor.helpers.select.select(this.dealText)},e}(r.TextEditorTool);exports.BackPrintDealTextTool=s},26519:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.BackPrintDealTool=void 0;var r=e(3551),n=e(35896),s=function(t){function e(e,o){var i=t.call(this,e,o)||this;return i.on("change","#backside-print-deal-checkbox",(function(t){return i.toggleDeal(t)})),i}return i(e,t),e.prototype.setEnabled=function(e){t.prototype.setEnabled.call(this,e),e?this.$el.removeClass("hidden"):this.$el.addClass("hidden")},e.prototype.toggleDeal=function(t){$("#backside-print-deal-checkbox").prop("checked")?(this.editor.api.ChangeActivePart(this.editor.api.GetBackDealPart().id),this.editor.svg.sheet.sheet_meta.BACKPRINT_DEAL_ENABLED=!0,this.$el.addClass("checked")):(this.editor.api.ChangeActivePart(this.editor.api.GetBackPart().id),this.editor.svg.sheet.sheet_meta.BACKPRINT_DEAL_ENABLED=!1,this.$el.removeClass("checked")),this.editor.trigger(n.EditorEventType.REQUEST_UPDATE),this.editor.trigger(n.EditorEventType.SET_ACTIVE_PART,this.editor.svg.activePart.side)},e}(r.EditorViewComponent);exports.BackPrintDealTool=s},70207:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.BackPrintEditorTool=void 0;var r=e(35896),n=e(3551),s=e(28977),a=e(65642),l=function(t){function e(e,o){var i=t.call(this,e,o)||this;return i.on("click","button",(function(t){t.preventDefault(),i.onSelectPart(t)})),i.on("click",e,(function(t){t.preventDefault(),i.editor.api.DeSelect()})),i}return i(e,t),e.prototype.setEnabled=function(e,o,i){void 0===o&&(o=""),void 0===i&&(i="");var r=this.enabled;e&&!r?(this.alternateTempToMeta(),this.editor.ui.update(!1)):!e&&r&&(this.alternateMetaToTemp(),((0,s.getBoolean)(this.tempBackprintDealEnabled)||(0,s.getBoolean)(this.tempBackprintModified))&&o&&i&&a.ConfirmModal.instance.confirmWithTitle(o,i),this.editor.ui.update(!1)),e?this.$el.removeClass("hidden"):this.$el.addClass("hidden"),t.prototype.setEnabled.call(this,e),(e&&!r||!e&&r)&&this.editor.ui.setSizeAndOrientation()},e.prototype.onSelectPart=function(t){if(t.preventDefault(),t.stopPropagation(),!$(t.currentTarget).hasClass("disabled")){var e=$(t.currentTarget).data("id");switch($(".tool-backside-print .btn").removeClass("active"),$(t.currentTarget).addClass("active"),this.editor.api.DeSelect(),e){case"back":if("back"!==this.editor.api.GetActivePartSide()&&"back_deal"!==this.editor.api.GetActivePartSide()){var o=this.editor.api.GetBackPart();$(".editor-header .modal-title").html(this.editor.model.language.paper_backprint),(0,s.getBoolean)(this.editor.svg.sheet.sheet_meta.BACKPRINT_DEAL_ENABLED)?($("#backside-print-deal-checkbox").prop("checked",!0),this.editor.ui.toolPane.backPrintDealTool.$el.addClass("checked"),this.editor.api.ChangeActivePart(this.editor.api.GetBackDealPart().id),this.editor.trigger(r.EditorEventType.SET_ACTIVE_PART,this.editor.api.GetBackDealPart().side)):(this.editor.ui.toolPane.backPrintDealTool.$el.removeClass("checked"),this.editor.api.ChangeActivePart(o.id),this.editor.trigger(r.EditorEventType.SET_ACTIVE_PART,o.side)),$("#confirm-modal-backside-print").length&&this.initBackprintInfoModal()}break;case"front":if("front"!==this.editor.api.GetActivePartSide()){var i=this.editor.api.GetFrontPart();$(".editor-header .modal-title").html(this.editor.model.editor.title),this.editor.api.ChangeActivePart(i.id),this.editor.trigger(r.EditorEventType.SET_ACTIVE_PART,i.side)}}}},e.prototype.setDisabled=function(e,o,i){void 0===o&&(o=""),void 0===i&&(i=""),e&&!this.isDisabled()?(this.alternateMetaToTemp(),this.$el.find("button").addClass("disabled"),((0,s.getBoolean)(this.tempBackprintDealEnabled)||(0,s.getBoolean)(this.tempBackprintModified))&&o&&i&&(a.ConfirmModal.instance.confirmWithTitle(o,i),this.editor.ui.update(!1))):!e&&this.isDisabled()&&(this.alternateTempToMeta(),this.editor.ui.update(!1),this.$el.find("button").removeClass("disabled")),t.prototype.setEnabled.call(this,!e)},e.prototype.isDisabled=function(){return this.$el.find("button").hasClass("disabled")},e.prototype.alternateMetaToTemp=function(){this.tempBackprintModified=this.editor.model.sheet.meta.BACKPRINT_MODIFIED,this.tempBackprintDealEnabled=this.editor.model.sheet.meta.BACKPRINT_DEAL_ENABLED,this.editor.model.sheet.meta.BACKPRINT_MODIFIED=!1,this.editor.model.sheet.meta.BACKPRINT_DEAL_ENABLED=!1},e.prototype.alternateTempToMeta=function(){this.editor.model.sheet.meta.BACKPRINT_MODIFIED=this.tempBackprintModified,this.editor.model.sheet.meta.BACKPRINT_DEAL_ENABLED=this.tempBackprintDealEnabled},e.prototype.initBackprintInfoModal=function(){var t=$("#confirm-modal-backside-print"),e=$("#confirm-modal-backside-print .btn-confirm");t.hasClass("showed")||(e.on("click",(function(){$("#show_again_paperback_info").is(":checked")&&(document.cookie="hideBackPrintInfo=1; path=/; domain=."+window.location.hostname.split(".").slice("uk"===LANG?-3:-2).join(".")),t.remove()})),t.addClass("in"),t.addClass("showed"))},e.prototype.disableButtons=function(){this.listenersActive=!1,this.$el.find("button").addClass("disabled")},e.prototype.enableButtons=function(){this.listenersActive=!0,this.$el.find("button").removeClass("disabled")},e}(n.EditorViewComponent);exports.BackPrintEditorTool=l},37700:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.BackgroundEditorTool=void 0;var r=e(92324),n=e(15046),s=e(24098),a=e(35896),l=e(28977),d=function(t){function e(o,i){var r=t.call(this,o,i,"background")||this;return r._mouseDown=!1,r._canvasID="background-canvas-"+r.editor.id,r.$body.find(".canvas-background").attr("id",r._canvasID),r._canvas=document.getElementById(r._canvasID),r.$colorpicker.spectrum({color:e.DEFAULT_BACKGROUND,flat:!0,showButtons:!1,move:function(t){return r.onColorsChange(t.toHexString())}}),r.on(a.EditorEventType.OPEN_TOOL,(function(t){return r.onOpenTool(t)})),r.on(a.EditorEventType.CLOSE_TOOL,(function(t){return r.onMouseLeave(t)})),r.registerCallback(i.$el,a.EditorEventType.SET_ACTIVE_PART,(function(t,e){return r.onSetActivePart(t,e)})),r.registerCallback(i.$el,a.EditorEventType.SVG_CHANGE_MODE,(function(t,e){return r.onSVGChangeMode(t,e)})),r.registerCallback(r.$content,"click",".btn-cmyk_rgb_warning",(function(t){return r.onClickCMYKRGBWarning(t)})),r.registerCallback(r.$content,"click","[name=cmyk_rgb]",(function(t){return r.onCMYKClick(t)})),r.registerCallback(r.$content,"mousemove","#"+r._canvasID,(function(t){return r.onMouseMoveCanvas(t)})),r.registerCallback(r.$content,"mousedown","#"+r._canvasID,(function(t){return r.onMouseDownCanvas(t)})),r.registerCallback(r.$content,"change","[name=rgb_input_type]",(function(){return r.onRGBInputTypeChange()})),r.registerCallback(r.$content,"click",".backgroundSwatch",(function(t){return r.onClickBackgroundSwatch(t)})),r.registerCallback(r.$content,"change","[name=rgb_input_red], [name=rgb_input_blue], [name=rgb_input_green]",(function(){return r.onRGBChange()})),r.registerCallback(r.$content,"click","[name=cmyk_input_set]",(function(){return r.setCmyk()})),r.on("mouseover",(function(t){return r.onMouseOver(t)})),r.on("mouseleave",(function(t){return r.onMouseLeave(t)})),r.on("mousedown",(function(t){return r.onMouseDown(t)})),r.listenersActive=!1,r}return i(e,t),e.prototype.render=function(){this.enabled?(this.$el.removeClass("hidden"),this.$el.removeClass("disabled")):(this.$el.addClass("hidden"),this.visible=!1)},e.prototype.renderHEX=function(t){"dec"==this.$content.find("[name=rgb_input_type]").val()&&(this.$content.find("[name=rgb_input_red]").val(parseInt(t.replace("#","").substring(0,2),16)),this.$content.find("[name=rgb_input_green]").val(parseInt(t.replace("#","").substring(2,4),16)),this.$content.find("[name=rgb_input_blue]").val(parseInt(t.replace("#","").substring(4,6),16))),"hex"==this.$content.find("[name=rgb_input_type]").val()&&(this.$content.find("[name=rgb_input_red]").val(t.replace("#","").substring(0,2).toUpperCase()),this.$content.find("[name=rgb_input_green]").val(t.replace("#","").substring(2,4).toUpperCase()),this.$content.find("[name=rgb_input_blue]").val(t.replace("#","").substring(4,6).toUpperCase())),this.visible&&this.$(".color-preview").css("fill",t)},e.prototype.setEnabled=function(o){if(t.prototype.setEnabled.call(this,o),this.render(),o){var i=this.editor.api.GetBackground();"none"!=i&&i?s.ColorUtil.isHexColor(i)&&(this.background=i,this.lastMinicolor=i):this.lastMinicolor&&s.ColorUtil.isHexColor(this.lastMinicolor)?(this.editor.api.ChangeBackground('{"color":"'+this.lastMinicolor+'", "sync":false}'),this.background=this.lastMinicolor):(this.editor.api.ChangeBackground('{"color":"'+e.DEFAULT_BACKGROUND+'", "sync":false}'),this.background=e.DEFAULT_BACKGROUND)}},e.prototype.setColorPickerCanvas=function(){if(null!=this.canvas){var t=this.canvas.getContext("2d");t.clearRect(0,0,this.canvas.width,this.canvas.height);var e=new Image;e.onload=function(){var o=Math.round((190-e.width)/2),i=Math.round((190-e.height)/2);isNaN(o)&&(o=0),isNaN(i)&&(i=0),t.drawImage(e,o,i)};var o=this.getSvgForCanvas();$.ajax({method:"POST",url:n.BackendServiceUtil.getURL(n.BackendServiceUtil.METHOD_URI_THUMB),data:{width:"190",height:"190",json:!0,svg:o},error:function(t){}}).done((function(t){var o=JSON.parse(t);e.src=o.image}))}},e.prototype.getSvgForCanvas=function(){for(var t=this.editor.api.Export(),e=0,o=0;o<t.parts.length;o++)t.parts[o].part_id==this.editor.svg.activePart.id&&(e=o);var i=t.parts[e].matrix,r=t.parts[e]._originalPathBoundingBox,n=r.x+" "+r.y+" "+r.width+" "+r.height;t.parts[e].cuttingline,t.parts[e].background,t.parts[e].cuttingline,t=t.parts[e].svg;var s="<svg ";return $("#"+this.editor.svgRootID).each((function(){$.each(this.attributes,(function(t,e){var o=e.name,i=e.value;"width"==o&&(i="190px"),"height"==o&&(i="190px"),"viewBox"==o&&(i=n),s+=o+'="'+i+'" '}))})),(s+=">")+'<g transform="'+i+'" >'+t+"</g></svg>"},e.prototype.setCmyk=function(t,e,o,i){if(void 0===t&&(t=this.$content.find("[name=cmyk_input_cyan]").val()),void 0===e&&(e=this.$content.find("[name=cmyk_input_magenta]").val()),void 0===o&&(o=this.$content.find("[name=cmyk_input_yellow]").val()),void 0===i&&(i=this.$content.find("[name=cmyk_input_black]").val()),t=parseInt(t),e=parseInt(e),o=parseInt(o),i=parseInt(i),isNaN(t)||isNaN(e)||isNaN(o)||isNaN(i))return this.$content.find("[name=cmyk_input_cyan]").val(""),this.$content.find("[name=cmyk_input_magenta]").val(""),this.$content.find("[name=cmyk_input_yellow]").val(""),void this.$content.find("[name=cmyk_input_black]").val("");t<0&&(t=0),e<0&&(e=0),o<0&&(o=0),i<0&&(i=0),t>100&&(t=100),e>100&&(e=100),o>100&&(o=100),i>100&&(i=100),this.$content.find("[name=cmyk_input_cyan]").val(t),this.$content.find("[name=cmyk_input_magenta]").val(e),this.$content.find("[name=cmyk_input_yellow]").val(o),this.$content.find("[name=cmyk_input_black]").val(i),this.editor.api.SetCMYKBackgound(t+" "+e+" "+o+" "+i);var r=this;$.get(n.BackendServiceUtil.getURL("color?c="+t+"&m="+e+"&y="+o+"&k="+i),(function(t){r.editor.api.ChangeBackground('{"color":"'+t+'", "sync":'+$("#syncBackground").hasClass("active")+"}"),r.editor.$(".bg-preview").css("background",t)}))},Object.defineProperty(e.prototype,"background",{get:function(){return this.$colorpicker.spectrum("get").toHexString()},set:function(t){this.$colorpicker.spectrum("set",t),this.visible&&this.$(".color-preview").css("fill",t)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"DEFAULT_BACKGROUND",{get:function(){return"#FFFFFF"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastMinicolor",{get:function(){return this._lastMinicolor},set:function(t){this._lastMinicolor=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canvas",{get:function(){return this._canvas},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$colorpicker",{get:function(){return this.$body.find("input.colorpicker")},enumerable:!1,configurable:!0}),e.prototype.onSetActivePart=function(t,e){this.background=this.editor.api.GetBackground()},e.prototype.onSVGChangeMode=function(t,e){e.change&&"part"==e.zoomMode?this.background=this.editor.api.GetBackground():e.change&&"sheet"==e.zoomMode&&(this.visible=!1)},e.prototype.onColorsChange=function(t){this.listenersActive&&("back"!=this.editor.api.GetActivePartSide()||(0,l.getBoolean)(this.editor.svg.sheet.sheet_meta.BACKPRINT_MODIFIED)||this.editor.trigger(a.EditorEventType.BACKSIDEPRINT_MODIFIED),this.editor.trigger(a.EditorEventType.PART_EDITED,{edited:"background"}),this._lastMinicolor=t,this.editor.api.ChangeBackground('{"color":"'+t+'", "sync":'+$("#syncBackground").hasClass("active")+"}"),this.editor.$(".bg-preview").css("background",t),this.renderHEX(t))},e.prototype.onRGBInputTypeChange=function(){this.renderHEX(this.editor.api.GetBackground())},e.prototype.onRGBChange=function(){var t="#";if("dec"==this.$content.find("[name=rgb_input_type]").val()){if(isNaN(this.$content.find("[name=rgb_input_red]").val())||isNaN(this.$content.find("[name=rgb_input_green]").val())||isNaN(this.$content.find("[name=rgb_input_blue]").val())){var e=this.editor.api.GetBackground();return this.$content.find("[name=rgb_input_red]").val(parseInt(e.replace("#","").substring(0,2),16)),this.$content.find("[name=rgb_input_green]").val(parseInt(e.replace("#","").substring(2,4),16)),void this.$content.find("[name=rgb_input_blue]").val(parseInt(e.replace("#","").substring(4,6),16))}(o=parseInt(this.$content.find("[name=rgb_input_red]").val()))<0&&(o=0),(i=parseInt(this.$content.find("[name=rgb_input_green]").val()))<0&&(i=0),(r=parseInt(this.$content.find("[name=rgb_input_blue]").val()))<0&&(r=0),o>255&&(o=255),i>255&&(i=255),r>255&&(r=255),$("[name=rgb_input_red]").val(o),$("[name=rgb_input_green]").val(i),$("[name=rgb_input_blue]").val(r),t+=s.ColorUtil.paddy(o.toString(16),2),t+=s.ColorUtil.paddy(i.toString(16),2),t+=s.ColorUtil.paddy(r.toString(16),2)}if("hex"==$("[name=rgb_input_type]").val()){var o=this.$content.find("[name=rgb_input_red]").val(),i=this.$content.find("[name=rgb_input_green]").val(),r=this.$content.find("[name=rgb_input_blue]").val();if(!s.ColorUtil.checkHex(o)||!s.ColorUtil.checkHex(i)||!s.ColorUtil.checkHex(r)){var n=this.editor.api.GetBackground();return $("[name=rgb_input_red]").val(n.replace("#","").substring(0,2).toUpperCase()),$("[name=rgb_input_green]").val(n.replace("#","").substring(2,4).toUpperCase()),void $("[name=rgb_input_blue]").val(n.replace("#","").substring(4,6).toUpperCase())}t+=s.ColorUtil.paddy(o,2),t+=s.ColorUtil.paddy(i,2),t+=s.ColorUtil.paddy(r,2)}this.background=t,this.onColorsChange(t)},e.prototype.onCMYKClick=function(t){var e=this,o=this.$content.find(".rgb_cmyk_class").length,i=0;this.$content.find(".rgb_cmyk_class").toggle("fast",(function(){if(++i==o)if(e.$content.find(".cmyk_div").is(":visible")){var t=e.editor.api.GetBackground(),r=s.ColorUtil.hexToRgb(t);$.get(n.BackendServiceUtil.getURL("color?r="+r.r+"&g="+r.g+"&b="+r.b),(function(t){var o=t.split(" ");e.setCmyk(o[0],o[1],o[2],o[3])})),e.$content.find("[name=cmyk_rgb]").html("Switch to RGB")}else e.editor.api.SetCMYKBackgound(null),e.background=e.editor.api.GetBackground(),e.$content.find("[name=cmyk_rgb]").html("Switch to CMYK")}))},e.prototype.onClickCMYKRGBWarning=function(t){var e=this,o=this.canvas.getContext("2d"),i="#",r=this.canvas.getBoundingClientRect(),n=t.clientX-r.left,a=t.clientY-r.top,l=o.getImageData(n,a,1,1).data,d=l[3]/255,c=255+(l[0]-255)*d,h=255+(l[1]-255)*d,u=255+(l[2]-255)*d;i+=s.ColorUtil.paddy(c.toString(16),2),i+=s.ColorUtil.paddy(h.toString(16),2),i+=s.ColorUtil.paddy(u.toString(16),2),this.background=i,this.$content.find(".btn-cmyk_rgb_warning").hide(),this.$content.find(".rgb_cmyk_class").toggle("fast",(function(){e.editor.api.SetCMYKBackgound(null),e.background=e.editor.api.GetBackground()}))},e.prototype.onMouseMoveCanvas=function(t){var e=this.canvas.getContext("2d"),o="#",i=this.canvas.getBoundingClientRect(),r=t.clientX-i.left,n=t.clientY-i.top,a=e.getImageData(r,n,1,1).data,l=a[3]/255,d=255+(a[0]-255)*l,c=255+(a[1]-255)*l,h=255+(a[2]-255)*l;o+=s.ColorUtil.paddy(d.toString(16),2),o+=s.ColorUtil.paddy(c.toString(16),2),o+=s.ColorUtil.paddy(h.toString(16),2),this.$body.find(".background-canvas-swatch").css("background-color",o)},e.prototype.onMouseDownCanvas=function(t){var e=s.ColorUtil.rgb2hex(this.$body.find(".background-canvas-swatch").css("background-color"));this.background=e,this.onColorsChange(e)},e.prototype.onClickBackgroundSwatch=function(t){var e=s.ColorUtil.rgb2hex($(t.currentTarget).css("backgroundColor"));this.background=e,this.onColorsChange(e)},e.prototype.onOpenTool=function(t){if(this.visible){if(null!=this.editor.api.GetCmykBackground()){this.$body.find(".cmyk_div").is(":visible")||(this.$body.find("[name=cmyk_rgb]").html("Switch to RGB"),this.$body.find(".rgb_cmyk_class").toggle(0)),this.$body.find(".btn-cmyk_rgb_warning").show();var e=this.editor.api.GetCmykBackground().split(" ");this.setCmyk(e[0],e[1],e[2],e[3])}else this.background=this.editor.api.GetBackground(),this.setColorPickerCanvas();this.$colorpicker.spectrum("reflow")}},e.prototype.onClick=function(e){t.prototype.onClick.call(this,e),this._mouseDown=!1},e.prototype.onMouseOver=function(t){},e.prototype.onMouseLeave=function(t){this.visible||this.$(".color-preview").css("fill","#5d5f62")},e.prototype.onMouseDown=function(t){this._mouseDown=!0},e.prototype.disable=function(){t.prototype.setEnabled.call(this,!1),this.$el.addClass("disabled"),this.$el.removeClass("hidden")},e}(r.EditorTool);exports.BackgroundEditorTool=d},4475:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.ClipartsEditorTool=void 0;var r=e(3076),n=e(28977),s=e(35896),a=function(t){function e(e,o){return t.call(this,e,o,"/editor/get_cliparts","/editor/get_clipart","cliparts")||this}return i(e,t),e.prototype.onAddedToEditor=function(e){this.editor.api.GetActivePartId()!=this.editor.api.GetBackPart().id||(0,n.getBoolean)(this.editor.svg.sheet.sheet_meta.BACKPRINT_MODIFIED)||this.editor.trigger(s.EditorEventType.BACKSIDEPRINT_MODIFIED),this.editor.trigger(s.EditorEventType.PART_EDITED,{edited:"clipart"}),this.editor.svg.fit(e,.7,!0,!1,!0),this.editor.svg.center(e,null,null,!0),t.prototype.onAddedToEditor.call(this,e)},e.prototype.setEnabled=function(e){t.prototype.setEnabled.call(this,e),this.render()},e.prototype.disable=function(){t.prototype.setEnabled.call(this,!1),this.$el.addClass("disabled")},e.prototype.render=function(){this.enabled?(this.$el.removeClass("hidden"),this.$el.removeClass("disabled")):(this.$el.addClass("hidden"),this.visible=!1)},e}(r.ProductsEditorTool);exports.ClipartsEditorTool=a},86923:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.CollageEditorTool=void 0;var r=e(92324),n=e(35896),s=function(t){function e(e,o){var i=t.call(this,e,o,"collage")||this;return i.registerCallback(o.$el,n.EditorEventType.SET_ACTIVE_PART,(function(t,e){return i.onSetActivePart(t,e)})),i.registerCallback(i.$body,"click",".collage-thumb",(function(t){return i.onClickCollageThumb(t)})),i}return i(e,t),e.prototype.render=function(){if(this.$body.html(""),this.enabled){if(this.$el.removeClass("hidden"),this.editor.model.editor.collages.length){this.$body.append('<div class="f-col-4 cta collage-thumb text-center" data-id="0"><label>'+this.editor.model.language.no_collage+"</label></div>");for(var t=0;t<this.editor.model.editor.collages.length;t++){var e=this.editor.model.editor.collages[t];this.$body.append('<div class="f-col-4 cta collage-thumb" data-id="'+e.id+'">'+e.preview+"</div>")}}}else this.$el.addClass("hidden"),this.hide()},e.prototype.show=function(){this.$el.hasClass("disabled")||(this.visible=!0)},e.prototype.hide=function(){this.visible=!1},e.prototype.setEnabled=function(e){t.prototype.setEnabled.call(this,e),this.render()},e.prototype.onSetActivePart=function(t,e){"back"==e?this.$el.removeClass("disabled"):(this.hide(),this.$el.addClass("disabled"))},e.prototype.onClickCollageThumb=function(t){t.preventDefault(),$("#overlay").show(),this.hide(),this.editor.api.ChangeCollage($(t.currentTarget).data("id")),this.editor.trigger(jQuery.Event(n.EditorEventType.PREVIEW_OFF)),$("#overlay").hide()},e}(r.EditorTool);exports.CollageEditorTool=s},30164:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.CutlineEditorTool=void 0;var r=e(92324),n=e(44985),s=e(35896),a=function(t){function e(e,o){var i=t.call(this,e,o,"cutline")||this;return i._tooltipActive=!1,i.on(s.EditorEventType.OPEN_TOOL,(function(t){return i.onShow(t)})),i.on("hidden.bs.tooltip",(function(t){return i.onHiddenToolTip(t)})),i.registerCallback(i.$content,"click",".btn-path-new-s",(function(t){return i.onClickBtnPathNewS(t)})),i.registerCallback(i.$content,"click",".btn-path-new-m",(function(t){return i.onClickBtnPathNewM(t)})),i.registerCallback(i.$content,"click",".btn-path-new-l",(function(t){return i.onClickBtnPathNewL(t)})),i.registerCallback(i.$content,"click",".cutline .cta, .shapes .cta, #old-outline, #new-outline, .btn-extra-new-outline",(function(t){return i.onClickOutline(t)})),i.registerCallback(i.editor.$el,s.EditorEventType.UPLOAD_END,(function(t){return i.processQueue()})),i.registerCallback(i.editor.$el,s.EditorEventType.UPLOAD_CANCEL,(function(t){return i.processQueue()})),i.registerCallback(i.$content,"click",".btn-get-cutline",(function(t){return i.onClickBtnGetCutline(t)})),i}return i(e,t),e.prototype.render=function(){if(this.enabled){if(this.$el.removeClass("hidden"),this.$el.data("has-tooltip")){var t=this.$el;this.$el.each((function(){$(this).is(":visible")&&(t=$(this))})),t.tooltip({placement:this.editor.orientation==n.Editor.ORIENTATION_PORTRAIT?"auto top":"auto left",container:"#"+this.editor.id,trigger:"manual"}).tooltip("show"),this._tooltipActive=!0}}else this.$el.addClass("hidden"),this.$el.tooltip("destroy"),this.visible=!1,this._tooltipActive=!1},e.prototype.show=function(){this.visible=!0},e.prototype.showStickerEmptyAlert=function(){this.$content.find(".alert").stop(!0,!0).slideDown("fast")},e.prototype.hide=function(){this.visible=!1},e.prototype.setEnabled=function(e){t.prototype.setEnabled.call(this,e),this.render()},e.prototype.processQueue=function(){var t=this;this._queued&&(this.editor.api.ChangePart(this._queued,(function(){return t.onChangePartCallback()})),this._queued=null)},e.prototype.onShow=function(t){this.$el.tooltip("hide"),this.$content.find(".alert").hide()},e.prototype.onHiddenToolTip=function(t){t.stopPropagation(),this._tooltipActive&&(this.$el.tooltip("destroy"),this._tooltipActive=!1)},e.prototype.onBtnUploadCutline=function(t){this.$content.find("[name=cutline]").trigger("click")},e.prototype.onClickBtnGetCutline=function(t){for(var e=document.createElement("a"),o=this.editor.api.Export(),i=o.parts,r=5.6693,n=2.83465*o.sheet.height+r+r,s='<svg viewbox="-5.6693 -5.6693 '+(2.83465*o.sheet.width+r+r)+" "+n+'" xmlns="http://www.w3.org/2000/svg" version="1.1">',a=0;a<i.length;a++)s+='<path d="'+i[a].cuttingline+'" fill="none" stroke="black" stroke-width="1" vector-effect="non-scaling-stroke" transform="'+i[a].matrix+'"/>';s+="</svg >",e.setAttribute("href","data:text/svg;charset=utf-8,"+encodeURIComponent(s)),e.setAttribute("download","cutline_sheet_"+this.editor.model.sheet.sheet_id+".svg"),e.style.display="none",document.body.appendChild(e),e.click(),document.body.removeChild(e)},e.prototype.onClickBtnGetImage=function(t){this.$content.find("[name=action]").val("get_image"),this.$content.find("[name=json]").val(JSON.stringify(this.editor.api.Export())),this.$content.find("[name=shapes-admin-form]").trigger("submit")},e.prototype.onUploadCutlineFile=function(t){var e=this,o=new FormData(this.$content.find("form[name=upload-cutline]")[0]);$.ajax({url:"/editor/upload_cutline",type:"POST",success:function(t){e.editor.api.ChangePart({part_type:"path-included",path:t}),e.$content.find("[name=cutline]").parent("form").trigger("reset")},error:function(t){},data:o,cache:!1,contentType:!1,processData:!1})},e.prototype.onClickOutline=function(t){var e=this;t.preventDefault(),this.$content.find(".alert").hide();var o={corner_radius:"0",part_type:$(t.currentTarget).data("type")};switch(o.part_type){case"path":case"path-org":case"path-s":case"path-m":case"path-l":case"path-x":case"path-new-x":if($("#overlay").show(),this.editor.ui.uploadTool.isUploading)return void(this._queued=o);break;case"rounded":o.part_type="rect",o.corner_radius="25"}this.editor.api.ChangePart(o,(function(){return e.onChangePartCallback()}))},e.prototype.onChangePartCallback=function(){this.editor.trigger(s.EditorEventType.PART_EDITED,{edited:"cutline"}),"phone"==currentSize_&&(this.visible=!1),$("#overlay").hide()},e.prototype.onClickBtnPathNewL=function(t){t.preventDefault(),this.$content.find("[name=new-outline-size]").val("800"),this.$content.find("[name=new-outline-threshold1]").val("200"),this.$content.find("[name=new-outline-gaussian]").val("3"),this.$content.find("[name=new-outline-k]").val("0.5"),this.$content.find("[name=new-outline-a]").val("1.2"),this.$content.find("[name=new-outline-O]").val("0.1"),this.$content.find("[name=new-outline-expand]").val("4"),this.$content.find("[name=new-outline-contract]").val("0.1"),this.$content.find("[name=new-outline-keep]").prop("checked",!1),this.$content.find("[name=new-outline-auto]").prop("checked",!0),this.$content.find("[name=new-outline-overcut]").prop("checked",!1),this.$content.find("[name=new-outline-padding]").prop("checked",!0)},e.prototype.onClickBtnPathNewM=function(t){t.preventDefault(),this.$content.find("[name=new-outline-size]").val("800"),this.$content.find("[name=new-outline-threshold1]").val("200"),this.$content.find("[name=new-outline-gaussian]").val("2"),this.$content.find("[name=new-outline-k]").val("0.5"),this.$content.find("[name=new-outline-a]").val("1.2"),this.$content.find("[name=new-outline-O]").val("0.1"),this.$content.find("[name=new-outline-expand]").val("2.9"),this.$content.find("[name=new-outline-contract]").val("0.1"),this.$content.find("[name=new-outline-keep]").prop("checked",!1),this.$content.find("[name=new-outline-auto]").prop("checked",!0),this.$content.find("[name=new-outline-overcut]").prop("checked",!1),this.$content.find("[name=new-outline-padding]").prop("checked",!0)},e.prototype.onClickBtnPathNewS=function(t){t.preventDefault(),this.$content.find("[name=new-outline-size]").val("800"),this.$content.find("[name=new-outline-threshold1]").val("200"),this.$content.find("[name=new-outline-gaussian]").val("1"),this.$content.find("[name=new-outline-k]").val("0.5"),this.$content.find("[name=new-outline-a]").val("1.2"),this.$content.find("[name=new-outline-O]").val("0.1"),this.$content.find("[name=new-outline-expand]").val("1.7"),this.$content.find("[name=new-outline-contract]").val("0.1"),this.$content.find("[name=new-outline-keep]").prop("checked",!1),this.$content.find("[name=new-outline-auto]").prop("checked",!0),this.$content.find("[name=new-outline-overcut]").prop("checked",!1),this.$content.find("[name=new-outline-padding]").prop("checked",!0)},e}(r.EditorTool);exports.CutlineEditorTool=a},92324:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.EditorTool=void 0;var r=e(3551),n=e(35896),s=function(t){function e(e,o,i){var r=t.call(this,e,o)||this;return r._visible=!1,r._hideOnClickOutside=!0,r._name=i,r._$content=r.$el.data("tool-content")?o.$(r.$el.data("tool-content")):$("<div/>"),r.on("click",(function(t){return r.onClick(t)})),r.registerCallback(r.$backButton,"click",(function(t){return r.onBack(t)})),r.registerCallback(r.editor.$el,n.EditorEventType.SVG_DESTROYED,(function(t){return r.onBack(t)})),r}return i(e,t),Object.defineProperty(e.prototype,"STATE_IN_TRANSITION",{get:function(){return"state_in_transition"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"STATE_TRANSITION_DONE",{get:function(){return"state_transition_done"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$backButton",{get:function(){return this.$header.find(".cta.back")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$content",{get:function(){return this._$content},set:function(t){this._$content=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$body",{get:function(){return this.$content.find(".tool-content-body")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$header",{get:function(){return this.$content.find(".tool-content-header")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$title",{get:function(){return this.$content.find(".tool-content-title")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"visible",{get:function(){return this._visible},set:function(t){switch(this._visible=t,this._visible){case!0:this.trigger(n.EditorEventType.OPEN_TOOL,this);break;case!1:this.trigger(n.EditorEventType.CLOSE_TOOL,this)}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bodyMaxHeight",{set:function(t){this.$body.css("max-height",t+"px")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bodyHeight",{set:function(t){t="number"==typeof t?t+"px":t,this.$body.css("height",t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hideOnClickOutside",{get:function(){return this._hideOnClickOutside},set:function(t){this._hideOnClickOutside=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),e.prototype.onClick=function(t){this.$el.hasClass("disabled")||(this.visible=!0)},e.prototype.onBack=function(t){this.visible=!1},e.prototype.onTransitionInDone=function(){},e.prototype.onLeave=function(){},e}(r.EditorViewComponent);exports.EditorTool=s},63200:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.EditorToolPane=void 0;var r=e(3551),n=e(44985),s=e(87664),a=e(35896),l=e(6488),d=e(46880),c=e(389),h=e(30164),u=e(65018),p=e(27419),f=e(4475),g=e(81657),v=e(19115),m=e(86923),_=e(89023),b=e(37700),y=e(48663),E=e(51859),T=e(50849),x=e(26519),S=e(38218),w=e(400),P=e(70207),C=e(4317),O=e(33566),A=function(t){function e(o,i){var r=t.call(this,o,i)||this;return r._swiping=!1,r._easterEggFound=!1,r._state=e.STATE_TOOLS_OVERVIEW,r._$easteregg=r.editor.$(".easter-egg"),r._materialPresetsTool=new s.MaterialPresetEditorTool(i.$(".tool-material-preset"),i),r._noteTool=new l.NoteEditorTool(r.$(".tool.tool-note"),i),r._quantityTool=new d.QuantityEditorTool(r.$(".tool.tool-quantity"),i),r._quantityTool.quantity=r.model.sheet.quantity,r._quantityTool.minQuantity=r.model.sheet.min_quantity,r._quantityTool.oldQuantity=r.model.sheet.quantity,r._textTool=new c.TextEditorTool(i.$(".tool.tool-text"),i),r._cutlineTool=new h.CutlineEditorTool(i.$(".tool.tool-cutline"),i),r._templateTool=new u.TemplateEditorTool(r.$(".tool.tool-template"),i),r._templateTypeTool=new p.TemplateTypeEditorTool(r.$(".tool.tool-template-type"),i),r._clipartsTool=new f.ClipartsEditorTool(i.$(".tool.tool-cliparts"),i),r._stickersTool=new g.StickersEditorTool(i.$(".tool.tool-stickers"),i),r._uploadTool=new v.UploadEditorTool(i.$(".tool.tool-upload"),i),r._collageTool=new m.CollageEditorTool(i.$(".tool.tool-collage"),i),r._templatePartTool=new _.TemplatePartEditorTool(r.$(".tool.tool-parts"),r.editor),r._backgroundTool=new b.BackgroundEditorTool(i.$(".tool.tool-background"),i),r._saveButtonTool=new E.SaveButtonEditorTool(r.model.ui.buttonSave?$(r.model.ui.buttonSave):r.editor.$(".btn-save"),i),r._effectLayerTool=new C.EffectLayerTool(i.$(".tool.tool-effect-layer"),i),r.editor.model.editor.backPrintToolEnabled&&(r._backPrintEditorTool=new P.BackPrintEditorTool(i.$(".tool.tool-backside-print"),r.editor),r._removeBackPrintTool=new T.RemoveBackPrintEditorTool(i.$(".tool.tool-backside-print-remove"),r.editor),r._backPrintDealTool=new x.BackPrintDealTool(i.$(".tool.tool-backside-print-deal"),r.editor),r._backPrintDealTextTool=new S.BackPrintDealTextTool(i.$(".tool.tool-backside-print-deal-text"),i)),r._saveButtonTool.setEnabled(!1),r.registerCallback(r.editor.$el,a.EditorEventType.OPEN_TOOL,(function(t,e){return r.onOpenTool(t,e)})),r.registerCallback(r.editor.$el,a.EditorEventType.CLOSE_TOOL,(function(t,e){return r.onCloseTool(t,e)})),r.registerCallback(r.editor.$el,a.EditorEventType.ORIENTATION_CHANGE,(function(t){return r.onOrientationChange(t)})),r.registerCallback(r.editor,a.EditorEventType.EDITOR_RESIZE,(function(t){return r.setCurrentToolMaxHeight()})),r.registerCallback($("body"),"click",(function(t){return r.onBodyClick(t)})),r.registerCallback($(r.editor),a.EditorEventType.EDITOR_CONTAINER_CLICK,(function(t){return r.onClickOutside()})),r.on(a.EditorEventType.SVG_DESTROYED,(function(){return r.stopTools()})),r.on("click",".panel-confirm .btn-done",(function(){return r.onClickOutside()})),y.MediaUtil.isTouchDevice()&&(r.$el.get(0).addEventListener("touchstart",(function(t){return r.onTouchStart(t)}),!1),r.$el.get(0).addEventListener("touchmove",(function(t){return r.onTouchMove(t)}),!1),r.$el.get(0).addEventListener("touchend",(function(t){return r.onTouchEnd(t)}),!1),r.$toolBar.get(0).addEventListener("touchstart",(function(t){return r.onTouchStart(t)}),!1),r.$toolBar.get(0).addEventListener("touchmove",(function(t){return r.onTouchMove(t)}),!1),r.$toolBar.get(0).addEventListener("touchend",(function(t){return r.onTouchEnd(t)}),!1)),r.render(),r}return i(e,t),e.prototype.prepTools=function(){this._materialPresetsTool.setEnabled(this.model.editor.materialPresetsSelectorEnabled),this._noteTool.setEnabled(this.model.editor.noteButtonEnabled),this._textTool.setEnabled(this.model.editor.textSelectorEnabled),this._cutlineTool.setEnabled(this.model.editor.cuttinglineSelectorEnabled),this._templateTool.setEnabled(this.model.editor.templatesToolEnabled),this._templateTypeTool.setEnabled(this.model.editor.templateTypesToolEnabled),this._clipartsTool.setEnabled(this.model.editor.clipartSelectorEnabled),this._stickersTool.setEnabled(this.model.editor.stickersSelectorEnabled),this._uploadTool.setEnabled(this.model.editor.uploadEnabled),this._collageTool.setEnabled(this.model.editor.collageSelectorEnabled&&void 0!==this.model.editor.collages),this._templatePartTool.setEnabled(this.editor.svg.mode==SVG.MODE_SKIN&&this.model.parts.length>1),this._backgroundTool.setEnabled(this.model.editor.backgroundSelectorEnabled),this._effectLayerTool.setEnabled(this.model.editor.effectLayerToolEnabled),this.model.editor.isCartFull&&!this.model.sheet.sheet_id||this._saveButtonTool.setEnabled(!0),this.editor.isLandscapeOrientation()&&this.state!=e.STATE_TOOL_OPEN&&this._uploadTool.enabled&&this._uploadTool.$el.is(":visible")&&(this._currentTool&&(this._currentTool.visible=!1),this._uploadTool.visible=!0)},e.prototype.stopTools=function(){this._collageTool.listenersActive=!1,this._stickersTool.listenersActive=!1,this._clipartsTool.listenersActive=!1,this._backgroundTool.listenersActive=!1,this._materialPresetsTool.listenersActive=!1,this._noteTool.listenersActive=!1,this._textTool.listenersActive=!1,this._cutlineTool.listenersActive=!1,this._uploadTool.listenersActive=!1,this._saveButtonTool.setEnabled(!1),this._effectLayerTool.setEnabled(!1)},e.prototype.render=function(){var t=this;switch(this.state){case e.STATE_TOOL_OPEN:this.$el.attr("data-tool",this._currentTool.name),this.$el.removeClass(e.STATE_TOOLS_OVERVIEW).addClass(e.STATE_TOOL_OPEN),this.editor.$el.removeClass(e.STATE_TOOLS_OVERVIEW).addClass(e.STATE_TOOL_OPEN),this.$panelToolContent.has(this._currentTool.$content.get(0)).length||this.$panelToolContent.append(this._currentTool.$content),this.$panelToolContent.find(".tool-content").addClass("hidden"),this.editor.$(".tool.active").removeClass("active"),this._currentTool.$el.addClass("active"),this._currentTool.$content.removeClass("hidden"),this.setCurrentToolMaxHeight(),setTimeout((function(){t._currentTool&&t._currentTool.onTransitionInDone()}),200),this.editor.orientation==n.Editor.ORIENTATION_PORTRAIT&&this.$el.css("bottom","0"),this._effectLayerTool.visible=this._effectLayerTool.enabled&&this._effectLayerTool.requirementsFulfilled(),this._effectLayerTool.disabled=!this._effectLayerTool.materialPresetIsValid();break;case e.STATE_TOOLS_OVERVIEW:this.editor.$(".tool.active").removeClass("active"),this.$el.removeClass(e.STATE_TOOL_OPEN).addClass(e.STATE_TOOLS_OVERVIEW),this.editor.$el.removeClass(e.STATE_TOOL_OPEN).addClass(e.STATE_TOOLS_OVERVIEW),this.$panelToolContent.find(".tool-content").addClass("hidden"),this._effectLayerTool.$el.addClass("hidden"),this.editor.orientation==n.Editor.ORIENTATION_PORTRAIT?this.$el.css("bottom",this.editor.$("> .tool-bar").outerHeight()+"px"):this.$el.css("bottom","")}},e.prototype.setCurrentToolMaxHeight=function(){if(this._currentTool){var t=this.$el.height()-this.$footer.outerHeight();this._currentTool.$header.is(":visible")&&(t-=this._currentTool.$header.outerHeight()),this.editor.isLandscapeOrientation()&&(t=t-(parseInt($(".action.btn-container:visible").css("bottom"))||0)-this.$panelToolsOverview.outerHeight()-$(".editor-header").outerHeight()-($(".tool-backside-print-deal:visible").outerHeight()||0)),"upload"==this._currentTool.name?this.$uploadToolWrapper.css("max-height",t):this._currentTool.bodyMaxHeight=t,this.editor.isLandscapeOrientation()?this._currentTool.bodyHeight="auto":this._currentTool.bodyHeight=t}},e.prototype.destroy=function(){var e=this;y.MediaUtil.isTouchDevice()&&(this.$el.get(0).removeEventListener("touchstart",(function(t){return e.onTouchStart(t)}),!1),this.$el.get(0).removeEventListener("touchmove",(function(t){return e.onTouchMove(t)}),!1),this.$el.get(0).removeEventListener("touchend",(function(t){return e.onTouchEnd(t)}),!1),this.$toolBar.get(0).removeEventListener("touchstart",(function(t){return e.onTouchStart(t)}),!1),this.$toolBar.get(0).removeEventListener("touchmove",(function(t){return e.onTouchMove(t)}),!1),this.$toolBar.get(0).removeEventListener("touchend",(function(t){return e.onTouchEnd(t)}),!1)),t.prototype.destroy.call(this)},e.prototype.isOpenToolState=function(){return this.state==e.STATE_TOOL_OPEN},Object.defineProperty(e,"STATE_TOOLS_OVERVIEW",{get:function(){return"state-tools-overview"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"STATE_TOOL_OPEN",{get:function(){return"state-tool-open"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$footer",{get:function(){return this.$(".footer")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"model",{get:function(){return this.editor.model},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$panelToolsOverview",{get:function(){return this.$(".panel-tools-overview")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$panelToolContent",{get:function(){return this.$(".panel-tool-content")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$uploadToolWrapper",{get:function(){return this.$(".upload-wrapper")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$toolBar",{get:function(){return this.editor.$("> .tool-bar")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"state",{get:function(){return this._state},set:function(t){this._state=t,this.render()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"quantityTool",{get:function(){return this._quantityTool},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"textTool",{get:function(){return this._textTool},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"backPrintDealTextTool",{get:function(){return this._backPrintDealTextTool},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"uploadTool",{get:function(){return this._uploadTool},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cutlineTool",{get:function(){return this._cutlineTool},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"backgroundTool",{get:function(){return this._backgroundTool},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"materialPresetsTool",{get:function(){return this._materialPresetsTool},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"clipartsTool",{get:function(){return this._clipartsTool},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"noteTool",{get:function(){return this._noteTool},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"effectLayerTool",{get:function(){return this._effectLayerTool},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"removeBackPrintTool",{get:function(){return this._removeBackPrintTool},set:function(t){this._removeBackPrintTool=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentTool",{get:function(){return this._currentTool},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"swiping",{get:function(){return this._swiping},set:function(t){this._swiping=t,!0===t?(this.$el.attr("data-swiping","true"),this.$toolBar.attr("data-swiping","true")):(this.$el.attr("data-swiping","false"),this.$toolBar.attr("data-swiping","false"))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"backPrintDealTool",{get:function(){return this._backPrintDealTool},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isEasterEggActive",{get:function(){return this._$easteregg.data("active")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"easterEggHeight",{get:function(){return this._$easteregg.data("height")},enumerable:!1,configurable:!0}),e.prototype.onOpenTool=function(t,o){o.name!==O.EditorToolName.EFFECT_LAYER_UPLOAD&&(this._currentTool&&this._currentTool.name!=o.name&&(this._currentTool.onLeave(),this._currentTool.visible=!1),this._currentTool=o,this.state=e.STATE_TOOL_OPEN,this.$el.trigger(a.EditorEventType.TOOL_PANE_STATE_CHANGE))},e.prototype.onCloseTool=function(t,o){o!=this._currentTool||this.editor.isLandscapeOrientation()||(this._currentTool=null,this.state=e.STATE_TOOLS_OVERVIEW,this.$el.trigger(a.EditorEventType.TOOL_PANE_STATE_CHANGE),"back"===this.editor.api.GetActivePartSide()&&"cliparts"===o.name&&this.editor.ui.setSizeAndOrientation())},e.prototype.onBodyClick=function(t){this.state==e.STATE_TOOL_OPEN&&(this.$el.has(t.target).length||this.$el.is(t.target)||!$(t.target).parents("html").length||$(t.target).hasClass(".tool")||$(t.target).closest(".tool").length||this.onClickOutside())},e.prototype.onClickOutside=function(){this._currentTool&&this._currentTool.hideOnClickOutside&&(this._currentTool.visible=!1)},e.prototype.onOrientationChange=function(t){this.editor.orientation==n.Editor.ORIENTATION_PORTRAIT&&this._currentTool&&(this._currentTool.visible=!1)},e.prototype.onTouchStart=function(t){this._touchStartY=t.touches[0].clientY,this._touchStartX=t.touches[0].clientX},e.prototype.onTouchMove=function(t){if(this.state!=e.STATE_TOOL_OPEN){var o=t.touches[0].clientY,i=t.touches[0].clientX,r=this._touchStartX-i,n=this._touchStartY-o;Math.abs(r)>Math.abs(n)||(this.isEasterEggActive&&parseInt(this.$el.css("margin-bottom"))<this.easterEggHeight||!this.isEasterEggActive?(t.stopPropagation(),t.preventDefault(),this.swiping=!0,n>0?(n/=2,this.$el.css("margin-bottom",n+"px"),this.$toolBar.css("margin-bottom",n+"px")):(n/=2,this.$el.css("margin-bottom",n/2+"px"),this.$toolBar.css("margin-bottom",n/2+"px"))):!1===this._easterEggFound&&this.isEasterEggActive&&(w.GTMService.easterEggFound(),this._easterEggFound=!0))}},e.prototype.onTouchEnd=function(t){this.swiping&&(this.swiping=!1)},Object.defineProperty(e.prototype,"backPrintEditorTool",{get:function(){return this._backPrintEditorTool},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"saveButtonTool",{get:function(){return this._saveButtonTool},enumerable:!1,configurable:!0}),e}(r.EditorViewComponent);exports.EditorToolPane=A},4317:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.EffectLayerTool=void 0;var r=e(3551),n=e(33566),s=e(52183),a=e(70946),l=e(35896),d=e(61347),c=e(400),h=function(t){function e(e,o){var i=t.call(this,e,o)||this;return i.init=function(){i.appendModal(),i.$popover.popover()},i.onEditorReady=function(){i._effectLayerUploadEditorTool.hasMeta()?(i.hideBox(),i.setFile(!0,!0),i.setFile(!0)):i.showBox()},i.onEditorUpdated=function(){i.uploadedFileIsValidForMaterial()},i.onEditorPreSave=function(){i._effectLayerUploadEditorTool.hasMeta()&&!i.materialPresetIsValid()&&i._effectLayerUploadEditorTool.removeMeta()},i.onModalShow=function(t){t.preventDefault(),i.showModal(),i.$modalTextarea.val(i.editor.model.sheet.note),$(document).trigger("changeCurrent","effect-layer-fileupload"),c.GTMService.effectLayerAdd(i.editor.model.sheet.materialPresetName)},i.onModalCancel=function(t){t.preventDefault(),i._effectLayerUploadEditorTool._hasSavedFile||i.setFile(!1),i.hideModal()},i.onModalBrowse=function(t){t.preventDefault(),i.$fileupload.trigger("click"),c.GTMService.effectLayerBrowse(i.editor.model.sheet.materialPresetName)},i.onModalDone=function(t){t.preventDefault(),i._lastNote!=i.$modalTextarea.val().toString()?i.setNote(!0):i.setNote(),i._effectLayerUploadEditorTool.hasMeta()&&(i._effectLayerUploadEditorTool._hasSavedFile=!0,i.hideBox(),i.setFile(!0,!0,!0)),i.$fileError.is(":visible")&&i.setFileError(!1),i.uploadedFileIsValidForMaterial(),i.hideModal(),c.GTMService.effectLayerDone(i.editor.model.sheet.materialPresetName)},i.onUploadCancel=function(t){t.preventDefault(),i._effectLayerUploadEditorTool.onCancel(t)},i.onFileRemove=function(t,e){void 0===e&&(e=!1),t.preventDefault(),t.stopImmediatePropagation(),i._effectLayerUploadEditorTool._hasSavedFile=!1,i._effectLayerUploadEditorTool.removeMeta(),e?(i.showBox(),i.setFile(!1,!0),i.editor.ui.toolPane.setCurrentToolMaxHeight()):i.setFile(!1),i.$toolNotification.hasClass("hidden")||i.$toolNotification.addClass("hidden"),c.GTMService.effectLayerRemove(i.editor.model.sheet.materialPresetName)},i.onFileErrorRemove=function(t){t.preventDefault(),i.setFileError(!1)},i.requirementsFulfilled=function(){return!(!i.editor.isLandscapeOrientation()||d.DevUtil.isAdmin())&&i.editor.api.GetActivePartSide()===a.EditorActivePartSide.FRONT&&i._mainTools.includes(i.editor.ui.toolPane.currentTool.name)},i.materialPresetIsValid=function(){return void 0!==i.editor.model.editor.effectLayerToolMaterialPresets&&i.editor.model.editor.effectLayerToolMaterialPresets.length>0&&i.editor.model.editor.effectLayerToolMaterialPresets.includes(i.editor.model.sheet.materialPresetName)},i.uploadedFileIsValidForMaterial=function(){i._effectLayerUploadEditorTool.hasMeta()&&(i.materialPresetIsValid()?(i.$editorFile.removeClass("hidden"),i.$editorFileTitle.text(i.editor.model.language.effect_layer_added).css({color:"#444"}),i.$toolNotification.hasClass("hidden")||i.$toolNotification.addClass("hidden")):(i.$toolNotification.removeClass("hidden").addClass("animated bounceIn").on("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",(function(){i.$toolNotification.removeClass("animated bounceIn")})),i.$editorFileTitle.text(i.editor.model.language.effect_layer_not_supported_for_material).css({color:"#da5246"})))},i.show=function(){i.enabled&&i.visible?i.$el.hasClass("hidden")&&i.$el.removeClass("hidden"):i.$el.hasClass("hidden")||i.$el.addClass("hidden")},i.disable=function(){i.disabled?i.$modalShowButton.attr("disabled","true"):i.$modalShowButton.removeAttr("disabled")},i.showBox=function(){i.$box.removeClass("hidden")},i.hideBox=function(){i.$box.hasClass("hidden")||i.$box.addClass("hidden")},i.appendModal=function(){if(!i.$modal.hasClass("appended")){var t=i.$modal;i.$modal.remove(),t.addClass("appended").appendTo(i.editor.$el)}},i.showModal=function(){i.$modal.modal("show")},i.hideModal=function(){$(document).trigger("changeCurrent","fileupload"),i.$modal.modal("hide")},i.setFile=function(t,e,o){void 0===e&&(e=!1),void 0===o&&(o=!1),t?e?(i.$editorFile.removeClass("hidden"),i.editor.ui.toolPane.setCurrentToolMaxHeight(),o&&i.$editorFile.addClass("animated bounceIn").on("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",(function(){i.$editorFile.removeClass("animated bounceIn")}))):(i.$modalFile.removeClass("hidden"),i.$fileError.hasClass("hidden")||i.$fileError.addClass("hidden")):e?(i.$editorFile.addClass("hidden"),i.$modalFile.addClass("hidden")):i.$modalFile.addClass("hidden"),i.setFileName(e)},i.setFileName=function(t){var e=i._effectLayerUploadEditorTool._fileName?i._effectLayerUploadEditorTool._fileName:i.editor.svg.sheet.sheet_meta.EFFECT_LAYER_UPLOAD_FILE_NAME;t?i.$editorFile.find("span").not(".file-title").not(".effect-layer-popover").text(e):i.$modalFile.find("span").text(e)},i.setFileError=function(t,e){void 0===e&&(e=null),t?(i.$fileError.removeClass("hidden"),i.$modalFile.hasClass("hidden")||i.$modalFile.addClass("hidden")):i.$fileError.addClass("hidden"),i.$fileError.find("span").text(e)},i.setNote=function(t){void 0===t&&(t=!1),i.editor.model.sheet.note=i.$modalTextarea.val().toString(),i.editor.ui.toolPane.noteTool.$textarea.val(i.editor.model.sheet.note),i.editor.ui.toolPane.noteTool.render(i.editor.model.sheet.note),i._lastNote=i.editor.model.sheet.note,t&&i.editor.ui.toolPane.noteTool.$el.addClass("animated bounceIn").on("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",(function(){i.editor.ui.toolPane.noteTool.$el.removeClass("animated bounceIn")}))},i.setBoxMaxHeight=function(){var t,e=i.editor.$el.height();t=e>640&&e<=740?220:e>600&&e<=640?200:e<=600?180:"initial",i.$uploadWrapper.css({"max-height":t})},i._mainTools=[n.EditorToolName.UPLOAD],i._visible=!1,i._disabled=!1,i._effectLayerUploadEditorTool=new s.EffectLayerUploadEditorTool(i.$fileupload,o),i._lastNote=o.model.sheet.note||"",i.registerCallback(i.$modalShowButton,"click",(function(t){return i.onModalShow(t)})),i.registerCallback(i.$modalCancelButton,"click",(function(t){return i.onModalCancel(t)})),i.registerCallback(i.$modalBrowseButton,"click",(function(t){return i.onModalBrowse(t)})),i.registerCallback(i.$modalDoneButton,"click",(function(t){return i.onModalDone(t)})),i.registerCallback(i.$uploadCancelButton,"click",(function(t){return i.onUploadCancel(t)})),i.registerCallback(i.$editorFileRemoveButton,"click",(function(t){return i.onFileRemove(t,!0)})),i.registerCallback(i.$modalFileRemoveButton,"click",(function(t){return i.onFileRemove(t)})),i.registerCallback(i.$fileErrorRemoveButton,"click",(function(t){return i.onFileErrorRemove(t)})),o.on(l.EditorEventType.READY,(function(){return i.onEditorReady()})),o.on(l.EditorEventType.UPDATED,(function(){return i.onEditorUpdated()})),o.on(l.EditorEventType.PRE_SAVE,(function(){return i.onEditorPreSave()})),i.init(),i}return i(e,t),e.prototype.setEnabled=function(e){t.prototype.setEnabled.call(this,e)},Object.defineProperty(e.prototype,"visible",{get:function(){return this._visible},set:function(t){this._visible=t,this.show()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"disabled",{get:function(){return this._disabled},set:function(t){this._disabled=t,this.disable()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$fileupload",{get:function(){return this.$el.find("input.effect-layer-fileupload")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$box",{get:function(){return this.$el.find(".effect-layer-box")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$modalShowButton",{get:function(){return this.$el.find(".show-modal-btn")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$popover",{get:function(){return this.$el.find("span.effect-layer-popover")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$editorFileTitle",{get:function(){return this.$el.find(".file-title")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$editorFile",{get:function(){return this.$el.find(".file")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$editorFileRemoveButton",{get:function(){return this.$el.find(".remove-btn.remove-file-btn")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$toolNotification",{get:function(){return this.editor.$el.find(".tool-notification")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$uploadWrapper",{get:function(){return this.editor.$el.find(".upload-wrapper")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$modal",{get:function(){return this.editor.$el.find("#effect-layer-modal")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$modalCancelButton",{get:function(){return this.$modal.find(".cancel-btn")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$modalBrowseButton",{get:function(){return this.$modal.find(".browse-btn")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$modalDoneButton",{get:function(){return this.$modal.find(".done-btn")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$modalTextarea",{get:function(){return this.$modal.find('textarea[name="note"]')},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$upload",{get:function(){return this.$modal.find(".upload")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$modalFile",{get:function(){return this.$modal.find(".file")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$modalFileRemoveButton",{get:function(){return this.$modal.find(".remove-btn.remove-file-btn")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$fileError",{get:function(){return this.$modal.find(".file-error")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$fileErrorRemoveButton",{get:function(){return this.$modal.find(".remove-btn.remove-file-error-btn")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$progress",{get:function(){return this.$modal.find(".progress")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$progressBar",{get:function(){return this.$modal.find(".progress-bar")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$progressionZone",{get:function(){return this.$modal.find(".progression-zone")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"progress",{set:function(t){this.$progressBar.css("width",t+"%"),this.$progressBar.css("width",t+"%"),this.$progressBar.attr("aria-valuenow",t),t>0?this.$(".progression").html(t+"%"):this.$(".progression").html("")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$uploadCancelButton",{get:function(){return this.$modal.find(".btn.cancel")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$modalButtons",{get:function(){return this.$modal.find(".modal-buttons")},enumerable:!1,configurable:!0}),e}(r.EditorViewComponent);exports.EffectLayerTool=h},52183:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.EffectLayerUploadEditorTool=void 0;var r=e(19115),n=e(35896),s=e(33047),a=e(33566),l=e(400),d=function(t){function e(e,o){var i=t.call(this,e,o)||this;return i._name=a.EditorToolName.EFFECT_LAYER_UPLOAD,i._hasSavedFile=!1,i._fileName=null,i._fileUrl=null,i}return i(e,t),e.prototype.open=function(){},Object.defineProperty(e.prototype,"$fileupload",{get:function(){return this.$el},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$connectionError",{get:function(){return $("#connection-error")},enumerable:!1,configurable:!0}),e.prototype.filterSend=function(t,e){return!!this.enabled&&(this.editor.api.isTooManyImages()||!this.uploadIsValid(e)?(this.hideProgress(),!1):(this.uploadIsValid(e)&&(this._fileName=e.files[0].name),void l.GTMService.effectLayerUploaded(this.editor.model.sheet.materialPresetName)))},e.prototype.onStart=function(t){this._status=s.EditorUploadStatus.START,this.editor.ui.toolPane.effectLayerTool.setFile(!1),this.editor.ui.toolPane.effectLayerTool.setFileError(!1),this.editor.ui.toolPane.effectLayerTool.progress=0,this.showProgress()},e.prototype.onProgressAll=function(t,e){this.editor.ui.toolPane.effectLayerTool.progress=parseInt((e.loaded/e.total*100).toString(),10)},e.prototype.onDone=function(t,e){var o=this._fileName?this._fileName:e.result.files[0].name;e.result.files[0].url&&(this._fileUrl=e.result.files[0].url),this.uploadIsValid(e)&&(o&&this._fileUrl?(this.setMeta(),this.editor.ui.toolPane.effectLayerTool.setFile(!0,!1)):this.onError(t,e)),this.hideProgress(),this._status=s.EditorUploadStatus.DONE,this.trigger(n.EditorEventType.UPLOAD_END)},e.prototype.onError=function(t,e){this._status=s.EditorUploadStatus.ERROR,this.editor.ui.toolPane.effectLayerTool.hideModal(),this.hideProgress(),this.$connectionError.modal("show"),this.trigger(n.EditorEventType.UPLOAD_END)},e.prototype.onCancel=function(t){t.preventDefault(),this._status==s.EditorUploadStatus.START&&(this.$fileupload.fileupload("abort"),this._status=s.EditorUploadStatus.IDLE),this.hideProgress(),this.destroy(),this.trigger(n.EditorEventType.UPLOAD_CANCEL)},e.prototype.hasMeta=function(){return!(null===this.editor.svg.sheet.sheet_meta||!this.editor.svg.sheet.sheet_meta.EFFECT_LAYER_UPLOAD_FILE_NAME||!this.editor.svg.sheet.sheet_meta.EFFECT_LAYER_UPLOAD_FILE_URL)},e.prototype.setMeta=function(){this.editor.svg.sheet.sheet_meta.EFFECT_LAYER_UPLOAD_FILE_NAME=this._fileName,this.editor.svg.sheet.sheet_meta.EFFECT_LAYER_UPLOAD_FILE_URL=this._fileUrl},e.prototype.removeMeta=function(){this.editor.svg.sheet.sheet_meta.EFFECT_LAYER_UPLOAD_FILE_NAME=null,this.editor.svg.sheet.sheet_meta.EFFECT_LAYER_UPLOAD_FILE_URL=null},e.prototype.uploadIsValid=function(t){var e=!0;if(t.result){for(var o=0;o<t.result.files.length;o++)if(t.result.files[o].error){this.removeMeta(),this.editor.ui.toolPane.effectLayerTool.setFileError(!0,t.result.files[o].error),e=!1;break}}else if(t.files.length>1)return this.editor.ui.toolPane.effectLayerTool.setFileError(!0,this.editor.model.language.effect_layer_too_many_images),!1;return e},e.prototype.showProgress=function(){this.editor.ui.toolPane.effectLayerTool.$modalButtons.addClass("hidden"),this.editor.ui.toolPane.effectLayerTool.$progressionZone.removeClass("hidden"),this.editor.ui.toolPane.effectLayerTool.$progress.removeClass("hidden")},e.prototype.hideProgress=function(){this.editor.ui.toolPane.effectLayerTool.$modalButtons.removeClass("hidden"),this.editor.ui.toolPane.effectLayerTool.$progressionZone.addClass("hidden"),this.editor.ui.toolPane.effectLayerTool.$progress.addClass("hidden"),this.editor.ui.toolPane.effectLayerTool.progress=0},e}(r.UploadEditorTool);exports.EffectLayerUploadEditorTool=d},87664:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.MaterialPresetEditorTool=void 0;var r=e(92324),n=e(35896),s=e(42319),a=e(400),l=function(t){function e(e,o){var i=t.call(this,e,o,"material-preset")||this;return i._changed=!1,i._queuedAfterUploadDone=!1,e.data("editor","#"+o.id),e.data("viewport","#"+o.id),e.data("container","#"+o.id),e.data("placement","top"),i._$list=$("<div class='w-12'></div>"),i._popover=new s.ManualPopover(e),i._popover.$contentContainer.addClass("stretch"),i._popover.$header.remove(),i._popover.$closeButton.remove(),i.registerCallback(i.editor.$el,n.EditorEventType.CHANGE_MATERIAL,(function(t,e){return i.onMaterialChange(t,e)})),i.registerCallback(i.editor.$el,n.EditorEventType.ORIENTATION_UPDATE,(function(t){return i.renderBasedOnEditorOrientation()})),i.registerCallback(i.editor.$el,n.EditorEventType.DESTROY,(function(t){return i._popover.destroy()})),i.registerCallback(i._$list,"click",".list-item:not(.disabled)",(function(t){return i.onSelectPreset(t)})),i.on("show.bs.popover",(function(t){return i.onShowPopover()})),i.on("shown.bs.popover",(function(t){return i.onShownPopover()})),i.registerCallback($(i.editor),n.EditorEventType.EDITOR_CONTAINER_CLICK,(function(t){return i._popover.visible=!1})),i.registerCallback(i.editor.$el,n.EditorEventType.UPLOAD_END,(function(t){return i.processQueue()})),i.registerCallback(i.editor.$el,n.EditorEventType.UPLOAD_CANCEL,(function(t){return i.processQueue()})),i}return i(e,t),e.prototype.render=function(){if(this.enabled){this.editor.$el.addClass("has-material-selector"),this.editor.$el.removeClass("has-no-material-selector"),this.$el.removeClass("hidden"),this.renderBasedOnEditorOrientation(),this._$list.html("");for(var t=this.editor.model.editor.materialPresets.filter((function(t){return"epoxy_hi_tack"!==t.materialPresetName})),e=0;e<t.length;e++){var o=t[e],i='\n\t\t\t\t\t\t<div class="f-row f-row-as-li cta list-item" data-quantity="50">\n\t\t\t\t\t\t\t<div class="w-3 p-right">\n\t\t\t\t\t\t\t\t<div style="background-image:url('.concat(o.iconThumbURL,')" class="material-image img-circle ').concat(o.materialPresetName,'"></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="f-col material-preset-title">\n\t\t\t\t\t\t\t\t').concat(o.title,"\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t"),r=$(i);o.inStock||r.addClass("disabled"),o.label&&o.label.length&&(r.find(".material-preset-title").removeClass("f-col").addClass("f-col-6"),r.append('<div class="f-col-3 f-justify-end"><span class="label label-'.concat(o.labelType,'">').concat(o.label,"</span></div>"))),r.data("vo",o),r.data("material-name",o.materialName),r.data("laminate-name",o.laminateName),this.editor.model.sheet.material==o.materialName&&this.editor.model.sheet.laminate==o.laminateName&&r.addClass("active"),this._$list.append(r)}!this.$active.length&&this._$list.find(".list-item").length&&(this._$list.find(".list-item:first").addClass("active"),this.editor.trigger(n.EditorEventType.CHANGE_MATERIAL,this.vo))}else this.editor.$el.addClass("has-no-material-selector"),this.editor.$el.removeClass("has-material-selector"),this.$el.addClass("hidden")},e.prototype.renderBasedOnEditorOrientation=function(){this._popover.disabled=!0,this.$body.append(this._$list)},e.prototype.renderScrollTop=function(){if(this.editor.isLandscapeOrientation()){var t=this.$active.offset().top-this._popover.$contentContainer.offset().top+this._popover.$contentContainer.scrollTop();this._popover.$contentContainer.scrollTop(t)}else t=this.$active.offset().top-this.$body.offset().top+this.$body.scrollTop(),this.$body.scrollTop(t)},e.prototype.setEnabled=function(e){t.prototype.setEnabled.call(this,e),this.render()},e.prototype.requestMaterial=function(){a.GTMService.changeMaterial(this.editor.model.sheet.material,this.vo.materialName),this.editor.trigger(n.EditorEventType.CHANGE_MATERIAL,this.vo),this._changed=!1},e.prototype.processQueue=function(){this._queuedAfterUploadDone&&(this.requestMaterial(),this._queuedAfterUploadDone=!1)},Object.defineProperty(e.prototype,"$active",{get:function(){return this._$list.find(".list-item.active")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"vo",{get:function(){return this.$active.data("vo")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bodyMaxHeight",{set:function(t){this.$body.css("max-height",t+"px"),this.renderScrollTop()},enumerable:!1,configurable:!0}),e.prototype.onClick=function(e){e.preventDefault(),t.prototype.onClick.call(this,e)},e.prototype.onSelectPreset=function(t){t.preventDefault(),t.stopPropagation(),this._$list.find(".list-item.active").removeClass("active"),$(t.currentTarget).addClass("active"),this._changed=!0,this._popover.visible=this.visible=!1,this._changed&&(this.editor.ui.uploadTool.isUploading?($("#overlay").show(),this._queuedAfterUploadDone=!0):this.requestMaterial())},e.prototype.onMaterialChange=function(t,e){this.$(".value").html(e.title+' <i class="icon-drop-up"></i>')},e.prototype.onShowPopover=function(){var t=this.editor.ui.toolPane.$el.outerHeight()-this.editor.ui.toolPane.$panelToolsOverview.outerHeight()-this.editor.ui.toolPane.$footer.outerHeight();this._popover.$contentContainer.css("max-height",t+"px")},e.prototype.onShownPopover=function(){this.renderScrollTop()},e.prototype.onTransitionInDone=function(){},e}(r.EditorTool);exports.MaterialPresetEditorTool=l},6488:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.NoteEditorTool=void 0;var r=e(92324),n=e(35896),s=e(42319),a=e(48663),l=function(t){function e(e,o){var i=t.call(this,e,o,"note")||this;return e.data("editor","#"+o.id),e.data("viewport","#"+o.id),e.data("container","#"+o.id),e.data("placement","top"),i._popover=new s.ManualPopover(e),i._popover.$closeButton.remove(),i._popover.$header.remove(),i.editor.model.sheet.note&&i.editor.model.sheet.note.length&&"false"!=i.editor.model.sheet.note&&i.$textarea.val(i.editor.model.sheet.note),i.registerCallback(o.$el,n.EditorEventType.CHANGE_NOTE,(function(t,e){return i.render(e)})),i.on(n.EditorEventType.PRE_SAVE+" "+n.EditorEventType.CLOSE_TOOL+" hidden.bs.popover",(function(){return i.editor.trigger(n.EditorEventType.CHANGE_NOTE,i.$textarea.val())})),i.registerCallback(i.editor.$el,n.EditorEventType.PRE_SAVE,(function(){return i.editor.trigger(n.EditorEventType.CHANGE_NOTE,i.$textarea.val())})),i.on("show.bs.popover",(function(t){return i.onShowPopover()})),i.on("shown.bs.popover",(function(t){return i.onShownPopover()})),i.registerCallback(i.editor.$el,n.EditorEventType.ORIENTATION_UPDATE,(function(t){return i.renderBasedOnEditorOrientation()})),i.registerCallback(i.$body,"click",".cta.done",(function(t){return i.onDone(t)})),i}return i(e,t),e.prototype.render=function(t){this.enabled?(this.$el.removeClass("hidden"),t?(this.$el.addClass("has-note"),this.$(".preview").text(t)):this.$el.removeClass("has-note")):this.$el.addClass("hidden")},e.prototype.setEnabled=function(e){t.prototype.setEnabled.call(this,e),this.render(this.editor.model.sheet.note)},e.prototype.renderBasedOnEditorOrientation=function(){this.editor.isLandscapeOrientation()?(this._popover.disabled=!1,this._popover.$content.append(this.$body)):(this._popover.disabled=!0,this.$content.append(this.$body))},Object.defineProperty(e.prototype,"$textarea",{get:function(){return this.$body.find("textarea")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$body",{get:function(){return this._$body||(this._$body=$(this.$content.find(".tool-content-body"))),this._$body},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$header",{get:function(){return this._$header||(this._$header=$(this.$content.find(".tool-content-header"))),this._$header},enumerable:!1,configurable:!0}),e.prototype.onClick=function(e){this.editor.isLandscapeOrientation()||(e.preventDefault(),t.prototype.onClick.call(this,e))},e.prototype.onShowPopover=function(){},e.prototype.onDone=function(t){t.stopPropagation(),this._popover.visible=!1},e.prototype.onShownPopover=function(){a.MediaUtil.isTouchDevice()||this.$textarea.trigger("focus")},e.prototype.onTransitionInDone=function(){a.MediaUtil.isTouchDevice()||this.$textarea.trigger("focus")},e}(r.EditorTool);exports.NoteEditorTool=l},3076:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.ProductsEditorTool=void 0;var r=function(t){function e(e,o,i,r,n){var s=t.call(this,e,o,n)||this;return s._productsRendered=!1,s.dataURLGetDataProvider=i,s.dataURLGetProductSVG=r,s._$categoryDropdown=s.$header.find(".category-dropdown"),s.registerCallback(s._$categoryDropdown,"click","li a",(function(t){return s.onCategoryClick(t)})),s.registerCallback(s.$body,"click",".products a",(function(t){return s.onProductClick(t)})),s}return i(e,t),e.prototype.render=function(){this.enabled?(this.$el.removeClass("hidden"),this.productsRendered||this.renderProducts()):this.$el.addClass("hidden")},e.prototype.renderProducts=function(){var t=this;this._$categoryDropdown.find(".dropdown-title").text(this._$categoryDropdown.find("li.active a").text());var e=this.$body.find(".products > #cat-"+this.categoryID);if($(e).length)return this.$body.find(".products>.category").addClass("hidden"),$(e).removeClass("hidden"),void(this._productsRendered=!0);this._productsRendered=!0,this.$body.find(".loader").show(),$.ajax({async:!1,type:"get",dataType:"json",timeout:timeout_,url:this.dataURLGetDataProvider,data:{id:this.categoryID},success:function(e){return t.onReceive(e)},error:function(e){return t.onError(e)}})},e.prototype.add=function(t){var e='<a class="f-col-4" href="#!" data-id="'+t.attachment_id+'" style=""><span class="product-card">';e+=t._img,e+="</span>",e+="</a>";var o=$(e);o.find("img.lazy[data-original]").each((function(){$(this).removeClass("lazy"),$(this).attr("src",$(this).data("original"))})),this.$body.find(".products > #cat-"+this.categoryID).append(o),this.$body.find(".img-tall").removeClass("img-tall")},Object.defineProperty(e.prototype,"categoryID",{get:function(){return this._$categoryDropdown.find("li.active a").data("id")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"productsRendered",{get:function(){return this._productsRendered},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dataProvider",{get:function(){return this._dataProvider},set:function(t){var e=this;this._dataProvider=t,this.$body.find(".products>.category").addClass("hidden"),this.$body.find(".products").append('<div class="category f-row" id="cat-'+this.categoryID+'"></div>'),$.each(t,(function(t,o){return e.add(o)}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dataURLGetDataProvider",{get:function(){return this._dataURLGetDataProvider},set:function(t){this._dataURLGetDataProvider=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dataURLGetProductSVG",{get:function(){return this._dataURLGetProductSVG},set:function(t){this._dataURLGetProductSVG=t},enumerable:!1,configurable:!0}),e.prototype.onReceive=function(t){this.dataProvider=t,this.$content.find(".loader").hide(),this.$body.scrollTop(0)},e.prototype.onCategoryClick=function(t){return t.preventDefault(),$(t.target).parent("li").addClass("active").siblings().removeClass("active"),this.renderProducts(),!1},e.prototype.onProductClick=function(t){var e=this;return t.preventDefault(),$("#overlay").show(),$.ajax({type:"get",dataType:"json",timeout:timeout_,url:this.dataURLGetProductSVG+"/"+$(t.currentTarget).data("id"),success:function(t){return e.onReceiveProduct(t)},error:function(t){return e.onError(t)}}),!1},e.prototype.onReceiveProduct=function(t){var e=this;this.editor.api.AddSVG(t,(function(t){return e.onAddedToEditor(t)}),!0)},e.prototype.onAddedToEditor=function(t){$("#overlay").hide()},e.prototype.onError=function(t){$("#overlay").hide(),$("#connection-error").modal("show"),this.$content.find(".loader").hide()},e.prototype.onTransitionInDone=function(t){this.productsRendered||this.renderProducts()},e}(e(92324).EditorTool);exports.ProductsEditorTool=r},46880:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.QuantityEditorTool=void 0;var r=e(2574),n=e(3551),s=e(35896),a=function(t){function e(e,o){var i=t.call(this,e,o)||this;return i.$input.data("editor","#"+o.id),i.$input.data("viewport","#"+o.id),i.$input.data("container","#"+o.id),i.$input.data("placement","top"),i._quantitySelector=new r.QuantitySelector(i.$input),i._quantitySelector.onResult(i.editor.model),i.$input.on("shown.bs.popover",(function(t){return i.onShown()})),i.registerCallback($(i.editor),s.EditorEventType.EDITOR_CONTAINER_CLICK,(function(t){return i.onEditorContainerClick()})),i.registerCallback(i.editor.$el,s.EditorEventType.DESTROY,(function(t){return i._quantitySelector.destroy()})),i}return i(e,t),e.prototype.render=function(){this._quantitySelector.render()},e.prototype.focus=function(){this.$input.trigger("focus")},e.prototype.update=function(){this.$input.trigger("update")},Object.defineProperty(e.prototype,"options",{set:function(t){this._quantitySelector.options=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"oldQuantity",{set:function(t){this.$input.attr("old",t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"minQuantity",{get:function(){return this.$input.attr("min")},set:function(t){this.$input.attr("min",t),parseInt(this.quantity)<parseInt(t)&&(this.quantity=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"quantity",{get:function(){return this.$input.val()},set:function(t){parseInt(t)<parseInt(this.minQuantity)&&(t=this.minQuantity),t!=this.quantity&&(this._quantitySelector.quantity=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$input",{get:function(){return this.editor.model.ui.inputQuantity?$(this.editor.model.ui.inputQuantity):this.$("input.summary-quantity")},enumerable:!1,configurable:!0}),e.prototype.onShown=function(){if(this._quantitySelector.$popover.hasClass("top")){var t=parseFloat(this._quantitySelector.$popover.css("top"));this._quantitySelector.$popover.css("top",t-25+"px")}},e.prototype.onEditorContainerClick=function(){this.$input.trigger("blur"),this._quantitySelector.visible=!1},e}(n.EditorViewComponent);exports.QuantityEditorTool=a},51859:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.SaveButtonEditorTool=void 0;var r=e(35896),n=e(3551),s=e(56716),a=function(t){function e(e,o){var i=t.call(this,e,o)||this;return i.preCheckoutModal=new s.PreCheckoutModal($(".pre-checkout-modal"),i.editor),i.$el.data("viewport","#"+o.id),i.$el.data("container","#"+o.id),i.$el.on("mouseenter",(function(t){return i.onSaveButtonHover(t)})),i.$el.on("mouseleave",(function(t){return i.onSaveButtonHoverOut(t)})),i.editor.on(r.EditorEventType.ZOOM_CHANGE,(function(t,e){return i.onEditorZoomChange(e)})),i.on("click",(function(t){return i.onClick(t)})),i.registerCallback(i.editor.$el,r.EditorEventType.UPLOAD_START,(function(t){return i.$el.addClass("disabled").attr("disabled","disabled")})),i.registerCallback(i.editor.$el,r.EditorEventType.UPLOAD_END,(function(t){return i.$el.removeClass("disabled").attr("disabled",null)})),i.registerCallback(i.editor.$el,r.EditorEventType.UPLOAD_CANCEL,(function(t){return i.$el.removeClass("disabled").attr("disabled",null)})),i}return i(e,t),e.prototype.render=function(t){t?(this.$el.removeClass("disabled").prop("disabled",!1),this.$(".btn-save").tooltip("hide")):this.$el.addClass("disabled").attr("disabled","disabled")},e.prototype.setEnabled=function(e){t.prototype.setEnabled.call(this,e),this.render(this.enabled)},e.prototype.onClick=function(t){var e=this;t.preventDefault(),this.editor.trigger(r.EditorEventType.PRE_SAVE),this.preCheckoutModal.isActive?(this.preCheckoutModal.disable(),this.preCheckoutModal.show(),$("#overlay").addClass("pre-checkout-modal-hide-overlay"),this.editor.once(r.EditorEventType.DATA_POSTED,(function(t,o,i){$("#overlay").removeClass("pre-checkout-modal-hide-overlay"),$.when(e.updateCartIndicator()).then((function(){e.preCheckoutModal.enable()}))})),this.editor.trigger(r.EditorEventType.SAVE,["noRedirect"])):this.editor.trigger(r.EditorEventType.SAVE)},e.prototype.updateCartIndicator=function(){return $.ajax("/checkout/get_cart_num_items",{success:function(t){var e=$(".cart-counter");t!==e.text()&&e.text(t)},error:function(t){}})},e.prototype.onSaveButtonHover=function(t){"sheet"==this.editor.model.sheet.sheet_type&&this.$(".btn-save").hasClass("disabled")&&this.$(".btn-save").tooltip("show")},e.prototype.onSaveButtonHoverOut=function(t){this.$(".btn-save").tooltip("hide")},e.prototype.onEditorZoomChange=function(t){"sheet"==this.editor.model.sheet.sheet_type&&("part"==t?this.setEnabled(!1):this.setEnabled(!0))},e}(n.EditorViewComponent);exports.SaveButtonEditorTool=a},81657:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.StickersEditorTool=void 0;var r=function(t){function e(e,o){return t.call(this,e,o,"/editor/get_stickers","/editor/get_sticker","stickers")||this}return i(e,t),e.prototype.add=function(t){var e='<a class="f-col-4" href="#!" data-id="'+t.id+'">';e+=t._img,e+="</a>";var o=$(e);o.find("img.lazy[data-original]").each((function(){$(this).removeClass("lazy"),$(this).attr("src",$(this).data("original"))})),this.$body.find(".products > #cat-"+this.categoryID).append(o)},e.prototype.onReceiveProduct=function(t){var e=this;this.editor.api.AddSVG(t,(function(){return e.onAddedToEditor()}),!1)},e}(e(3076).ProductsEditorTool);exports.StickersEditorTool=r},65018:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.TemplateEditorTool=void 0;var r=e(92324),n=e(35896),s=e(42319),a=e(400),l=e(65642),d=function(t){function e(e,o){var i=t.call(this,e,o,"template")||this;return e.data("editor","#"+o.id),e.data("viewport","#"+o.id),e.data("container","#"+o.id),e.data("placement","top"),i._popover=new s.ManualPopover(e),i._popover.$header.css("height","auto"),i._popover.$contentContainer.addClass("stretch"),i._popover.$closeButton.remove(),i._$categoryDropdown=i.$header.find(".category-dropdown"),i.$body.append(i._$categoryDropdown.find(".template-menu")),i.registerCallback(i._$categoryDropdown,"click","li:not(.disabled) a",(function(t){return i.onCategoryClick(t)})),i.registerCallback(i.$body,"click",".link-template:not(.disabled)",(function(t){return i.onClickTemplate(t)})),i.registerCallback(i.editor.$el,n.EditorEventType.ORIENTATION_UPDATE,(function(t){return i.renderBasedOnEditorOrientation()})),i.registerCallback(i.editor.$el,n.EditorEventType.DESTROY,(function(t){return i._popover.destroy()})),i.on("show.bs.popover",(function(t){return i.onShowPopover()})),i.on("shown.bs.popover",(function(t){return i.onShownPopover()})),i.registerCallback($(i.editor),n.EditorEventType.EDITOR_CONTAINER_CLICK,(function(t){return i._popover.visible=!1})),i.registerCallback(i.editor.$el,n.EditorEventType.UPLOAD_START,(function(t){return i.onUploadStart()})),i.registerCallback(i.editor.$el,n.EditorEventType.UPLOAD_END,(function(t){return i.onUploadEnd()})),i.registerCallback(i.editor.$el,n.EditorEventType.UPLOAD_CANCEL,(function(t){return i.onUploadEnd()})),i}return i(e,t),e.prototype.render=function(){this.enabled?(this.$el.removeClass("hidden"),this.renderBasedOnEditorOrientation(),this.$header.find(".active").removeClass("active"),this.$body.find(".active").removeClass("active"),"case"==this.editor.model.sheet.sheet_type?"iphone-6-tough"==this.editor.model.sheet.sheet_name?(this.$currentTemplateLink.removeClass("active"),this.$body.find(".link-template[data-template-name='iphone-6-tough']").addClass("active").removeClass("hidden"),this.$body.find(".link-template[data-template-name='iphone5']").removeClass("active").removeClass("hidden"),this.$body.find(".link-template[data-template-name='iphone6'], .link-template[data-template-name='iphone-5-tough']").addClass("hidden").removeClass("active")):"iphone-5-tough"==this.editor.model.sheet.sheet_name?(this.$currentTemplateLink.removeClass("active"),this.$body.find(".link-template[data-template-name='iphone-5-tough']").addClass("active").removeClass("hidden"),this.$body.find(".link-template[data-template-name='iphone6']").removeClass("active").removeClass("hidden"),this.$body.find(".link-template[data-template-name='iphone-6-tough'], .link-template[data-template-name='iphone5']").addClass("hidden").removeClass("active")):"iphone6"==this.editor.model.sheet.sheet_name?(this.$currentTemplateLink.removeClass("active"),this.$body.find(".link-template[data-template-name='iphone6']").addClass("active").removeClass("hidden"),this.$body.find(".link-template[data-template-name='iphone5']").removeClass("active").removeClass("hidden"),this.$body.find(".link-template[data-template-name='iphone-5-tough'], .link-template[data-template-name='iphone-6-tough']").addClass("hidden").removeClass("active")):"iphone5"==this.editor.model.sheet.sheet_name?(this.$currentTemplateLink.removeClass("active"),this.$body.find(".link-template[data-template-name='iphone5']").addClass("active").removeClass("hidden"),this.$body.find(".link-template[data-template-name='iphone6']").removeClass("active").removeClass("hidden"),this.$body.find(".link-template[data-template-name='iphone6'], .link-template[data-template-name='iphone-5-tough'], .link-template[data-template-name='iphone-6-tough']").addClass("hidden").removeClass("active")):(this.$currentTemplateLink.addClass("active"),this.$body.find(".link-template[data-template-name='iphone5'], .link-template[data-template-name='iphone6']").removeClass("hidden").removeClass("active"),this.$body.find(".link-template[data-template-name='iphone-5-tough'], .link-template[data-template-name='iphone-6-tough']").addClass("hidden").removeClass("active")):this.$currentTemplateLink.addClass("active"),this.$currentTemplateCategoryLink.addClass("active"),this._$categoryDropdown.find(".dropdown-title").text(this.currentCategoryTitle),this.$(".template-title").html(this.$currentTemplateLink.text()+' <i class="icon-drop-up"></i>'),this.$body.find(".template-menu[data-category-id='"+this.currentCategoryID+"']").removeClass("hidden").addClass("active").siblings().removeClass("active").addClass("hidden")):this.$el.addClass("hidden")},e.prototype.setEnabled=function(e){t.prototype.setEnabled.call(this,e),this.render()},e.prototype.renderBasedOnEditorOrientation=function(){this.editor.isLandscapeOrientation()?(this._popover.disabled=!1,this._popover.$content.append(this.$body),this._popover.$header.append(this.$header)):(this._popover.disabled=!0,this.$content.append(this.$header),this.$content.append(this.$body))},e.prototype.renderScrollTop=function(){if(this.editor.isLandscapeOrientation()){var t=this.$currentTemplateLink.offset().top-this._popover.$contentContainer.offset().top+this._popover.$contentContainer.scrollTop();this._popover.$contentContainer.scrollTop(t)}else t=this.$currentTemplateLink.offset().top-this.$body.offset().top+this.$body.scrollTop(),this.$body.scrollTop(t)},Object.defineProperty(e.prototype,"$currentTemplateLink",{get:function(){var t=this.editor.model.sheet.sheet_name.replace("-tough","");return"iphone-6-tough"!=this.editor.model.sheet.sheet_name&&"iphone-5-tough"!=this.editor.model.sheet.sheet_name||(t=this.editor.model.sheet.sheet_name),this.$body.find(".link-template[data-template-name='"+t+"']")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentCategoryID",{get:function(){return this.$currentTemplateLink.closest(".template-menu").data("category-id")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentCategoryTitle",{get:function(){return this.$currentTemplateCategoryLink.data("category-title")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$currentTemplateCategoryLink",{get:function(){return this._$categoryDropdown.find("li[data-category-id='"+this.currentCategoryID+"']")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$body",{get:function(){return this._$body||(this._$body=$(this.$content.find(".tool-content-body"))),this._$body},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$header",{get:function(){return this._$header||(this._$header=$(this.$content.find(".tool-content-header"))),this._$header},enumerable:!1,configurable:!0}),e.prototype.onClick=function(e){a.GTMService.openTemplateSelector(this.editor.model.sheet.sheet_name),this.editor.isLandscapeOrientation()||(e.preventDefault(),t.prototype.onClick.call(this,e),this.renderScrollTop())},e.prototype.onCategoryClick=function(t){t.preventDefault();var e=$(t.target).parent("li").data("category-id"),o=$(t.target).parent("li").data("category-title");return a.GTMService.changeTemplateCategory(this.currentCategoryTitle,o),$(t.target).parent("li").addClass("active").siblings().removeClass("active"),this.$body.find(".template-menu[data-category-id='"+e+"']").removeClass("hidden").addClass("active").siblings().removeClass("active").addClass("hidden"),this._$categoryDropdown.find(".dropdown-title").text(o),this._popover.disabled||this._popover.renderPopover(),!1},e.prototype.onClickTemplate=function(t){var e=this;t.preventDefault(),t.stopPropagation();var o=t.currentTarget.dataset,i=o.templateName;this._popover.disabled||(this._popover.visible=!1),this.visible&&(this.visible=!1),i!=this.editor.model.sheet.sheet_name&&(null!=this.editor.svg.collage?l.ConfirmModal.instance.confirmOrCancel(this.editor.model.language.change_template_collage_warning,(function(){"case"==e.editor.model.sheet.sheet_type?e.editor.trigger(n.EditorEventType.CHANGE_TEMPLATE,{templateName:i,templateData:o}):e.editor.trigger(n.EditorEventType.CHANGE_TEMPLATE,{templateName:i})})):"case"==this.editor.model.sheet.sheet_type?this.editor.trigger(n.EditorEventType.CHANGE_TEMPLATE,{templateName:i,templateData:o}):this.editor.trigger(n.EditorEventType.CHANGE_TEMPLATE,{templateName:i}))},e.prototype.onShowPopover=function(){var t=this.editor.ui.toolPane.$el.outerHeight()-this.editor.ui.toolPane.$panelToolsOverview.outerHeight()-this.$el.position().top-this.$el.outerHeight()-75;this._popover.$contentContainer.css("max-height",t+"px")},e.prototype.onShownPopover=function(){this.renderScrollTop()},e.prototype.onUploadStart=function(){this.$el.addClass("disabled"),this.$body.find(".cta").addClass("disabled")},e.prototype.onUploadEnd=function(){this.$el.removeClass("disabled"),this.$body.find(".cta").removeClass("disabled")},e}(r.EditorTool);exports.TemplateEditorTool=d},27419:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.TemplateTypeEditorTool=void 0;var r=e(92324),n=e(35896),s=e(42319),a=e(65642),l=function(t){function e(e,o){var i=t.call(this,e,o,"template-type")||this;return e.data("editor","#"+o.id),e.data("viewport","#"+o.id),e.data("container","#"+o.id),e.data("placement","top"),i._popover=new s.ManualPopover(e),i._popover.$header.css("height","auto"),i._popover.$contentContainer.addClass("stretch"),i._popover.$closeButton.remove(),i._$templateTypeDropdown=i.$header.find(".template-type-dropdown"),i.$body.append(i._$templateTypeDropdown.find(".template-type-dropdown-menu")),i.registerCallback(i.editor.$el,n.EditorEventType.CHANGE_TEMPLATE,(function(t,e){return i.onClickTemplate(t,e)})),i.registerCallback(i.editor.$el,n.EditorEventType.OPEN_TEMPLATE_TYPE_SELECTOR,(function(t,e){return i.updateTemplateTypes(t,e)})),i.registerCallback(i.editor.$el,"click",".template-type-dropdown-item:not(.disabled)",(function(t){return i.onClickTemplateType(t)})),i.registerCallback(i.editor.$el,n.EditorEventType.ORIENTATION_UPDATE,(function(t){return i.renderBasedOnEditorOrientation()})),i.registerCallback(i.editor.$el,n.EditorEventType.DESTROY,(function(t){return i._popover.destroy()})),i.on("show.bs.popover",(function(t){return i.onShowPopover()})),i.registerCallback($(i.editor),n.EditorEventType.EDITOR_CONTAINER_CLICK,(function(t){return i._popover.visible=!1})),i.registerCallback(i.editor.$el,n.EditorEventType.UPLOAD_START,(function(t){return i.onUploadStart()})),i.registerCallback(i.editor.$el,n.EditorEventType.UPLOAD_END,(function(t){return i.onUploadEnd()})),i.registerCallback(i.editor.$el,n.EditorEventType.UPLOAD_CANCEL,(function(t){return i.onUploadEnd()})),i}return i(e,t),e.prototype.render=function(){this.enabled?(this.$el.removeClass("hidden"),this.renderBasedOnEditorOrientation(),this.$currentTemplateTypeLink.addClass("active")):this.$el.addClass("hidden")},e.prototype.setEnabled=function(e){t.prototype.setEnabled.call(this,e),this.render()},e.prototype.renderBasedOnEditorOrientation=function(){this.editor.isLandscapeOrientation()?(this._popover.disabled=!1,this._popover.$content.append(this.$body),this._popover.$header.append(this.$header)):(this._popover.disabled=!0,this.$content.append(this.$header),this.$content.append(this.$body))},e.prototype.renderScrollTop=function(){if(this.editor.isLandscapeOrientation()){var t=this.$currentTemplateTypeLink.offset().top-this._popover.$contentContainer.offset().top+this._popover.$contentContainer.scrollTop();this._popover.$contentContainer.scrollTop(t)}},Object.defineProperty(e.prototype,"$triggerPopoverTemplateTypeLink",{get:function(){return this.$body.find(".cta.tool-template-type")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$currentTemplateTypeLink",{get:function(){return this.$body.find('.template-type-dropdown-item[data-template-name="'+this.editor.model.sheet.sheet_name+'"]')},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$header",{get:function(){return this._$header||(this._$header=$(this.$content.find(".tool-content-header"))),this._$header},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$body",{get:function(){return this._$body||(this._$body=$(this.$content.find(".tool-content-body"))),this._$body},enumerable:!1,configurable:!0}),e.prototype.onClick=function(e){this.editor.isLandscapeOrientation()||(e.preventDefault(),t.prototype.onClick.call(this,e),this.renderScrollTop())},e.prototype.onClickTemplate=function(t,e){var o=e.templateName,i=o.replace("-tough",""),r=!1;"iphone-6"!=i&&"iphone-5"!=i||(r=!0);var s,a,l=e.templateData.templateTypeStrings,d=e.templateData.toughStatus,c=l.split(","),h=c[0],u=c[1];s=u.indexOf("-")>-1?(a=u.split("-"))[0]+" <small>"+a[1]+"</small>":u;var p={slim:{templateType:!0===r?i.replace("-",""):i,html:h,disabled:!1},tough:{templateType:!0===r?o:"1"==d?i+"-tough":"",html:s,disabled:"1"!=d}};this.$(".template-type-title.value").html(h+' <i class="icon-drop-up hidden-xs"></i>'),this.editor.trigger(n.EditorEventType.OPEN_TEMPLATE_TYPE_SELECTOR,{buttons:p,eventString:l})},e.prototype.updateTemplateTypes=function(t,e){this.$triggerPopoverTemplateTypeLink.trigger("click"),this._popover.visible=!0;var o=e.buttons;this.$body.find(".template-type-dropdown-item").removeClass("active");var i=document.querySelector('.template-type-dropdown-item[data-template-type="slim"]');i.classList.add("active"),i.dataset.templateName=o.slim.templateType;var r=document.querySelector('.template-type-dropdown-item[data-template-type="tough"]');r.innerHTML=o.tough.html,r.dataset.templateName=o.tough.templateType,o.tough.disabled?(r.setAttribute("disabled","disabled"),r.classList.add("disabled")):(r.removeAttribute("disabled"),r.classList.remove("disabled"))},e.prototype.onClickTemplateType=function(t){var e=this;t.preventDefault(),t.stopPropagation();var o=t.currentTarget.dataset,i=o.templateName;if(this._popover.disabled||(this._popover.visible=!1),this.visible&&(this.visible=!1),"iphone6-tough"==i&&(i="iphone-6-tough",o.templateName="iphone-6-tough"),"iphone5-tough"==i&&(i="iphone-5-tough",o.templateName="iphone-5-tough"),i!==this.editor.model.sheet.sheet_name){if(null!=this.editor.svg.collage)$("body").find('div.template-menu .f-row[data-template-name="'+i+'"]'),a.ConfirmModal.instance.confirmOrCancel(this.editor.model.language.change_template_collage_warning,(function(){return e.editor.trigger(n.EditorEventType.CHANGE_TEMPLATE,{templateName:i})}));else{this.editor.trigger(n.EditorEventType.CHANGE_TEMPLATE_TYPE,{templateName:i});var r=this.$body.find('li.template-type-dropdown-item[data-template-name="'+i+'"]').text();this.$(".value").html(r+'<i class="icon-drop-up hidden-xs"></i>')}this.$body.find("li.template-type-dropdown-item").removeClass("active"),this.$body.find('li.template-type-dropdown-item[data-template-name="'+i+'"]').addClass("active")}},e.prototype.onShowPopover=function(){var t=this.editor.ui.toolPane.$el.outerHeight()-this.editor.ui.toolPane.$panelToolsOverview.outerHeight()-this.$el.position().top-this.$el.outerHeight()+75;this._popover.$contentContainer.css("max-height",t+"px")},e.prototype.onUploadStart=function(){this.$el.addClass("disabled"),this.$body.find(".cta").addClass("disabled")},e.prototype.onUploadEnd=function(){this.$el.removeClass("disabled"),this.$body.find(".cta").removeClass("disabled")},e}(r.EditorTool);exports.TemplateTypeEditorTool=l},389:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.TextEditorTool=void 0;var r=e(92324),n=e(35896),s=e(24098),a=e(48663),l=e(28977),d=function(t){function e(e,o){var i=t.call(this,e,o,"text")||this;return i.$colorpicker.spectrum({color:"#000000",flat:!0,showButtons:!1,move:function(t){return i.onChangeTextColor(t.toHexString())}}),i.locked=!1,i.registerCallBacks(),i}return i(e,t),e.prototype.registerCallBacks=function(){var t=this;this.on(n.EditorEventType.OPEN_TOOL,(function(e){return t.onOpenTool(e)})),this.registerCallback(this.$content,"input propertychange","textarea",(function(e){return t.onInputText(e)})),this.registerCallback(this.$content,"change","[name=rgb_text_input_type]",(function(){return t.onRGBTextInputTypeChange()})),this.registerCallback(this.$content,"change","[name=rgb_text_input_red], [name=rgb_text_input_blue], [name=rgb_text_input_green]",(function(){return t.onRGBChange()})),this.registerCallback(this.$content,"click","#save-text",(function(){return t.editor.api.DeSelect()})),this.registerCallback(this.$content,"click","li a",(function(e){return t.onSelectFont(e)})),this.registerCallback(this.$content,"click",".btn-alignment",(function(e){return t.onClickAlignment(e)})),this.registerCallback(this.editor.$el,n.EditorEventType.DESELECT_NODE,(function(e){return t.hide()}))},e.prototype.render=function(){if(this.enabled){this.$el.removeClass("hidden"),this.$content.find(".font-preview").text(this.title),this.$content.find(".font-preview").css("font-family",this.fontName),this.$textarea.removeClass("text-center text-right");var t=this.$content.find("input[name=text-align][checked]").siblings("i");this.$content.find(".align-preview > i").attr("class",t.attr("class")),"end"==this.anchor?this.$textarea.addClass("text-right"):"middle"==this.anchor&&this.$textarea.addClass("text-center")}else this.$el.addClass("hidden"),this.hide()},e.prototype.reset=function(){this.text="",this.fontName="",this.color="",this.align="left"},e.prototype.hide=function(){this.visible=!1,this.editor.isLandscapeOrientation()&&this.reset()},e.prototype.show=function(){this.render(),this.visible=!0},e.prototype.setEnabled=function(e){t.prototype.setEnabled.call(this,e),this.render()},e.prototype.setTextByJSON=function(t){this.enabled&&(this.text=t.text,this.fontName=t.font,this.color=t.color,this.anchor=t.align,this.render(),this.editor.isLandscapeOrientation()&&(this.$el.hasClass("active")?this.$textarea.trigger("focus"):this.show()))},Object.defineProperty(e.prototype,"$textarea",{get:function(){return this.$body.find("textarea")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$colorpicker",{get:function(){return this.$body.find("input.colorpicker")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"text",{get:function(){return this.$textarea.val()},set:function(t){this.$textarea.val(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bodyMaxHeight",{set:function(t){this.$body.css("max-height",t);var e=t-80;this.$body.find(".sp-container.sp-flat .sp-top-inner").css("max-height",e>=60?e:t-10+"px"),this.$colorpicker.spectrum("reflow")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"color",{get:function(){return this.$colorpicker.spectrum("get").toHexString()},set:function(t){this.$colorpicker.spectrum("set",t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"align",{get:function(){var t="left";switch(this.anchor){case"end":t="right";break;case"middle":t="center"}return t},set:function(t){switch(t){case"right":t="end";break;case"center":t="middle";break;default:t="start"}this.$content.find("input[name=text-align]").prop("checked",!1).parent("label").removeClass("active"),this.$content.find("input[name=text-align][value="+t+"]").prop("checked",!0).parent("label").addClass("active")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"anchor",{get:function(){return this.$content.find("input[name=text-align][checked]").val()},set:function(t){t||(t="start"),this.$content.find("input[name=text-align]").prop("checked",null).attr("checked",null).parent("label").removeClass("active"),this.$content.find("input[name=text-align][value="+t+"]").attr("checked","checked").prop("checked","checked").parent("label").addClass("active")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"title",{get:function(){return this.$activeFontLink.data("title")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontName",{get:function(){return this.$activeFontLink.data("fontName")},set:function(t){var e=this.$content.find(".font-wrapper ul li a").first();this.$content.find(".font-wrapper ul li a").each((function(){$(this).data("fontName")==t&&(e=$(this))})),this.$activeFontLink=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$activeFontLink",{get:function(){return this.$content.find(".font-wrapper ul li.active a")},set:function(t){this.$content.find(".font-wrapper ul li").removeClass("active"),t.parent("li").addClass("active"),this.$content.find(".font-preview").text(this.title),this.$content.find(".font-preview").css("font-family",this.fontName)},enumerable:!1,configurable:!0}),e.prototype.onOpenTool=function(t){this.visible&&this.$colorpicker.spectrum("reflow")},e.prototype.onTransitionInDone=function(){a.MediaUtil.isTouchDevice()||this.$textarea.trigger("focus")},e.prototype.onInputText=function(t){"back"!=this.editor.api.GetActivePartSide()||(0,l.getBoolean)(this.editor.svg.sheet.sheet_meta.BACKPRINT_MODIFIED)||this.editor.trigger(n.EditorEventType.BACKSIDEPRINT_MODIFIED),this.editor.trigger(n.EditorEventType.PART_EDITED,{edited:"text"}),this.editor.api.ChangeText({font:this.fontName,text:this.text,color:this.color,align:this.anchor,locked:this.locked})},e.prototype.onChangeTextColor=function(t,e){switch(void 0===e&&(e=!0),e&&this.editor.api.ChangeTextColor(t),this.$content.find("[name=rgb_text_input_type]").val()){case"dec":this.$content.find("[name=rgb_text_input_red]").val(parseInt(t.replace("#","").substring(0,2),16)),this.$content.find("[name=rgb_text_input_green]").val(parseInt(t.replace("#","").substring(2,4),16)),this.$content.find("[name=rgb_text_input_blue]").val(parseInt(t.replace("#","").substring(4,6),16));break;case"hex":this.$content.find("[name=rgb_text_input_red]").val(t.replace("#","").substring(0,2).toUpperCase()),this.$content.find("[name=rgb_text_input_green]").val(t.replace("#","").substring(2,4).toUpperCase()),this.$content.find("[name=rgb_text_input_blue]").val(t.replace("#","").substring(4,6).toUpperCase())}},e.prototype.onRGBTextInputTypeChange=function(){this.onChangeTextColor(this.color,!1)},e.prototype.onRGBChange=function(){var t="#";if("dec"==this.$content.find("[name=rgb_text_input_type]").val()){if(isNaN(this.$content.find("[name=rgb_text_input_red]").val())||isNaN(this.$content.find("[name=rgb_text_input_green]").val())||isNaN(this.$content.find("[name=rgb_text_input_blue]").val()))return t=this.color,this.$content.find("[name=rgb_text_input_red]").val(parseInt(t.replace("#","").substring(0,2),16)),this.$content.find("[name=rgb_text_input_green]").val(parseInt(t.replace("#","").substring(2,4),16)),void this.$content.find("[name=rgb_text_input_blue]").val(parseInt(t.replace("#","").substring(4,6),16));(e=parseInt(this.$content.find("[name=rgb_text_input_red]").val()))<0&&(e=0),(o=parseInt(this.$content.find("[name=rgb_text_input_green]").val()))<0&&(o=0),(i=parseInt(this.$content.find("[name=rgb_text_input_blue]").val()))<0&&(i=0),e>255&&(e=255),o>255&&(o=255),i>255&&(i=255),this.$content.find("[name=rgb_text_input_red]").val(e),this.$content.find("[name=rgb_text_input_green]").val(o),this.$content.find("[name=rgb_text_input_blue]").val(i),t+=s.ColorUtil.paddy(e.toString(16),2),t+=s.ColorUtil.paddy(o.toString(16),2),t+=s.ColorUtil.paddy(i.toString(16),2)}if("hex"==this.$content.find("[name=rgb_text_input_type]").val()){var e=this.$content.find("[name=rgb_text_input_red]").val(),o=this.$content.find("[name=rgb_text_input_green]").val(),i=this.$content.find("[name=rgb_text_input_blue]").val();if(!s.ColorUtil.checkHex(e)||!s.ColorUtil.checkHex(o)||!s.ColorUtil.checkHex(i))return t=this.color,this.$content.find("[name=rgb_text_input_red]").val(t.replace("#","").substring(0,2).toUpperCase()),this.$content.find("[name=rgb_text_input_green]").val(t.replace("#","").substring(2,4).toUpperCase()),void this.$content.find("[name=rgb_text_input_blue]").val(t.replace("#","").substring(4,6).toUpperCase());t+=s.ColorUtil.paddy(e,2),t+=s.ColorUtil.paddy(o,2),t+=s.ColorUtil.paddy(i,2)}this.color=t,this.onChangeTextColor(t)},e.prototype.onSelectFont=function(t){this.$activeFontLink=$(t.target),this.editor.api.ChangeText({font:this.fontName}),this.render()},e.prototype.onClickAlignment=function(t){var e=$(t.currentTarget).find("input").val();this.anchor=e,this.$content.find("textarea").trigger("focus"),this.editor.api.ChangeText({align:e}),this.render()},e.prototype.onClick=function(t){if(t.preventDefault(),this.$el.hasClass("disabled"))return!1;this.editor.svg.selected&&this.editor.svg.selected.type==SVG.SHAPE_TEXT||(this.reset(),this.editor.api.DeSelect()),this.show()},e.prototype.disable=function(){t.prototype.setEnabled.call(this,!1),this.$el.addClass("disabled")},e}(r.EditorTool);exports.TextEditorTool=d},19115:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.UploadEditorTool=void 0;var r=e(92324),n=e(44985),s=e(92013),a=e(35896),l=e(28977),d=e(33047),c=function(t){function e(e,o){var i=t.call(this,e,o,"upload")||this;return i._status=d.EditorUploadStatus.IDLE,i._quickloadedNodes=[],i._quickloadBytesLimit=3e6,i.showTooltip=!0,i.hideOnClickOutside=!1,i.initFileUpload(o),i.$progressionZone.addClass("hidden"),i.registerCallback(i.$cancelButton,"click",(function(t){return i.onCancel(t)})),i.registerCallback(i.$dropZone,"click",(function(){return i.open()})),$(document).trigger("changeCurrent","fileupload"),i}return i(e,t),e.prototype.initFileUpload=function(t){var e=this;this.$fileupload.fileupload({i18n:{lang:t.model.editor.lang,mimeTypeError:t.model.language.mime_type_error,fileAppEnabled:t.model.editor.fileAppEnabled},done:function(t,o){return e.onDone(t,o)},progressall:function(t,o){return e.onProgressAll(t,o)},send:function(t,o){return e.filterSend(t,o)},start:function(t){return e.onStart(t)},error:function(t,o){return e.onError(t,o)}})},e.prototype.setEnabled=function(e){t.prototype.setEnabled.call(this,e),this.renderEnabled()},e.prototype.renderOnStart=function(){this.$el.tooltip("destroy"),this.$progressionZone.removeClass("hidden"),this.$dropZone.addClass("hidden"),this.editor.ui.$uploadMessages.remove(),this.progress=0,"sheet"==this.editor.model.sheet.sheet_type&&this.editor.api.isZoomed(),this.visible=!0},e.prototype.renderOnDone=function(){this.editor.isLandscapeOrientation()||(this.visible=!1),this.$progressionZone.addClass("hidden"),this.$dropZone.removeClass("hidden"),this.progress=0,this.$(".progress").addClass("hidden")},e.prototype.renderEnabled=function(){var t=this;if(this.enabled){this.$el.removeClass("hidden"),this.$el.removeClass("disabled");var e=this.$el;this.$el.each((function(){$(this).is(":visible")&&(e=$(this))})),this.showTooltip&&(e.tooltip({placement:this.editor.orientation==n.Editor.ORIENTATION_PORTRAIT?"auto top":"auto left",container:"#"+this.editor.id,trigger:"manual"}).tooltip("show"),setTimeout((function(){return t.$el.tooltip("destroy")}),2500),this.showTooltip=!1),this.renderDropZone()}else this.$el.addClass("hidden"),this.$el.tooltip("destroy")},e.prototype.renderDropZone=function(){this.editor.isLandscapeOrientation()?this.$dropZone.attr("style",""):this.$dropZone.css("display","none")},e.prototype.destroy=function(){this.editor.ui.$fileupload.fileupload("destroy")},e.prototype.open=function(){this.editor.ui.$fileupload.trigger("click")},e.prototype.quickLoad=function(t){for(var e=this,o=function(o){var r=i.editor.ui.$fileupload.data("stapp.fileupload").test(t.item(o));if(r.isApprovedForUpload()&&r.file.size<=i._quickloadBytesLimit){var n=new FileReader,s="image/svg+xml"==t.item(o).type;n.onload=function(t){var i=new Image;i.onload=function(){var t={svg:'<image uploaded="0" upload_id="'+o+'" vector="'+(s?"true":"")+'" xlink:href="'+this.src+'" x="0" y="0" height="'+this.height+'" width="'+this.width+'" />'};e.editor.api.AddSVG(t,(function(t){e._status==d.EditorUploadStatus.DONE||e._status==d.EditorUploadStatus.ERROR?t.remove():e._quickloadedNodes[o]=t}))},i.src=t.target.result},n.readAsDataURL(t.item(o))}},i=this,r=0;r<t.length;r++)o(r);return t},e.prototype.removeQuickLoaded=function(){if(this._quickloadedNodes.length){for(var t=0;t<this._quickloadedNodes.length;t++){var e=this._quickloadedNodes[t];e.onDeleteMenu()&&e.remove()}this.editor.helpers.select.select(null)}},e.prototype.getQuickloadedImageNodeByUploadID=function(t){if(this._quickloadedNodes[t]){var e=this._quickloadedNodes[t];if(e){var o=e.findChildWithOption("upload_id",t);if(o)return o}}return!1},Object.defineProperty(e.prototype,"$fileupload",{get:function(){return this.editor.ui.$fileupload},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bodyMaxHeight",{set:function(t){this.$body.css("max-height",t+"px"),this.$body.css("height",t+"px")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$progressBar",{get:function(){return this.$content.find(".progress-bar")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"progress",{set:function(t){this.$(".progress-bar").css("width",t+"%"),this.$progressBar.css("width",t+"%"),this.$progressBar.attr("aria-valuenow",t),t>0?this.$(".progression").html(t+"%"):this.$(".progression").html("")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$cancelButton",{get:function(){return this.$body.find(".btn.cancel")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$browseButton",{get:function(){return this.$body.find("a.browse-link")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$progressionZone",{get:function(){return this.$body.find(".progression-zone")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$dropZone",{get:function(){return this.$body.find(".drop-zone")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isUploading",{get:function(){return this._status==d.EditorUploadStatus.START},enumerable:!1,configurable:!0}),e.prototype.onDone=function(t,e){var o=e.result.files.length,i=this;$.each(e.result.files,(function(t,e){var r=i.getQuickloadedImageNodeByUploadID(e.upload_id);if(void 0===e.error){if(r)(a=i._quickloadedNodes[e.upload_id]).options.json.svg=null,r.element.setAttribute("xlink:href","https://stickerapp.com"+e.thumb_url),e.vector?(r.element.setAttribute("vector",e.vector),i.editor.helpers.dpi.removeImageNode(r)):r.element.removeAttribute("vector"),r.element.setAttribute("uploaded","1"),r.element.removeAttribute("upload_id"),r.uploaded="1",r.uploaded_id=null,e.fileapp_id&&(r.element.setAttribute("fileapp_id",e.fileapp_id),r.element.setAttribute("fileapp_region",e.fileapp_region)),r.vector=e.vector,--o<=0&&i.renderOnDone();else{var n={svg:""};e.fileapp_id?n.svg='<image fileapp_id="'+e.fileapp_id+'" fileapp_region="'+e.fileapp_region+'" uploaded="1" xlink:href="https://stickerapp.com'+e.thumb_url+'" x="0" y="0" height="'+e.height+'" width="'+e.width+'"':n.svg='<image uploaded="1" xlink:href="https://stickerapp.com'+e.thumb_url+'" x="0" y="0" height="'+e.height+'" width="'+e.width+'"',e.vector&&(n.svg+=' vector="true"'),n.svg+="/>",i.editor.api.AddSVG(n,(function(t){if(--o<=0&&i.renderOnDone(),null==t){var e=i.editor.model.language.editor_image_error;i.editor.ui.showMessage(s.NotificationEditorTool.CATEGORY_UPLOAD,"error",null,e)}}))}i._quickloadedNodes[e.upload_id]}else{if(--o,r){var a=i._quickloadedNodes[e.upload_id];i.editor.svg.selected==a&&i.editor.api.DeSelect(),a.onDeleteMenu()&&a.remove()}o<=0&&(i.renderOnDone(),i.editor.ui.showMessage(s.NotificationEditorTool.CATEGORY_UPLOAD,"error",null,e.error))}})),i._quickloadedNodes=[],this._status=d.EditorUploadStatus.DONE,this.editor.api.GetActivePartId()!=this.editor.api.GetBackPart().id||(0,l.getBoolean)(this.editor.svg.sheet.sheet_meta.BACKPRINT_MODIFIED)||this.editor.trigger(a.EditorEventType.BACKSIDEPRINT_MODIFIED),this.editor.trigger(a.EditorEventType.PART_EDITED,{edited:"upload"}),this.trigger(a.EditorEventType.UPLOAD_END)},e.prototype.onProgressAll=function(t,e){this.progress=parseInt((e.loaded/e.total*100).toString(),10)},e.prototype.filterSend=function(t,e){if(!this.enabled)return!1;if(this.editor.api.isTooManyImages())return this.renderOnDone(),!1;for(var o=!0,i=0;i<e.files.length;i++)switch(e.files.item(i).type){case"image/png":case"image/svg+xml":case"image/jpeg":case"image/gif":break;default:o=!1}return o?(this.quickLoad(e.files),!0):void 0},e.prototype.onStart=function(t){this._status=d.EditorUploadStatus.START,this.renderOnStart(),this.visible=!0,this.trigger(a.EditorEventType.UPLOAD_START)},e.prototype.onError=function(t,e){this.removeQuickLoaded(),this.renderOnDone(),$("#connection-error").modal("show"),this._status=d.EditorUploadStatus.ERROR,this.trigger(a.EditorEventType.UPLOAD_END)},e.prototype.onCancel=function(t){t.preventDefault(),this._status==d.EditorUploadStatus.START&&(this.editor.ui.$fileupload.fileupload("abort"),this._status=d.EditorUploadStatus.IDLE),this.removeQuickLoaded(),this.renderOnDone(),this.trigger(a.EditorEventType.UPLOAD_CANCEL)},e.prototype.onClick=function(e){if(this.$el.hasClass("disabled"))return!1;this.renderDropZone(),this.visible||this.editor.isLandscapeOrientation()?this.visible&&this.editor.isLandscapeOrientation()?this.open():t.prototype.onClick.call(this,e):this.open()},e.prototype.onTransitionInDone=function(){this.$(".progress").addClass("hidden")},e.prototype.onLeave=function(){this._status==d.EditorUploadStatus.START&&this.$(".progress").removeClass("hidden")},e.prototype.show=function(){this.visible=!0},e.prototype.disable=function(){t.prototype.setEnabled.call(this,!1),this.$el.addClass("disabled")},e}(r.EditorTool);exports.UploadEditorTool=c},88270:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.EditorModal=void 0;var r=e(15839),n=e(35896),s=e(65642),a=e(44985),l=e(48663),d=function(t){function e(o){var i=t.call(this,o)||this;if(i._state=e.STATE_RENDER_IDLE,i._animateInClass="fadeInDown",i._animateOutClass="fadeOutUp",e._instance)return i;var r=i,s=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,a=window.devicePixelRatio||1,d=(window.screen.width,window.screen.height*a);return i._$closeButton=i.$("button.close"),i.onOrientationUpdate(null,null),(!s||s&&2436!=d)&&i.$(".editor-modal-content").css("padding-bottom","0"),i.on("click",(function(t){return i.onClick(t)})),i.on(n.EditorEventType.READY,".editor",(function(t,e){r._editor=e,$(this).find(".modal.modal-scrollable").each((function(){r.$el.append($(this)),$(this).on("show.bs.modal",(function(){r.$content.css("opacity","0")})),$(this).on("hide.bs.modal",(function(){r.$content.css("opacity","1")}))}))})),i.on("click",".editor .btn-home, .editor .btn-back, .editor-modal-content > button.close",(function(t){return i.onClickBack(t)})),i.on(n.EditorEventType.ORIENTATION_UPDATE,".editor",(function(t,e){return i.onOrientationUpdate(t,e)})),i.on("mousedown",(function(t){return i.onMouseDown(t)})),i.on("mouseup",(function(t){return i.onMouseUp(t)})),l.MediaUtil.isInstagramInAppBrowser()&&$(window).on("scroll",(function(t){return i.onInstagramWindowScroll(t)})),i}return i(e,t),Object.defineProperty(e,"STATE_RENDER_IDLE",{get:function(){return"state_render_idle"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"STATE_RENDER_LOAD_CSS",{get:function(){return"state_render_load_css"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"STATE_RENDER_LOAD_JS",{get:function(){return"state_render_load_js"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"STATE_RENDER_LOAD_HTML",{get:function(){return"state_render_load_html"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"ELEMENT_ID",{get:function(){return"editor-modal"},enumerable:!1,configurable:!0}),e.prototype.render=function(t,e){var o=this;this.sheetPreviewComponent=e,this.$editor.length||($("#overlay").show(),this._editorAPIURL=t,this.destroyEditor(),this._xhr&&this._xhr.abort(),this._xhr=$.ajax(this._editorAPIURL,{success:function(t){return o.onLoadEditor(t)},error:function(t){}}))},e.prototype.show=function(){this._bodyScrollTopBeforeOpen=$(window).scrollTop(),this.$el.addClass("in"),$("body").addClass("editor-modal-open"),this.buildEditor()},e.prototype.maybeHide=function(t){void 0===t&&(t=!0),this.askBeforeHide?this.confirmHide(t):this.hide(t)},e.prototype.confirmHide=function(t,e){var o=this;return void 0===t&&(t=!0),void 0===e&&(e=null),s.ConfirmModal.instance.confirmOrCancel(this._editor.model.language.unload_warning,(function(){return o.hide(t)}),e),!1},e.prototype.hide=function(t){void 0===t&&(t=!0),$("body").removeClass("editor-modal-open"),$(window).scrollTop(this._bodyScrollTopBeforeOpen),this.$el.removeClass("in"),this.destroyEditor(),t&&this.$el.trigger("hidden.stickerapp.editormodal")},e.prototype.destroyEditor=function(){this.$editor.trigger("selfdestroy.stickerapp.editor"),this.$editor.remove(),this.$(".modal").remove()},e.prototype.buildEditor=function(){this.$editor.trigger("build.stickerapp.editor")},Object.defineProperty(e,"instance",{get:function(){return e._instance||(e._instance=new e($("#"+e.ELEMENT_ID))),e._instance},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"askBeforeHide",{get:function(){return this._editor.model.editor.askBeforeExit&&this._editor.api.isChanged()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"editorAPIURL",{get:function(){return this._editorAPIURL},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$editor",{get:function(){return this.$(".editor")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$content",{get:function(){return this.$(".editor-modal-content")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sheetPreviewComponent",{get:function(){return this._sheetPreviewComponent},set:function(t){this._sheetPreviewComponent=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isShown",{get:function(){return this.$el.hasClass("in")},enumerable:!1,configurable:!0}),e.prototype.onLoadEditor=function(t){$("#overlay").hide(),this._$closeButton.remove(),this.$content.html(t),this.$content.find(".modal").each((function(){$(this).attr("data-backdrop","false")})),this.$content.append(this._$closeButton),this.show()},e.prototype.onClick=function(t){},e.prototype.onMouseDown=function(t){this._$startClickTarget=$(t.target)},e.prototype.onMouseUp=function(t){this._$startClickTarget&&(this._$startClickTarget.hasClass("editor-modal")?this.$el.hasClass("animating")||this.maybeHide():this._$startClickTarget.hasClass("modal")&&this._$startClickTarget.modal("hide")),this._$startClickTarget=null},e.prototype.onClickBack=function(t){t.preventDefault(),t.stopPropagation(),this._editor.model.editor.backPrintToolEnabled?this._editor.ui.closeEditor(t):this.maybeHide()},e.prototype.onOrientationUpdate=function(t,e){var o=e?e.isLandscape:a.Editor.isLandscape(this.$el.width(),this.$el.height()),i=e?e.isLarge:a.Editor.isLarge(this.$el.width(),this.$el.height());this.$el.attr("data-is-orientation-landscape",o),this.$el.attr("data-is-large-mode",i)},e.prototype.onInstagramWindowScroll=function(t){this._editor&&!this._editor.focus&&this.$el.find(".editor-modal-content").css("margin-top",$(window).scrollTop())},e}(r.ViewComponent);exports.EditorModal=d},2574:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.QuantitySelector=void 0;var r=e(42319),n=e(15046),s=e(35896),a=e(400),l=e(61347),d=e(28977),c=e(27761),h=function(t){function e(e){var o=t.call(this,e)||this;return o._asc=!0,o.closeOnClickAgain=!1,o.$popover.addClass("editor-popover-md editor-popover-lg-when-screen-sm editor-popover-quantity-selector"),o.$contentContainer.addClass("stretch"),o.$el.data("editor")&&$(o.$el.data("editor")).on(s.EditorEventType.UPDATED,(function(t,e){return o.onResult(e,!0)})),o.$content.on("mousedown",".list-item",(function(t){return o.onSelect(t)})),o.$el.on("change update",(function(t){return o.render()})),o.$el.on("shown.bs.popover",(function(t){return o.onShown(t)})),o.$el.on("blur",(function(t){return o.visible=!1})),o}return i(e,t),e.prototype.update=function(t,e){var o=this;void 0===t&&(t=!0),void 0===e&&(e=null);var i=n.BackendServiceUtil.getEditorAsJSONURI(this.sheet_type,this.sheet_name,this.design_id,this.quantity,this.width,this.height,this.material,this.laminate,this.lang,this.inc_vat,(0,d.getBoolean)(this.backprint_modified));this._xhr&&this._xhr.abort(),t&&this.$content.html('<div class="f-row"><div class="f-col-12 text-center"><img src="https://stickerapp.com/static/images/web/loaders/light.gif" width="16" height="16"></div></div>'),this.visible&&this.$el.popover("show"),this._xhr=$.ajax(i,{error:function(t){},success:function(i){o.onResult(JSON.parse(i),t),e&&e()}})},e.prototype.formatAddToCartURI=function(t){return void 0===t&&(t=!0),n.BackendServiceUtil.getEditorURI("edit",this.sheet_type,this.sheet_name,this.design_id,this.quantity,this.width,this.height,this.material,this.laminate,this.lang,this.inc_vat,(0,d.getBoolean)(this.backprint_modified),t)},e.prototype.render=function(){this.quantity&&this.quantity%1==0&&(this.$content.find(".list-item").removeClass("active"),this.$content.find(".list-item[data-quantity="+this.quantity+"]").addClass("active"))},e.prototype.clear=function(){this.$content.html("")},e.prototype.renderPopover=function(){t.prototype.renderPopover.call(this),this._visible&&(this.$content.find(".list-item").length||this.update())},e.prototype.select=function(t){this.quantity=t.data("quantity"),this.render(),this.$el.trigger("focus"),this.$el.trigger("update"),l.DevUtil.isCheckout()&&!this.$el.data("editor")?a.GTMService.triggerQuantityStepSelect(t.find(".quantity-formatted").html(),t.find(".price-formatted").html(),"checkout"):a.GTMService.triggerQuantityStepSelect(t.find(".quantity-formatted").html(),t.find(".price-formatted").html(),"editor"),this.trigger({type:c.STAPP_EVENT_SELECT,priceFormatted:t.find(".price-formatted").html()})},Object.defineProperty(e,"DATA_KEY",{get:function(){return"QuantitySelector"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sheet_type",{get:function(){return this.$el.data("sheet_type")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sheet_name",{get:function(){return this.$el.data("sheet_name")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"design_id",{get:function(){return this.$el.data("design_id")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"quantity",{get:function(){return this.$el.val()},set:function(t){this.$el.val(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this.$el.data("width")},set:function(t){this.$el.data("width",t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.$el.data("height")},set:function(t){this.$el.data("height",t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"material",{get:function(){return this.$el.data("material")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"laminate",{get:function(){return this.$el.data("laminate")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lang",{get:function(){return this.$el.data("lang")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"inc_vat",{get:function(){return this.$el.data("inc_vat")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"backprint_modified",{get:function(){return this.$el.data("backprint_modified")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"template",{get:function(){return'\n\t\t\t<div class="popover editor-popover" role="tooltip">\n\t\t\t\t<div class="arrow"></div>\n\t\t\t\t<div class="popover-content"></div>\n\t\t\t</div>\n\t\t'},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"options",{set:function(t){var e=this;$(t).each((function(t,o){var i=$('\n\t\t\t<div class="f-row f-row-as-li cta list-item" data-quantity="'.concat(o.quantity,'">\n\t\t\t   <div class="f-col">\n\t\t\t      <div class="quantity-formatted">').concat(o.quantityFormatted,'</div>\n\t\t\t   </div>\n\t\t\t   <div class="f-col">\n\t\t\t      <div class="price-formatted">').concat(o.price,'</div>\n\t\t\t   </div>\n\t\t\t   <div class="f-col">\n\t\t\t      <div class="save">\n\t\t\t         <div class="price-tag sm">\n\t\t\t            <div class="price">-').concat(o.save,"%</div>\n\t\t\t         </div>\n\t\t\t      </div>\n\t\t\t   </div>\n\t\t\t</div>\n\t\t\t"));o.save&&0!=parseInt(o.save)||i.find(".save").addClass("hidden"),e.$content.append(i)}))},enumerable:!1,configurable:!0}),e.prototype.onResult=function(t,e){void 0===e&&(e=!1),e&&(this.$content.html(""),this._asc=!0,this.options=t.editor.quantityAndPriceOptions,this.$popover.hasClass("top")&&(this.$content.append(this.$content.find(".list-item").get().reverse()),this._asc=!1)),this.visible&&this.$el.popover("show"),this.render(),this.trigger({type:c.STAPP_EVENT_REFRESH,editorData:t})},e.prototype.onSelect=function(t){return t.preventDefault(),t.stopPropagation(),this.select($(t.currentTarget).closest(".list-item")),this.$el.trigger("blur"),!1},e.prototype.onShown=function(t){this.$popover.hasClass("top")&&this.$content.find(".list-item").length&&this._asc&&(this.$content.append(this.$content.find(".list-item").get().reverse()),this._asc=!1)},e}(r.ManualPopover);exports.QuantitySelector=h},42319:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.ManualPopover=void 0;var r=function(t){function e(e){var o=t.call(this,e)||this;return o._visible=!1,o._disabled=!1,o._sticky=!1,o._closeOnClickAgain=!0,o.$content=$('<div class="w-12"></div>'),o.$el.popover({animation:!1,html:!0,content:function(){return o.$content},template:o.template,trigger:"manual"}),o._onBodyMouseDownHandler=function(t){return o.onBodyClick(t)},$("body").on("click",o._onBodyMouseDownHandler),o}return i(e,t),e.prototype.renderPopover=function(){this._visible?(this.$el.addClass("active"),this.$el.popover("show")):(this.$el.popover("hide"),this.$el.removeClass("active"))},e.prototype.destroy=function(){$("body").off("click",this._onBodyMouseDownHandler),this.disabled=!0,this.$el.popover("destroy")},Object.defineProperty(e.prototype,"disabled",{get:function(){return!this.$el.data("bs.popover")||this._disabled},set:function(t){this._disabled=t,1==t&&this.visible&&(this.visible=!1)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"visible",{get:function(){return this.$popover?this.$popover.is(":visible"):this._visible},set:function(t){this._visible!=t&&(this._visible=t,this.renderPopover())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$content",{get:function(){return this._$content},set:function(t){this._$content=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$popover",{get:function(){return this.$el.data("bs.popover").tip()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$contentContainer",{get:function(){return this.$popover.find(".popover-content")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$header",{get:function(){return this.$popover.find(".popover-header")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$closeButton",{get:function(){return this.$popover.find("button.close")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"template",{get:function(){return'\n\t\t\t<div class="popover editor-popover" role="tooltip">\n\t\t\t\t<div class="arrow"></div>\n\t\t\t\t<div class="popover-header">\n\t\t\t\t\t<span class="popover-title"></span>\n\t\t\t\t</div>\n\t\t\t\t<button type="button" class="close" data-dismiss="modal" aria-hidden="true"><i class="icon-cross"></i></button>\n\t\t\t\t<div class="popover-content"></div>\n\t\t\t</div>\n\t\t'},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"closeOnClickAgain",{get:function(){return this._closeOnClickAgain},set:function(t){this._closeOnClickAgain=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sticky",{get:function(){return this._sticky},set:function(t){this._sticky=t},enumerable:!1,configurable:!0}),e.prototype.onBodyClick=function(t){this.disabled||this.sticky||(this.$el.has(t.target).length||this.$el.is(t.target)||this.$popover.has(t.target).length||this.$popover.is(t.target)?this.$el.hasClass("disabled")||$(t.target).hasClass("close")||$(t.target).parent().hasClass("close")||(this.$el.has(t.target).length||this.$el.is(t.target))&&this.visible&&this.closeOnClickAgain?this.visible=!1:this.visible=!0:this.visible=!1)},e}(e(15839).ViewComponent);exports.ManualPopover=r},88939:function(t,exports,e){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.SheetPreviewComponent=void 0;var r=function(t){function e(e,o){var i=t.call(this,e)||this;return i.refreshURL=o,i}return i(e,t),Object.defineProperty(e,"DATA_KEY",{get:function(){return"stickerapp.sheetpreview"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"CSS_CLASS_NAME",{get:function(){return"sheet-preview"},enumerable:!1,configurable:!0}),e.prototype.render=function(t){this.$el.html(t),this.$el.addClass("animated rubberBand").one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",(function(){$(this).removeClass("animated rubberBand")}))},e.prototype.refresh=function(){var t=this;this._xhr&&this._xhr.abort();var e=$("<div class='loader-wrapper'><img src='https://stickerapp.com/static/images/web/loaders/light.gif' class='loader-gif' /> </div>");e.css("width",this.$el.innerWidth()+"px"),e.css("height",this.$el.innerHeight()+"px"),this.$el.html(""),this.$el.append(e),this._xhr=$.ajax(this.refreshURL,{dataType:"html",success:function(e){return t.render(e)},error:function(t){}})},Object.defineProperty(e.prototype,"refreshURL",{get:function(){return this._refreshURL},set:function(t){this._refreshURL=t},enumerable:!1,configurable:!0}),e.getInstance=function(t){return t.data(e.DATA_KEY)||t.data(e.DATA_KEY,new e(t,t.data("refresh-url"))),t.data(e.DATA_KEY)},e}(e(15839).ViewComponent);exports.SheetPreviewComponent=r},84363:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.EventReference=void 0;var e=function(){function t(t,e,o,i){this.object=t,this.eventName=e,this.selector=o,this.callback=i}return Object.defineProperty(t.prototype,"callback",{get:function(){return this._callback},set:function(t){this._callback=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selector",{get:function(){return this._selector},set:function(t){this._selector=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"eventName",{get:function(){return this._eventName},set:function(t){this._eventName=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"object",{get:function(){return this._object},set:function(t){this._object=t},enumerable:!1,configurable:!0}),t}();exports.EventReference=e},71079:function(t,exports){"use strict";var e,o=this&&this.__extends||(e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},e(t,o)},function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function i(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.StappRouter=void 0;var i=function(t){function e(){var e=t.call(this)||this;return e.route(/(.*?)/,"nomatch"),e.start({pushState:!0}),e}return o(e,t),e.prototype.start=function(t){Backbone.history.start(t)},Object.defineProperty(e,"instance",{get:function(){return e._intance||(e._intance=new e),e._intance},enumerable:!1,configurable:!0}),e}(Backbone.Router);exports.StappRouter=i},7353:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Collection=void 0;var e=function(){function t(){this._dp={}}return t.prototype.add=function(t,e,o){return void 0===o&&(o=!0),!(this.has(t)&&!o||(this.has(t)&&this.delete(t),this._dp[t]=e,0))},t.prototype.delete=function(t){delete this._dp[t]},t.prototype.has=function(t){return this._dp.hasOwnProperty(t)},t.prototype.get=function(t){return this.has(t)?this._dp[t]:null},Object.defineProperty(t.prototype,"length",{get:function(){var t=0;for(var e in this._dp)t++;return t},enumerable:!1,configurable:!0}),t}();exports.Collection=e},400:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.GTMService=exports.gtmCookieTypes=void 0;var o=e(61347);exports.gtmCookieTypes=["analytics","marketing"];var i=function(){function t(){}return t.triggerEvent=function(t,e,i,r){void 0===r&&(r=0);var n={event:"com.stickerapp.events.GoogleAnalyticsEvent","event.category":t,"event.action":e,"event.label":i,"event.value":r};o.DevUtil.isDevMode(),dataLayer.push(n)},t.triggerEcommerceEvent=function(t,e){var i={event:t,ecommerce:e};o.DevUtil.isDevMode(),dataLayer.push(i)},t.triggerCheckoutEvent=function(e,o,i){void 0===i&&(i=0),t.triggerEvent("checkout",e,o,i)},t.triggerAdminEvent=function(e,o,i){void 0===i&&(i=0),t.triggerEvent("admin",e,o,i)},t.triggerStartPageEvent=function(e,o,i){void 0===i&&(i=0),t.triggerEvent("start",e,o,i)},t.triggerSingleProductPageEvent=function(e,o,i){void 0===i&&(i=0),t.triggerEvent("single",e,o,i)},t.triggerEditorEvent=function(e,o,i){void 0===i&&(i=0),t.triggerEvent("editor",e,o,i)},t.triggerFigureTagFilterEvent=function(e,o,i){void 0===i&&(i=0),t.triggerEvent("figure_tag_filter",e,o,i)},t.triggerFavoriteEvent=function(e,o,i){void 0===i&&(i=0),t.triggerEvent("favorite",e,o,i)},t.frameByFrameActivity=function(e,o,i){void 0===i&&(i=0),t.triggerEvent("material",e,o,i)},t.triggerPageEvent=function(e,o,i){void 0===i&&(i=0),t.triggerEvent("page",e,o,i)},t.addStickerToSheetFromCart=function(){t.triggerEditorEvent("ADD_STICKER_TO_A_SHEET_IN_THE_CART",window.location.toString())},t.addStickerToNewSheet=function(){t.triggerEditorEvent("ADD_STICKER_TO_A_NEW_SHEET",window.location.toString())},t.addGiftcardToCart=function(e){t.triggerEvent("ADD_GIFTCARD_TO_CART",window.location.toString(),e)},t.triggerQuantityStepSelect=function(e,o,i){void 0===i&&(i="editor"),t.triggerEvent(i,"CLICK_QUANTITY_STEP",e+" - "+o,e)},t.clickDuplicateCartSheet=function(e){t.triggerEvent("cart","CLICK_DUPLICATE_CART_SHEET",e)},t.changeTemplate=function(e,o){t.triggerEditorEvent("CHANGE_TEMPLATE",e+" -> "+o)},t.changeTemplateType=function(e,o){t.triggerEditorEvent("CHANGE_TEMPLATE_TYPE",e+" -> "+o)},t.changeTemplateCategory=function(e,o){t.triggerEditorEvent("CHANGE_TEMPLATE_CATEGORY",e+" -> "+o)},t.changeMaterial=function(e,o){t.triggerEditorEvent("CHANGE_MATERIAL",e+" -> "+o)},t.openTemplateSelector=function(e){t.triggerEditorEvent("OPEN_TEMPLATE_SELECTOR",e)},t.openTemplateTypeSelector=function(e){t.triggerEditorEvent("OPEN_TEMPLATE_TYPE_SELECTOR",e.eventString)},t.easterEggFound=function(){t.triggerEditorEvent("EASTER_EGG","shown")},t.effectLayerAdd=function(e){t.triggerEditorEvent("EFFECT_LAYER_ADD",e)},t.effectLayerRemove=function(e){t.triggerEditorEvent("EFFECT_LAYER_REMOVE",e)},t.effectLayerBrowse=function(e){t.triggerEditorEvent("EFFECT_LAYER_BROWSE",e)},t.effectLayerUploaded=function(e){t.triggerEditorEvent("EFFECT_LAYER_UPLOADED",e)},t.effectLayerDone=function(e){t.triggerEditorEvent("EFFECT_LAYER_DONE",e)},t.preCheckoutModal=function(e){t.triggerEditorEvent("PRE_CHECKOUT_MODAL",e)},t.usageCategoriesCardClick=function(e){t.triggerStartPageEvent("USAGE_CATEGORIES_CARD_CLICK",e)},t.usageCategoriesUsageClick=function(){t.triggerStartPageEvent("USAGE_CATEGORIES_USAGE_BUTTON_CLICK","clicked")},t.wizformButtonClick=function(){t.triggerPageEvent("WIZFORM_BUTTON_CLICK",window.location.toString())},t.triggerEcommercePurchaseEvent=function(t){this.triggerEcommerceEvent("purchase",t)},t.cookieAcceptedEvent=function(t){dataLayer.push({event:"accept",cookie_types:t})},t.cookieAllCategoriesAcceptedEvent=function(){dataLayer.push({event:"accept",cookie_types:["all","necessary","analytics","marketing"]})},t.RenderGTMScript=function(){"undefined"==typeof GTM_MODE||1===GTM_MODE?$("body").append("\t <noscript>\n        <iframe src=\"//www.googletagmanager.com/ns.html?id=GTM-WZXX56\"\n                height=\"0\" width=\"0\" style=\"display:none;visibility:hidden\">\n        </iframe>\n    </noscript>\n    <script>\n            (function ( w, d, s, l, i ) {\n                w[ l ] = w[ l ] || [];\n                w[ l ].push( {\n                    'gtm.start': new Date().getTime(), event: 'gtm.js'\n                } );\n                var f = d.getElementsByTagName( s )[ 0 ],\n                    j = d.createElement( s ), dl = l != 'dataLayer' ? '&l=' + l : '';\n                j.async = true;\n                j.src =\n                    '//www.googletagmanager.com/gtm.js?id=' + i + dl;\n                f.parentNode.insertBefore( j, f );\n            })( window, document, 'script', 'dataLayer', 'GTM-WZXX56' );\n    <\/script>"):"undefined"!=typeof GTM_MODE&&2===GTM_MODE&&$("body").append("\t <noscript>\n        <iframe src=\"https://www.googletagmanager.com/ns.html?id=GTM-WZXX56&gtm_auth=IB3USY9oot_RnA3TMaVkOA&gtm_preview=env-104&gtm_cookies_win=x\"\n                height=\"0\" width=\"0\" style=\"display:none;visibility:hidden\">\n        </iframe>\n    </noscript>\n    <script>\n            (function (w, d, s, l, i) {\n                w[l] = w[l] || [];\n                w[l].push({\n                    'gtm.start':\n                        new Date().getTime(), event: 'gtm.js'\n                });\n                var f = d.getElementsByTagName(s)[0],\n                    j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : '';\n                j.async = true;\n                j.src =\n                    'https://www.googletagmanager.com/gtm.js?id=' + i + dl + '&gtm_auth=IB3USY9oot_RnA3TMaVkOA&gtm_preview=env-104&gtm_cookies_win=x';\n                f.parentNode.insertBefore(j, f);\n            })(window, document, 'script', 'dataLayer', 'GTM-WZXX56');\n    <\/script>")},t.RenderOptimizeScript=function(){$("head").append('<script src="https://www.googleoptimize.com/optimize.js?id=OPT-K8DXW8V"><\/script>')},t}();exports.GTMService=i},28977:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getBoolean=void 0,exports.getBoolean=function(t){switch(t){case!0:case"true":case 1:case"1":return!0;default:return!1}}},24098:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ColorUtil=void 0;var e=function(){function t(){}return t.rgb2hex=function(t){function e(t){return("0"+parseInt(t).toString(16)).slice(-2)}return"#"+e((t=t.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/))[1])+e(t[2])+e(t[3])},t.hexToRgb=function(t){var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null},t.paddy=function(t,e,o){var i=void 0!==o?o:"0",r=new Array(1+e).join(i);return(r+t).slice(-r.length)},t.checkHex=function(t){return!(t.length>2)&&/[A-Fa-f0-9]/.test(t)},t.isHexColor=function(t){return/^#[0-9a-f]{3}(?:[0-9a-f]{3})?$/i.test(t)},t}();exports.ColorUtil=e},41476:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ObjectUtil=void 0;var e=function(){function t(){}return t.removeEmpty=function(e){return Object.keys(e).map((function(o){e[o]instanceof Object?Object.keys(e[o]).length||"function"==typeof e[o].getMonth?t.removeEmpty(e[o]):delete e[o]:""===e[o]&&delete e[o]})),e},t}();exports.ObjectUtil=e},62754:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.StringUtil=void 0;var e=function(){function t(){}return t.uniqueID=function(){return(performance.now()*Math.random()).toString().replace(".","")},t}();exports.StringUtil=e},15839:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ViewComponent=void 0;var e=function(){function t(t){this.$el=t}return t.prototype.$=function(t){return this.$el.find(t)},t.prototype.destroy=function(){this.$el.remove(),this.$el.off()},t.prototype.on=function(t,e,o){return this.$el.on(t,e,o)},t.prototype.off=function(t,e,o){return this.$el.off(t,e,o)},t.prototype.trigger=function(t,e){return this.$el.trigger(t,e)},Object.defineProperty(t.prototype,"$el",{get:function(){return this._$el},set:function(t){this._$el=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"el",{get:function(){return this._$el.get(0)},enumerable:!1,configurable:!0}),t}();exports.ViewComponent=e},29421:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CSSEventType=void 0;var e=function(){function t(){}return Object.defineProperty(t,"ANIMATION_END",{get:function(){return"webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend"},enumerable:!1,configurable:!0}),t}();exports.CSSEventType=e},37463:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CartEventType=void 0;var e=function(){function t(){}return Object.defineProperty(t,"UPDATE",{get:function(){return"updatestickerappcart"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"CHANGE",{get:function(){return"changestickerappcart"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"DUPLICATED_CART_SHEET",{get:function(){return"duplicatedcartsheet"},enumerable:!1,configurable:!0}),t}();exports.CartEventType=e},27761:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.STAPP_EVENT_END=exports.STAPP_EVENT_START=exports.STAPP_EVENT_SELECT=exports.STAPP_EVENT_REFRESH=exports.STAPP_EVENT_OPEN=exports.STAPP_EVENT_CLOSE=exports.STAPP_EVENT_ERROR=exports.STAPP_EVENT_READY=exports.STAPP_EVENT_DONE=exports.STAPP_EVENT_PRE_SUBMIT_FORM_MODAL=exports.STAPP_EVENT_SUBMITTED_FORM_MODAL=exports.STAPP_EVENT_LOAD_FORM_MODAL=exports.STAPP_EVENT_CHANGE=exports.STAPP_EVENT_PROGRESS=void 0,exports.STAPP_EVENT_PROGRESS="progress.stapp",exports.STAPP_EVENT_CHANGE="change.stapp",exports.STAPP_EVENT_LOAD_FORM_MODAL="loadformmodal.stapp",exports.STAPP_EVENT_SUBMITTED_FORM_MODAL="submittedformmodal.stapp",exports.STAPP_EVENT_PRE_SUBMIT_FORM_MODAL="presubmitformmodal.stapp",exports.STAPP_EVENT_DONE="done.stapp",exports.STAPP_EVENT_READY="ready.stapp",exports.STAPP_EVENT_ERROR="error.stapp",exports.STAPP_EVENT_CLOSE="close.stapp",exports.STAPP_EVENT_OPEN="open.stapp",exports.STAPP_EVENT_REFRESH="refresh.stapp",exports.STAPP_EVENT_SELECT="select.stapp",exports.STAPP_EVENT_START="start.stapp",exports.STAPP_EVENT_END="end.stapp"},2650:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var o=e(88270),i=e(88939),r=e(35896),n=e(71079),s=e(48663),a=e(65642);$((function(){var t;n.StappRouter.instance.route("editor/edit/*path","viewEditor"),n.StappRouter.instance.route(/action=edit_template/,"viewEditor"),n.StappRouter.instance.on("route:nomatch",(function(t){o.EditorModal.instance.isShown&&(o.EditorModal.instance.askBeforeHide?(o.EditorModal.instance.confirmHide(!1,(function(){return window.history.forward()})),s.MediaUtil.isTouchDevice()&&setTimeout((function(){a.ConfirmModal.instance.$el.scrollTop(10)}),500)):o.EditorModal.instance.hide(!1))})),n.StappRouter.instance.on("route:viewEditor",(function(t){var e=Backbone.history.getFragment(),o=$("a[href='"+e+"'],a[href='/"+e+"'],a[href='/"+e+"/'],a[href='"+e+"/']");o.length&&o.trigger("click")})),$("body").on("click","a[data-toggle=editor]",(function(e){e.preventDefault(),o.EditorModal.instance.render($(this).attr("href"),$(this).data("sheet-preview-component")),t=Backbone.history.getFragment(),n.StappRouter.instance.navigate($(this).attr("href"),{trigger:!1}),$("body").hasClass("modal-open")&&$(".cart .hybrid-drawer-trigger").trigger("click")})),$("body").on("hide.editormodal.stickerapp",(function(){return o.EditorModal.instance.hide()})),$("body").on(r.EditorEventType.DATA_POSTED,(function(e,r,s,a){"noRedirect"!==a&&(n.StappRouter.instance.navigate(t,{trigger:!1}),o.EditorModal.instance.hide(!1),o.EditorModal.instance.sheetPreviewComponent&&o.EditorModal.instance.sheetPreviewComponent.length&&$(o.EditorModal.instance.sheetPreviewComponent).length&&setTimeout((function(){i.SheetPreviewComponent.getInstance($(o.EditorModal.instance.sheetPreviewComponent)).refresh()}),300))})),$("body").on("hidden.stickerapp.editormodal",(function(){window.history.back()}))}))},52507:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var o=e(44985);$((function(){if(!window.EDITOR_INITIATED){var t=e(34851).toString();$("head").append('<style type="text/css" title="svg" media="all">'+t+"</style>"),$("div.editor").length&&$("div.editor").each((function(){$(this).attr("id")||$(this).attr("id",o.Editor.constructUniqueID()),o.Editor.getInstance($(this).attr("id"))})),$(document).on("build.stickerapp.editor","div.editor",(function(t){$(t.currentTarget).attr("id")||$(t.currentTarget).attr("id",o.Editor.constructUniqueID()),o.Editor.getInstance($(t.currentTarget).attr("id"))})),$(document).on("selfdestroy.stickerapp.editor","div.editor",(function(t){o.Editor.getInstance($(t.currentTarget).attr("id")).destroy()})),window.EDITOR_INITIATED=!0}}))},92090:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var o=e(88939);$(document).ready((function(){var t="."+o.SheetPreviewComponent.CSS_CLASS_NAME;$("body").on("refresh.sheetpreview.stickerapp",t,(function(t){o.SheetPreviewComponent.getInstance($(this)).refresh()}))}))},15046:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.BackendServiceUtil=void 0;var e=function(){function t(){}return t.getURL=function(t){var e=TOOLS_URL+"/";return t&&t.length?e+t:e},t.getEditorAsJSONURI=function(e,o,i,r,n,s,a,l,d,c,h){return void 0===h&&(h=!1),t.getEditorURI("get_as_json",e,o,i,r,n,s,a,l,d,c,h)},t.getEditorURI=function(t,e,o,i,r,n,s,a,l,d,c,h,u){void 0===h&&(h=!1),void 0===u&&(u=!1);var p="/editor/"+t+"/new/"+e+"/"+o+"/"+i+"/"+r+"/"+n+"/"+s+"/"+a+"/"+l+"/"+d+"/"+c+"/"+h;return u&&(p+="?checkout"),p},Object.defineProperty(t,"METHOD_URI_THUMB",{get:function(){return"thumb"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"METHOD_URI_OUTLINE",{get:function(){return"outline"},enumerable:!1,configurable:!0}),t}();exports.BackendServiceUtil=e},61347:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DevUtil=void 0;var e=function(){function t(){}return t.getDomain=function(){return window.hasOwnProperty("DOMAIN")?DOMAIN:""},t.getProtocol=function(){return window.hasOwnProperty("PROTOCOL")?PROTOCOL:""},t.isDevMode=function(){return window.hasOwnProperty("ENVIRONMENT")&&"development"==ENVIRONMENT},t.isLocalDevMode=function(){return window.location.toString().indexOf("192.168")>=0},t.isTestMode=function(){return window.hasOwnProperty("ENVIRONMENT")&&"testing"==ENVIRONMENT},t.isAdmin=function(){return window.location.toString().indexOf("admin.stickerapp")>=0||window.location.toString().indexOf("admin.photoapp")>=0||window.location.toString().indexOf("admin.mxapp")>=0},t.langTRoTLD=function(e){if(t.isDevMode())return"ci";if(t.isTestMode())return"nu";switch(e){case"us":e="com";break;case"uk":e="co.uk"}return e},t.isCheckout=function(){return $("body").hasClass("checkout")},t}();exports.DevUtil=e,window.DevUtil=e},48663:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MediaUtil=void 0;var e=function(){function t(){}return t.isLandscape=function(t,e){var o=t>=480;return t<=e&&t<800&&(o=!1),o},t.isLarge=function(t,e){return t>=480&&e>=480},t.isTouchDevice=function(){return!!("ontouchstart"in window)},t.getDeviceType=function(){var t=navigator.userAgent;return/(tablet|ipad|playbook|silk)|(android(?!.*mobi))/i.test(t)?"tablet":/Mobile|iP(hone|od)|Android|BlackBerry|IEMobile|Kindle|Silk-Accelerated|(hpw|web)OS|Opera M(obi|ini)/.test(t)?"mobile":"desktop"},t.isInstagramInAppBrowser=function(){return!!navigator.userAgent.match(/instagram/i)},t}();exports.MediaUtil=e},62132:t=>{t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var o=function(t,e){var o=t[1]||"",i=t[3];return i?e&&"function"==typeof btoa?(t=function(t){return"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(t))))+" */"}(i),e=i.sources.map((function(t){return"/*# sourceURL="+i.sourceRoot+t+" */"})),[o].concat(e).concat([t]).join("\n")):[o].join("\n"):o}(e,t);return e[2]?"@media "+e[2]+"{"+o+"}":o})).join("")},e.i=function(t,o){"string"==typeof t&&(t=[[null,t,""]]);for(var i={},r=0;r<this.length;r++){var n=this[r][0];"number"==typeof n&&(i[n]=!0)}for(r=0;r<t.length;r++){var s=t[r];"number"==typeof s[0]&&i[s[0]]||(o&&!s[2]?s[2]=o:o&&(s[2]="("+s[2]+") and ("+o+")"),e.push(s))}},e}}},e={};function o(i){var r=e[i];if(void 0!==r)return r.exports;var n=e[i]={id:i,exports:{}};return t[i].call(n.exports,n,n.exports,o),n.exports}(()=>{"use strict";o(89761),o(47662),window.SELECT_TOOL_MOVE="move",window.SELECT_TOOL_ROTATE="rotate",window.SELECT_TOOL_ROTATE_INVERSE="rotate_inverse",window.SELECT_TOOL_NE_RESIZE="neResize",window.SELECT_TOOL_NW_RESIZE="nwResize",window.SELECT_TOOL_SW_RESIZE="swResize",window.SELECT_TOOL_SE_RESIZE="seResize",window.SELECT_TOOL_N_RESIZE="nResize",window.SELECT_TOOL_W_RESIZE="wResize",window.SELECT_TOOL_S_RESIZE="sResize",window.SELECT_TOOL_E_RESIZE="eResize",window.SELECT_TOOL_RESIZE="resize",window.SELECT_TOOL_DELETE="delete",window.SELECT_ICON_SIZE=20,window.SELECT_MENU_UP="menuOptionUp",window.SELECT_MENU_DOWN="menuOptionDown",window.SELECT_MENU_EDIT="menuOptionEdit",window.SELECT_MENU_DELETE="menuOptionDelete",window.SELECT_MENU_COPY="menuOptionCopy",window.SELECT_MENU_COLLAGE="menuOptionCollage",window.SELECT_MENU_UPLOAD="menuOptionUpload",window.SELECT_MENU_CENTER_VER="menuOptionCenterVer",window.SELECT_MENU_CENTER_HOR="menuOptionCenterHor",window.SELECT_MENU_PART_UP="menuOptionPartUp",window.SELECT_MENU_PART_DOWN="menuOptionPartDown",o(2170),o(55215),o(8830),o(63353),o(93318),o(75255),o(20375),o(61118),o(13400),o(44142),o(73508),o(62008),o(62788),o(85804),o(90277),o(33926),o(94461),o(62342),o(40940),o(11174),o(8417),o(13708),o(52507),o(2650),o(92090)})()})();